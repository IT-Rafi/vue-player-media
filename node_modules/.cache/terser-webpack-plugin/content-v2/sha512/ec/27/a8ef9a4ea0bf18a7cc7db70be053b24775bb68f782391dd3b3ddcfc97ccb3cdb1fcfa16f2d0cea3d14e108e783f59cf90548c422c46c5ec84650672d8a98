{"code":"!function(e,t){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define(\"VuePlayer\",[],t):\"object\"==typeof exports?exports.VuePlayer=t():e.VuePlayer=t()}(window,(function(){return r={},e.m=t={\"./node_modules/@babel/runtime/helpers/typeof.js\":function(e,t){function r(t){return\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?e.exports=r=function(e){return typeof e}:e.exports=r=function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e},r(t)}e.exports=r},\"./node_modules/css-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js!./node_modules/dplayer/dist/DPlayer.min.css\":function(e,t,r){(t=r(\"./node_modules/css-loader/dist/runtime/api.js\")(!1)).push([e.i,\"button[data-balloon]{overflow:visible}[data-balloon]{position:relative;cursor:pointer}[data-balloon]:after{font-family:sans-serif !important;font-weight:400 !important;font-style:normal !important;text-shadow:none !important;font-size:12px !important;background:rgba(18,18,18,0.9);border-radius:4px;color:#fff;content:attr(data-balloon);padding:.5em 1em;white-space:nowrap}[data-balloon]:after,[data-balloon]:before{filter:alpha(opactiy=0);-ms-filter:\\\"progid:DXImageTransform.Microsoft.Alpha(Opacity=0)\\\";-moz-opacity:0;-khtml-opacity:0;opacity:0;pointer-events:none;transition:all .18s ease-out .18s;position:absolute;z-index:10}[data-balloon]:before{background:no-repeat url(\\\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='36' height='12'%3E%3Cpath fill='rgba(17, 17, 17, 0.9)' d='M2.658 0h32.004c-6 0-11.627 12.002-16.002 12.002C14.285 12.002 8.594 0 2.658 0z'/%3E%3C/svg%3E\\\");background-size:100% auto;width:18px;height:6px;content:\\\"\\\"}[data-balloon]:hover:after,[data-balloon]:hover:before,[data-balloon][data-balloon-visible]:after,[data-balloon][data-balloon-visible]:before{filter:alpha(opactiy=100);-ms-filter:\\\"progid:DXImageTransform.Microsoft.Alpha(Opacity=100)\\\";-moz-opacity:1;-khtml-opacity:1;opacity:1;pointer-events:auto}[data-balloon].font-awesome:after{font-family:FontAwesome}[data-balloon][data-balloon-break]:after{white-space:pre}[data-balloon][data-balloon-blunt]:after,[data-balloon][data-balloon-blunt]:before{transition:none}[data-balloon][data-balloon-pos=up]:after{margin-bottom:11px}[data-balloon][data-balloon-pos=up]:after,[data-balloon][data-balloon-pos=up]:before{bottom:100%;left:50%;-webkit-transform:translate(-50%, 10px);transform:translate(-50%, 10px);-webkit-transform-origin:top;transform-origin:top}[data-balloon][data-balloon-pos=up]:before{margin-bottom:5px}[data-balloon][data-balloon-pos=up]:hover:after,[data-balloon][data-balloon-pos=up]:hover:before,[data-balloon][data-balloon-pos=up][data-balloon-visible]:after,[data-balloon][data-balloon-pos=up][data-balloon-visible]:before{-webkit-transform:translate(-50%);transform:translate(-50%)}[data-balloon][data-balloon-pos=up-left]:after{left:0;margin-bottom:11px}[data-balloon][data-balloon-pos=up-left]:after,[data-balloon][data-balloon-pos=up-left]:before{bottom:100%;-webkit-transform:translateY(10px);transform:translateY(10px);-webkit-transform-origin:top;transform-origin:top}[data-balloon][data-balloon-pos=up-left]:before{left:5px;margin-bottom:5px}[data-balloon][data-balloon-pos=up-left]:hover:after,[data-balloon][data-balloon-pos=up-left]:hover:before,[data-balloon][data-balloon-pos=up-left][data-balloon-visible]:after,[data-balloon][data-balloon-pos=up-left][data-balloon-visible]:before{-webkit-transform:translate(0);transform:translate(0)}[data-balloon][data-balloon-pos=up-right]:after{right:0;margin-bottom:11px}[data-balloon][data-balloon-pos=up-right]:after,[data-balloon][data-balloon-pos=up-right]:before{bottom:100%;-webkit-transform:translateY(10px);transform:translateY(10px);-webkit-transform-origin:top;transform-origin:top}[data-balloon][data-balloon-pos=up-right]:before{right:5px;margin-bottom:5px}[data-balloon][data-balloon-pos=up-right]:hover:after,[data-balloon][data-balloon-pos=up-right]:hover:before,[data-balloon][data-balloon-pos=up-right][data-balloon-visible]:after,[data-balloon][data-balloon-pos=up-right][data-balloon-visible]:before{-webkit-transform:translate(0);transform:translate(0)}[data-balloon][data-balloon-pos=down]:after{margin-top:11px}[data-balloon][data-balloon-pos=down]:after,[data-balloon][data-balloon-pos=down]:before{left:50%;top:100%;-webkit-transform:translate(-50%, -10px);transform:translate(-50%, -10px)}[data-balloon][data-balloon-pos=down]:before{background:no-repeat url(\\\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='36' height='12'%3E%3Cpath fill='rgba(17, 17, 17, 0.9)' d='M33.342 12H1.338c6 0 11.627-12.002 16.002-12.002C21.715-.002 27.406 12 33.342 12z'/%3E%3C/svg%3E\\\");background-size:100% auto;width:18px;height:6px;margin-top:5px}[data-balloon][data-balloon-pos=down]:hover:after,[data-balloon][data-balloon-pos=down]:hover:before,[data-balloon][data-balloon-pos=down][data-balloon-visible]:after,[data-balloon][data-balloon-pos=down][data-balloon-visible]:before{-webkit-transform:translate(-50%);transform:translate(-50%)}[data-balloon][data-balloon-pos=down-left]:after{left:0;margin-top:11px;top:100%;-webkit-transform:translateY(-10px);transform:translateY(-10px)}[data-balloon][data-balloon-pos=down-left]:before{background:no-repeat url(\\\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='36' height='12'%3E%3Cpath fill='rgba(17, 17, 17, 0.9)' d='M33.342 12H1.338c6 0 11.627-12.002 16.002-12.002C21.715-.002 27.406 12 33.342 12z'/%3E%3C/svg%3E\\\");background-size:100% auto;width:18px;height:6px;left:5px;margin-top:5px;top:100%;-webkit-transform:translateY(-10px);transform:translateY(-10px)}[data-balloon][data-balloon-pos=down-left]:hover:after,[data-balloon][data-balloon-pos=down-left]:hover:before,[data-balloon][data-balloon-pos=down-left][data-balloon-visible]:after,[data-balloon][data-balloon-pos=down-left][data-balloon-visible]:before{-webkit-transform:translate(0);transform:translate(0)}[data-balloon][data-balloon-pos=down-right]:after{right:0;margin-top:11px;top:100%;-webkit-transform:translateY(-10px);transform:translateY(-10px)}[data-balloon][data-balloon-pos=down-right]:before{background:no-repeat url(\\\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='36' height='12'%3E%3Cpath fill='rgba(17, 17, 17, 0.9)' d='M33.342 12H1.338c6 0 11.627-12.002 16.002-12.002C21.715-.002 27.406 12 33.342 12z'/%3E%3C/svg%3E\\\");background-size:100% auto;width:18px;height:6px;right:5px;margin-top:5px;top:100%;-webkit-transform:translateY(-10px);transform:translateY(-10px)}[data-balloon][data-balloon-pos=down-right]:hover:after,[data-balloon][data-balloon-pos=down-right]:hover:before,[data-balloon][data-balloon-pos=down-right][data-balloon-visible]:after,[data-balloon][data-balloon-pos=down-right][data-balloon-visible]:before{-webkit-transform:translate(0);transform:translate(0)}[data-balloon][data-balloon-pos=left]:after{margin-right:11px;right:100%;top:50%;-webkit-transform:translate(10px, -50%);transform:translate(10px, -50%)}[data-balloon][data-balloon-pos=left]:before{background:no-repeat url(\\\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='36'%3E%3Cpath fill='rgba(17, 17, 17, 0.9)' d='M0 33.342V1.338c0 6 12.002 11.627 12.002 16.002C12.002 21.715 0 27.406 0 33.342z'/%3E%3C/svg%3E\\\");background-size:100% auto;width:6px;height:18px;margin-right:5px;right:100%;top:50%;-webkit-transform:translate(10px, -50%);transform:translate(10px, -50%)}[data-balloon][data-balloon-pos=left]:hover:after,[data-balloon][data-balloon-pos=left]:hover:before,[data-balloon][data-balloon-pos=left][data-balloon-visible]:after,[data-balloon][data-balloon-pos=left][data-balloon-visible]:before{-webkit-transform:translateY(-50%);transform:translateY(-50%)}[data-balloon][data-balloon-pos=right]:after{left:100%;margin-left:11px;top:50%;-webkit-transform:translate(-10px, -50%);transform:translate(-10px, -50%)}[data-balloon][data-balloon-pos=right]:before{background:no-repeat url(\\\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='36'%3E%3Cpath fill='rgba(17, 17, 17, 0.9)' d='M12 2.658v32.004c0-6-12.002-11.627-12.002-16.002C-.002 14.285 12 8.594 12 2.658z'/%3E%3C/svg%3E\\\");background-size:100% auto;width:6px;height:18px;left:100%;margin-left:5px;top:50%;-webkit-transform:translate(-10px, -50%);transform:translate(-10px, -50%)}[data-balloon][data-balloon-pos=right]:hover:after,[data-balloon][data-balloon-pos=right]:hover:before,[data-balloon][data-balloon-pos=right][data-balloon-visible]:after,[data-balloon][data-balloon-pos=right][data-balloon-visible]:before{-webkit-transform:translateY(-50%);transform:translateY(-50%)}[data-balloon][data-balloon-length=small]:after{white-space:normal;width:80px}[data-balloon][data-balloon-length=medium]:after{white-space:normal;width:150px}[data-balloon][data-balloon-length=large]:after{white-space:normal;width:260px}[data-balloon][data-balloon-length=xlarge]:after{white-space:normal;width:380px}@media screen and (max-width: 768px){[data-balloon][data-balloon-length=xlarge]:after{white-space:normal;width:90vw}}[data-balloon][data-balloon-length=fit]:after{white-space:normal;width:100%}@-webkit-keyframes my-face{2%{-webkit-transform:translateY(1.5px) rotate(1.5deg);transform:translateY(1.5px) rotate(1.5deg)}4%{-webkit-transform:translateY(-1.5px) rotate(-0.5deg);transform:translateY(-1.5px) rotate(-0.5deg)}6%{-webkit-transform:translateY(1.5px) rotate(-1.5deg);transform:translateY(1.5px) rotate(-1.5deg)}8%{-webkit-transform:translateY(-1.5px) rotate(-1.5deg);transform:translateY(-1.5px) rotate(-1.5deg)}10%{-webkit-transform:translateY(2.5px) rotate(1.5deg);transform:translateY(2.5px) rotate(1.5deg)}12%{-webkit-transform:translateY(-0.5px) rotate(1.5deg);transform:translateY(-0.5px) rotate(1.5deg)}14%{-webkit-transform:translateY(-1.5px) rotate(1.5deg);transform:translateY(-1.5px) rotate(1.5deg)}16%{-webkit-transform:translateY(-0.5px) rotate(-1.5deg);transform:translateY(-0.5px) rotate(-1.5deg)}18%{-webkit-transform:translateY(0.5px) rotate(-1.5deg);transform:translateY(0.5px) rotate(-1.5deg)}20%{-webkit-transform:translateY(-1.5px) rotate(2.5deg);transform:translateY(-1.5px) rotate(2.5deg)}22%{-webkit-transform:translateY(0.5px) rotate(-1.5deg);transform:translateY(0.5px) rotate(-1.5deg)}24%{-webkit-transform:translateY(1.5px) rotate(1.5deg);transform:translateY(1.5px) rotate(1.5deg)}26%{-webkit-transform:translateY(0.5px) rotate(0.5deg);transform:translateY(0.5px) rotate(0.5deg)}28%{-webkit-transform:translateY(0.5px) rotate(1.5deg);transform:translateY(0.5px) rotate(1.5deg)}30%{-webkit-transform:translateY(-0.5px) rotate(2.5deg);transform:translateY(-0.5px) rotate(2.5deg)}32%{-webkit-transform:translateY(1.5px) rotate(-0.5deg);transform:translateY(1.5px) rotate(-0.5deg)}34%{-webkit-transform:translateY(1.5px) rotate(-0.5deg);transform:translateY(1.5px) rotate(-0.5deg)}36%{-webkit-transform:translateY(-1.5px) rotate(2.5deg);transform:translateY(-1.5px) rotate(2.5deg)}38%{-webkit-transform:translateY(1.5px) rotate(-1.5deg);transform:translateY(1.5px) rotate(-1.5deg)}40%{-webkit-transform:translateY(-0.5px) rotate(2.5deg);transform:translateY(-0.5px) rotate(2.5deg)}42%{-webkit-transform:translateY(2.5px) rotate(-1.5deg);transform:translateY(2.5px) rotate(-1.5deg)}44%{-webkit-transform:translateY(1.5px) rotate(0.5deg);transform:translateY(1.5px) rotate(0.5deg)}46%{-webkit-transform:translateY(-1.5px) rotate(2.5deg);transform:translateY(-1.5px) rotate(2.5deg)}48%{-webkit-transform:translateY(-0.5px) rotate(0.5deg);transform:translateY(-0.5px) rotate(0.5deg)}50%{-webkit-transform:translateY(0.5px) rotate(0.5deg);transform:translateY(0.5px) rotate(0.5deg)}52%{-webkit-transform:translateY(2.5px) rotate(2.5deg);transform:translateY(2.5px) rotate(2.5deg)}54%{-webkit-transform:translateY(-1.5px) rotate(1.5deg);transform:translateY(-1.5px) rotate(1.5deg)}56%{-webkit-transform:translateY(2.5px) rotate(2.5deg);transform:translateY(2.5px) rotate(2.5deg)}58%{-webkit-transform:translateY(0.5px) rotate(2.5deg);transform:translateY(0.5px) rotate(2.5deg)}60%{-webkit-transform:translateY(2.5px) rotate(2.5deg);transform:translateY(2.5px) rotate(2.5deg)}62%{-webkit-transform:translateY(-0.5px) rotate(2.5deg);transform:translateY(-0.5px) rotate(2.5deg)}64%{-webkit-transform:translateY(-0.5px) rotate(1.5deg);transform:translateY(-0.5px) rotate(1.5deg)}66%{-webkit-transform:translateY(1.5px) rotate(-0.5deg);transform:translateY(1.5px) rotate(-0.5deg)}68%{-webkit-transform:translateY(-1.5px) rotate(-0.5deg);transform:translateY(-1.5px) rotate(-0.5deg)}70%{-webkit-transform:translateY(1.5px) rotate(0.5deg);transform:translateY(1.5px) rotate(0.5deg)}72%{-webkit-transform:translateY(2.5px) rotate(1.5deg);transform:translateY(2.5px) rotate(1.5deg)}74%{-webkit-transform:translateY(-0.5px) rotate(0.5deg);transform:translateY(-0.5px) rotate(0.5deg)}76%{-webkit-transform:translateY(-0.5px) rotate(2.5deg);transform:translateY(-0.5px) rotate(2.5deg)}78%{-webkit-transform:translateY(-0.5px) rotate(1.5deg);transform:translateY(-0.5px) rotate(1.5deg)}80%{-webkit-transform:translateY(1.5px) rotate(1.5deg);transform:translateY(1.5px) rotate(1.5deg)}82%{-webkit-transform:translateY(-0.5px) rotate(0.5deg);transform:translateY(-0.5px) rotate(0.5deg)}84%{-webkit-transform:translateY(1.5px) rotate(2.5deg);transform:translateY(1.5px) rotate(2.5deg)}86%{-webkit-transform:translateY(-1.5px) rotate(-1.5deg);transform:translateY(-1.5px) rotate(-1.5deg)}88%{-webkit-transform:translateY(-0.5px) rotate(2.5deg);transform:translateY(-0.5px) rotate(2.5deg)}90%{-webkit-transform:translateY(2.5px) rotate(-0.5deg);transform:translateY(2.5px) rotate(-0.5deg)}92%{-webkit-transform:translateY(0.5px) rotate(-0.5deg);transform:translateY(0.5px) rotate(-0.5deg)}94%{-webkit-transform:translateY(2.5px) rotate(0.5deg);transform:translateY(2.5px) rotate(0.5deg)}96%{-webkit-transform:translateY(-0.5px) rotate(1.5deg);transform:translateY(-0.5px) rotate(1.5deg)}98%{-webkit-transform:translateY(-1.5px) rotate(-0.5deg);transform:translateY(-1.5px) rotate(-0.5deg)}0%,to{-webkit-transform:translate(0) rotate(0deg);transform:translate(0) rotate(0deg)}}@keyframes my-face{2%{-webkit-transform:translateY(1.5px) rotate(1.5deg);transform:translateY(1.5px) rotate(1.5deg)}4%{-webkit-transform:translateY(-1.5px) rotate(-0.5deg);transform:translateY(-1.5px) rotate(-0.5deg)}6%{-webkit-transform:translateY(1.5px) rotate(-1.5deg);transform:translateY(1.5px) rotate(-1.5deg)}8%{-webkit-transform:translateY(-1.5px) rotate(-1.5deg);transform:translateY(-1.5px) rotate(-1.5deg)}10%{-webkit-transform:translateY(2.5px) rotate(1.5deg);transform:translateY(2.5px) rotate(1.5deg)}12%{-webkit-transform:translateY(-0.5px) rotate(1.5deg);transform:translateY(-0.5px) rotate(1.5deg)}14%{-webkit-transform:translateY(-1.5px) rotate(1.5deg);transform:translateY(-1.5px) rotate(1.5deg)}16%{-webkit-transform:translateY(-0.5px) rotate(-1.5deg);transform:translateY(-0.5px) rotate(-1.5deg)}18%{-webkit-transform:translateY(0.5px) rotate(-1.5deg);transform:translateY(0.5px) rotate(-1.5deg)}20%{-webkit-transform:translateY(-1.5px) rotate(2.5deg);transform:translateY(-1.5px) rotate(2.5deg)}22%{-webkit-transform:translateY(0.5px) rotate(-1.5deg);transform:translateY(0.5px) rotate(-1.5deg)}24%{-webkit-transform:translateY(1.5px) rotate(1.5deg);transform:translateY(1.5px) rotate(1.5deg)}26%{-webkit-transform:translateY(0.5px) rotate(0.5deg);transform:translateY(0.5px) rotate(0.5deg)}28%{-webkit-transform:translateY(0.5px) rotate(1.5deg);transform:translateY(0.5px) rotate(1.5deg)}30%{-webkit-transform:translateY(-0.5px) rotate(2.5deg);transform:translateY(-0.5px) rotate(2.5deg)}32%{-webkit-transform:translateY(1.5px) rotate(-0.5deg);transform:translateY(1.5px) rotate(-0.5deg)}34%{-webkit-transform:translateY(1.5px) rotate(-0.5deg);transform:translateY(1.5px) rotate(-0.5deg)}36%{-webkit-transform:translateY(-1.5px) rotate(2.5deg);transform:translateY(-1.5px) rotate(2.5deg)}38%{-webkit-transform:translateY(1.5px) rotate(-1.5deg);transform:translateY(1.5px) rotate(-1.5deg)}40%{-webkit-transform:translateY(-0.5px) rotate(2.5deg);transform:translateY(-0.5px) rotate(2.5deg)}42%{-webkit-transform:translateY(2.5px) rotate(-1.5deg);transform:translateY(2.5px) rotate(-1.5deg)}44%{-webkit-transform:translateY(1.5px) rotate(0.5deg);transform:translateY(1.5px) rotate(0.5deg)}46%{-webkit-transform:translateY(-1.5px) rotate(2.5deg);transform:translateY(-1.5px) rotate(2.5deg)}48%{-webkit-transform:translateY(-0.5px) rotate(0.5deg);transform:translateY(-0.5px) rotate(0.5deg)}50%{-webkit-transform:translateY(0.5px) rotate(0.5deg);transform:translateY(0.5px) rotate(0.5deg)}52%{-webkit-transform:translateY(2.5px) rotate(2.5deg);transform:translateY(2.5px) rotate(2.5deg)}54%{-webkit-transform:translateY(-1.5px) rotate(1.5deg);transform:translateY(-1.5px) rotate(1.5deg)}56%{-webkit-transform:translateY(2.5px) rotate(2.5deg);transform:translateY(2.5px) rotate(2.5deg)}58%{-webkit-transform:translateY(0.5px) rotate(2.5deg);transform:translateY(0.5px) rotate(2.5deg)}60%{-webkit-transform:translateY(2.5px) rotate(2.5deg);transform:translateY(2.5px) rotate(2.5deg)}62%{-webkit-transform:translateY(-0.5px) rotate(2.5deg);transform:translateY(-0.5px) rotate(2.5deg)}64%{-webkit-transform:translateY(-0.5px) rotate(1.5deg);transform:translateY(-0.5px) rotate(1.5deg)}66%{-webkit-transform:translateY(1.5px) rotate(-0.5deg);transform:translateY(1.5px) rotate(-0.5deg)}68%{-webkit-transform:translateY(-1.5px) rotate(-0.5deg);transform:translateY(-1.5px) rotate(-0.5deg)}70%{-webkit-transform:translateY(1.5px) rotate(0.5deg);transform:translateY(1.5px) rotate(0.5deg)}72%{-webkit-transform:translateY(2.5px) rotate(1.5deg);transform:translateY(2.5px) rotate(1.5deg)}74%{-webkit-transform:translateY(-0.5px) rotate(0.5deg);transform:translateY(-0.5px) rotate(0.5deg)}76%{-webkit-transform:translateY(-0.5px) rotate(2.5deg);transform:translateY(-0.5px) rotate(2.5deg)}78%{-webkit-transform:translateY(-0.5px) rotate(1.5deg);transform:translateY(-0.5px) rotate(1.5deg)}80%{-webkit-transform:translateY(1.5px) rotate(1.5deg);transform:translateY(1.5px) rotate(1.5deg)}82%{-webkit-transform:translateY(-0.5px) rotate(0.5deg);transform:translateY(-0.5px) rotate(0.5deg)}84%{-webkit-transform:translateY(1.5px) rotate(2.5deg);transform:translateY(1.5px) rotate(2.5deg)}86%{-webkit-transform:translateY(-1.5px) rotate(-1.5deg);transform:translateY(-1.5px) rotate(-1.5deg)}88%{-webkit-transform:translateY(-0.5px) rotate(2.5deg);transform:translateY(-0.5px) rotate(2.5deg)}90%{-webkit-transform:translateY(2.5px) rotate(-0.5deg);transform:translateY(2.5px) rotate(-0.5deg)}92%{-webkit-transform:translateY(0.5px) rotate(-0.5deg);transform:translateY(0.5px) rotate(-0.5deg)}94%{-webkit-transform:translateY(2.5px) rotate(0.5deg);transform:translateY(2.5px) rotate(0.5deg)}96%{-webkit-transform:translateY(-0.5px) rotate(1.5deg);transform:translateY(-0.5px) rotate(1.5deg)}98%{-webkit-transform:translateY(-1.5px) rotate(-0.5deg);transform:translateY(-1.5px) rotate(-0.5deg)}0%,to{-webkit-transform:translate(0) rotate(0deg);transform:translate(0) rotate(0deg)}}.dplayer{position:relative;overflow:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;line-height:1}.dplayer *{box-sizing:content-box}.dplayer svg{width:100%;height:100%}.dplayer svg circle,.dplayer svg path{fill:#fff}.dplayer:-webkit-full-screen{width:100%;height:100%;background:#000;position:fixed;z-index:100000;left:0;top:0;margin:0;padding:0;-webkit-transform:translate(0);transform:translate(0)}.dplayer:-webkit-full-screen .dplayer-danmaku .dplayer-danmaku-bottom.dplayer-danmaku-move,.dplayer:-webkit-full-screen .dplayer-danmaku .dplayer-danmaku-top.dplayer-danmaku-move{-webkit-animation:danmaku-center 6s linear;animation:danmaku-center 6s linear;-webkit-animation-play-state:inherit;animation-play-state:inherit}.dplayer:-webkit-full-screen .dplayer-danmaku .dplayer-danmaku-right.dplayer-danmaku-move{-webkit-animation:danmaku 8s linear;animation:danmaku 8s linear;-webkit-animation-play-state:inherit;animation-play-state:inherit}.dplayer.dplayer-live .dplayer-bar-wrap,.dplayer.dplayer-live.dplayer-no-danmaku .dplayer-setting,.dplayer.dplayer-live .dplayer-setting-loop,.dplayer.dplayer-live .dplayer-setting-speed,.dplayer.dplayer-live .dplayer-time,.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-comment,.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box .dplayer-setting-danmaku,.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box .dplayer-setting-danunlimit,.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box .dplayer-setting-showdan,.dplayer.dplayer-no-danmaku .dplayer-danmaku{display:none}.dplayer.dplayer-arrow .dplayer-danmaku{font-size:18px}.dplayer.dplayer-arrow .dplayer-icon{margin:0 -3px}.dplayer.dplayer-playing .dplayer-danmaku .dplayer-danmaku-move{-webkit-animation-play-state:running;animation-play-state:running}@media (min-width: 900px){.dplayer.dplayer-playing .dplayer-controller,.dplayer.dplayer-playing .dplayer-controller-mask{opacity:0}.dplayer.dplayer-playing:hover .dplayer-controller,.dplayer.dplayer-playing:hover .dplayer-controller-mask{opacity:1}}.dplayer.dplayer-loading .dplayer-bezel .diplayer-loading-icon{display:block}.dplayer.dplayer-loading .dplayer-danmaku,.dplayer.dplayer-loading .dplayer-danmaku-move,.dplayer.dplayer-paused .dplayer-danmaku,.dplayer.dplayer-paused .dplayer-danmaku-move{-webkit-animation-play-state:paused;animation-play-state:paused}.dplayer.dplayer-hide-controller{cursor:none}.dplayer.dplayer-hide-controller .dplayer-controller,.dplayer.dplayer-hide-controller .dplayer-controller-mask{opacity:0;-webkit-transform:translateY(100%);transform:translateY(100%)}.dplayer.dplayer-show-controller .dplayer-controller,.dplayer.dplayer-show-controller .dplayer-controller-mask{opacity:1}.dplayer.dplayer-fulled{position:fixed;z-index:100000;left:0;top:0;width:100%;height:100%}.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-camera-icon,.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-volume{display:none}.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-full .dplayer-full-in-icon{position:static;display:inline-block}.dplayer.dplayer-mobile .dplayer-bar-time{display:none}.dplayer-web-fullscreen-fix{position:fixed;top:0;left:0;margin:0;padding:0}[data-balloon]:before{display:none}[data-balloon]:after{padding:.3em .7em;background:rgba(18,18,18,0.7)}[data-balloon][data-balloon-pos=up]:after{margin-bottom:0}.dplayer-bezel{position:absolute;left:0;right:0;top:0;bottom:0;font-size:22px;color:#fff;pointer-events:none}.dplayer-bezel .dplayer-bezel-icon{position:absolute;top:50%;left:50%;margin:-26px 0 0 -26px;height:52px;width:52px;padding:12px;box-sizing:border-box;background:rgba(0,0,0,0.5);border-radius:50%;opacity:0;pointer-events:none}.dplayer-bezel .dplayer-bezel-icon.dplayer-bezel-transition{-webkit-animation:bezel-hide .5s linear;animation:bezel-hide .5s linear}@-webkit-keyframes bezel-hide{0%{opacity:1;-webkit-transform:scale(1);transform:scale(1)}to{opacity:0;-webkit-transform:scale(2);transform:scale(2)}}@keyframes bezel-hide{0%{opacity:1;-webkit-transform:scale(1);transform:scale(1)}to{opacity:0;-webkit-transform:scale(2);transform:scale(2)}}.dplayer-bezel .dplayer-danloading{position:absolute;top:50%;margin-top:-7px;width:100%;text-align:center;font-size:14px;line-height:14px;-webkit-animation:my-face 5s infinite ease-in-out;animation:my-face 5s infinite ease-in-out}.dplayer-bezel .diplayer-loading-icon{display:none;position:absolute;top:50%;left:50%;margin:-18px 0 0 -18px;height:36px;width:36px;pointer-events:none}.dplayer-bezel .diplayer-loading-icon .diplayer-loading-hide{display:none}.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot{-webkit-animation:diplayer-loading-dot-fade .8s ease infinite;animation:diplayer-loading-dot-fade .8s ease infinite;opacity:0;-webkit-transform-origin:4px 4px;transform-origin:4px 4px}.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-7{-webkit-animation-delay:.7s;animation-delay:.7s}.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-6{-webkit-animation-delay:.6s;animation-delay:.6s}.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-5{-webkit-animation-delay:.5s;animation-delay:.5s}.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-4{-webkit-animation-delay:.4s;animation-delay:.4s}.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-3{-webkit-animation-delay:.3s;animation-delay:.3s}.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-2{-webkit-animation-delay:.2s;animation-delay:.2s}.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-1{-webkit-animation-delay:.1s;animation-delay:.1s}@-webkit-keyframes diplayer-loading-dot-fade{0%{opacity:.7;-webkit-transform:scale(1.2);transform:scale(1.2)}50%{opacity:.25;-webkit-transform:scale(0.9);transform:scale(0.9)}to{opacity:.25;-webkit-transform:scale(0.85);transform:scale(0.85)}}@keyframes diplayer-loading-dot-fade{0%{opacity:.7;-webkit-transform:scale(1.2);transform:scale(1.2)}50%{opacity:.25;-webkit-transform:scale(0.9);transform:scale(0.9)}to{opacity:.25;-webkit-transform:scale(0.85);transform:scale(0.85)}}.dplayer-controller-mask{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAADGCAYAAAAT+OqFAAAAdklEQVQoz42QQQ7AIAgEF/T/D+kbq/RWAlnQyyazA4aoAB4FsBSA/bFjuF1EOL7VbrIrBuusmrt4ZZORfb6ehbWdnRHEIiITaEUKa5EJqUakRSaEYBJSCY2dEstQY7AuxahwXFrvZmWl2rh4JZ07z9dLtesfNj5q0FU3A5ObbwAAAABJRU5ErkJggg==) repeat-x bottom;height:98px;width:100%}.dplayer-controller,.dplayer-controller-mask{position:absolute;bottom:0;transition:all .3s ease}.dplayer-controller{left:0;right:0;height:41px;padding:0 20px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.dplayer-controller.dplayer-controller-comment .dplayer-icons{display:none}.dplayer-controller.dplayer-controller-comment .dplayer-icons.dplayer-comment-box{display:block}.dplayer-controller .dplayer-bar-wrap{padding:5px 0;cursor:pointer;position:absolute;bottom:33px;width:calc(100% - 40px);height:3px}.dplayer-controller .dplayer-bar-wrap:hover .dplayer-bar .dplayer-played .dplayer-thumb{-webkit-transform:scale(1);transform:scale(1)}.dplayer-controller .dplayer-bar-wrap:hover .dplayer-highlight{display:block;width:8px;-webkit-transform:translateX(-4px);transform:translateX(-4px);top:4px;height:40%}.dplayer-controller .dplayer-bar-wrap .dplayer-highlight{z-index:12;position:absolute;top:5px;width:6px;height:20%;border-radius:6px;background-color:#fff;text-align:center;-webkit-transform:translateX(-3px);transform:translateX(-3px);transition:all .2s ease-in-out}.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover .dplayer-highlight-text{display:block}.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover ~ .dplayer-bar-preview,.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover ~ .dplayer-bar-time{opacity:0}.dplayer-controller .dplayer-bar-wrap .dplayer-highlight .dplayer-highlight-text{display:none;position:absolute;left:50%;top:-24px;padding:5px 8px;background-color:rgba(0,0,0,0.62);color:#fff;border-radius:4px;font-size:12px;white-space:nowrap;-webkit-transform:translateX(-50%);transform:translateX(-50%)}.dplayer-controller .dplayer-bar-wrap .dplayer-bar-preview{position:absolute;background:#fff;pointer-events:none;display:none;background-size:16000px 100%}.dplayer-controller .dplayer-bar-wrap .dplayer-bar-preview-canvas{position:absolute;width:100%;height:100%;z-index:1;pointer-events:none}.dplayer-controller .dplayer-bar-wrap .dplayer-bar-time{position:absolute;left:0;top:-20px;border-radius:4px;padding:5px 7px;background-color:rgba(0,0,0,0.62);color:#fff;font-size:12px;text-align:center;opacity:1;transition:opacity .1s ease-in-out;word-wrap:normal;word-break:normal;z-index:2;pointer-events:none}.dplayer-controller .dplayer-bar-wrap .dplayer-bar-time.hidden{opacity:0}.dplayer-controller .dplayer-bar-wrap .dplayer-bar{position:relative;height:3px;width:100%;background:rgba(255,255,255,0.2);cursor:pointer}.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-loaded{background:rgba(255,255,255,0.4);transition:all .5s ease}.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-loaded,.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-played{position:absolute;left:0;top:0;bottom:0;height:3px;will-change:width}.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-played .dplayer-thumb{position:absolute;top:0;right:5px;margin-top:-4px;margin-right:-10px;height:11px;width:11px;border-radius:50%;cursor:pointer;transition:all .3s ease-in-out;-webkit-transform:scale(0);transform:scale(0)}.dplayer-controller .dplayer-icons{height:38px;position:absolute;bottom:0}.dplayer-controller .dplayer-icons.dplayer-comment-box{display:none;position:absolute;transition:all .3s ease-in-out;z-index:2;height:38px;bottom:0;left:20px;right:20px;color:#fff}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-icon{padding:7px}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-icon{position:absolute;left:0;top:0}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-send-icon{position:absolute;right:0;top:0}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box{position:absolute;background:rgba(28,28,28,0.9);bottom:41px;left:0;box-shadow:0 0 25px rgba(0,0,0,0.3);border-radius:4px;padding:10px 10px 16px;font-size:14px;width:204px;transition:all .3s ease-in-out;-webkit-transform:scale(0);transform:scale(0)}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box.dplayer-comment-setting-open{-webkit-transform:scale(1);transform:scale(1)}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box input[type=radio]{display:none}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box label{cursor:pointer}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-title{font-size:13px;color:#fff;line-height:30px}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type{font-size:0}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type .dplayer-comment-setting-title{margin-bottom:6px}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type label:nth-child(2) span{border-radius:4px 0 0 4px}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type label:nth-child(4) span{border-radius:0 4px 4px 0}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type span{width:33%;padding:4px 6px;line-height:16px;display:inline-block;font-size:12px;color:#fff;border:1px solid #fff;margin-right:-1px;box-sizing:border-box;text-align:center;cursor:pointer}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type input:checked+span{background:#e4e4e6;color:#1c1c1c}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color{font-size:0}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color label{font-size:0;padding:6px;display:inline-block}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color span{width:22px;height:22px;display:inline-block;border-radius:50%;box-sizing:border-box;cursor:pointer}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color span:hover{-webkit-animation:my-face 5s infinite ease-in-out;animation:my-face 5s infinite ease-in-out}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input{outline:none;border:none;padding:8px 31px;font-size:14px;line-height:18px;text-align:center;border-radius:4px;background:none;margin:0;height:100%;box-sizing:border-box;width:100%;color:#fff}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input::-webkit-input-placeholder{color:#fff;opacity:.8}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input:-ms-input-placeholder,.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input::-ms-input-placeholder{color:#fff;opacity:.8}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input::placeholder{color:#fff;opacity:.8}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input::-ms-clear{display:none}.dplayer-controller .dplayer-icons.dplayer-icons-left .dplayer-icon{padding:7px}.dplayer-controller .dplayer-icons.dplayer-icons-right{right:20px}.dplayer-controller .dplayer-icons.dplayer-icons-right .dplayer-icon{padding:8px}.dplayer-controller .dplayer-icons .dplayer-live-badge,.dplayer-controller .dplayer-icons .dplayer-time{line-height:38px;color:#eee;text-shadow:0 0 2px rgba(0,0,0,0.5);vertical-align:middle;font-size:13px;cursor:default}.dplayer-controller .dplayer-icons .dplayer-live-dot{display:inline-block;width:6px;height:6px;vertical-align:4%;margin-right:5px;content:\\\"\\\";border-radius:6px}.dplayer-controller .dplayer-icons .dplayer-icon{width:40px;height:100%;border:none;background-color:transparent;outline:none;cursor:pointer;vertical-align:middle;box-sizing:border-box;display:inline-block}.dplayer-controller .dplayer-icons .dplayer-icon .dplayer-icon-content{transition:all .2s ease-in-out;opacity:.8}.dplayer-controller .dplayer-icons .dplayer-icon:hover .dplayer-icon-content{opacity:1}.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-quality-icon{color:#fff;width:auto;line-height:22px;font-size:14px}.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-comment-icon{padding:10px 9px 9px}.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-setting-icon{padding-top:8.5px}.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-volume-icon{width:43px}.dplayer-controller .dplayer-icons .dplayer-volume{position:relative;display:inline-block;cursor:pointer;height:100%}.dplayer-controller .dplayer-icons .dplayer-volume:hover .dplayer-volume-bar-wrap .dplayer-volume-bar{width:45px}.dplayer-controller .dplayer-icons .dplayer-volume:hover .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb{-webkit-transform:scale(1);transform:scale(1)}.dplayer-controller .dplayer-icons .dplayer-volume.dplayer-volume-active .dplayer-volume-bar-wrap .dplayer-volume-bar{width:45px}.dplayer-controller .dplayer-icons .dplayer-volume.dplayer-volume-active .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb{-webkit-transform:scale(1);transform:scale(1)}.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap{display:inline-block;margin:0 10px 0 -5px;vertical-align:middle;height:100%}.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar{position:relative;top:17px;width:0;height:3px;background:#aaa;transition:all .3s ease-in-out}.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner{position:absolute;bottom:0;left:0;height:100%;transition:all .1s ease;will-change:width}.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb{position:absolute;top:0;right:5px;margin-top:-4px;margin-right:-10px;height:11px;width:11px;border-radius:50%;cursor:pointer;transition:all .3s ease-in-out;-webkit-transform:scale(0);transform:scale(0)}.dplayer-controller .dplayer-icons .dplayer-setting,.dplayer-controller .dplayer-icons .dplayer-subtitle-btn{display:inline-block;height:100%}.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box{position:absolute;right:0;bottom:50px;-webkit-transform:scale(0);transform:scale(0);width:150px;border-radius:2px;background:rgba(28,28,28,0.9);padding:7px 0;transition:all .3s ease-in-out;overflow:hidden;z-index:2}.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box>div{display:none}.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box>div.dplayer-setting-origin-panel{display:block}.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-open{-webkit-transform:scale(1);transform:scale(1)}.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-narrow{width:70px;height:180px;text-align:center}.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-speed .dplayer-setting-origin-panel{display:none}.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-speed .dplayer-setting-speed-panel{display:block}.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-item,.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-speed-item{height:30px;padding:5px 10px;box-sizing:border-box;cursor:pointer;position:relative}.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-item:hover,.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-speed-item:hover{background-color:rgba(255,255,255,0.1)}.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku{padding:5px 0}.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-label{padding:0 10px;display:inline}.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku:hover .dplayer-label{display:none}.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku:hover .dplayer-danmaku-bar-wrap{display:inline-block}.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku.dplayer-setting-danmaku-active .dplayer-label{display:none}.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku.dplayer-setting-danmaku-active .dplayer-danmaku-bar-wrap{display:inline-block}.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap{padding:0 10px;box-sizing:border-box;display:none;vertical-align:middle;height:100%;width:100%}.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar{position:relative;top:8.5px;width:100%;height:3px;background:#fff;transition:all .3s ease-in-out}.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar .dplayer-danmaku-bar-inner{position:absolute;bottom:0;left:0;height:100%;transition:all .1s ease;background:#aaa;will-change:width}.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar .dplayer-danmaku-bar-inner .dplayer-thumb{position:absolute;top:0;right:5px;margin-top:-4px;margin-right:-10px;height:11px;width:11px;border-radius:50%;cursor:pointer;transition:all .3s ease-in-out;background:#aaa}.dplayer-controller .dplayer-icons .dplayer-full{display:inline-block;height:100%;position:relative}.dplayer-controller .dplayer-icons .dplayer-full:hover .dplayer-full-in-icon{display:block}.dplayer-controller .dplayer-icons .dplayer-full .dplayer-full-in-icon{position:absolute;top:-30px;z-index:1;display:none}.dplayer-controller .dplayer-icons .dplayer-quality{position:relative;display:inline-block;height:100%;z-index:2}.dplayer-controller .dplayer-icons .dplayer-quality:hover .dplayer-quality-list,.dplayer-controller .dplayer-icons .dplayer-quality:hover .dplayer-quality-mask{display:block}.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-mask{display:none;position:absolute;bottom:38px;left:-18px;width:80px;padding-bottom:12px}.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-list{display:none;font-size:12px;width:80px;border-radius:2px;background:rgba(28,28,28,0.9);padding:5px 0;transition:all .3s ease-in-out;overflow:hidden;color:#fff;text-align:center}.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-item{height:25px;box-sizing:border-box;cursor:pointer;line-height:25px}.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-item:hover{background-color:rgba(255,255,255,0.1)}.dplayer-controller .dplayer-icons .dplayer-comment{display:inline-block;height:100%}.dplayer-controller .dplayer-icons .dplayer-label{color:#eee;font-size:13px;display:inline-block;vertical-align:middle;white-space:nowrap}.dplayer-controller .dplayer-icons .dplayer-toggle{width:32px;height:20px;text-align:center;font-size:0;vertical-align:middle;position:absolute;top:5px;right:10px}.dplayer-controller .dplayer-icons .dplayer-toggle input{max-height:0;max-width:0;display:none}.dplayer-controller .dplayer-icons .dplayer-toggle input+label{display:inline-block;position:relative;box-shadow:inset 0 0 0 0 #dfdfdf;border:1px solid #dfdfdf;height:20px;width:32px;border-radius:10px;box-sizing:border-box;cursor:pointer;transition:.2s ease-in-out}.dplayer-controller .dplayer-icons .dplayer-toggle input+label:after,.dplayer-controller .dplayer-icons .dplayer-toggle input+label:before{content:\\\"\\\";position:absolute;display:block;height:18px;width:18px;top:0;left:0;border-radius:15px;transition:.2s ease-in-out}.dplayer-controller .dplayer-icons .dplayer-toggle input+label:after{background:#fff;box-shadow:0 1px 3px rgba(0,0,0,0.4)}.dplayer-controller .dplayer-icons .dplayer-toggle input:checked+label{border-color:rgba(255,255,255,0.5)}.dplayer-controller .dplayer-icons .dplayer-toggle input:checked+label:before{width:30px;background:rgba(255,255,255,0.5)}.dplayer-controller .dplayer-icons .dplayer-toggle input:checked+label:after{left:12px}.dplayer-danmaku{position:absolute;left:0;right:0;top:0;bottom:0;font-size:22px;color:#fff}.dplayer-danmaku .dplayer-danmaku-item{display:inline-block;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default;white-space:nowrap;text-shadow:0.5px 0.5px 0.5px rgba(0,0,0,0.5)}.dplayer-danmaku .dplayer-danmaku-item--demo{position:absolute;visibility:hidden}.dplayer-danmaku .dplayer-danmaku-right{position:absolute;right:0;-webkit-transform:translateX(100%);transform:translateX(100%)}.dplayer-danmaku .dplayer-danmaku-right.dplayer-danmaku-move{will-change:transform;-webkit-animation:danmaku 5s linear;animation:danmaku 5s linear;-webkit-animation-play-state:paused;animation-play-state:paused}@-webkit-keyframes danmaku{0%{-webkit-transform:translateX(100%);transform:translateX(100%)}}@keyframes danmaku{0%{-webkit-transform:translateX(100%);transform:translateX(100%)}}.dplayer-danmaku .dplayer-danmaku-bottom,.dplayer-danmaku .dplayer-danmaku-top{position:absolute;width:100%;text-align:center;visibility:hidden}.dplayer-danmaku .dplayer-danmaku-bottom.dplayer-danmaku-move,.dplayer-danmaku .dplayer-danmaku-top.dplayer-danmaku-move{will-change:visibility;-webkit-animation:danmaku-center 4s linear;animation:danmaku-center 4s linear;-webkit-animation-play-state:paused;animation-play-state:paused}@-webkit-keyframes danmaku-center{0%{visibility:visible}to{visibility:visible}}@keyframes danmaku-center{0%{visibility:visible}to{visibility:visible}}.dplayer-logo{pointer-events:none;position:absolute;left:20px;top:20px;max-width:50px;max-height:50px}.dplayer-logo img{max-width:100%;max-height:100%;background:none}.dplayer-menu{position:absolute;width:170px;border-radius:2px;background:rgba(28,28,28,0.85);padding:5px 0;overflow:hidden;z-index:3;display:none}.dplayer-menu.dplayer-menu-show{display:block}.dplayer-menu .dplayer-menu-item{height:30px;box-sizing:border-box;cursor:pointer}.dplayer-menu .dplayer-menu-item:hover{background-color:rgba(255,255,255,0.1)}.dplayer-menu .dplayer-menu-item a{padding:0 10px;line-height:30px;color:#eee;font-size:13px;display:inline-block;vertical-align:middle;width:100%;box-sizing:border-box;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.dplayer-menu .dplayer-menu-item a:hover{text-decoration:none}.dplayer-notice{opacity:0;position:absolute;bottom:60px;left:20px;font-size:14px;border-radius:2px;background:rgba(28,28,28,0.9);padding:7px 20px;transition:all .3s ease-in-out;overflow:hidden;color:#fff;pointer-events:none}.dplayer-subtitle{position:absolute;bottom:40px;width:90%;left:5%;text-align:center;color:#fff;text-shadow:0.5px 0.5px 0.5px rgba(0,0,0,0.5);font-size:20px}.dplayer-subtitle.dplayer-subtitle-hide{display:none}.dplayer-mask{position:absolute;top:0;bottom:0;left:0;right:0;z-index:1;display:none}.dplayer-mask.dplayer-mask-show{display:block}.dplayer-video-wrap{position:relative;background:#000;font-size:0;width:100%;height:100%}.dplayer-video-wrap .dplayer-video{width:100%;height:100%;display:none}.dplayer-video-wrap .dplayer-video-current{display:block}.dplayer-video-wrap .dplayer-video-prepare{display:none}.dplayer-info-panel{position:absolute;top:10px;left:10px;width:400px;background:rgba(28,28,28,0.8);padding:10px;color:#fff;font-size:12px;border-radius:2px}.dplayer-info-panel-hide{display:none}.dplayer-info-panel .dplayer-info-panel-close{cursor:pointer;position:absolute;right:10px;top:10px}.dplayer-info-panel .dplayer-info-panel-item>span{display:inline-block;vertical-align:middle;line-height:15px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.dplayer-info-panel .dplayer-info-panel-item-title{width:100px;text-align:right;margin-right:10px}.dplayer-info-panel .dplayer-info-panel-item-data{width:260px}\\n\",\"\"]),e.exports=t},\"./node_modules/css-loader/dist/runtime/api.js\":function(e,t,r){\"use strict\";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r=function(e,t){var r=e[1]||\"\",n=e[3];if(!n)return r;if(t&&\"function\"==typeof btoa){var i=function(e){var t=btoa(unescape(encodeURIComponent(JSON.stringify(e)))),r=\"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(t);return\"/*# \".concat(r,\" */\")}(n),a=n.sources.map((function(e){return\"/*# sourceURL=\".concat(n.sourceRoot||\"\").concat(e,\" */\")}));return[r].concat(a).concat([i]).join(\"\\n\")}return[r].join(\"\\n\")}(t,e);return t[2]?\"@media \".concat(t[2],\" {\").concat(r,\"}\"):r})).join(\"\")},t.i=function(e,r,n){\"string\"==typeof e&&(e=[[null,e,\"\"]]);var i={};if(n)for(var a=0;a<this.length;a++){var o=this[a][0];null!=o&&(i[o]=!0)}for(var s=0;s<e.length;s++){var l=[].concat(e[s]);n&&i[l[0]]||(r&&(l[2]?l[2]=\"\".concat(r,\" and \").concat(l[2]):l[2]=r),t.push(l))}},t}},\"./node_modules/dplayer/dist/DPlayer.min.css\":function(e,t,r){var n=r(\"./node_modules/css-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js!./node_modules/dplayer/dist/DPlayer.min.css\");\"string\"==typeof n&&(n=[[e.i,n,\"\"]]);r(\"./node_modules/style-loader/lib/addStyles.js\")(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},\"./node_modules/dplayer/dist/DPlayer.min.js\":function(e,t,r){(function(t,r){window,e.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,\"a\",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p=\"/\",r(r.s=78)}([function(e,t,r){\"use strict\";var n=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e},i=r(11),a=r(65),o=Object.prototype.toString;function s(e){return\"[object Array]\"===o.call(e)}function l(e){return null!==e&&\"object\"===(void 0===e?\"undefined\":n(e))}function d(e){return\"[object Function]\"===o.call(e)}function u(e,t){if(null!=e)if(\"object\"!==(void 0===e?\"undefined\":n(e))&&(e=[e]),s(e))for(var r=0,i=e.length;r<i;r++)t.call(null,e[r],r,e);else for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.call(null,e[a],a,e)}e.exports={isArray:s,isArrayBuffer:function(e){return\"[object ArrayBuffer]\"===o.call(e)},isBuffer:a,isFormData:function(e){return\"undefined\"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return\"undefined\"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return\"string\"==typeof e},isNumber:function(e){return\"number\"==typeof e},isObject:l,isUndefined:function(e){return void 0===e},isDate:function(e){return\"[object Date]\"===o.call(e)},isFile:function(e){return\"[object File]\"===o.call(e)},isBlob:function(e){return\"[object Blob]\"===o.call(e)},isFunction:d,isStream:function(e){return l(e)&&d(e.pipe)},isURLSearchParams:function(e){return\"undefined\"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return(\"undefined\"==typeof navigator||\"ReactNative\"!==navigator.product)&&\"undefined\"!=typeof window&&\"undefined\"!=typeof document},forEach:u,merge:function e(){var t={};function r(r,i){\"object\"===n(t[i])&&\"object\"===(void 0===r?\"undefined\":n(r))?t[i]=e(t[i],r):t[i]=r}for(var i=0,a=arguments.length;i<a;i++)u(arguments[i],r);return t},extend:function(e,t,r){return u(t,(function(t,n){e[n]=r&&\"function\"==typeof t?i(t,r):t})),e},trim:function(e){return e.replace(/^\\s*/,\"\").replace(/\\s*$/,\"\")}}},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=/mobile/i.test(window.navigator.userAgent),i={secondToTime:function(e){var t=Math.floor(e/3600),r=Math.floor((e-3600*t)/60),n=Math.floor(e-3600*t-60*r);return(0<t?[t,r,n]:[r,n]).map((function(e){return e<10?\"0\"+e:\"\"+e})).join(\":\")},getElementViewLeft:function(e){var t=e.offsetLeft,r=e.offsetParent,n=document.body.scrollLeft+document.documentElement.scrollLeft;if(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement)for(;null!==r&&r!==e;)t+=r.offsetLeft,r=r.offsetParent;else for(;null!==r;)t+=r.offsetLeft,r=r.offsetParent;return t-n},getBoundingClientRectViewLeft:function(e){var t,r=document.documentElement.scrollTop;if(e.getBoundingClientRect){\"number\"!=typeof this.getBoundingClientRectViewLeft.offset&&((t=document.createElement(\"div\")).style.cssText=\"position:absolute;top:0;left:0;\",document.body.appendChild(t),this.getBoundingClientRectViewLeft.offset=-t.getBoundingClientRect().top-r,document.body.removeChild(t),t=null);var n=e.getBoundingClientRect(),i=this.getBoundingClientRectViewLeft.offset;return n.left+i}return this.getElementViewLeft(e)},getScrollPosition:function(){return{left:window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0,top:window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0}},setScrollPosition:function(e){var t=e.left,r=void 0===t?0:t,n=e.top,i=void 0===n?0:n;this.isFirefox?(document.documentElement.scrollLeft=r,document.documentElement.scrollTop=i):window.scrollTo(r,i)},isMobile:n,isFirefox:/firefox/i.test(window.navigator.userAgent),isChrome:/chrome/i.test(window.navigator.userAgent),storage:{set:function(e,t){localStorage.setItem(e,t)},get:function(e){return localStorage.getItem(e)}},cumulativeOffset:function(e){for(var t=0,r=0;t+=e.offsetTop||0,r+=e.offsetLeft||0,e=e.offsetParent;);return{top:t,left:r}},nameMap:{dragStart:n?\"touchstart\":\"mousedown\",dragMove:n?\"touchmove\":\"mousemove\",dragEnd:n?\"touchend\":\"mouseup\"},color2Number:function(e){return\"#\"===e[0]&&(e=e.substr(1)),3===e.length&&(e=\"\"+e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),parseInt(e,16)+0&16777215},number2Color:function(e){return\"#\"+(\"00000\"+e.toString(16)).slice(-6)},number2Type:function(e){switch(e){case 0:return\"right\";case 1:return\"top\";case 2:return\"bottom\";default:return\"right\"}}};t.default=i},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=_(r(46)),i=_(r(45)),a=_(r(44)),o=_(r(43)),s=_(r(42)),l=_(r(41)),d=_(r(40)),u=_(r(39)),c=_(r(38)),h=_(r(37)),f=_(r(36)),p=_(r(35)),m=_(r(34)),g=_(r(33)),y=_(r(32)),v=_(r(31));function _(e){return e&&e.__esModule?e:{default:e}}var b={play:n.default,pause:i.default,volumeUp:a.default,volumeDown:o.default,volumeOff:s.default,full:l.default,fullWeb:d.default,setting:u.default,right:c.default,comment:h.default,commentOff:f.default,send:p.default,pallette:m.default,camera:g.default,subtitle:y.default,loading:v.default};t.default=b},function(e,t,r){\"use strict\";(function(t){var n=r(0),i=r(63),a={\"Content-Type\":\"application/x-www-form-urlencoded\"};function o(e,t){!n.isUndefined(e)&&n.isUndefined(e[\"Content-Type\"])&&(e[\"Content-Type\"]=t)}var s,l={adapter:(\"undefined\"==typeof XMLHttpRequest&&void 0===t||(s=r(10)),s),transformRequest:[function(e,t){return i(t,\"Content-Type\"),n.isFormData(e)||n.isArrayBuffer(e)||n.isBuffer(e)||n.isStream(e)||n.isFile(e)||n.isBlob(e)?e:n.isArrayBufferView(e)?e.buffer:n.isURLSearchParams(e)?(o(t,\"application/x-www-form-urlencoded;charset=utf-8\"),e.toString()):n.isObject(e)?(o(t,\"application/json;charset=utf-8\"),JSON.stringify(e)):e}],transformResponse:[function(e){if(\"string\"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:\"XSRF-TOKEN\",xsrfHeaderName:\"X-XSRF-TOKEN\",maxContentLength:-1,validateStatus:function(e){return 200<=e&&e<300},headers:{common:{Accept:\"application/json, text/plain, */*\"}}};n.forEach([\"delete\",\"get\",\"head\"],(function(e){l.headers[e]={}})),n.forEach([\"post\",\"put\",\"patch\"],(function(e){l.headers[e]=n.merge(a)})),e.exports=l}).call(this,r(12))},function(e,t,r){\"use strict\";var n=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e},i=function(){return this}();try{i=i||Function(\"return this\")()||(0,eval)(\"this\")}catch(e){\"object\"===(\"undefined\"==typeof window?\"undefined\":n(window))&&(i=window)}e.exports=i},function(e,t,r){var n=r(6);e.exports=function(e){\"use strict\";var t=\"\",r=e=e||{},i=e.subtitle,a=e.current,o=e.pic,s=n.$escape,l=e.screenshot,d=e.preload,u=e.url;r=i&&\"webvtt\"===i.type;return t+='\\n<video\\n    class=\"dplayer-video ',a&&(t+=\"dplayer-video-current\"),t+='\"\\n    webkit-playsinline\\n    playsinline\\n    ',o&&(t+='poster=\"',t+=s(o),t+='\"'),t+=\"\\n    \",(l||r)&&(t+='crossorigin=\"anonymous\"'),t+=\"\\n    \",d&&(t+='preload=\"',t+=s(d),t+='\"'),t+=\"\\n    \",u&&(t+='src=\"',t+=s(u),t+='\"'),t+=\"\\n    >\\n    \",r&&(t+='\\n    <track kind=\"metadata\" default src=\"',t+=s(i.url),t+='\"></track>\\n    '),t+\"\\n</video>\"}},function(e,t,r){\"use strict\";e.exports=r(29)},function(e,t,r){\"use strict\";function n(e){this.message=e}n.prototype.toString=function(){return\"Cancel\"+(this.message?\": \"+this.message:\"\")},n.prototype.__CANCEL__=!0,e.exports=n},function(e,t,r){\"use strict\";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,r){\"use strict\";var n=r(61);e.exports=function(e,t,r,i,a){var o=new Error(e);return n(o,t,r,i,a)}},function(e,t,r){\"use strict\";var n=r(0),i=r(62),a=r(60),o=r(59),s=r(58),l=r(9),d=\"undefined\"!=typeof window&&window.btoa&&window.btoa.bind(window)||r(57);e.exports=function(e){return new Promise((function(t,u){var c=e.data,h=e.headers;n.isFormData(c)&&delete h[\"Content-Type\"];var f,p,m,g,y=new XMLHttpRequest,v=\"onreadystatechange\",_=!1;if(\"undefined\"==typeof window||!window.XDomainRequest||\"withCredentials\"in y||s(e.url)||(y=new window.XDomainRequest,v=\"onload\",_=!0,y.onprogress=function(){},y.ontimeout=function(){}),e.auth&&(f=e.auth.username||\"\",p=e.auth.password||\"\",h.Authorization=\"Basic \"+d(f+\":\"+p)),y.open(e.method.toUpperCase(),a(e.url,e.params,e.paramsSerializer),!0),y.timeout=e.timeout,y[v]=function(){var r,n;y&&(4===y.readyState||_)&&(0!==y.status||y.responseURL&&0===y.responseURL.indexOf(\"file:\"))&&(r=\"getAllResponseHeaders\"in y?o(y.getAllResponseHeaders()):null,n={data:e.responseType&&\"text\"!==e.responseType?y.response:y.responseText,status:1223===y.status?204:y.status,statusText:1223===y.status?\"No Content\":y.statusText,headers:r,config:e,request:y},i(t,u,n),y=null)},y.onerror=function(){u(l(\"Network Error\",e,null,y)),y=null},y.ontimeout=function(){u(l(\"timeout of \"+e.timeout+\"ms exceeded\",e,\"ECONNABORTED\",y)),y=null},n.isStandardBrowserEnv()&&(m=r(56),(g=(e.withCredentials||s(e.url))&&e.xsrfCookieName?m.read(e.xsrfCookieName):void 0)&&(h[e.xsrfHeaderName]=g)),\"setRequestHeader\"in y&&n.forEach(h,(function(e,t){void 0===c&&\"content-type\"===t.toLowerCase()?delete h[t]:y.setRequestHeader(t,e)})),e.withCredentials&&(y.withCredentials=!0),e.responseType)try{y.responseType=e.responseType}catch(t){if(\"json\"!==e.responseType)throw t}\"function\"==typeof e.onDownloadProgress&&y.addEventListener(\"progress\",e.onDownloadProgress),\"function\"==typeof e.onUploadProgress&&y.upload&&y.upload.addEventListener(\"progress\",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){y&&(y.abort(),u(e),y=null)})),void 0===c&&(c=null),y.send(c)}))}},function(e,t,r){\"use strict\";e.exports=function(e,t){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return e.apply(t,r)}}},function(e,t,r){\"use strict\";var n,i,a=e.exports={};function o(){throw new Error(\"setTimeout has not been defined\")}function s(){throw new Error(\"clearTimeout has not been defined\")}function l(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n=\"function\"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{i=\"function\"==typeof clearTimeout?clearTimeout:s}catch(e){i=s}}();var d,u=[],c=!1,h=-1;function f(){c&&d&&(c=!1,d.length?u=d.concat(u):h=-1,u.length&&p())}function p(){if(!c){var e=l(f);c=!0;for(var t=u.length;t;){for(d=u,u=[];++h<t;)d&&d[h].run();h=-1,t=u.length}d=null,c=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function g(){}a.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new m(e,t)),1!==u.length||c||l(p)},m.prototype.run=function(){this.fun.apply(null,this.array)},a.title=\"browser\",a.browser=!0,a.env={},a.argv=[],a.version=\"\",a.versions={},a.on=g,a.addListener=g,a.once=g,a.off=g,a.removeListener=g,a.removeAllListeners=g,a.emit=g,a.prependListener=g,a.prependOnceListener=g,a.listeners=function(e){return[]},a.binding=function(e){throw new Error(\"process.binding is not supported\")},a.cwd=function(){return\"/\"},a.chdir=function(e){throw new Error(\"process.chdir is not supported\")},a.umask=function(){return 0}},function(e,t,r){\"use strict\";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,\"__esModule\",{value:!0});var i=(function(e,t,r){t&&n(e.prototype,t)}(a,[{key:\"show\",value:function(){this.beginTime=Date.now(),this.update(),this.player.timer.enable(\"info\"),this.player.timer.enable(\"fps\"),this.container.classList.remove(\"dplayer-info-panel-hide\")}},{key:\"hide\",value:function(){this.player.timer.disable(\"info\"),this.player.timer.disable(\"fps\"),this.container.classList.add(\"dplayer-info-panel-hide\")}},{key:\"triggle\",value:function(){this.container.classList.contains(\"dplayer-info-panel-hide\")?this.show():this.hide()}},{key:\"update\",value:function(){this.template.infoVersion.innerHTML=\"v1.25.0 fdcf45b\",this.template.infoType.innerHTML=this.player.type,this.template.infoUrl.innerHTML=this.player.options.video.url,this.template.infoResolution.innerHTML=this.player.video.videoWidth+\" x \"+this.player.video.videoHeight,this.template.infoDuration.innerHTML=this.player.video.duration,this.player.options.danmaku&&(this.template.infoDanmakuId.innerHTML=this.player.options.danmaku.id,this.template.infoDanmakuApi.innerHTML=this.player.options.danmaku.api,this.template.infoDanmakuAmount.innerHTML=this.player.danmaku.dan.length)}},{key:\"fps\",value:function(e){this.template.infoFPS.innerHTML=\"\"+e.toFixed(1)}}]),a);function a(e){var t=this;!function(e){if(!(e instanceof a))throw new TypeError(\"Cannot call a class as a function\")}(this),this.container=e.template.infoPanel,this.template=e.template,this.video=e.video,this.player=e,this.template.infoPanelClose.addEventListener(\"click\",(function(){t.hide()}))}t.default=i},function(e,t,r){\"use strict\";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,\"__esModule\",{value:!0});var i=(function(e,t,r){t&&n(e.prototype,t)}(a,[{key:\"show\",value:function(e,t){this.player.template.menu.classList.add(\"dplayer-menu-show\");var r=this.player.container.getBoundingClientRect();e+this.player.template.menu.offsetWidth>=r.width?(this.player.template.menu.style.right=r.width-e+\"px\",this.player.template.menu.style.left=\"initial\"):(this.player.template.menu.style.left=e+\"px\",this.player.template.menu.style.right=\"initial\"),t+this.player.template.menu.offsetHeight>=r.height?(this.player.template.menu.style.bottom=r.height-t+\"px\",this.player.template.menu.style.top=\"initial\"):(this.player.template.menu.style.top=t+\"px\",this.player.template.menu.style.bottom=\"initial\"),this.player.template.mask.classList.add(\"dplayer-mask-show\"),this.shown=!0,this.player.events.trigger(\"contextmenu_show\")}},{key:\"hide\",value:function(){this.player.template.mask.classList.remove(\"dplayer-mask-show\"),this.player.template.menu.classList.remove(\"dplayer-menu-show\"),this.shown=!1,this.player.events.trigger(\"contextmenu_hide\")}}]),a);function a(e){var t=this;!function(e){if(!(e instanceof a))throw new TypeError(\"Cannot call a class as a function\")}(this),this.player=e,this.shown=!1,Array.prototype.slice.call(this.player.template.menuItem).forEach((function(e,r){t.player.options.contextmenu[r].click&&e.addEventListener(\"click\",(function(){t.player.options.contextmenu[r].click(t.player),t.hide()}))})),this.player.container.addEventListener(\"contextmenu\",(function(e){var r,n;t.shown?t.hide():((r=e||window.event).preventDefault(),n=t.player.container.getBoundingClientRect(),t.show(r.clientX-n.left,r.clientY-n.top),t.player.template.mask.addEventListener(\"click\",(function(){t.hide()})))}))}t.default=i},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.default=function e(t){!function(t){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this),t.options.hotkey&&document.addEventListener(\"keydown\",(function(e){if(t.focus){var r=document.activeElement.tagName.toUpperCase(),n=document.activeElement.getAttribute(\"contenteditable\");if(\"INPUT\"!==r&&\"TEXTAREA\"!==r&&\"\"!==n&&\"true\"!==n){var i=e||window.event,a=void 0;switch(i.keyCode){case 32:i.preventDefault(),t.toggle();break;case 37:i.preventDefault(),t.seek(t.video.currentTime-5),t.controller.setAutoHide();break;case 39:i.preventDefault(),t.seek(t.video.currentTime+5),t.controller.setAutoHide();break;case 38:i.preventDefault(),a=t.volume()+.1,t.volume(a);break;case 40:i.preventDefault(),a=t.volume()-.1,t.volume(a)}}}})),document.addEventListener(\"keydown\",(function(e){27===(e||window.event).keyCode&&t.fullScreen.isFullScreen(\"web\")&&t.fullScreen.cancel(\"web\")}))}},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=r(1),i=n&&n.__esModule?n:{default:n};function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=(function(e,t,r){t&&a(e.prototype,t),r&&a(e,r)}(s,[{key:\"show\",value:function(){this.player.controller.disableAutoHide=!0,this.player.template.controller.classList.add(\"dplayer-controller-comment\"),this.player.template.mask.classList.add(\"dplayer-mask-show\"),this.player.container.classList.add(\"dplayer-show-controller\"),this.player.template.commentInput.focus()}},{key:\"hide\",value:function(){this.player.template.controller.classList.remove(\"dplayer-controller-comment\"),this.player.template.mask.classList.remove(\"dplayer-mask-show\"),this.player.container.classList.remove(\"dplayer-show-controller\"),this.player.controller.disableAutoHide=!1,this.hideSetting()}},{key:\"showSetting\",value:function(){this.player.template.commentSettingBox.classList.add(\"dplayer-comment-setting-open\")}},{key:\"hideSetting\",value:function(){this.player.template.commentSettingBox.classList.remove(\"dplayer-comment-setting-open\")}},{key:\"toggleSetting\",value:function(){this.player.template.commentSettingBox.classList.contains(\"dplayer-comment-setting-open\")?this.hideSetting():this.showSetting()}},{key:\"send\",value:function(){var e=this;this.player.template.commentInput.blur(),this.player.template.commentInput.value.replace(/^\\s+|\\s+$/g,\"\")?this.player.danmaku.send({text:this.player.template.commentInput.value,color:i.default.color2Number(this.player.container.querySelector(\".dplayer-comment-setting-color input:checked\").value),type:parseInt(this.player.container.querySelector(\".dplayer-comment-setting-type input:checked\").value)},(function(){e.player.template.commentInput.value=\"\",e.hide()})):this.player.notice(this.player.tran(\"Please input danmaku content!\"))}}]),s);function s(e){var t=this;!function(e){if(!(e instanceof s))throw new TypeError(\"Cannot call a class as a function\")}(this),this.player=e,this.player.template.mask.addEventListener(\"click\",(function(){t.hide()})),this.player.template.commentButton.addEventListener(\"click\",(function(){t.show()})),this.player.template.commentSettingButton.addEventListener(\"click\",(function(){t.toggleSetting()})),this.player.template.commentColorSettingBox.addEventListener(\"click\",(function(){var e;t.player.template.commentColorSettingBox.querySelector(\"input:checked+span\")&&(e=t.player.template.commentColorSettingBox.querySelector(\"input:checked\").value,t.player.template.commentSettingFill.style.fill=e,t.player.template.commentInput.style.color=e,t.player.template.commentSendFill.style.fill=e)})),this.player.template.commentInput.addEventListener(\"click\",(function(){t.hideSetting()})),this.player.template.commentInput.addEventListener(\"keydown\",(function(e){13===(e||window.event).keyCode&&t.send()})),this.player.template.commentSendButton.addEventListener(\"click\",(function(){t.send()}))}t.default=o},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=r(1),i=n&&n.__esModule?n:{default:n};function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=(function(e,t,r){t&&a(e.prototype,t),r&&a(e,r)}(s,[{key:\"hide\",value:function(){var e=this;this.player.template.settingBox.classList.remove(\"dplayer-setting-box-open\"),this.player.template.mask.classList.remove(\"dplayer-mask-show\"),setTimeout((function(){e.player.template.settingBox.classList.remove(\"dplayer-setting-box-narrow\"),e.player.template.settingBox.classList.remove(\"dplayer-setting-box-speed\")}),300),this.player.controller.disableAutoHide=!1}},{key:\"show\",value:function(){this.player.template.settingBox.classList.add(\"dplayer-setting-box-open\"),this.player.template.mask.classList.add(\"dplayer-mask-show\"),this.player.controller.disableAutoHide=!0}}]),s);function s(e){var t=this;!function(e){if(!(e instanceof s))throw new TypeError(\"Cannot call a class as a function\")}(this),this.player=e,this.player.template.mask.addEventListener(\"click\",(function(){t.hide()})),this.player.template.settingButton.addEventListener(\"click\",(function(){t.show()})),this.loop=this.player.options.loop,this.player.template.loopToggle.checked=this.loop,this.player.template.loop.addEventListener(\"click\",(function(){t.player.template.loopToggle.checked=!t.player.template.loopToggle.checked,t.player.template.loopToggle.checked?t.loop=!0:t.loop=!1,t.hide()})),this.showDanmaku=this.player.user.get(\"danmaku\"),this.showDanmaku||this.player.danmaku&&this.player.danmaku.hide(),this.player.template.showDanmakuToggle.checked=this.showDanmaku,this.player.template.showDanmaku.addEventListener(\"click\",(function(){t.player.template.showDanmakuToggle.checked=!t.player.template.showDanmakuToggle.checked,t.player.template.showDanmakuToggle.checked?(t.showDanmaku=!0,t.player.danmaku.show()):(t.showDanmaku=!1,t.player.danmaku.hide()),t.player.user.set(\"danmaku\",t.showDanmaku?1:0),t.hide()})),this.unlimitDanmaku=this.player.user.get(\"unlimited\"),this.player.template.unlimitDanmakuToggle.checked=this.unlimitDanmaku,this.player.template.unlimitDanmaku.addEventListener(\"click\",(function(){t.player.template.unlimitDanmakuToggle.checked=!t.player.template.unlimitDanmakuToggle.checked,t.player.template.unlimitDanmakuToggle.checked?(t.unlimitDanmaku=!0,t.player.danmaku.unlimit(!0)):(t.unlimitDanmaku=!1,t.player.danmaku.unlimit(!1)),t.player.user.set(\"unlimited\",t.unlimitDanmaku?1:0),t.hide()})),this.player.template.speed.addEventListener(\"click\",(function(){t.player.template.settingBox.classList.add(\"dplayer-setting-box-narrow\"),t.player.template.settingBox.classList.add(\"dplayer-setting-box-speed\")}));for(var r,n,a=0;a<this.player.template.speedItem.length;a++)!function(e){t.player.template.speedItem[e].addEventListener(\"click\",(function(){t.player.speed(t.player.template.speedItem[e].dataset.speed),t.hide()}))}(a);this.player.danmaku&&(this.player.on(\"danmaku_opacity\",(function(e){t.player.bar.set(\"danmaku\",e,\"width\"),t.player.user.set(\"opacity\",e)})),this.player.danmaku.opacity(this.player.user.get(\"opacity\")),r=function(e){var r=e||window.event,n=((r.clientX||r.changedTouches[0].clientX)-i.default.getBoundingClientRectViewLeft(t.player.template.danmakuOpacityBarWrap))/130;n=Math.max(n,0);n=Math.min(n,1),t.player.danmaku.opacity(n)},n=function e(){document.removeEventListener(i.default.nameMap.dragEnd,e),document.removeEventListener(i.default.nameMap.dragMove,r),t.player.template.danmakuOpacityBox.classList.remove(\"dplayer-setting-danmaku-active\")},this.player.template.danmakuOpacityBarWrapWrap.addEventListener(\"click\",(function(e){var r=e||window.event,n=((r.clientX||r.changedTouches[0].clientX)-i.default.getBoundingClientRectViewLeft(t.player.template.danmakuOpacityBarWrap))/130;n=Math.max(n,0);n=Math.min(n,1),t.player.danmaku.opacity(n)})),this.player.template.danmakuOpacityBarWrapWrap.addEventListener(i.default.nameMap.dragStart,(function(){document.addEventListener(i.default.nameMap.dragMove,r),document.addEventListener(i.default.nameMap.dragEnd,n),t.player.template.danmakuOpacityBox.classList.add(\"dplayer-setting-danmaku-active\")})))}t.default=o},function(e,t,r){\"use strict\";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,\"__esModule\",{value:!0});var i=(function(e,t,r){t&&n(e.prototype,t)}(a,[{key:\"resize\",value:function(e,t){this.container.style.width=e+\"px\",this.container.style.height=t+\"px\",this.container.style.top=2-t+\"px\"}},{key:\"show\",value:function(){this.container.style.display=\"block\",this.events&&this.events.trigger(\"thumbnails_show\")}},{key:\"move\",value:function(e){this.container.style.backgroundPosition=\"-\"+160*(Math.ceil(e/this.barWidth*100)-1)+\"px 0\",this.container.style.left=Math.min(Math.max(e-this.container.offsetWidth/2,-10),this.barWidth-150)+\"px\"}},{key:\"hide\",value:function(){this.container.style.display=\"none\",this.events&&this.events.trigger(\"thumbnails_hide\")}}]),a);function a(e){!function(e){if(!(e instanceof a))throw new TypeError(\"Cannot call a class as a function\")}(this),this.container=e.container,this.barWidth=e.barWidth,this.container.style.backgroundImage=\"url('\"+e.url+\"')\",this.events=e.events}t.default=i},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=s(r(1)),i=s(r(18)),a=s(r(2));function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e){return e&&e.__esModule?e:{default:e}}var l=(function(e,t,r){t&&o(e.prototype,t),r&&o(e,r)}(d,[{key:\"initPlayButton\",value:function(){var e=this;this.player.template.playButton.addEventListener(\"click\",(function(){e.player.toggle()})),n.default.isMobile?(this.player.template.videoWrap.addEventListener(\"click\",(function(){e.toggle()})),this.player.template.controllerMask.addEventListener(\"click\",(function(){e.toggle()}))):(this.player.template.videoWrap.addEventListener(\"click\",(function(){e.player.toggle()})),this.player.template.controllerMask.addEventListener(\"click\",(function(){e.player.toggle()})))}},{key:\"initHighlights\",value:function(){var e=this;this.player.on(\"durationchange\",(function(){if(1!==e.player.video.duration&&e.player.video.duration!==1/0&&e.player.options.highlight){var t=document.querySelectorAll(\".dplayer-highlight\");[].slice.call(t,0).forEach((function(t){e.player.template.playedBarWrap.removeChild(t)}));for(var r,n=0;n<e.player.options.highlight.length;n++)e.player.options.highlight[n].text&&e.player.options.highlight[n].time&&((r=document.createElement(\"div\")).classList.add(\"dplayer-highlight\"),r.style.left=e.player.options.highlight[n].time/e.player.video.duration*100+\"%\",r.innerHTML='<span class=\"dplayer-highlight-text\">'+e.player.options.highlight[n].text+\"</span>\",e.player.template.playedBarWrap.insertBefore(r,e.player.template.playedBarTime))}}))}},{key:\"initThumbnails\",value:function(){var e=this;this.player.options.video.thumbnails&&(this.thumbnails=new i.default({container:this.player.template.barPreview,barWidth:this.player.template.barWrap.offsetWidth,url:this.player.options.video.thumbnails,events:this.player.events}),this.player.on(\"loadedmetadata\",(function(){e.thumbnails.resize(160,e.player.video.videoHeight/e.player.video.videoWidth*160)})))}},{key:\"initPlayedBar\",value:function(){function e(e){var t=((e.clientX||e.changedTouches[0].clientX)-n.default.getBoundingClientRectViewLeft(r.player.template.playedBarWrap))/r.player.template.playedBarWrap.clientWidth;t=Math.max(t,0);t=Math.min(t,1),r.player.bar.set(\"played\",t,\"width\"),r.player.template.ptime.innerHTML=n.default.secondToTime(t*r.player.video.duration)}function t(i){document.removeEventListener(n.default.nameMap.dragEnd,t),document.removeEventListener(n.default.nameMap.dragMove,e);var a=((i.clientX||i.changedTouches[0].clientX)-n.default.getBoundingClientRectViewLeft(r.player.template.playedBarWrap))/r.player.template.playedBarWrap.clientWidth;a=Math.max(a,0);a=Math.min(a,1),r.player.bar.set(\"played\",a,\"width\"),r.player.seek(r.player.bar.get(\"played\")*r.player.video.duration),r.player.timer.enable(\"progress\")}var r=this;this.player.template.playedBarWrap.addEventListener(n.default.nameMap.dragStart,(function(){r.player.timer.disable(\"progress\"),document.addEventListener(n.default.nameMap.dragMove,e),document.addEventListener(n.default.nameMap.dragEnd,t)})),this.player.template.playedBarWrap.addEventListener(n.default.nameMap.dragMove,(function(e){if(r.player.video.duration){var t=n.default.cumulativeOffset(r.player.template.playedBarWrap).left,i=(e.clientX||e.changedTouches[0].clientX)-t;if(i<0||i>r.player.template.playedBarWrap.offsetWidth)return;var a=r.player.video.duration*(i/r.player.template.playedBarWrap.offsetWidth);n.default.isMobile&&r.thumbnails&&r.thumbnails.show(),r.thumbnails&&r.thumbnails.move(i),r.player.template.playedBarTime.style.left=i-(3600<=a?25:20)+\"px\",r.player.template.playedBarTime.innerText=n.default.secondToTime(a),r.player.template.playedBarTime.classList.remove(\"hidden\")}})),this.player.template.playedBarWrap.addEventListener(n.default.nameMap.dragEnd,(function(){n.default.isMobile&&r.thumbnails&&r.thumbnails.hide()})),n.default.isMobile||(this.player.template.playedBarWrap.addEventListener(\"mouseenter\",(function(){r.player.video.duration&&(r.thumbnails&&r.thumbnails.show(),r.player.template.playedBarTime.classList.remove(\"hidden\"))})),this.player.template.playedBarWrap.addEventListener(\"mouseleave\",(function(){r.player.video.duration&&(r.thumbnails&&r.thumbnails.hide(),r.player.template.playedBarTime.classList.add(\"hidden\"))})))}},{key:\"initFullButton\",value:function(){var e=this;this.player.template.browserFullButton.addEventListener(\"click\",(function(){e.player.fullScreen.toggle(\"browser\")})),this.player.template.webFullButton.addEventListener(\"click\",(function(){e.player.fullScreen.toggle(\"web\")}))}},{key:\"initVolumeButton\",value:function(){function e(e){var t=e||window.event,i=((t.clientX||t.changedTouches[0].clientX)-n.default.getBoundingClientRectViewLeft(r.player.template.volumeBarWrap)-5.5)/35;r.player.volume(i)}function t(){document.removeEventListener(n.default.nameMap.dragEnd,t),document.removeEventListener(n.default.nameMap.dragMove,e),r.player.template.volumeButton.classList.remove(\"dplayer-volume-active\")}var r=this;this.player.template.volumeBarWrapWrap.addEventListener(\"click\",(function(e){var t=e||window.event,i=((t.clientX||t.changedTouches[0].clientX)-n.default.getBoundingClientRectViewLeft(r.player.template.volumeBarWrap)-5.5)/35;r.player.volume(i)})),this.player.template.volumeBarWrapWrap.addEventListener(n.default.nameMap.dragStart,(function(){document.addEventListener(n.default.nameMap.dragMove,e),document.addEventListener(n.default.nameMap.dragEnd,t),r.player.template.volumeButton.classList.add(\"dplayer-volume-active\")})),this.player.template.volumeButtonIcon.addEventListener(\"click\",(function(){r.player.video.muted?(r.player.video.muted=!1,r.player.switchVolumeIcon(),r.player.bar.set(\"volume\",r.player.volume(),\"width\")):(r.player.video.muted=!0,r.player.template.volumeIcon.innerHTML=a.default.volumeOff,r.player.bar.set(\"volume\",0,\"width\"))}))}},{key:\"initQualityButton\",value:function(){var e=this;this.player.options.video.quality&&this.player.template.qualityList.addEventListener(\"click\",(function(t){t.target.classList.contains(\"dplayer-quality-item\")&&e.player.switchQuality(t.target.dataset.index)}))}},{key:\"initScreenshotButton\",value:function(){var e=this;this.player.options.screenshot&&this.player.template.camareButton.addEventListener(\"click\",(function(){var t=document.createElement(\"canvas\");t.width=e.player.video.videoWidth,t.height=e.player.video.videoHeight,t.getContext(\"2d\").drawImage(e.player.video,0,0,t.width,t.height);var r=void 0;t.toBlob((function(e){r=URL.createObjectURL(e);var t=document.createElement(\"a\");t.href=r,t.download=\"DPlayer.png\",t.style.display=\"none\",document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(r)})),e.player.events.trigger(\"screenshot\",r)}))}},{key:\"initSubtitleButton\",value:function(){var e=this;this.player.options.subtitle&&(this.player.events.on(\"subtitle_show\",(function(){e.player.template.subtitleButton.dataset.balloon=e.player.tran(\"Hide subtitle\"),e.player.template.subtitleButtonInner.style.opacity=\"\",e.player.user.set(\"subtitle\",1)})),this.player.events.on(\"subtitle_hide\",(function(){e.player.template.subtitleButton.dataset.balloon=e.player.tran(\"Show subtitle\"),e.player.template.subtitleButtonInner.style.opacity=\"0.4\",e.player.user.set(\"subtitle\",0)})),this.player.template.subtitleButton.addEventListener(\"click\",(function(){e.player.subtitle.toggle()})))}},{key:\"setAutoHide\",value:function(){var e=this;this.show(),clearTimeout(this.autoHideTimer),this.autoHideTimer=setTimeout((function(){!e.player.video.played.length||e.player.paused||e.disableAutoHide||e.hide()}),3e3)}},{key:\"show\",value:function(){this.player.container.classList.remove(\"dplayer-hide-controller\")}},{key:\"hide\",value:function(){this.player.container.classList.add(\"dplayer-hide-controller\"),this.player.setting.hide(),this.player.comment&&this.player.comment.hide()}},{key:\"isShow\",value:function(){return!this.player.container.classList.contains(\"dplayer-hide-controller\")}},{key:\"toggle\",value:function(){this.isShow()?this.hide():this.show()}},{key:\"destroy\",value:function(){clearTimeout(this.autoHideTimer)}}]),d);function d(e){var t=this;!function(e){if(!(e instanceof d))throw new TypeError(\"Cannot call a class as a function\")}(this),this.player=e,this.autoHideTimer=0,n.default.isMobile||(this.player.container.addEventListener(\"mousemove\",(function(){t.setAutoHide()})),this.player.container.addEventListener(\"click\",(function(){t.setAutoHide()})),this.player.on(\"play\",(function(){t.setAutoHide()})),this.player.on(\"pause\",(function(){t.setAutoHide()}))),this.initPlayButton(),this.initThumbnails(),this.initPlayedBar(),this.initFullButton(),this.initQualityButton(),this.initScreenshotButton(),this.initSubtitleButton(),this.initHighlights(),n.default.isMobile||this.initVolumeButton()}t.default=l},function(e,t,r){\"use strict\";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,\"__esModule\",{value:!0});var i=(function(e,t,r){t&&n(e.prototype,t)}(a,[{key:\"switch\",value:function(e){this.container.innerHTML=e,this.container.classList.add(\"dplayer-bezel-transition\")}}]),a);function a(e){var t=this;!function(e){if(!(e instanceof a))throw new TypeError(\"Cannot call a class as a function\")}(this),this.container=e,this.container.addEventListener(\"animationend\",(function(){t.container.classList.remove(\"dplayer-bezel-transition\")}))}t.default=i},function(e,t,r){\"use strict\";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,\"__esModule\",{value:!0});var i=(function(e,t,r){t&&n(e.prototype,t)}(a,[{key:\"init\",value:function(){var e=this;this.types.map((function(t){return\"fps\"!==t&&e[\"init\"+t+\"Checker\"](),t}))}},{key:\"initloadingChecker\",value:function(){var e,t=this,r=0,n=!1;this.loadingChecker=setInterval((function(){t.enableloadingChecker&&(e=t.player.video.currentTime,n||e!==r||t.player.video.paused||(t.player.container.classList.add(\"dplayer-loading\"),n=!0),n&&r<e&&!t.player.video.paused&&(t.player.container.classList.remove(\"dplayer-loading\"),n=!1),r=e)}),100)}},{key:\"initfpsChecker\",value:function(){var e=this;window.requestAnimationFrame((function(){var t;e.enablefpsChecker?(e.initfpsChecker(),e.fpsStart?(e.fpsIndex++,1e3<(t=new Date)-e.fpsStart&&(e.player.infoPanel.fps(e.fpsIndex/(t-e.fpsStart)*1e3),e.fpsStart=new Date,e.fpsIndex=0)):(e.fpsStart=new Date,e.fpsIndex=0)):(e.fpsStart=0,e.fpsIndex=0)}))}},{key:\"initinfoChecker\",value:function(){var e=this;this.infoChecker=setInterval((function(){e.enableinfoChecker&&e.player.infoPanel.update()}),1e3)}},{key:\"enable\",value:function(e){this[\"enable\"+e+\"Checker\"]=!0,\"fps\"===e&&this.initfpsChecker()}},{key:\"disable\",value:function(e){this[\"enable\"+e+\"Checker\"]=!1}},{key:\"destroy\",value:function(){var e=this;this.types.map((function(t){return e[\"enable\"+t+\"Checker\"]=!1,e[t+\"Checker\"]&&clearInterval(e[t+\"Checker\"]),t}))}}]),a);function a(e){!function(e){if(!(e instanceof a))throw new TypeError(\"Cannot call a class as a function\")}(this),this.player=e,window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)},this.types=[\"loading\",\"info\",\"fps\"],this.init()}t.default=i},function(e,t,r){\"use strict\";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,\"__esModule\",{value:!0});var i=(function(e,t,r){t&&n(e.prototype,t)}(a,[{key:\"set\",value:function(e,t,r){t=Math.max(t,0),t=Math.min(t,1),this.elements[e].style[r]=100*t+\"%\"}},{key:\"get\",value:function(e){return parseFloat(this.elements[e].style.width)/100}}]),a);function a(e){!function(e){if(!(e instanceof a))throw new TypeError(\"Cannot call a class as a function\")}(this),this.elements={},this.elements.volume=e.volumeBar,this.elements.played=e.playedBar,this.elements.loaded=e.loadedBar,this.elements.danmaku=e.danmakuOpacityBar}t.default=i},function(e,t,r){\"use strict\";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,\"__esModule\",{value:!0});var i=(function(e,t,r){t&&n(e.prototype,t)}(a,[{key:\"init\",value:function(){var e,t=this;this.container.style.fontSize=this.options.fontSize,this.container.style.bottom=this.options.bottom,this.container.style.color=this.options.color,this.video.textTracks&&this.video.textTracks[0]&&((e=this.video.textTracks[0]).oncuechange=function(){var r,n=e.activeCues[0];n?(t.container.innerHTML=\"\",(r=document.createElement(\"p\")).appendChild(n.getCueAsHTML()),t.container.appendChild(r)):t.container.innerHTML=\"\",t.events.trigger(\"subtitle_change\")})}},{key:\"show\",value:function(){this.container.classList.remove(\"dplayer-subtitle-hide\"),this.events.trigger(\"subtitle_show\")}},{key:\"hide\",value:function(){this.container.classList.add(\"dplayer-subtitle-hide\"),this.events.trigger(\"subtitle_hide\")}},{key:\"toggle\",value:function(){this.container.classList.contains(\"dplayer-subtitle-hide\")?this.show():this.hide()}}]),a);function a(e,t,r,n){!function(e){if(!(e instanceof a))throw new TypeError(\"Cannot call a class as a function\")}(this),this.container=e,this.video=t,this.options=r,this.events=n,this.init()}t.default=i},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=r(1),i=n&&n.__esModule?n:{default:n};function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=(function(e,t,r){t&&a(e.prototype,t),r&&a(e,r)}(s,[{key:\"init\",value:function(){for(var e in this.storageName){var t=this.storageName[e];this.data[e]=parseFloat(i.default.storage.get(t)||this.default[e])}}},{key:\"get\",value:function(e){return this.data[e]}},{key:\"set\",value:function(e,t){this.data[e]=t,i.default.storage.set(this.storageName[e],t)}}]),s);function s(e){!function(e){if(!(e instanceof s))throw new TypeError(\"Cannot call a class as a function\")}(this),this.storageName={opacity:\"dplayer-danmaku-opacity\",volume:\"dplayer-volume\",unlimited:\"dplayer-danmaku-unlimited\",danmaku:\"dplayer-danmaku-show\",subtitle:\"dplayer-subtitle-show\"},this.default={opacity:.7,volume:e.options.hasOwnProperty(\"volume\")?e.options.volume:.7,unlimited:(e.options.danmaku&&e.options.danmaku.unlimited?1:0)||0,danmaku:1,subtitle:1},this.data={},this.init()}t.default=o},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=r(1),i=n&&n.__esModule?n:{default:n};function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=(function(e,t,r){t&&a(e.prototype,t),r&&a(e,r)}(s,[{key:\"isFullScreen\",value:function(){switch(0<arguments.length&&void 0!==arguments[0]?arguments[0]:\"browser\"){case\"browser\":return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement;case\"web\":return this.player.container.classList.contains(\"dplayer-fulled\")}}},{key:\"request\",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:\"browser\",t=\"browser\"===e?\"web\":\"browser\",r=this.isFullScreen(t);switch(r||(this.lastScrollPosition=i.default.getScrollPosition()),e){case\"browser\":this.player.container.requestFullscreen?this.player.container.requestFullscreen():this.player.container.mozRequestFullScreen?this.player.container.mozRequestFullScreen():this.player.container.webkitRequestFullscreen?this.player.container.webkitRequestFullscreen():this.player.video.webkitEnterFullscreen?this.player.video.webkitEnterFullscreen():this.player.video.webkitEnterFullScreen?this.player.video.webkitEnterFullScreen():this.player.container.msRequestFullscreen&&this.player.container.msRequestFullscreen();break;case\"web\":this.player.container.classList.add(\"dplayer-fulled\"),document.body.classList.add(\"dplayer-web-fullscreen-fix\"),this.player.events.trigger(\"webfullscreen\")}r&&this.cancel(t)}},{key:\"cancel\",value:function(){switch(0<arguments.length&&void 0!==arguments[0]?arguments[0]:\"browser\"){case\"browser\":document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.webkitCancelFullscreen?document.webkitCancelFullscreen():document.msCancelFullScreen?document.msCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen();break;case\"web\":this.player.container.classList.remove(\"dplayer-fulled\"),document.body.classList.remove(\"dplayer-web-fullscreen-fix\"),this.player.events.trigger(\"webfullscreen_cancel\")}}},{key:\"toggle\",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:\"browser\";this.isFullScreen(e)?this.cancel(e):this.request(e)}}]),s);function s(e){var t=this;function r(){t.player.resize(),t.isFullScreen(\"browser\")?t.player.events.trigger(\"fullscreen\"):(i.default.setScrollPosition(t.lastScrollPosition),t.player.events.trigger(\"fullscreen_cancel\"))}function n(){var e=document.fullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;e&&e!==t.player.container||(t.player.resize(),e?t.player.events.trigger(\"fullscreen\"):(i.default.setScrollPosition(t.lastScrollPosition),t.player.events.trigger(\"fullscreen_cancel\")))}!function(e){if(!(e instanceof s))throw new TypeError(\"Cannot call a class as a function\")}(this),this.player=e,this.player.events.on(\"webfullscreen\",(function(){t.player.resize()})),this.player.events.on(\"webfullscreen_cancel\",(function(){t.player.resize(),i.default.setScrollPosition(t.lastScrollPosition)})),/Firefox/.test(navigator.userAgent)?(document.addEventListener(\"mozfullscreenchange\",n),document.addEventListener(\"fullscreenchange\",n)):(this.player.container.addEventListener(\"fullscreenchange\",r),this.player.container.addEventListener(\"webkitfullscreenchange\",r),document.addEventListener(\"msfullscreenchange\",n),document.addEventListener(\"MSFullscreenChange\",n))}t.default=o},function(e,t,r){\"use strict\";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,\"__esModule\",{value:!0});var i=(function(e,t,r){t&&n(e.prototype,t)}(a,[{key:\"on\",value:function(e,t){this.type(e)&&\"function\"==typeof t&&(this.events[e]||(this.events[e]=[]),this.events[e].push(t))}},{key:\"trigger\",value:function(e,t){if(this.events[e]&&this.events[e].length)for(var r=0;r<this.events[e].length;r++)this.events[e][r](t)}},{key:\"type\",value:function(e){return-1!==this.playerEvents.indexOf(e)?\"player\":-1!==this.videoEvents.indexOf(e)?\"video\":(console.error(\"Unknown event name: \"+e),null)}}]),a);function a(){!function(e){if(!(e instanceof a))throw new TypeError(\"Cannot call a class as a function\")}(this),this.events={},this.videoEvents=[\"abort\",\"canplay\",\"canplaythrough\",\"durationchange\",\"emptied\",\"ended\",\"error\",\"loadeddata\",\"loadedmetadata\",\"loadstart\",\"mozaudioavailable\",\"pause\",\"play\",\"playing\",\"progress\",\"ratechange\",\"seeked\",\"seeking\",\"stalled\",\"suspend\",\"timeupdate\",\"volumechange\",\"waiting\"],this.playerEvents=[\"screenshot\",\"thumbnails_show\",\"thumbnails_hide\",\"danmaku_show\",\"danmaku_hide\",\"danmaku_clear\",\"danmaku_loaded\",\"danmaku_send\",\"danmaku_opacity\",\"contextmenu_show\",\"contextmenu_hide\",\"notice_show\",\"notice_hide\",\"quality_start\",\"quality_end\",\"destroy\",\"resize\",\"fullscreen\",\"fullscreen_cancel\",\"webfullscreen\",\"webfullscreen_cancel\",\"subtitle_show\",\"subtitle_hide\",\"subtitle_change\"]}t.default=i},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e},i=r(1),a=i&&i.__esModule?i:{default:i};function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=(function(e,t,r){t&&o(e.prototype,t),r&&o(e,r)}(l,[{key:\"load\",value:function(){var e=this,t=this.options.api.maximum?this.options.api.address+\"v3/?id=\"+this.options.api.id+\"&max=\"+this.options.api.maximum:this.options.api.address+\"v3/?id=\"+this.options.api.id,r=(this.options.api.addition||[]).slice(0);r.push(t),this.events&&this.events.trigger(\"danmaku_load_start\",r),this._readAllEndpoints(r,(function(t){e.dan=[].concat.apply([],t).sort((function(e,t){return e.time-t.time})),window.requestAnimationFrame((function(){e.frame()})),e.options.callback(),e.events&&e.events.trigger(\"danmaku_load_end\")}))}},{key:\"reload\",value:function(e){this.options.api=e,this.dan=[],this.clear(),this.load()}},{key:\"_readAllEndpoints\",value:function(e,t){for(var r=this,n=[],i=0,a=0;a<e.length;++a)!function(a){r.options.apiBackend.read({url:e[a],success:function(r){n[a]=r,++i===e.length&&t(n)},error:function(o){r.options.error(o||r.options.tran(\"Danmaku load failed\")),n[a]=[],++i===e.length&&t(n)}})}(a)}},{key:\"send\",value:function(e,t){var r=this,n={token:this.options.api.token,id:this.options.api.id,author:this.options.api.user,time:this.options.time(),text:e.text,color:e.color,type:e.type};this.options.apiBackend.send({url:this.options.api.address+\"v3/\",data:n,success:t,error:function(e){r.options.error(e||r.options.tran(\"Danmaku send failed\"))}}),this.dan.splice(this.danIndex,0,n),this.danIndex++;var i={text:this.htmlEncode(n.text),color:n.color,type:n.type,border:\"2px solid \"+this.options.borderColor};this.draw(i),this.events&&this.events.trigger(\"danmaku_send\",n)}},{key:\"frame\",value:function(){var e=this;if(this.dan.length&&!this.paused&&this.showing){for(var t=this.dan[this.danIndex],r=[];t&&this.options.time()>parseFloat(t.time);)r.push(t),t=this.dan[++this.danIndex];this.draw(r)}window.requestAnimationFrame((function(){e.frame()}))}},{key:\"opacity\",value:function(e){if(void 0!==e){for(var t=this.container.getElementsByClassName(\"dplayer-danmaku-item\"),r=0;r<t.length;r++)t[r].style.opacity=e;this._opacity=e,this.events&&this.events.trigger(\"danmaku_opacity\",this._opacity)}return this._opacity}},{key:\"draw\",value:function(e){var t=this;if(this.showing){var r=this.options.height,i=this.container.offsetWidth,o=this.container.offsetHeight,s=parseInt(o/r),l=function(e){return(i+e)/5},d=function(e,r,a){for(var o=i/l(a),d=function(n){var a=t.danTunnel[r][n+\"\"];if(!a||!a.length)return t.danTunnel[r][n+\"\"]=[e],e.addEventListener(\"animationend\",(function(){t.danTunnel[r][n+\"\"].splice(0,1)})),{v:n%s};if(\"right\"!==r)return\"continue\";for(var d,u,c,h=0;h<a.length;h++){var f=(void 0,u=(d=a[h]).offsetWidth||parseInt(d.style.width),c=d.getBoundingClientRect().right||t.container.getBoundingClientRect().right+u,t.container.getBoundingClientRect().right-c-10);if(f<=i-o*l(parseInt(a[h].style.width))||f<=0)break;if(h===a.length-1)return t.danTunnel[r][n+\"\"].push(e),e.addEventListener(\"animationend\",(function(){t.danTunnel[r][n+\"\"].splice(0,1)})),{v:n%s}}},u=0;t.unlimited||u<s;u++){var c=d(u);if(\"continue\"!==c&&\"object\"===(void 0===c?\"undefined\":n(c)))return c.v}return-1};\"[object Array]\"!==Object.prototype.toString.call(e)&&(e=[e]);for(var u=document.createDocumentFragment(),c=0;c<e.length;c++)!function(n){e[n].type=a.default.number2Type(e[n].type),e[n].color||(e[n].color=16777215);var o=document.createElement(\"div\");o.classList.add(\"dplayer-danmaku-item\"),o.classList.add(\"dplayer-danmaku-\"+e[n].type),e[n].border?o.innerHTML='<span style=\"border:'+e[n].border+'\">'+e[n].text+\"</span>\":o.innerHTML=e[n].text,o.style.opacity=t._opacity,o.style.color=a.default.number2Color(e[n].color),o.addEventListener(\"animationend\",(function(){t.container.removeChild(o)}));var s=t._measure(e[n].text),l=void 0;switch(e[n].type){case\"right\":0<=(l=d(o,e[n].type,s))&&(o.style.width=s+1+\"px\",o.style.top=r*l+\"px\",o.style.transform=\"translateX(-\"+i+\"px)\");break;case\"top\":0<=(l=d(o,e[n].type))&&(o.style.top=r*l+\"px\");break;case\"bottom\":0<=(l=d(o,e[n].type))&&(o.style.bottom=r*l+\"px\");break;default:console.error(\"Can't handled danmaku type: \"+e[n].type)}0<=l&&(o.classList.add(\"dplayer-danmaku-move\"),u.appendChild(o))}(c);return this.container.appendChild(u),u}}},{key:\"play\",value:function(){this.paused=!1}},{key:\"pause\",value:function(){this.paused=!0}},{key:\"_measure\",value:function(e){var t;return this.context||(t=getComputedStyle(this.container.getElementsByClassName(\"dplayer-danmaku-item\")[0],null),this.context=document.createElement(\"canvas\").getContext(\"2d\"),this.context.font=t.getPropertyValue(\"font\")),this.context.measureText(e).width}},{key:\"seek\",value:function(){this.clear();for(var e=0;e<this.dan.length;e++){if(this.dan[e].time>=this.options.time()){this.danIndex=e;break}this.danIndex=this.dan.length}}},{key:\"clear\",value:function(){this.danTunnel={right:{},top:{},bottom:{}},this.danIndex=0,this.options.container.innerHTML=\"\",this.events&&this.events.trigger(\"danmaku_clear\")}},{key:\"htmlEncode\",value:function(e){return e.replace(/&/g,\"&amp;\").replace(/</g,\"&lt;\").replace(/>/g,\"&gt;\").replace(/\"/g,\"&quot;\").replace(/'/g,\"&#x27;\").replace(/\\//g,\"&#x2f;\")}},{key:\"resize\",value:function(){for(var e=this.container.offsetWidth,t=this.container.getElementsByClassName(\"dplayer-danmaku-item\"),r=0;r<t.length;r++)t[r].style.transform=\"translateX(-\"+e+\"px)\"}},{key:\"hide\",value:function(){this.showing=!1,this.pause(),this.clear(),this.events&&this.events.trigger(\"danmaku_hide\")}},{key:\"show\",value:function(){this.seek(),this.showing=!0,this.play(),this.events&&this.events.trigger(\"danmaku_show\")}},{key:\"unlimit\",value:function(e){this.unlimited=e}}]),l);function l(e){!function(e){if(!(e instanceof l))throw new TypeError(\"Cannot call a class as a function\")}(this),this.options=e,this.container=this.options.container,this.danTunnel={right:{},top:{},bottom:{}},this.danIndex=0,this.dan=[],this.showing=!0,this._opacity=this.options.opacity,this.events=this.options.events,this.unlimited=this.options.unlimited,this._measure(\"\"),this.load()}t.default=s},function(e,t,r){\"use strict\";(function(t){e.exports=!1;try{e.exports=\"[object process]\"===Object.prototype.toString.call(t.process)}catch(t){}}).call(this,r(4))},function(e,t,r){\"use strict\";(function(t){var n=r(28),i=Object.create(n?t:window),a=/[\"&'<>]/;i.$escape=function(e){return function(e){var t=\"\"+e,r=a.exec(t);if(!r)return e;var n=\"\",i=void 0,o=void 0,s=void 0;for(i=r.index,o=0;i<t.length;i++){switch(t.charCodeAt(i)){case 34:s=\"&#34;\";break;case 38:s=\"&#38;\";break;case 39:s=\"&#39;\";break;case 60:s=\"&#60;\";break;case 62:s=\"&#62;\";break;default:continue}o!==i&&(n+=t.substring(o,i)),o=i+1,n+=s}return o!==i?n+t.substring(o,i):n}(function e(t){return\"string\"!=typeof t&&(t=null==t?\"\":\"function\"==typeof t?e(t.call(t)):JSON.stringify(t)),t}(e))},i.$each=function(e,t){if(Array.isArray(e))for(var r=0,n=e.length;r<n;r++)t(e[r],r);else for(var i in e)t(e[i],i)},e.exports=i}).call(this,r(4))},function(e,t,r){var n=r(6);e.exports=function(e){\"use strict\";var t,i=\"\",a=(e=e||{}).video,o=e.options,s=n.$escape,l=e.tran,d=e.icons,u=e.index,c=n.$each;return e.$value,e.$index,i+='<div class=\"dplayer-mask\"></div>\\n<div class=\"dplayer-video-wrap\">\\n    ',t=r(5)(a),i+=t,i+=\"\\n    \",o.logo&&(i+='\\n    <div class=\"dplayer-logo\">\\n        <img src=\"',i+=s(o.logo),i+='\">\\n    </div>\\n    '),i+='\\n    <div class=\"dplayer-danmaku\"',o.danmaku&&o.danmaku.bottm&&(i+=' style=\"margin-bottom:',i+=s(o.danmaku.bottm),i+='\"'),i+='>\\n        <div class=\"dplayer-danmaku-item dplayer-danmaku-item--demo\"></div>\\n    </div>\\n    <div class=\"dplayer-subtitle\"></div>\\n    <div class=\"dplayer-bezel\">\\n        <span class=\"dplayer-bezel-icon\"></span>\\n        ',o.danmaku&&(i+='\\n        <span class=\"dplayer-danloading\">',i+=s(l(\"Danmaku is loading\")),i+=\"</span>\\n        \"),i+='\\n        <span class=\"diplayer-loading-icon\">',i+=d.loading,i+='</span>\\n    </div>\\n</div>\\n<div class=\"dplayer-controller-mask\"></div>\\n<div class=\"dplayer-controller\">\\n    <div class=\"dplayer-icons dplayer-comment-box\">\\n        <button class=\"dplayer-icon dplayer-comment-setting-icon\" data-balloon=\"',i+=s(l(\"Setting\")),i+='\" data-balloon-pos=\"up\">\\n            <span class=\"dplayer-icon-content\">',i+=d.pallette,i+='</span>\\n        </button>\\n        <div class=\"dplayer-comment-setting-box\">\\n            <div class=\"dplayer-comment-setting-color\">\\n                <div class=\"dplayer-comment-setting-title\">',i+=s(l(\"Set danmaku color\")),i+='</div>\\n                <label>\\n                    <input type=\"radio\" name=\"dplayer-danmaku-color-',i+=s(u),i+='\" value=\"#fff\" checked>\\n                    <span style=\"background: #fff;\"></span>\\n                </label>\\n                <label>\\n                    <input type=\"radio\" name=\"dplayer-danmaku-color-',i+=s(u),i+='\" value=\"#e54256\">\\n                    <span style=\"background: #e54256\"></span>\\n                </label>\\n                <label>\\n                    <input type=\"radio\" name=\"dplayer-danmaku-color-',i+=s(u),i+='\" value=\"#ffe133\">\\n                    <span style=\"background: #ffe133\"></span>\\n                </label>\\n                <label>\\n                    <input type=\"radio\" name=\"dplayer-danmaku-color-',i+=s(u),i+='\" value=\"#64DD17\">\\n                    <span style=\"background: #64DD17\"></span>\\n                </label>\\n                <label>\\n                    <input type=\"radio\" name=\"dplayer-danmaku-color-',i+=s(u),i+='\" value=\"#39ccff\">\\n                    <span style=\"background: #39ccff\"></span>\\n                </label>\\n                <label>\\n                    <input type=\"radio\" name=\"dplayer-danmaku-color-',i+=s(u),i+='\" value=\"#D500F9\">\\n                    <span style=\"background: #D500F9\"></span>\\n                </label>\\n            </div>\\n            <div class=\"dplayer-comment-setting-type\">\\n                <div class=\"dplayer-comment-setting-title\">',i+=s(l(\"Set danmaku type\")),i+='</div>\\n                <label>\\n                    <input type=\"radio\" name=\"dplayer-danmaku-type-',i+=s(u),i+='\" value=\"1\">\\n                    <span>',i+=s(l(\"Top\")),i+='</span>\\n                </label>\\n                <label>\\n                    <input type=\"radio\" name=\"dplayer-danmaku-type-',i+=s(u),i+='\" value=\"0\" checked>\\n                    <span>',i+=s(l(\"Rolling\")),i+='</span>\\n                </label>\\n                <label>\\n                    <input type=\"radio\" name=\"dplayer-danmaku-type-',i+=s(u),i+='\" value=\"2\">\\n                    <span>',i+=s(l(\"Bottom\")),i+='</span>\\n                </label>\\n            </div>\\n        </div>\\n        <input class=\"dplayer-comment-input\" type=\"text\" placeholder=\"',i+=s(l(\"Input danmaku, hit Enter\")),i+='\" maxlength=\"30\">\\n        <button class=\"dplayer-icon dplayer-send-icon\" data-balloon=\"',i+=s(l(\"Send\")),i+='\" data-balloon-pos=\"up\">\\n            <span class=\"dplayer-icon-content\">',i+=d.send,i+='</span>\\n        </button>\\n    </div>\\n    <div class=\"dplayer-icons dplayer-icons-left\">\\n        <button class=\"dplayer-icon dplayer-play-icon\">\\n            <span class=\"dplayer-icon-content\">',i+=d.play,i+='</span>\\n        </button>\\n        <div class=\"dplayer-volume\">\\n            <button class=\"dplayer-icon dplayer-volume-icon\">\\n                <span class=\"dplayer-icon-content\">',i+=d.volumeDown,i+='</span>\\n            </button>\\n            <div class=\"dplayer-volume-bar-wrap\" data-balloon-pos=\"up\">\\n                <div class=\"dplayer-volume-bar\">\\n                    <div class=\"dplayer-volume-bar-inner\" style=\"background: ',i+=s(o.theme),i+=';\">\\n                        <span class=\"dplayer-thumb\" style=\"background: ',i+=s(o.theme),i+='\"></span>\\n                    </div>\\n                </div>\\n            </div>\\n        </div>\\n        <span class=\"dplayer-time\">\\n            <span class=\"dplayer-ptime\">0:00</span> /\\n            <span class=\"dplayer-dtime\">0:00</span>\\n        </span>\\n        ',o.live&&(i+='\\n        <span class=\"dplayer-live-badge\"><span class=\"dplayer-live-dot\" style=\"background: ',i+=s(o.theme),i+=';\"></span>',i+=s(l(\"Live\")),i+=\"</span>\\n        \"),i+='\\n    </div>\\n    <div class=\"dplayer-icons dplayer-icons-right\">\\n        ',o.video.quality&&(i+='\\n        <div class=\"dplayer-quality\">\\n            <button class=\"dplayer-icon dplayer-quality-icon\">',i+=s(o.video.quality[o.video.defaultQuality].name),i+='</button>\\n            <div class=\"dplayer-quality-mask\">\\n                <div class=\"dplayer-quality-list\">\\n                ',c(o.video.quality,(function(e,t){i+='\\n                    <div class=\"dplayer-quality-item\" data-index=\"',i+=s(t),i+='\">',i+=s(e.name),i+=\"</div>\\n                \"})),i+=\"\\n                </div>\\n            </div>\\n        </div>\\n        \"),i+=\"\\n        \",o.screenshot&&(i+='\\n        <div class=\"dplayer-icon dplayer-camera-icon\" data-balloon=\"',i+=s(l(\"Screenshot\")),i+='\" data-balloon-pos=\"up\">\\n            <span class=\"dplayer-icon-content\">',i+=d.camera,i+=\"</span>\\n        </div>\\n        \"),i+='\\n        <div class=\"dplayer-comment\">\\n            <button class=\"dplayer-icon dplayer-comment-icon\" data-balloon=\"',i+=s(l(\"Send danmaku\")),i+='\" data-balloon-pos=\"up\">\\n                <span class=\"dplayer-icon-content\">',i+=d.comment,i+=\"</span>\\n            </button>\\n        </div>\\n        \",o.subtitle&&(i+='\\n        <div class=\"dplayer-subtitle-btn\">\\n            <button class=\"dplayer-icon dplayer-subtitle-icon\" data-balloon=\"',i+=s(l(\"Hide subtitle\")),i+='\" data-balloon-pos=\"up\">\\n                <span class=\"dplayer-icon-content\">',i+=d.subtitle,i+=\"</span>\\n            </button>\\n        </div>\\n        \"),i+='\\n        <div class=\"dplayer-setting\">\\n            <button class=\"dplayer-icon dplayer-setting-icon\" data-balloon=\"',i+=s(l(\"Setting\")),i+='\" data-balloon-pos=\"up\">\\n                <span class=\"dplayer-icon-content\">',i+=d.setting,i+='</span>\\n            </button>\\n            <div class=\"dplayer-setting-box\">\\n                <div class=\"dplayer-setting-origin-panel\">\\n                    <div class=\"dplayer-setting-item dplayer-setting-speed\">\\n                        <span class=\"dplayer-label\">',i+=s(l(\"Speed\")),i+='</span>\\n                        <div class=\"dplayer-toggle\">',i+=d.right,i+='</div>\\n                    </div>\\n                    <div class=\"dplayer-setting-item dplayer-setting-loop\">\\n                        <span class=\"dplayer-label\">',i+=s(l(\"Loop\")),i+='</span>\\n                        <div class=\"dplayer-toggle\">\\n                            <input class=\"dplayer-toggle-setting-input\" type=\"checkbox\" name=\"dplayer-toggle\">\\n                            <label for=\"dplayer-toggle\"></label>\\n                        </div>\\n                    </div>\\n                    <div class=\"dplayer-setting-item dplayer-setting-showdan\">\\n                        <span class=\"dplayer-label\">',i+=s(l(\"Show danmaku\")),i+='</span>\\n                        <div class=\"dplayer-toggle\">\\n                            <input class=\"dplayer-showdan-setting-input\" type=\"checkbox\" name=\"dplayer-toggle-dan\">\\n                            <label for=\"dplayer-toggle-dan\"></label>\\n                        </div>\\n                    </div>\\n                    <div class=\"dplayer-setting-item dplayer-setting-danunlimit\">\\n                        <span class=\"dplayer-label\">',i+=s(l(\"Unlimited danmaku\")),i+='</span>\\n                        <div class=\"dplayer-toggle\">\\n                            <input class=\"dplayer-danunlimit-setting-input\" type=\"checkbox\" name=\"dplayer-toggle-danunlimit\">\\n                            <label for=\"dplayer-toggle-danunlimit\"></label>\\n                        </div>\\n                    </div>\\n                    <div class=\"dplayer-setting-item dplayer-setting-danmaku\">\\n                        <span class=\"dplayer-label\">',i+=s(l(\"Opacity for danmaku\")),i+='</span>\\n                        <div class=\"dplayer-danmaku-bar-wrap\">\\n                            <div class=\"dplayer-danmaku-bar\">\\n                                <div class=\"dplayer-danmaku-bar-inner\">\\n                                    <span class=\"dplayer-thumb\"></span>\\n                                </div>\\n                            </div>\\n                        </div>\\n                    </div>\\n                </div>\\n                <div class=\"dplayer-setting-speed-panel\">\\n                    <div class=\"dplayer-setting-speed-item\" data-speed=\"0.5\">\\n                        <span class=\"dplayer-label\">0.5</span>\\n                    </div>\\n                    <div class=\"dplayer-setting-speed-item\" data-speed=\"0.75\">\\n                        <span class=\"dplayer-label\">0.75</span>\\n                    </div>\\n                    <div class=\"dplayer-setting-speed-item\" data-speed=\"1\">\\n                        <span class=\"dplayer-label\">',i+=s(l(\"Normal\")),i+='</span>\\n                    </div>\\n                    <div class=\"dplayer-setting-speed-item\" data-speed=\"1.25\">\\n                        <span class=\"dplayer-label\">1.25</span>\\n                    </div>\\n                    <div class=\"dplayer-setting-speed-item\" data-speed=\"1.5\">\\n                        <span class=\"dplayer-label\">1.5</span>\\n                    </div>\\n                    <div class=\"dplayer-setting-speed-item\" data-speed=\"2\">\\n                        <span class=\"dplayer-label\">2</span>\\n                    </div>\\n                </div>\\n            </div>\\n        </div>\\n        <div class=\"dplayer-full\">\\n            <button class=\"dplayer-icon dplayer-full-in-icon\" data-balloon=\"',i+=s(l(\"Web full screen\")),i+='\" data-balloon-pos=\"up\">\\n                <span class=\"dplayer-icon-content\">',i+=d.fullWeb,i+='</span>\\n            </button>\\n            <button class=\"dplayer-icon dplayer-full-icon\" data-balloon=\"',i+=s(l(\"Full screen\")),i+='\" data-balloon-pos=\"up\">\\n                <span class=\"dplayer-icon-content\">',i+=d.full,i+='</span>\\n            </button>\\n        </div>\\n    </div>\\n    <div class=\"dplayer-bar-wrap\">\\n        <div class=\"dplayer-bar-time hidden\">00:00</div>\\n        <div class=\"dplayer-bar-preview\"></div>\\n        <div class=\"dplayer-bar\">\\n            <div class=\"dplayer-loaded\" style=\"width: 0;\"></div>\\n            <div class=\"dplayer-played\" style=\"width: 0; background: ',i+=s(o.theme),i+='\">\\n                <span class=\"dplayer-thumb\" style=\"background: ',i+=s(o.theme),i+='\"></span>\\n            </div>\\n        </div>\\n    </div>\\n</div>\\n<div class=\"dplayer-info-panel dplayer-info-panel-hide\">\\n    <div class=\"dplayer-info-panel-close\">[x]</div>\\n    <div class=\"dplayer-info-panel-item dplayer-info-panel-item-version\">\\n        <span class=\"dplayer-info-panel-item-title\">Player version</span>\\n        <span class=\"dplayer-info-panel-item-data\"></span>\\n    </div>\\n    <div class=\"dplayer-info-panel-item dplayer-info-panel-item-fps\">\\n        <span class=\"dplayer-info-panel-item-title\">Player FPS</span>\\n        <span class=\"dplayer-info-panel-item-data\"></span>\\n    </div>\\n    <div class=\"dplayer-info-panel-item dplayer-info-panel-item-type\">\\n        <span class=\"dplayer-info-panel-item-title\">Video type</span>\\n        <span class=\"dplayer-info-panel-item-data\"></span>\\n    </div>\\n    <div class=\"dplayer-info-panel-item dplayer-info-panel-item-url\">\\n        <span class=\"dplayer-info-panel-item-title\">Video url</span>\\n        <span class=\"dplayer-info-panel-item-data\"></span>\\n    </div>\\n    <div class=\"dplayer-info-panel-item dplayer-info-panel-item-resolution\">\\n        <span class=\"dplayer-info-panel-item-title\">Video resolution</span>\\n        <span class=\"dplayer-info-panel-item-data\"></span>\\n    </div>\\n    <div class=\"dplayer-info-panel-item dplayer-info-panel-item-duration\">\\n        <span class=\"dplayer-info-panel-item-title\">Video duration</span>\\n        <span class=\"dplayer-info-panel-item-data\"></span>\\n    </div>\\n    ',o.danmaku&&(i+='\\n    <div class=\"dplayer-info-panel-item dplayer-info-panel-item-danmaku-id\">\\n        <span class=\"dplayer-info-panel-item-title\">Danamku id</span>\\n        <span class=\"dplayer-info-panel-item-data\"></span>\\n    </div>\\n    <div class=\"dplayer-info-panel-item dplayer-info-panel-item-danmaku-api\">\\n        <span class=\"dplayer-info-panel-item-title\">Danamku api</span>\\n        <span class=\"dplayer-info-panel-item-data\"></span>\\n    </div>\\n    <div class=\"dplayer-info-panel-item dplayer-info-panel-item-danmaku-amount\">\\n        <span class=\"dplayer-info-panel-item-title\">Danamku amount</span>\\n        <span class=\"dplayer-info-panel-item-data\"></span>\\n    </div>\\n    '),i+='\\n</div>\\n<div class=\"dplayer-menu\">\\n    ',c(o.contextmenu,(function(e,t){i+='\\n        <div class=\"dplayer-menu-item\">\\n            <a',e.link&&(i+=' target=\"_blank\"'),i+=' href=\"',i+=s(e.link||\"javascript:void(0);\"),i+='\">',i+=s(l(e.text)),i+=\"</a>\\n        </div>\\n    \"})),i+='\\n</div>\\n<div class=\"dplayer-notice\"></div>'}},function(e,t){e.exports='<svg version=\"1.1\" viewBox=\"0 0 22 22\"><svg x=\"7\" y=\"1\"><circle class=\"diplayer-loading-dot diplayer-loading-dot-0\" cx=\"4\" cy=\"4\" r=\"2\"></circle></svg><svg x=\"11\" y=\"3\"><circle class=\"diplayer-loading-dot diplayer-loading-dot-1\" cx=\"4\" cy=\"4\" r=\"2\"></circle></svg><svg x=\"13\" y=\"7\"><circle class=\"diplayer-loading-dot diplayer-loading-dot-2\" cx=\"4\" cy=\"4\" r=\"2\"></circle></svg><svg x=\"11\" y=\"11\"><circle class=\"diplayer-loading-dot diplayer-loading-dot-3\" cx=\"4\" cy=\"4\" r=\"2\"></circle></svg><svg x=\"7\" y=\"13\"><circle class=\"diplayer-loading-dot diplayer-loading-dot-4\" cx=\"4\" cy=\"4\" r=\"2\"></circle></svg><svg x=\"3\" y=\"11\"><circle class=\"diplayer-loading-dot diplayer-loading-dot-5\" cx=\"4\" cy=\"4\" r=\"2\"></circle></svg><svg x=\"1\" y=\"7\"><circle class=\"diplayer-loading-dot diplayer-loading-dot-6\" cx=\"4\" cy=\"4\" r=\"2\"></circle></svg><svg x=\"3\" y=\"3\"><circle class=\"diplayer-loading-dot diplayer-loading-dot-7\" cx=\"4\" cy=\"4\" r=\"2\"></circle></svg></svg>'},function(e,t){e.exports='<svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" viewBox=\"0 0 32 32\"><path d=\"M26.667 5.333h-21.333c-0 0-0.001 0-0.001 0-1.472 0-2.666 1.194-2.666 2.666 0 0 0 0.001 0 0.001v-0 16c0 0 0 0.001 0 0.001 0 1.472 1.194 2.666 2.666 2.666 0 0 0.001 0 0.001 0h21.333c0 0 0.001 0 0.001 0 1.472 0 2.666-1.194 2.666-2.666 0-0 0-0.001 0-0.001v0-16c0-0 0-0.001 0-0.001 0-1.472-1.194-2.666-2.666-2.666-0 0-0.001 0-0.001 0h0zM5.333 16h5.333v2.667h-5.333v-2.667zM18.667 24h-13.333v-2.667h13.333v2.667zM26.667 24h-5.333v-2.667h5.333v2.667zM26.667 18.667h-13.333v-2.667h13.333v2.667z\"></path></svg>'},function(e,t){e.exports='<svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" viewBox=\"0 0 32 32\"><path d=\"M16 23c-3.309 0-6-2.691-6-6s2.691-6 6-6 6 2.691 6 6-2.691 6-6 6zM16 13c-2.206 0-4 1.794-4 4s1.794 4 4 4c2.206 0 4-1.794 4-4s-1.794-4-4-4zM27 28h-22c-1.654 0-3-1.346-3-3v-16c0-1.654 1.346-3 3-3h3c0.552 0 1 0.448 1 1s-0.448 1-1 1h-3c-0.551 0-1 0.449-1 1v16c0 0.552 0.449 1 1 1h22c0.552 0 1-0.448 1-1v-16c0-0.551-0.448-1-1-1h-11c-0.552 0-1-0.448-1-1s0.448-1 1-1h11c1.654 0 3 1.346 3 3v16c0 1.654-1.346 3-3 3zM24 10.5c0 0.828 0.672 1.5 1.5 1.5s1.5-0.672 1.5-1.5c0-0.828-0.672-1.5-1.5-1.5s-1.5 0.672-1.5 1.5zM15 4c0 0.552-0.448 1-1 1h-4c-0.552 0-1-0.448-1-1v0c0-0.552 0.448-1 1-1h4c0.552 0 1 0.448 1 1v0z\"></path></svg>'},function(e,t){e.exports='<svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" viewBox=\"0 0 32 32\"><path d=\"M19.357 2.88c1.749 0 3.366 0.316 4.851 0.946 1.485 0.632 2.768 1.474 3.845 2.533s1.922 2.279 2.532 3.661c0.611 1.383 0.915 2.829 0.915 4.334 0 1.425-0.304 2.847-0.915 4.271-0.611 1.425-1.587 2.767-2.928 4.028-0.855 0.813-1.811 1.607-2.869 2.38s-2.136 1.465-3.233 2.075c-1.099 0.61-2.198 1.098-3.296 1.465-1.098 0.366-2.115 0.549-3.051 0.549-1.343 0-2.441-0.438-3.296-1.311-0.854-0.876-1.281-2.41-1.281-4.608 0-0.366 0.020-0.773 0.060-1.221s0.062-0.895 0.062-1.343c0-0.773-0.183-1.353-0.55-1.738-0.366-0.387-0.793-0.58-1.281-0.58-0.652 0-1.21 0.295-1.678 0.886s-0.926 1.23-1.373 1.921c-0.447 0.693-0.905 1.334-1.372 1.923s-1.028 0.886-1.679 0.886c-0.529 0-1.048-0.427-1.556-1.282s-0.763-2.259-0.763-4.212c0-2.197 0.529-4.241 1.587-6.133s2.462-3.529 4.21-4.912c1.75-1.383 3.762-2.471 6.041-3.264 2.277-0.796 4.617-1.212 7.018-1.253zM7.334 15.817c0.569 0 1.047-0.204 1.434-0.611s0.579-0.875 0.579-1.404c0-0.569-0.193-1.047-0.579-1.434s-0.864-0.579-1.434-0.579c-0.529 0-0.987 0.193-1.373 0.579s-0.58 0.864-0.58 1.434c0 0.53 0.194 0.998 0.58 1.404 0.388 0.407 0.845 0.611 1.373 0.611zM12.216 11.79c0.691 0 1.292-0.254 1.8-0.763s0.762-1.107 0.762-1.8c0-0.732-0.255-1.343-0.762-1.831-0.509-0.489-1.109-0.732-1.8-0.732-0.732 0-1.342 0.244-1.831 0.732-0.488 0.488-0.732 1.098-0.732 1.831 0 0.693 0.244 1.292 0.732 1.8s1.099 0.763 1.831 0.763zM16.366 25.947c0.692 0 1.282-0.214 1.77-0.64s0.732-0.987 0.732-1.678-0.244-1.261-0.732-1.709c-0.489-0.448-1.078-0.671-1.77-0.671-0.65 0-1.21 0.223-1.678 0.671s-0.702 1.018-0.702 1.709c0 0.692 0.234 1.25 0.702 1.678s1.027 0.64 1.678 0.64zM19.113 9.592c0.651 0 1.129-0.203 1.433-0.611 0.305-0.406 0.459-0.874 0.459-1.404 0-0.488-0.154-0.947-0.459-1.373-0.304-0.427-0.782-0.641-1.433-0.641-0.529 0-1.008 0.193-1.434 0.58s-0.64 0.865-0.64 1.434c0 0.571 0.213 1.049 0.64 1.434 0.427 0.389 0.905 0.581 1.434 0.581zM24.848 12.826c0.57 0 1.067-0.213 1.495-0.64 0.427-0.427 0.64-0.947 0.64-1.556 0-0.57-0.214-1.068-0.64-1.495-0.428-0.427-0.927-0.64-1.495-0.64-0.611 0-1.129 0.213-1.555 0.64-0.428 0.427-0.642 0.926-0.642 1.495 0 0.611 0.213 1.129 0.642 1.556s0.947 0.64 1.555 0.64z\"></path></svg>'},function(e,t){e.exports='<svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" viewBox=\"0 0 32 32\"><path d=\"M13.725 30l3.9-5.325-3.9-1.125v6.45zM0 17.5l11.050 3.35 13.6-11.55-10.55 12.425 11.8 3.65 6.1-23.375-32 15.5z\"></path></svg>'},function(e,t){e.exports='<svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" viewBox=\"0 0 32 32\"><path d=\"M27.090 0.131h-22.731c-2.354 0-4.262 1.839-4.262 4.109v16.401c0 2.269 1.908 4.109 4.262 4.109h4.262v-2.706h8.469l-8.853 8.135 1.579 1.451 7.487-6.88h9.787c2.353 0 4.262-1.84 4.262-4.109v-16.401c0-2.27-1.909-4.109-4.262-4.109v0zM28.511 19.304c0 1.512-1.272 2.738-2.841 2.738h-8.425l-0.076-0.070-0.076 0.070h-11.311c-1.569 0-2.841-1.226-2.841-2.738v-13.696c0-1.513 1.272-2.739 2.841-2.739h19.889c1.569 0 2.841-0.142 2.841 1.37v15.064z\"></path></svg>'},function(e,t){e.exports='<svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" viewBox=\"0 0 32 32\"><path d=\"M27.128 0.38h-22.553c-2.336 0-4.229 1.825-4.229 4.076v16.273c0 2.251 1.893 4.076 4.229 4.076h4.229v-2.685h8.403l-8.784 8.072 1.566 1.44 7.429-6.827h9.71c2.335 0 4.229-1.825 4.229-4.076v-16.273c0-2.252-1.894-4.076-4.229-4.076zM28.538 19.403c0 1.5-1.262 2.717-2.819 2.717h-8.36l-0.076-0.070-0.076 0.070h-11.223c-1.557 0-2.819-1.217-2.819-2.717v-13.589c0-1.501 1.262-2.718 2.819-2.718h19.734c1.557 0 2.819-0.141 2.819 1.359v14.947zM9.206 10.557c-1.222 0-2.215 0.911-2.215 2.036s0.992 2.035 2.215 2.035c1.224 0 2.216-0.911 2.216-2.035s-0.992-2.036-2.216-2.036zM22.496 10.557c-1.224 0-2.215 0.911-2.215 2.036s0.991 2.035 2.215 2.035c1.224 0 2.215-0.911 2.215-2.035s-0.991-2.036-2.215-2.036zM15.852 10.557c-1.224 0-2.215 0.911-2.215 2.036s0.991 2.035 2.215 2.035c1.222 0 2.215-0.911 2.215-2.035s-0.992-2.036-2.215-2.036z\"></path></svg>'},function(e,t){e.exports='<svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" viewBox=\"0 0 32 32\"><path d=\"M22 16l-10.105-10.6-1.895 1.987 8.211 8.613-8.211 8.612 1.895 1.988 8.211-8.613z\"></path></svg>'},function(e,t){e.exports='<svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" viewBox=\"0 0 32 28\"><path d=\"M28.633 17.104c0.035 0.21 0.026 0.463-0.026 0.76s-0.14 0.598-0.262 0.904c-0.122 0.306-0.271 0.581-0.445 0.825s-0.367 0.419-0.576 0.524c-0.209 0.105-0.393 0.157-0.55 0.157s-0.332-0.035-0.524-0.105c-0.175-0.052-0.393-0.1-0.655-0.144s-0.528-0.052-0.799-0.026c-0.271 0.026-0.541 0.083-0.812 0.17s-0.502 0.236-0.694 0.445c-0.419 0.437-0.664 0.934-0.734 1.493s0.009 1.092 0.236 1.598c0.175 0.349 0.148 0.699-0.079 1.048-0.105 0.14-0.271 0.284-0.498 0.432s-0.476 0.284-0.747 0.406-0.555 0.218-0.851 0.288c-0.297 0.070-0.559 0.105-0.786 0.105-0.157 0-0.306-0.061-0.445-0.183s-0.236-0.253-0.288-0.393h-0.026c-0.192-0.541-0.52-1.009-0.982-1.402s-1-0.589-1.611-0.589c-0.594 0-1.131 0.197-1.611 0.589s-0.816 0.851-1.009 1.375c-0.087 0.21-0.218 0.362-0.393 0.458s-0.367 0.144-0.576 0.144c-0.244 0-0.52-0.044-0.825-0.131s-0.611-0.197-0.917-0.327c-0.306-0.131-0.581-0.284-0.825-0.458s-0.428-0.349-0.55-0.524c-0.087-0.122-0.135-0.266-0.144-0.432s0.057-0.397 0.197-0.694c0.192-0.402 0.266-0.86 0.223-1.375s-0.266-0.991-0.668-1.428c-0.244-0.262-0.541-0.432-0.891-0.511s-0.681-0.109-0.995-0.092c-0.367 0.017-0.742 0.087-1.127 0.21-0.244 0.070-0.489 0.052-0.734-0.052-0.192-0.070-0.371-0.231-0.537-0.485s-0.314-0.533-0.445-0.838c-0.131-0.306-0.231-0.62-0.301-0.943s-0.087-0.59-0.052-0.799c0.052-0.384 0.227-0.629 0.524-0.734 0.524-0.21 0.995-0.555 1.415-1.035s0.629-1.017 0.629-1.611c0-0.611-0.21-1.144-0.629-1.598s-0.891-0.786-1.415-0.996c-0.157-0.052-0.288-0.179-0.393-0.38s-0.157-0.406-0.157-0.616c0-0.227 0.035-0.48 0.105-0.76s0.162-0.55 0.275-0.812 0.244-0.502 0.393-0.72c0.148-0.218 0.31-0.38 0.485-0.485 0.14-0.087 0.275-0.122 0.406-0.105s0.275 0.052 0.432 0.105c0.524 0.21 1.070 0.275 1.637 0.197s1.070-0.327 1.506-0.747c0.21-0.209 0.362-0.467 0.458-0.773s0.157-0.607 0.183-0.904c0.026-0.297 0.026-0.568 0-0.812s-0.048-0.419-0.065-0.524c-0.035-0.105-0.066-0.227-0.092-0.367s-0.013-0.262 0.039-0.367c0.105-0.244 0.293-0.458 0.563-0.642s0.563-0.336 0.878-0.458c0.314-0.122 0.62-0.214 0.917-0.275s0.533-0.092 0.707-0.092c0.227 0 0.406 0.074 0.537 0.223s0.223 0.301 0.275 0.458c0.192 0.471 0.507 0.886 0.943 1.244s0.952 0.537 1.546 0.537c0.611 0 1.153-0.17 1.624-0.511s0.803-0.773 0.996-1.297c0.070-0.14 0.179-0.284 0.327-0.432s0.301-0.223 0.458-0.223c0.244 0 0.511 0.035 0.799 0.105s0.572 0.166 0.851 0.288c0.279 0.122 0.537 0.279 0.773 0.472s0.423 0.402 0.563 0.629c0.087 0.14 0.113 0.293 0.079 0.458s-0.070 0.284-0.105 0.354c-0.227 0.506-0.297 1.039-0.21 1.598s0.341 1.048 0.76 1.467c0.419 0.419 0.934 0.651 1.546 0.694s1.179-0.057 1.703-0.301c0.14-0.087 0.31-0.122 0.511-0.105s0.371 0.096 0.511 0.236c0.262 0.244 0.493 0.616 0.694 1.113s0.336 1 0.406 1.506c0.035 0.297-0.013 0.528-0.144 0.694s-0.266 0.275-0.406 0.327c-0.542 0.192-1.004 0.528-1.388 1.009s-0.576 1.026-0.576 1.637c0 0.594 0.162 1.113 0.485 1.559s0.747 0.764 1.27 0.956c0.122 0.070 0.227 0.14 0.314 0.21 0.192 0.157 0.323 0.358 0.393 0.602v0zM16.451 19.462c0.786 0 1.528-0.149 2.227-0.445s1.305-0.707 1.821-1.231c0.515-0.524 0.921-1.131 1.218-1.821s0.445-1.428 0.445-2.214c0-0.786-0.148-1.524-0.445-2.214s-0.703-1.292-1.218-1.808c-0.515-0.515-1.122-0.921-1.821-1.218s-1.441-0.445-2.227-0.445c-0.786 0-1.524 0.148-2.214 0.445s-1.292 0.703-1.808 1.218c-0.515 0.515-0.921 1.118-1.218 1.808s-0.445 1.428-0.445 2.214c0 0.786 0.149 1.524 0.445 2.214s0.703 1.297 1.218 1.821c0.515 0.524 1.118 0.934 1.808 1.231s1.428 0.445 2.214 0.445v0z\"></path></svg>'},function(e,t){e.exports='<svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" viewBox=\"0 0 32 33\"><path d=\"M24.965 24.38h-18.132c-1.366 0-2.478-1.113-2.478-2.478v-11.806c0-1.364 1.111-2.478 2.478-2.478h18.132c1.366 0 2.478 1.113 2.478 2.478v11.806c0 1.364-1.11 2.478-2.478 2.478zM6.833 10.097v11.806h18.134l-0.002-11.806h-18.132zM2.478 28.928h5.952c0.684 0 1.238-0.554 1.238-1.239 0-0.684-0.554-1.238-1.238-1.238h-5.952v-5.802c0-0.684-0.554-1.239-1.238-1.239s-1.239 0.556-1.239 1.239v5.802c0 1.365 1.111 2.478 2.478 2.478zM30.761 19.412c-0.684 0-1.238 0.554-1.238 1.238v5.801h-5.951c-0.686 0-1.239 0.554-1.239 1.238 0 0.686 0.554 1.239 1.239 1.239h5.951c1.366 0 2.478-1.111 2.478-2.478v-5.801c0-0.683-0.554-1.238-1.239-1.238zM0 5.55v5.802c0 0.683 0.554 1.238 1.238 1.238s1.238-0.555 1.238-1.238v-5.802h5.952c0.684 0 1.238-0.554 1.238-1.238s-0.554-1.238-1.238-1.238h-5.951c-1.366-0.001-2.478 1.111-2.478 2.476zM32 11.35v-5.801c0-1.365-1.11-2.478-2.478-2.478h-5.951c-0.686 0-1.239 0.554-1.239 1.238s0.554 1.238 1.239 1.238h5.951v5.801c0 0.683 0.554 1.237 1.238 1.237 0.686 0.002 1.239-0.553 1.239-1.236z\"></path></svg>'},function(e,t){e.exports='<svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" viewBox=\"0 0 32 33\"><path d=\"M6.667 28h-5.333c-0.8 0-1.333-0.533-1.333-1.333v-5.333c0-0.8 0.533-1.333 1.333-1.333s1.333 0.533 1.333 1.333v4h4c0.8 0 1.333 0.533 1.333 1.333s-0.533 1.333-1.333 1.333zM30.667 28h-5.333c-0.8 0-1.333-0.533-1.333-1.333s0.533-1.333 1.333-1.333h4v-4c0-0.8 0.533-1.333 1.333-1.333s1.333 0.533 1.333 1.333v5.333c0 0.8-0.533 1.333-1.333 1.333zM30.667 12c-0.8 0-1.333-0.533-1.333-1.333v-4h-4c-0.8 0-1.333-0.533-1.333-1.333s0.533-1.333 1.333-1.333h5.333c0.8 0 1.333 0.533 1.333 1.333v5.333c0 0.8-0.533 1.333-1.333 1.333zM1.333 12c-0.8 0-1.333-0.533-1.333-1.333v-5.333c0-0.8 0.533-1.333 1.333-1.333h5.333c0.8 0 1.333 0.533 1.333 1.333s-0.533 1.333-1.333 1.333h-4v4c0 0.8-0.533 1.333-1.333 1.333z\"></path></svg>'},function(e,t){e.exports='<svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" viewBox=\"0 0 21 32\"><path d=\"M13.728 6.272v19.456q0 0.448-0.352 0.8t-0.8 0.32-0.8-0.32l-5.952-5.952h-4.672q-0.48 0-0.8-0.352t-0.352-0.8v-6.848q0-0.48 0.352-0.8t0.8-0.352h4.672l5.952-5.952q0.32-0.32 0.8-0.32t0.8 0.32 0.352 0.8z\"></path></svg>'},function(e,t){e.exports='<svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" viewBox=\"0 0 21 32\"><path d=\"M13.728 6.272v19.456q0 0.448-0.352 0.8t-0.8 0.32-0.8-0.32l-5.952-5.952h-4.672q-0.48 0-0.8-0.352t-0.352-0.8v-6.848q0-0.48 0.352-0.8t0.8-0.352h4.672l5.952-5.952q0.32-0.32 0.8-0.32t0.8 0.32 0.352 0.8zM20.576 16q0 1.344-0.768 2.528t-2.016 1.664q-0.16 0.096-0.448 0.096-0.448 0-0.8-0.32t-0.32-0.832q0-0.384 0.192-0.64t0.544-0.448 0.608-0.384 0.512-0.64 0.192-1.024-0.192-1.024-0.512-0.64-0.608-0.384-0.544-0.448-0.192-0.64q0-0.48 0.32-0.832t0.8-0.32q0.288 0 0.448 0.096 1.248 0.48 2.016 1.664t0.768 2.528z\"></path></svg>'},function(e,t){e.exports='<svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" viewBox=\"0 0 21 32\"><path d=\"M13.728 6.272v19.456q0 0.448-0.352 0.8t-0.8 0.32-0.8-0.32l-5.952-5.952h-4.672q-0.48 0-0.8-0.352t-0.352-0.8v-6.848q0-0.48 0.352-0.8t0.8-0.352h4.672l5.952-5.952q0.32-0.32 0.8-0.32t0.8 0.32 0.352 0.8zM20.576 16q0 1.344-0.768 2.528t-2.016 1.664q-0.16 0.096-0.448 0.096-0.448 0-0.8-0.32t-0.32-0.832q0-0.384 0.192-0.64t0.544-0.448 0.608-0.384 0.512-0.64 0.192-1.024-0.192-1.024-0.512-0.64-0.608-0.384-0.544-0.448-0.192-0.64q0-0.48 0.32-0.832t0.8-0.32q0.288 0 0.448 0.096 1.248 0.48 2.016 1.664t0.768 2.528zM25.152 16q0 2.72-1.536 5.056t-4 3.36q-0.256 0.096-0.448 0.096-0.48 0-0.832-0.352t-0.32-0.8q0-0.704 0.672-1.056 1.024-0.512 1.376-0.8 1.312-0.96 2.048-2.4t0.736-3.104-0.736-3.104-2.048-2.4q-0.352-0.288-1.376-0.8-0.672-0.352-0.672-1.056 0-0.448 0.32-0.8t0.8-0.352q0.224 0 0.48 0.096 2.496 1.056 4 3.36t1.536 5.056z\"></path></svg>'},function(e,t){e.exports='<svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" viewBox=\"0 0 17 32\"><path d=\"M14.080 4.8q2.88 0 2.88 2.048v18.24q0 2.112-2.88 2.112t-2.88-2.112v-18.24q0-2.048 2.88-2.048zM2.88 4.8q2.88 0 2.88 2.048v18.24q0 2.112-2.88 2.112t-2.88-2.112v-18.24q0-2.048 2.88-2.048z\"></path></svg>'},function(e,t){e.exports='<svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" viewBox=\"0 0 16 32\"><path d=\"M15.552 15.168q0.448 0.32 0.448 0.832 0 0.448-0.448 0.768l-13.696 8.512q-0.768 0.512-1.312 0.192t-0.544-1.28v-16.448q0-0.96 0.544-1.28t1.312 0.192z\"></path></svg>'},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=o(r(2)),i=o(r(30));function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e){return e&&e.__esModule?e:{default:e}}var s=(function(e,t,r){t&&a(e.prototype,t),r&&a(e,r)}(l,[{key:\"init\",value:function(){this.container.innerHTML=(0,i.default)({options:this.options,index:this.index,tran:this.tran,icons:n.default,video:{current:!0,pic:this.options.video.pic,screenshot:this.options.screenshot,preload:this.options.preload,url:this.options.video.url,subtitle:this.options.subtitle}}),this.volumeBar=this.container.querySelector(\".dplayer-volume-bar-inner\"),this.volumeBarWrap=this.container.querySelector(\".dplayer-volume-bar\"),this.volumeBarWrapWrap=this.container.querySelector(\".dplayer-volume-bar-wrap\"),this.volumeButton=this.container.querySelector(\".dplayer-volume\"),this.volumeButtonIcon=this.container.querySelector(\".dplayer-volume-icon\"),this.volumeIcon=this.container.querySelector(\".dplayer-volume-icon .dplayer-icon-content\"),this.playedBar=this.container.querySelector(\".dplayer-played\"),this.loadedBar=this.container.querySelector(\".dplayer-loaded\"),this.playedBarWrap=this.container.querySelector(\".dplayer-bar-wrap\"),this.playedBarTime=this.container.querySelector(\".dplayer-bar-time\"),this.danmaku=this.container.querySelector(\".dplayer-danmaku\"),this.danmakuLoading=this.container.querySelector(\".dplayer-danloading\"),this.video=this.container.querySelector(\".dplayer-video-current\"),this.bezel=this.container.querySelector(\".dplayer-bezel-icon\"),this.playButton=this.container.querySelector(\".dplayer-play-icon\"),this.videoWrap=this.container.querySelector(\".dplayer-video-wrap\"),this.controllerMask=this.container.querySelector(\".dplayer-controller-mask\"),this.ptime=this.container.querySelector(\".dplayer-ptime\"),this.settingButton=this.container.querySelector(\".dplayer-setting-icon\"),this.settingBox=this.container.querySelector(\".dplayer-setting-box\"),this.mask=this.container.querySelector(\".dplayer-mask\"),this.loop=this.container.querySelector(\".dplayer-setting-loop\"),this.loopToggle=this.container.querySelector(\".dplayer-setting-loop .dplayer-toggle-setting-input\"),this.showDanmaku=this.container.querySelector(\".dplayer-setting-showdan\"),this.showDanmakuToggle=this.container.querySelector(\".dplayer-showdan-setting-input\"),this.unlimitDanmaku=this.container.querySelector(\".dplayer-setting-danunlimit\"),this.unlimitDanmakuToggle=this.container.querySelector(\".dplayer-danunlimit-setting-input\"),this.speed=this.container.querySelector(\".dplayer-setting-speed\"),this.speedItem=this.container.querySelectorAll(\".dplayer-setting-speed-item\"),this.danmakuOpacityBar=this.container.querySelector(\".dplayer-danmaku-bar-inner\"),this.danmakuOpacityBarWrap=this.container.querySelector(\".dplayer-danmaku-bar\"),this.danmakuOpacityBarWrapWrap=this.container.querySelector(\".dplayer-danmaku-bar-wrap\"),this.danmakuOpacityBox=this.container.querySelector(\".dplayer-setting-danmaku\"),this.dtime=this.container.querySelector(\".dplayer-dtime\"),this.controller=this.container.querySelector(\".dplayer-controller\"),this.commentInput=this.container.querySelector(\".dplayer-comment-input\"),this.commentButton=this.container.querySelector(\".dplayer-comment-icon\"),this.commentSettingBox=this.container.querySelector(\".dplayer-comment-setting-box\"),this.commentSettingButton=this.container.querySelector(\".dplayer-comment-setting-icon\"),this.commentSettingFill=this.container.querySelector(\".dplayer-comment-setting-icon path\"),this.commentSendButton=this.container.querySelector(\".dplayer-send-icon\"),this.commentSendFill=this.container.querySelector(\".dplayer-send-icon path\"),this.commentColorSettingBox=this.container.querySelector(\".dplayer-comment-setting-color\"),this.browserFullButton=this.container.querySelector(\".dplayer-full-icon\"),this.webFullButton=this.container.querySelector(\".dplayer-full-in-icon\"),this.menu=this.container.querySelector(\".dplayer-menu\"),this.menuItem=this.container.querySelectorAll(\".dplayer-menu-item\"),this.qualityList=this.container.querySelector(\".dplayer-quality-list\"),this.camareButton=this.container.querySelector(\".dplayer-camera-icon\"),this.subtitleButton=this.container.querySelector(\".dplayer-subtitle-icon\"),this.subtitleButtonInner=this.container.querySelector(\".dplayer-subtitle-icon .dplayer-icon-content\"),this.subtitle=this.container.querySelector(\".dplayer-subtitle\"),this.qualityButton=this.container.querySelector(\".dplayer-quality-icon\"),this.barPreview=this.container.querySelector(\".dplayer-bar-preview\"),this.barWrap=this.container.querySelector(\".dplayer-bar-wrap\"),this.notice=this.container.querySelector(\".dplayer-notice\"),this.infoPanel=this.container.querySelector(\".dplayer-info-panel\"),this.infoPanelClose=this.container.querySelector(\".dplayer-info-panel-close\"),this.infoVersion=this.container.querySelector(\".dplayer-info-panel-item-version .dplayer-info-panel-item-data\"),this.infoFPS=this.container.querySelector(\".dplayer-info-panel-item-fps .dplayer-info-panel-item-data\"),this.infoType=this.container.querySelector(\".dplayer-info-panel-item-type .dplayer-info-panel-item-data\"),this.infoUrl=this.container.querySelector(\".dplayer-info-panel-item-url .dplayer-info-panel-item-data\"),this.infoResolution=this.container.querySelector(\".dplayer-info-panel-item-resolution .dplayer-info-panel-item-data\"),this.infoDuration=this.container.querySelector(\".dplayer-info-panel-item-duration .dplayer-info-panel-item-data\"),this.infoDanmakuId=this.container.querySelector(\".dplayer-info-panel-item-danmaku-id .dplayer-info-panel-item-data\"),this.infoDanmakuApi=this.container.querySelector(\".dplayer-info-panel-item-danmaku-api .dplayer-info-panel-item-data\"),this.infoDanmakuAmount=this.container.querySelector(\".dplayer-info-panel-item-danmaku-amount .dplayer-info-panel-item-data\")}}]),l);function l(e){!function(e){if(!(e instanceof l))throw new TypeError(\"Cannot call a class as a function\")}(this),this.container=e.container,this.options=e.options,this.index=e.index,this.tran=e.tran,this.init()}t.default=s},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n={\"zh-cn\":{\"Danmaku is loading\":\"弹幕加载中\",Top:\"顶部\",Bottom:\"底部\",Rolling:\"滚动\",\"Input danmaku, hit Enter\":\"输入弹幕，回车发送\",\"About author\":\"关于作者\",\"DPlayer feedback\":\"播放器意见反馈\",\"About DPlayer\":\"关于 DPlayer 播放器\",Loop:\"洗脑循环\",Speed:\"速度\",\"Opacity for danmaku\":\"弹幕透明度\",Normal:\"正常\",\"Please input danmaku content!\":\"要输入弹幕内容啊喂！\",\"Set danmaku color\":\"设置弹幕颜色\",\"Set danmaku type\":\"设置弹幕类型\",\"Show danmaku\":\"显示弹幕\",\"Video load failed\":\"视频加载失败\",\"Danmaku load failed\":\"弹幕加载失败\",\"Danmaku send failed\":\"弹幕发送失败\",\"Switching to\":\"正在切换至\",\"Switched to\":\"已经切换至\",quality:\"画质\",FF:\"快进\",REW:\"快退\",\"Unlimited danmaku\":\"海量弹幕\",\"Send danmaku\":\"发送弹幕\",Setting:\"设置\",\"Full screen\":\"全屏\",\"Web full screen\":\"页面全屏\",Send:\"发送\",Screenshot:\"截图\",s:\"秒\",\"Show subtitle\":\"显示字幕\",\"Hide subtitle\":\"隐藏字幕\",Volume:\"音量\",Live:\"直播\",\"Video info\":\"视频统计信息\"},\"zh-tw\":{\"Danmaku is loading\":\"彈幕載入中\",Top:\"頂部\",Bottom:\"底部\",Rolling:\"滾動\",\"Input danmaku, hit Enter\":\"輸入彈幕，Enter 發送\",\"About author\":\"關於作者\",\"DPlayer feedback\":\"播放器意見回饋\",\"About DPlayer\":\"關於 DPlayer 播放器\",Loop:\"循環播放\",Speed:\"速度\",\"Opacity for danmaku\":\"彈幕透明度\",Normal:\"正常\",\"Please input danmaku content!\":\"請輸入彈幕內容啊！\",\"Set danmaku color\":\"設定彈幕顏色\",\"Set danmaku type\":\"設定彈幕類型\",\"Show danmaku\":\"顯示彈幕\",\"Video load failed\":\"影片載入失敗\",\"Danmaku load failed\":\"彈幕載入失敗\",\"Danmaku send failed\":\"彈幕發送失敗\",\"Switching to\":\"正在切換至\",\"Switched to\":\"已經切換至\",quality:\"畫質\",FF:\"快進\",REW:\"快退\",\"Unlimited danmaku\":\"巨量彈幕\",\"Send danmaku\":\"發送彈幕\",Setting:\"設定\",\"Full screen\":\"全螢幕\",\"Web full screen\":\"頁面全螢幕\",Send:\"發送\",Screenshot:\"截圖\",s:\"秒\",\"Show subtitle\":\"顯示字幕\",\"Hide subtitle\":\"隱藏字幕\",Volume:\"音量\",Live:\"直播\",\"Video info\":\"影片統計訊息\"}};t.default=function(e){var t=this;this.lang=e,this.tran=function(e){return n[t.lang]&&n[t.lang][e]?n[t.lang][e]:e}}},function(e,t,r){\"use strict\";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,r){\"use strict\";var n=r(7);function i(e){if(\"function\"!=typeof e)throw new TypeError(\"executor must be a function.\");var t;this.promise=new Promise((function(e){t=e}));var r=this;e((function(e){r.reason||(r.reason=new n(e),t(r.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.source=function(){var e;return{token:new i((function(t){e=t})),cancel:e}},e.exports=i},function(e,t,r){\"use strict\";e.exports=function(e,t){return t?e.replace(/\\/+$/,\"\")+\"/\"+t.replace(/^\\/+/,\"\"):e}},function(e,t,r){\"use strict\";e.exports=function(e){return/^([a-z][a-z\\d\\+\\-\\.]*:)?\\/\\//i.test(e)}},function(e,t,r){\"use strict\";var n=r(0);e.exports=function(e,t,r){return n.forEach(r,(function(r){e=r(e,t)})),e}},function(e,t,r){\"use strict\";var n=r(0),i=r(53),a=r(8),o=r(3),s=r(52),l=r(51);function d(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return d(e),e.baseURL&&!s(e.url)&&(e.url=l(e.baseURL,e.url)),e.headers=e.headers||{},e.data=i(e.data,e.headers,e.transformRequest),e.headers=n.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),n.forEach([\"delete\",\"get\",\"head\",\"post\",\"put\",\"patch\",\"common\"],(function(t){delete e.headers[t]})),(e.adapter||o.adapter)(e).then((function(t){return d(e),t.data=i(t.data,t.headers,e.transformResponse),t}),(function(t){return a(t)||(d(e),t&&t.response&&(t.response.data=i(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},function(e,t,r){\"use strict\";var n=r(0);function i(){this.handlers=[]}i.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},i.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},i.prototype.forEach=function(e){n.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=i},function(e,t,r){\"use strict\";var n=r(0);e.exports=n.isStandardBrowserEnv()?{write:function(e,t,r,i,a,o){var s=[];s.push(e+\"=\"+encodeURIComponent(t)),n.isNumber(r)&&s.push(\"expires=\"+new Date(r).toGMTString()),n.isString(i)&&s.push(\"path=\"+i),n.isString(a)&&s.push(\"domain=\"+a),!0===o&&s.push(\"secure\"),document.cookie=s.join(\"; \")},read:function(e){var t=document.cookie.match(new RegExp(\"(^|;\\\\s*)(\"+e+\")=([^;]*)\"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,\"\",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,r){\"use strict\";function n(){this.message=\"String contains an invalid character\"}(n.prototype=new Error).code=5,n.prototype.name=\"InvalidCharacterError\",e.exports=function(e){for(var t,r,i=String(e),a=\"\",o=0,s=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";i.charAt(0|o)||(s=\"=\",o%1);a+=s.charAt(63&t>>8-o%1*8)){if(255<(r=i.charCodeAt(o+=.75)))throw new n;t=t<<8|r}return a}},function(e,t,r){\"use strict\";var n,i,a,o=r(0);function s(e){var t=e;return i&&(a.setAttribute(\"href\",t),t=a.href),a.setAttribute(\"href\",t),{href:a.href,protocol:a.protocol?a.protocol.replace(/:$/,\"\"):\"\",host:a.host,search:a.search?a.search.replace(/^\\?/,\"\"):\"\",hash:a.hash?a.hash.replace(/^#/,\"\"):\"\",hostname:a.hostname,port:a.port,pathname:\"/\"===a.pathname.charAt(0)?a.pathname:\"/\"+a.pathname}}e.exports=o.isStandardBrowserEnv()?(i=/(msie|trident)/i.test(navigator.userAgent),a=document.createElement(\"a\"),n=s(window.location.href),function(e){var t=o.isString(e)?s(e):e;return t.protocol===n.protocol&&t.host===n.host}):function(){return!0}},function(e,t,r){\"use strict\";var n=r(0),i=[\"age\",\"authorization\",\"content-length\",\"content-type\",\"etag\",\"expires\",\"from\",\"host\",\"if-modified-since\",\"if-unmodified-since\",\"last-modified\",\"location\",\"max-forwards\",\"proxy-authorization\",\"referer\",\"retry-after\",\"user-agent\"];e.exports=function(e){var t,r,a,o={};return e&&n.forEach(e.split(\"\\n\"),(function(e){if(a=e.indexOf(\":\"),t=n.trim(e.substr(0,a)).toLowerCase(),r=n.trim(e.substr(a+1)),t){if(o[t]&&0<=i.indexOf(t))return;o[t]=\"set-cookie\"===t?(o[t]?o[t]:[]).concat([r]):o[t]?o[t]+\", \"+r:r}})),o}},function(e,t,r){\"use strict\";var n=r(0);function i(e){return encodeURIComponent(e).replace(/%40/gi,\"@\").replace(/%3A/gi,\":\").replace(/%24/g,\"$\").replace(/%2C/gi,\",\").replace(/%20/g,\"+\").replace(/%5B/gi,\"[\").replace(/%5D/gi,\"]\")}e.exports=function(e,t,r){if(!t)return e;var a,o=r?r(t):n.isURLSearchParams(t)?t.toString():(a=[],n.forEach(t,(function(e,t){null!=e&&(n.isArray(e)?t+=\"[]\":e=[e],n.forEach(e,(function(e){n.isDate(e)?e=e.toISOString():n.isObject(e)&&(e=JSON.stringify(e)),a.push(i(t)+\"=\"+i(e))})))})),a.join(\"&\"));return o&&(e+=(-1===e.indexOf(\"?\")?\"?\":\"&\")+o),e}},function(e,t,r){\"use strict\";e.exports=function(e,t,r,n,i){return e.config=t,r&&(e.code=r),e.request=n,e.response=i,e}},function(e,t,r){\"use strict\";var n=r(9);e.exports=function(e,t,r){var i=r.config.validateStatus;r.status&&i&&!i(r.status)?t(n(\"Request failed with status code \"+r.status,r.config,null,r.request,r)):e(r)}},function(e,t,r){\"use strict\";var n=r(0);e.exports=function(e,t){n.forEach(e,(function(r,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[n])}))}},function(e,t,r){\"use strict\";var n=r(3),i=r(0),a=r(55),o=r(54);function s(e){this.defaults=e,this.interceptors={request:new a,response:new a}}s.prototype.request=function(e){\"string\"==typeof e&&(e=i.merge({url:arguments[0]},arguments[1])),(e=i.merge(n,{method:\"get\"},this.defaults,e)).method=e.method.toLowerCase();var t=[o,void 0],r=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)r=r.then(t.shift(),t.shift());return r},i.forEach([\"delete\",\"get\",\"head\",\"options\"],(function(e){s.prototype[e]=function(t,r){return this.request(i.merge(r||{},{method:e,url:t}))}})),i.forEach([\"post\",\"put\",\"patch\"],(function(e){s.prototype[e]=function(t,r,n){return this.request(i.merge(n||{},{method:e,url:t,data:r}))}})),e.exports=s},function(e,t,r){\"use strict\";function n(e){return!!e.constructor&&\"function\"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}e.exports=function(e){return null!=e&&(n(e)||\"function\"==typeof e.readFloatLE&&\"function\"==typeof e.slice&&n(e.slice(0,0))||!!e._isBuffer)}},function(e,t,r){\"use strict\";var n=r(0),i=r(11),a=r(64),o=r(3);function s(e){var t=new a(e),r=i(a.prototype.request,t);return n.extend(r,a.prototype,t),n.extend(r,t),r}var l=s(o);l.Axios=a,l.create=function(e){return s(n.merge(o,e))},l.Cancel=r(7),l.CancelToken=r(50),l.isCancel=r(8),l.all=function(e){return Promise.all(e)},l.spread=r(49),e.exports=l,e.exports.default=l},function(e,t,r){\"use strict\";e.exports=r(66)},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=r(67),i=n&&n.__esModule?n:{default:n};t.default={send:function(e){i.default.post(e.url,e.data).then((function(t){var r=t.data;r&&0===r.code?e.success&&e.success(r):e.error&&e.error(r&&r.msg)})).catch((function(t){console.error(t),e.error&&e.error()}))},read:function(e){i.default.get(e.url).then((function(t){var r=t.data;r&&0===r.code?e.success&&e.success(r.data.map((function(e){return{time:e[0],type:e[1],color:e[2],author:e[3],text:e[4]}}))):e.error&&e.error(r&&r.msg)})).catch((function(t){console.error(t),e.error&&e.error()}))}}},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e},i=r(68),a=i&&i.__esModule?i:{default:i};t.default=function(e){var t={container:e.element||document.getElementsByClassName(\"dplayer\")[0],live:!1,autoplay:!1,theme:\"#b7daff\",loop:!1,lang:(navigator.language||navigator.browserLanguage).toLowerCase(),screenshot:!1,hotkey:!0,preload:\"metadata\",volume:.7,apiBackend:a.default,video:{},contextmenu:[],mutex:!0};for(var r in t)t.hasOwnProperty(r)&&!e.hasOwnProperty(r)&&(e[r]=t[r]);return e.video&&!e.video.type&&(e.video.type=\"auto\"),\"object\"===n(e.danmaku)&&e.danmaku&&!e.danmaku.user&&(e.danmaku.user=\"DIYgod\"),e.subtitle&&(e.subtitle.type||(e.subtitle.type=\"webvtt\"),e.subtitle.fontSize||(e.subtitle.fontSize=\"20px\"),e.subtitle.bottom||(e.subtitle.bottom=\"40px\"),e.subtitle.color||(e.subtitle.color=\"#fff\")),e.video.quality&&(e.video.url=e.video.quality[e.video.defaultQuality].url),e.lang&&(e.lang=e.lang.toLowerCase()),e.contextmenu=e.contextmenu.concat([{text:\"Video info\",click:function(e){e.infoPanel.triggle()}},{text:\"About author\",link:\"https://diygod.me\"},{text:\"DPlayer v1.25.0\",link:\"https://github.com/MoePlayer/DPlayer\"}]),e}},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.default=function(e){var t=this.constructor;return this.then((function(r){return t.resolve(e()).then((function(){return r}))}),(function(r){return t.resolve(e()).then((function(){return t.reject(r)}))}))}},function(e,t,r){\"use strict\";(function(e,t){function r(e){delete u[e]}function n(e){if(c)setTimeout(n,0,e);else{var t=u[e];if(t){c=!0;try{!function(){var e=t.callback,r=t.args;switch(r.length){case 0:e();break;case 1:e(r[0]);break;case 2:e(r[0],r[1]);break;case 3:e(r[0],r[1],r[2]);break;default:e.apply(void 0,r)}}()}finally{r(e),c=!1}}}}var i,a,o,s,l,d,u,c,h,f,p;(i=\"undefined\"==typeof self?void 0===e?void 0:e:self).setImmediate||(d=1,c=!(u={}),h=i.document,f=(f=Object.getPrototypeOf&&Object.getPrototypeOf(i))&&f.setTimeout?f:i,p=\"[object process]\"==={}.toString.call(i.process)?function(e){t.nextTick((function(){n(e)}))}:function(){if(i.postMessage&&!i.importScripts){var e=!0,t=i.onmessage;return i.onmessage=function(){e=!1},i.postMessage(\"\",\"*\"),i.onmessage=t,e}}()?(s=\"setImmediate$\"+Math.random()+\"$\",l=function(e){e.source===i&&\"string\"==typeof e.data&&0===e.data.indexOf(s)&&n(+e.data.slice(s.length))},i.addEventListener?i.addEventListener(\"message\",l,!1):i.attachEvent(\"onmessage\",l),function(e){i.postMessage(s+e,\"*\")}):i.MessageChannel?((o=new MessageChannel).port1.onmessage=function(e){n(e.data)},function(e){o.port2.postMessage(e)}):h&&\"onreadystatechange\"in h.createElement(\"script\")?(a=h.documentElement,function(e){var t=h.createElement(\"script\");t.onreadystatechange=function(){n(e),t.onreadystatechange=null,a.removeChild(t),t=null},a.appendChild(t)}):function(e){setTimeout(n,0,e)},f.setImmediate=function(e){\"function\"!=typeof e&&(e=new Function(\"\"+e));for(var t=new Array(arguments.length-1),r=0;r<t.length;r++)t[r]=arguments[r+1];var n={callback:e,args:t};return u[d]=n,p(d),d++},f.clearImmediate=r)}).call(this,r(4),r(12))},function(e,n,i){\"use strict\";var a=Function.prototype.apply;function o(e,t){this._id=e,this._clearFn=t}n.setTimeout=function(){return new o(a.call(setTimeout,window,arguments),clearTimeout)},n.setInterval=function(){return new o(a.call(setInterval,window,arguments),clearInterval)},n.clearTimeout=n.clearInterval=function(e){e&&e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(window,this._id)},n.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},n.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},n._unrefActive=n.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;0<=t&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},i(71),n.setImmediate=t,n.clearImmediate=r},function(e,t,r){\"use strict\";(function(e){Object.defineProperty(t,\"__esModule\",{value:!0});var n=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e},i=r(70),a=i&&i.__esModule?i:{default:i},o=setTimeout;function s(){}function l(e){if(!(this instanceof l))throw new TypeError(\"Promises must be constructed via new\");if(\"function\"!=typeof e)throw new TypeError(\"not a function\");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],f(e,this)}function d(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,l._immediateFn((function(){var r,n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){try{r=n(e._value)}catch(r){return void c(t.promise,r)}u(t.promise,r)}else(1===e._state?u:c)(t.promise,e._value)}))):e._deferreds.push(t)}function u(e,t){try{if(t===e)throw new TypeError(\"A promise cannot be resolved with itself.\");if(t&&(\"object\"===(void 0===t?\"undefined\":n(t))||\"function\"==typeof t)){var r=t.then;if(t instanceof l)return e._state=3,e._value=t,void h(e);if(\"function\"==typeof r)return void f((i=r,a=t,function(){i.apply(a,arguments)}),e)}e._state=1,e._value=t,h(e)}catch(t){c(e,t)}var i,a}function c(e,t){e._state=2,e._value=t,h(e)}function h(e){2===e._state&&0===e._deferreds.length&&l._immediateFn((function(){e._handled||l._unhandledRejectionFn(e._value)}));for(var t=0,r=e._deferreds.length;t<r;t++)d(e,e._deferreds[t]);e._deferreds=null}function f(e,t){var r=!1;try{e((function(e){r||(r=!0,u(t,e))}),(function(e){r||(r=!0,c(t,e))}))}catch(e){if(r)return;r=!0,c(t,e)}}l.prototype.catch=function(e){return this.then(null,e)},l.prototype.then=function(e,t){var r=new this.constructor(s);return d(this,new function(t,r,n){this.onFulfilled=\"function\"==typeof e?e:null,this.onRejected=\"function\"==typeof r?r:null,this.promise=n}(0,t,r)),r},l.prototype.finally=a.default,l.all=function(e){return new l((function(t,r){if(!e||void 0===e.length)throw new TypeError(\"Promise.all accepts an array\");var i=Array.prototype.slice.call(e);if(0===i.length)return t([]);for(var a=i.length,o=0;o<i.length;o++)!function e(o,s){try{if(s&&(\"object\"===(void 0===s?\"undefined\":n(s))||\"function\"==typeof s)){var l=s.then;if(\"function\"==typeof l)return l.call(s,(function(t){e(o,t)}),r),0}i[o]=s,0==--a&&t(i)}catch(o){r(o)}}(o,i[o])}))},l.resolve=function(e){return e&&\"object\"===(void 0===e?\"undefined\":n(e))&&e.constructor===l?e:new l((function(t){t(e)}))},l.reject=function(e){return new l((function(t,r){r(e)}))},l.race=function(e){return new l((function(t,r){for(var n=0,i=e.length;n<i;n++)e[n].then(t,r)}))},l._immediateFn=\"function\"==typeof e?function(t){e(t)}:function(e){o(e,0)},l._unhandledRejectionFn=function(e){\"undefined\"!=typeof console&&console&&console.warn(\"Possible Unhandled Promise Rejection:\",e)},t.default=l}).call(this,r(72).setImmediate)},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=T(r(73)),i=T(r(1)),a=T(r(69)),o=T(r(48)),s=T(r(47)),l=T(r(2)),d=T(r(27)),u=T(r(26)),c=T(r(25)),h=T(r(24)),f=T(r(23)),p=T(r(22)),m=T(r(21)),g=T(r(20)),y=T(r(19)),v=T(r(17)),_=T(r(16)),b=T(r(15)),E=T(r(14)),k=T(r(13)),w=T(r(5));function S(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function T(e){return e&&e.__esModule?e:{default:e}}var x=0,L=[],A=(function(e,t,r){t&&S(e.prototype,t),r&&S(e,r)}(R,[{key:\"seek\",value:function(e){e=Math.max(e,0),this.video.duration&&(e=Math.min(e,this.video.duration)),this.video.currentTime<e?this.notice(this.tran(\"FF\")+\" \"+(e-this.video.currentTime).toFixed(0)+\" \"+this.tran(\"s\")):this.video.currentTime>e&&this.notice(this.tran(\"REW\")+\" \"+(this.video.currentTime-e).toFixed(0)+\" \"+this.tran(\"s\")),this.video.currentTime=e,this.danmaku&&this.danmaku.seek(),this.bar.set(\"played\",e/this.video.duration,\"width\"),this.template.ptime.innerHTML=i.default.secondToTime(e)}},{key:\"play\",value:function(){var e=this;if(this.paused=!1,this.video.paused&&this.bezel.switch(l.default.play),this.template.playButton.innerHTML=l.default.pause,n.default.resolve(this.video.play()).catch((function(){e.pause()})).then((function(){})),this.timer.enable(\"loading\"),this.container.classList.remove(\"dplayer-paused\"),this.container.classList.add(\"dplayer-playing\"),this.danmaku&&this.danmaku.play(),this.options.mutex)for(var t=0;t<L.length;t++)this!==L[t]&&L[t].pause()}},{key:\"pause\",value:function(){this.paused=!0,this.container.classList.remove(\"dplayer-loading\"),this.video.paused||this.bezel.switch(l.default.pause),this.template.playButton.innerHTML=l.default.play,this.video.pause(),this.timer.disable(\"loading\"),this.container.classList.remove(\"dplayer-playing\"),this.container.classList.add(\"dplayer-paused\"),this.danmaku&&this.danmaku.pause()}},{key:\"switchVolumeIcon\",value:function(){.95<=this.volume()?this.template.volumeIcon.innerHTML=l.default.volumeUp:0<this.volume()?this.template.volumeIcon.innerHTML=l.default.volumeDown:this.template.volumeIcon.innerHTML=l.default.volumeOff}},{key:\"volume\",value:function(e,t,r){var n;return e=parseFloat(e),isNaN(e)||(e=Math.max(e,0),e=Math.min(e,1),this.bar.set(\"volume\",e,\"width\"),n=(100*e).toFixed(0)+\"%\",this.template.volumeBarWrapWrap.dataset.balloon=n,t||this.user.set(\"volume\",e),r||this.notice(this.tran(\"Volume\")+\" \"+(100*e).toFixed(0)+\"%\"),this.video.volume=e,this.video.muted&&(this.video.muted=!1),this.switchVolumeIcon()),this.video.volume}},{key:\"toggle\",value:function(){this.video.paused?this.play():this.pause()}},{key:\"on\",value:function(e,t){this.events.on(e,t)}},{key:\"switchVideo\",value:function(e,t){this.pause(),this.video.poster=e.pic?e.pic:\"\",this.video.src=e.url,this.initMSE(this.video,e.type||\"auto\"),t&&(this.template.danmakuLoading.style.display=\"block\",this.bar.set(\"played\",0,\"width\"),this.bar.set(\"loaded\",0,\"width\"),this.template.ptime.innerHTML=\"00:00\",this.template.danmaku.innerHTML=\"\",this.danmaku&&this.danmaku.reload({id:t.id,address:t.api,token:t.token,maximum:t.maximum,addition:t.addition,user:t.user}))}},{key:\"initMSE\",value:function(e,t){var r,n,i,a,o=this;if(this.type=t,this.options.video.customType&&this.options.video.customType[t])\"[object Function]\"===Object.prototype.toString.call(this.options.video.customType[t])?this.options.video.customType[t](this.video,this):console.error(\"Illegal customType: \"+t);else switch(\"auto\"===this.type&&(/m3u8(#|\\?|$)/i.exec(e.src)?this.type=\"hls\":/.flv(#|\\?|$)/i.exec(e.src)?this.type=\"flv\":/.mpd(#|\\?|$)/i.exec(e.src)?this.type=\"dash\":this.type=\"normal\"),\"hls\"===this.type&&(e.canPlayType(\"application/x-mpegURL\")||e.canPlayType(\"application/vnd.apple.mpegURL\"))&&(this.type=\"normal\"),this.type){case\"hls\":Hls?Hls.isSupported()?((r=new Hls).loadSource(e.src),r.attachMedia(e)):this.notice(\"Error: Hls is not supported.\"):this.notice(\"Error: Can't find Hls.\");break;case\"flv\":flvjs&&flvjs.isSupported()?flvjs.isSupported()?((n=flvjs.createPlayer({type:\"flv\",url:e.src})).attachMediaElement(e),n.load()):this.notice(\"Error: flvjs is not supported.\"):this.notice(\"Error: Can't find flvjs.\");break;case\"dash\":dashjs?dashjs.MediaPlayer().create().initialize(e,e.src,!1):this.notice(\"Error: Can't find dashjs.\");break;case\"webtorrent\":WebTorrent?WebTorrent.WEBRTC_SUPPORT?(this.container.classList.add(\"dplayer-loading\"),i=new WebTorrent,a=e.src,i.add(a,(function(e){e.files.find((function(e){return e.name.endsWith(\".mp4\")})).renderTo(o.video,{autoplay:o.options.autoplay},(function(){o.container.classList.remove(\"dplayer-loading\")}))}))):this.notice(\"Error: Webtorrent is not supported.\"):this.notice(\"Error: Can't find Webtorrent.\")}}},{key:\"initVideo\",value:function(e,t){var r=this;this.initMSE(e,t),this.on(\"durationchange\",(function(){1!==e.duration&&e.duration!==1/0&&(r.template.dtime.innerHTML=i.default.secondToTime(e.duration))})),this.on(\"progress\",(function(){var t=e.buffered.length?e.buffered.end(e.buffered.length-1)/e.duration:0;r.bar.set(\"loaded\",t,\"width\")})),this.on(\"error\",(function(){r.video.error&&r.tran&&r.notice&&(r.type,r.notice(r.tran(\"Video load failed\"),-1))})),this.on(\"ended\",(function(){r.bar.set(\"played\",1,\"width\"),r.setting.loop?(r.seek(0),r.play()):r.pause(),r.danmaku&&(r.danmaku.danIndex=0)})),this.on(\"play\",(function(){r.paused&&r.play()})),this.on(\"pause\",(function(){r.paused||r.pause()})),this.on(\"timeupdate\",(function(){r.bar.set(\"played\",r.video.currentTime/r.video.duration,\"width\");var e=i.default.secondToTime(r.video.currentTime);r.template.ptime.innerHTML!==e&&(r.template.ptime.innerHTML=e)}));for(var n=0;n<this.events.videoEvents.length;n++)!function(t){e.addEventListener(r.events.videoEvents[t],(function(){r.events.trigger(r.events.videoEvents[t])}))}(n);this.volume(this.user.get(\"volume\"),!0,!0),this.options.subtitle&&(this.subtitle=new f.default(this.template.subtitle,this.video,this.options.subtitle,this.events),this.user.get(\"subtitle\")||this.subtitle.hide())}},{key:\"switchQuality\",value:function(e){var t,r,n,i=this;this.qualityIndex===e||this.switchingQuality||(this.qualityIndex=e,this.switchingQuality=!0,this.quality=this.options.video.quality[e],this.template.qualityButton.innerHTML=this.quality.name,t=this.video.paused,this.video.pause(),r=(0,w.default)({current:!1,pic:null,screenshot:this.options.screenshot,preload:\"auto\",url:this.quality.url,subtitle:this.options.subtitle}),n=(new DOMParser).parseFromString(r,\"text/html\").body.firstChild,this.template.videoWrap.insertBefore(n,this.template.videoWrap.getElementsByTagName(\"div\")[0]),this.prevVideo=this.video,this.video=n,this.initVideo(this.video,this.quality.type||this.options.video.type),this.seek(this.prevVideo.currentTime),this.notice(this.tran(\"Switching to\")+\" \"+this.quality.name+\" \"+this.tran(\"quality\"),-1),this.events.trigger(\"quality_start\",this.quality),this.on(\"canplay\",(function(){if(i.prevVideo){if(i.video.currentTime!==i.prevVideo.currentTime)return void i.seek(i.prevVideo.currentTime);i.template.videoWrap.removeChild(i.prevVideo),i.video.classList.add(\"dplayer-video-current\"),t||i.video.play(),i.prevVideo=null,i.notice(i.tran(\"Switched to\")+\" \"+i.quality.name+\" \"+i.tran(\"quality\")),i.switchingQuality=!1,i.events.trigger(\"quality_end\")}})))}},{key:\"notice\",value:function(e){var t=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:2e3,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:.8;this.template.notice.innerHTML=e,this.template.notice.style.opacity=n,this.noticeTime&&clearTimeout(this.noticeTime),this.events.trigger(\"notice_show\",e),0<r&&(this.noticeTime=setTimeout((function(){t.template.notice.style.opacity=0,t.events.trigger(\"notice_hide\")}),r))}},{key:\"resize\",value:function(){this.danmaku&&this.danmaku.resize(),this.events.trigger(\"resize\")}},{key:\"speed\",value:function(e){this.video.playbackRate=e}},{key:\"destroy\",value:function(){L.splice(L.indexOf(this),1),this.pause(),this.controller.destroy(),this.timer.destroy(),this.video.src=\"\",this.container.innerHTML=\"\",this.events.trigger(\"destroy\")}}],[{key:\"version\",get:function(){return\"1.25.0\"}}]),R);function R(e){var t=this;!function(e){if(!(e instanceof R))throw new TypeError(\"Cannot call a class as a function\")}(this),this.options=(0,a.default)(e),this.options.video.quality&&(this.qualityIndex=this.options.video.defaultQuality,this.quality=this.options.video.quality[this.options.video.defaultQuality]),this.tran=new o.default(this.options.lang).tran,this.events=new u.default,this.user=new h.default(this),this.container=this.options.container,this.container.classList.add(\"dplayer\"),this.options.danmaku||this.container.classList.add(\"dplayer-no-danmaku\"),this.options.live&&this.container.classList.add(\"dplayer-live\"),i.default.isMobile&&this.container.classList.add(\"dplayer-mobile\"),this.arrow=this.container.offsetWidth<=500,this.arrow&&this.container.classList.add(\"dplayer-arrow\"),this.template=new s.default({container:this.container,options:this.options,index:x,tran:this.tran}),this.video=this.template.video,this.bar=new p.default(this.template),this.bezel=new g.default(this.template.bezel),this.fullScreen=new c.default(this),this.controller=new y.default(this),this.options.danmaku&&(this.danmaku=new d.default({container:this.template.danmaku,opacity:this.user.get(\"opacity\"),callback:function(){setTimeout((function(){t.template.danmakuLoading.style.display=\"none\",t.options.autoplay&&t.play()}),0)},error:function(e){t.notice(e)},apiBackend:this.options.apiBackend,borderColor:this.options.theme,height:this.arrow?24:30,time:function(){return t.video.currentTime},unlimited:this.user.get(\"unlimited\"),api:{id:this.options.danmaku.id,address:this.options.danmaku.api,token:this.options.danmaku.token,maximum:this.options.danmaku.maximum,addition:this.options.danmaku.addition,user:this.options.danmaku.user},events:this.events,tran:function(e){return t.tran(e)}}),this.comment=new _.default(this)),this.setting=new v.default(this),document.addEventListener(\"click\",(function(){t.focus=!1}),!0),this.container.addEventListener(\"click\",(function(){t.focus=!0}),!0),this.paused=!0,this.timer=new m.default(this),this.hotkey=new b.default(this),this.contextmenu=new E.default(this),this.initVideo(this.video,this.quality&&this.quality.type||this.options.video.type),this.infoPanel=new k.default(this),!this.danmaku&&this.options.autoplay&&this.play(),x++,L.push(this)}t.default=A},,,function(e,t,r){},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),r(77);var n=r(74),i=n&&n.__esModule?n:{default:n};console.log(\"\\n %c DPlayer v1.25.0 fdcf45b %c http://dplayer.js.org \\n\\n\",\"color: #fadfa3; background: #030307; padding:5px 0;\",\"background: #fadfa3; padding:5px 0;\"),t.default=i.default}]).default}).call(this,r(\"./node_modules/timers-browserify/main.js\").setImmediate,r(\"./node_modules/timers-browserify/main.js\").clearImmediate)},\"./node_modules/hls.js/dist/hls.js\":function(e,t,r){var n;\"undefined\"!=typeof window&&(n=function(){return r={},e.m=t={\"./node_modules/eventemitter3/index.js\":\n/*!*********************************************!*\\\n  !*** ./node_modules/eventemitter3/index.js ***!\n  \\*********************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){\"use strict\";var n=Object.prototype.hasOwnProperty,i=\"~\";function a(){}function o(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function s(e,t,r,n,a){if(\"function\"!=typeof r)throw new TypeError(\"The listener must be a function\");var s=new o(r,n||e,a),l=i?i+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],s]:e._events[l].push(s):(e._events[l]=s,e._eventsCount++),e}function l(e,t){0==--e._eventsCount?e._events=new a:delete e._events[t]}function d(){this._events=new a,this._eventsCount=0}Object.create&&(a.prototype=Object.create(null),(new a).__proto__||(i=!1)),d.prototype.eventNames=function(){var e,t,r=[];if(0===this._eventsCount)return r;for(t in e=this._events)n.call(e,t)&&r.push(i?t.slice(1):t);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},d.prototype.listeners=function(e){var t=i?i+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var n=0,a=r.length,o=new Array(a);n<a;n++)o[n]=r[n].fn;return o},d.prototype.listenerCount=function(e){var t=i?i+e:e,r=this._events[t];return r?r.fn?1:r.length:0},d.prototype.emit=function(e,t,r,n,a,o){var s=i?i+e:e;if(!this._events[s])return!1;var l,d=this._events[s],u=arguments.length;if(d.fn){switch(d.once&&this.removeListener(e,d.fn,void 0,!0),u){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,t),!0;case 3:return d.fn.call(d.context,t,r),!0;case 4:return d.fn.call(d.context,t,r,n),!0;case 5:return d.fn.call(d.context,t,r,n,a),!0;case 6:return d.fn.call(d.context,t,r,n,a,o),!0}for(f=1,l=new Array(u-1);f<u;f++)l[f-1]=arguments[f];d.fn.apply(d.context,l)}else for(var c,h=d.length,f=0;f<h;f++)switch(d[f].once&&this.removeListener(e,d[f].fn,void 0,!0),u){case 1:d[f].fn.call(d[f].context);break;case 2:d[f].fn.call(d[f].context,t);break;case 3:d[f].fn.call(d[f].context,t,r);break;case 4:d[f].fn.call(d[f].context,t,r,n);break;default:if(!l)for(c=1,l=new Array(u-1);c<u;c++)l[c-1]=arguments[c];d[f].fn.apply(d[f].context,l)}return!0},d.prototype.on=function(e,t,r){return s(this,e,t,r,!1)},d.prototype.once=function(e,t,r){return s(this,e,t,r,!0)},d.prototype.removeListener=function(e,t,r,n){var a=i?i+e:e;if(!this._events[a])return this;if(!t)return l(this,a),this;var o=this._events[a];if(o.fn)o.fn!==t||n&&!o.once||r&&o.context!==r||l(this,a);else{for(var s=0,d=[],u=o.length;s<u;s++)(o[s].fn!==t||n&&!o[s].once||r&&o[s].context!==r)&&d.push(o[s]);d.length?this._events[a]=1===d.length?d[0]:d:l(this,a)}return this},d.prototype.removeAllListeners=function(e){var t;return e?(t=i?i+e:e,this._events[t]&&l(this,t)):(this._events=new a,this._eventsCount=0),this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prefixed=i,d.EventEmitter=d,e.exports=d},\"./node_modules/url-toolkit/src/url-toolkit.js\":\n/*!*****************************************************!*\\\n  !*** ./node_modules/url-toolkit/src/url-toolkit.js ***!\n  \\*****************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){var n,i,a,o,s;n=/^((?:[a-zA-Z0-9+\\-.]+:)?)(\\/\\/[^\\/?#]*)?((?:[^\\/?#]*\\/)*[^;?#]*)?(;[^?#]*)?(\\?[^#]*)?(#.*)?$/,i=/^([^\\/?#]*)(.*)$/,a=/(?:\\/|^)\\.(?=\\/)/g,o=/(?:\\/|^)\\.\\.\\/(?!\\.\\.\\/)[^\\/]*(?=\\/)/g,s={buildAbsoluteURL:function(e,t,r){if(r=r||{},e=e.trim(),!(t=t.trim())){if(!r.alwaysNormalize)return e;var n=s.parseURL(e);if(!n)throw new Error(\"Error trying to parse base URL.\");return n.path=s.normalizePath(n.path),s.buildURLFromParts(n)}var a=s.parseURL(t);if(!a)throw new Error(\"Error trying to parse relative URL.\");if(a.scheme)return r.alwaysNormalize?(a.path=s.normalizePath(a.path),s.buildURLFromParts(a)):t;var o,l=s.parseURL(e);if(!l)throw new Error(\"Error trying to parse base URL.\");!l.netLoc&&l.path&&\"/\"!==l.path[0]&&(o=i.exec(l.path),l.netLoc=o[1],l.path=o[2]),l.netLoc&&!l.path&&(l.path=\"/\");var d,u,c={scheme:l.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};return a.netLoc||(c.netLoc=l.netLoc,\"/\"!==a.path[0]&&(a.path?(u=(d=l.path).substring(0,d.lastIndexOf(\"/\")+1)+a.path,c.path=s.normalizePath(u)):(c.path=l.path,a.params||(c.params=l.params,a.query||(c.query=l.query))))),null===c.path&&(c.path=r.alwaysNormalize?s.normalizePath(a.path):a.path),s.buildURLFromParts(c)},parseURL:function(e){var t=n.exec(e);return t?{scheme:t[1]||\"\",netLoc:t[2]||\"\",path:t[3]||\"\",params:t[4]||\"\",query:t[5]||\"\",fragment:t[6]||\"\"}:null},normalizePath:function(e){for(e=e.split(\"\").reverse().join(\"\").replace(a,\"\");e.length!==(e=e.replace(o,\"\")).length;);return e.split(\"\").reverse().join(\"\")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=s},\"./node_modules/webworkify-webpack/index.js\":\n/*!**************************************************!*\\\n  !*** ./node_modules/webworkify-webpack/index.js ***!\n  \\**************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){function n(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.i=function(e){return e},r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.r=function(e){Object.defineProperty(e,\"__esModule\",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,\"a\",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p=\"/\",r.oe=function(e){throw console.error(e),e};var n=r(r.s=ENTRY_MODULE);return n.default||n}var i=\"[\\\\.|\\\\-|\\\\+|\\\\w|/|@]+\",a=\"\\\\(\\\\s*(/\\\\*.*?\\\\*/)?\\\\s*.*?(\"+i+\").*?\\\\)\";function o(e){return(e+\"\").replace(/[.?*+^$[\\]\\\\(){}|-]/g,\"\\\\$&\")}function s(e,t,n){var s={};s[n]=[];var l=t.toString(),d=l.match(/^function\\s?\\w*\\(\\w+,\\s*\\w+,\\s*(\\w+)\\)/);if(!d)return s;for(var u,c=d[1],h=new RegExp(\"(\\\\\\\\n|\\\\W)\"+o(c)+a,\"g\");u=h.exec(l);)\"dll-reference\"!==u[3]&&s[n].push(u[3]);for(h=new RegExp(\"\\\\(\"+o(c)+'\\\\(\"(dll-reference\\\\s('+i+'))\"\\\\)\\\\)'+a,\"g\");u=h.exec(l);)e[u[2]]||(s[n].push(u[1]),e[u[2]]=r(u[1]).m),s[u[2]]=s[u[2]]||[],s[u[2]].push(u[4]);for(var f,p=Object.keys(s),m=0;m<p.length;m++)for(var g=0;g<s[p[m]].length;g++)f=s[p[m]][g],isNaN(+f)||(s[p[m]][g]=+s[p[m]][g]);return s}e.exports=function(e,t){t=t||{};var i={main:r.m},a=t.all?{main:Object.keys(i.main)}:function(e,t){for(var r={main:[t]},n={main:[]},i={main:{}};function(e){return Object.keys(e).reduce((function(t,r){return t||0<e[r].length}),!1)}(r);)for(var a=Object.keys(r),o=0;o<a.length;o++){var l=a[o],d=r[l].pop();if(i[l]=i[l]||{},!i[l][d]&&e[l][d]){i[l][d]=!0,n[l]=n[l]||[],n[l].push(d);for(var u=s(e,e[l][d],l),c=Object.keys(u),h=0;h<c.length;h++)r[c[h]]=r[c[h]]||[],r[c[h]]=r[c[h]].concat(u[c[h]])}}return n}(i,e),o=\"\";Object.keys(a).filter((function(e){return\"main\"!==e})).forEach((function(e){for(var t=0;a[e][t];)t++;a[e].push(t),i[e][t]=\"(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })\",o=o+\"var \"+e+\" = (\"+n.toString().replace(\"ENTRY_MODULE\",JSON.stringify(t))+\")({\"+a[e].map((function(t){return JSON.stringify(t)+\": \"+i[e][t].toString()})).join(\",\")+\"});\\n\"})),o=o+\"new ((\"+n.toString().replace(\"ENTRY_MODULE\",JSON.stringify(e))+\")({\"+a.main.map((function(e){return JSON.stringify(e)+\": \"+i.main[e].toString()})).join(\",\")+\"}))(self);\";var l=new window.Blob([o],{type:\"text/javascript\"});if(t.bare)return l;var d=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(l),u=new window.Worker(d);return u.objectURL=d,u}},\"./src/crypt/decrypter.js\":\n/*!********************************************!*\\\n  !*** ./src/crypt/decrypter.js + 3 modules ***!\n  \\********************************************/\n/*! exports provided: default */\n/*! ModuleConcatenation bailout: Cannot concat with ./src/errors.ts because of ./src/hls.ts */\n/*! ModuleConcatenation bailout: Cannot concat with ./src/events.js because of ./src/hls.ts */\n/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/get-self-scope.js because of ./src/hls.ts */\n/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/logger.js because of ./src/hls.ts */function(e,t,r){\"use strict\";r.r(t);var n=function(){function e(e,t){this.subtle=e,this.aesIV=t}return e.prototype.decrypt=function(e,t){return this.subtle.decrypt({name:\"AES-CBC\",iv:this.aesIV},t,e)},e}(),i=function(){function e(e,t){this.subtle=e,this.key=t}return e.prototype.expandKey=function(){return this.subtle.importKey(\"raw\",this.key,{name:\"AES-CBC\"},!1,[\"encrypt\",\"decrypt\"])},e}(),a=function(){function e(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}var t=e.prototype;return t.uint8ArrayToUint32Array_=function(e){for(var t=new DataView(e),r=new Uint32Array(4),n=0;n<4;n++)r[n]=t.getUint32(4*n);return r},t.initTable=function(){var e=this.sBox,t=this.invSBox,r=this.subMix,n=r[0],i=r[1],a=r[2],o=r[3],s=this.invSubMix,l=s[0],d=s[1],u=s[2],c=s[3],h=new Uint32Array(256),f=0,p=0,m=0;for(m=0;m<256;m++)h[m]=m<128?m<<1:m<<1^283;for(m=0;m<256;m++){var g=(g=p^p<<1^p<<2^p<<3^p<<4)>>>8^255&g^99,y=h[t[e[f]=g]=f],v=h[y],_=h[v],b=257*h[g]^16843008*g;n[f]=b<<24|b>>>8,i[f]=b<<16|b>>>16,a[f]=b<<8|b>>>24,o[f]=b,b=16843009*_^65537*v^257*y^16843008*f,l[g]=b<<24|b>>>8,d[g]=b<<16|b>>>16,u[g]=b<<8|b>>>24,c[g]=b,f?(f=y^h[h[h[_^y]]],p^=h[h[p]]):f=p=1}},t.expandKey=function(e){for(var t=this.uint8ArrayToUint32Array_(e),r=!0,n=0;n<t.length&&r;)r=t[n]===this.key[n],n++;if(!r){this.key=t;var i=this.keySize=t.length;if(4!==i&&6!==i&&8!==i)throw new Error(\"Invalid aes key size=\"+i);for(var a,o,s,l=this.ksRows=4*(i+6+1),d=this.keySchedule=new Uint32Array(l),u=this.invKeySchedule=new Uint32Array(l),c=this.sBox,h=this.rcon,f=this.invSubMix,p=f[0],m=f[1],g=f[2],y=f[3],v=0;v<l;v++)v<i?o=d[v]=t[v]:(s=o,v%i==0?(s=c[(s=s<<8|s>>>24)>>>24]<<24|c[s>>>16&255]<<16|c[s>>>8&255]<<8|c[255&s],s^=h[v/i|0]<<24):6<i&&v%i==4&&(s=c[s>>>24]<<24|c[s>>>16&255]<<16|c[s>>>8&255]<<8|c[255&s]),d[v]=o=(d[v-i]^s)>>>0);for(a=0;a<l;a++)v=l-a,s=3&a?d[v]:d[v-4],u[a]=a<4||v<=4?s:p[c[s>>>24]]^m[c[s>>>16&255]]^g[c[s>>>8&255]]^y[c[255&s]],u[a]=u[a]>>>0}},t.networkToHostOrderSwap=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},t.decrypt=function(e,t,r,n){for(var i,a,o,s,l,d,u,c,h,f,p,m,g,y,v,_,b,E=this.keySize+6,k=this.invKeySchedule,w=this.invSBox,S=this.invSubMix,T=S[0],x=S[1],L=S[2],A=S[3],R=this.uint8ArrayToUint32Array_(r),D=R[0],O=R[1],C=R[2],I=R[3],M=new Int32Array(e),P=new Int32Array(M.length),B=this.networkToHostOrderSwap;t<M.length;){for(h=B(M[t]),f=B(M[t+1]),p=B(M[t+2]),m=B(M[t+3]),l=h^k[0],d=m^k[1],u=p^k[2],c=f^k[3],g=4,y=1;y<E;y++)i=T[l>>>24]^x[d>>16&255]^L[u>>8&255]^A[255&c]^k[g],a=T[d>>>24]^x[u>>16&255]^L[c>>8&255]^A[255&l]^k[g+1],o=T[u>>>24]^x[c>>16&255]^L[l>>8&255]^A[255&d]^k[g+2],s=T[c>>>24]^x[l>>16&255]^L[d>>8&255]^A[255&u]^k[g+3],l=i,d=a,u=o,c=s,g+=4;i=w[l>>>24]<<24^w[d>>16&255]<<16^w[u>>8&255]<<8^w[255&c]^k[g],a=w[d>>>24]<<24^w[u>>16&255]<<16^w[c>>8&255]<<8^w[255&l]^k[g+1],o=w[u>>>24]<<24^w[c>>16&255]<<16^w[l>>8&255]<<8^w[255&d]^k[g+2],s=w[c>>>24]<<24^w[l>>16&255]<<16^w[d>>8&255]<<8^w[255&u]^k[g+3],g+=3,P[t]=B(i^D),P[t+1]=B(s^O),P[t+2]=B(o^C),P[t+3]=B(a^I),D=h,O=f,C=p,I=m,t+=4}return n?(b=(_=(v=P.buffer).byteLength)&&new DataView(v).getUint8(_-1))?v.slice(0,_-b):v:P.buffer},t.destroy=function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0},e}(),o=r(\"./src/errors.ts\"),s=r(\"./src/utils/logger.js\"),l=r(\"./src/events.js\"),d=r(\"./src/utils/get-self-scope.js\"),u=Object(d.getSelfScope)(),c=function(){function e(e,t,r){var n=(void 0===r?{}:r).removePKCS7Padding,i=void 0===n||n;if(this.logEnabled=!0,this.observer=e,this.config=t,this.removePKCS7Padding=i)try{var a=u.crypto;a&&(this.subtle=a.subtle||a.webkitSubtle)}catch(e){}this.disableWebCrypto=!this.subtle}var t=e.prototype;return t.isSync=function(){return this.disableWebCrypto&&this.config.enableSoftwareAES},t.decrypt=function(e,t,r,o){var l,d,u=this;this.disableWebCrypto&&this.config.enableSoftwareAES?(this.logEnabled&&(s.logger.log(\"JS AES decrypt\"),this.logEnabled=!1),(l=this.decryptor)||(this.decryptor=l=new a),l.expandKey(t),o(l.decrypt(e,0,r,this.removePKCS7Padding))):(this.logEnabled&&(s.logger.log(\"WebCrypto AES decrypt\"),this.logEnabled=!1),d=this.subtle,this.key!==t&&(this.key=t,this.fastAesKey=new i(d,t)),this.fastAesKey.expandKey().then((function(i){new n(d,r).decrypt(e,i).catch((function(n){u.onWebCryptoError(n,e,t,r,o)})).then((function(e){o(e)}))})).catch((function(n){u.onWebCryptoError(n,e,t,r,o)})))},t.onWebCryptoError=function(e,t,r,n,i){this.config.enableSoftwareAES?(s.logger.log(\"WebCrypto Error, disable WebCrypto API\"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(t,r,n,i)):(s.logger.error(\"decrypting error : \"+e.message),this.observer.trigger(l.default.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!0,reason:e.message}))},t.destroy=function(){var e=this.decryptor;e&&(e.destroy(),this.decryptor=void 0)},e}();t.default=c},\"./src/demux/demuxer-inline.js\":\n/*!**************************************************!*\\\n  !*** ./src/demux/demuxer-inline.js + 12 modules ***!\n  \\**************************************************/\n/*! exports provided: default */\n/*! ModuleConcatenation bailout: Cannot concat with ./src/crypt/decrypter.js because of ./src/hls.ts */\n/*! ModuleConcatenation bailout: Cannot concat with ./src/demux/id3.js because of ./src/hls.ts */\n/*! ModuleConcatenation bailout: Cannot concat with ./src/demux/mp4demuxer.js because of ./src/hls.ts */\n/*! ModuleConcatenation bailout: Cannot concat with ./src/errors.ts because of ./src/hls.ts */\n/*! ModuleConcatenation bailout: Cannot concat with ./src/events.js because of ./src/hls.ts */\n/*! ModuleConcatenation bailout: Cannot concat with ./src/polyfills/number.js because of ./src/hls.ts */\n/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/get-self-scope.js because of ./src/hls.ts */\n/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/logger.js because of ./src/hls.ts */function(e,t,r){\"use strict\";r.r(t);var n=r(\"./src/events.js\"),i=r(\"./src/errors.ts\"),a=r(\"./src/crypt/decrypter.js\"),o=r(\"./src/polyfills/number.js\"),s=r(\"./src/utils/logger.js\"),l=r(\"./src/utils/get-self-scope.js\");function d(e,t){return 255===e[t]&&240==(246&e[t+1])}function u(e,t){return 1&e[t+1]?7:9}function c(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function h(e,t){return!!(t+1<e.length&&d(e,t))}function f(e,t,r,a,o){var l;e.samplerate||(l=function(e,t,r,a){var o,l,d,u=navigator.userAgent.toLowerCase(),c=a,h=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],f=1+((192&t[r+2])>>>6),p=(60&t[r+2])>>>2;if(!(h.length-1<p))return l=(1&t[r+2])<<2,l|=(192&t[r+3])>>>6,s.logger.log(\"manifest codec:\"+a+\",ADTS data:type:\"+f+\",sampleingIndex:\"+p+\"[\"+h[p]+\"Hz],channelConfig:\"+l),o=/firefox/i.test(u)?6<=p?(f=5,d=new Array(4),p-3):(f=2,d=new Array(2),p):-1!==u.indexOf(\"android\")?(f=2,d=new Array(2),p):(f=5,d=new Array(4),a&&(-1!==a.indexOf(\"mp4a.40.29\")||-1!==a.indexOf(\"mp4a.40.5\"))||!a&&6<=p?p-3:((a&&-1!==a.indexOf(\"mp4a.40.2\")&&(6<=p&&1==l||/vivaldi/i.test(u))||!a&&1==l)&&(f=2,d=new Array(2)),p)),d[0]=f<<3,d[0]|=(14&p)>>1,d[1]|=(1&p)<<7,d[1]|=l<<3,5===f&&(d[1]|=(14&o)>>1,d[2]=(1&o)<<7,d[2]|=8,d[3]=0),{config:d,samplerate:h[p],channelCount:l,codec:\"mp4a.40.\"+f,manifestCodec:c};e.trigger(n.default.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:\"invalid ADTS sampling index:\"+p})}(t,r,a,o),e.config=l.config,e.samplerate=l.samplerate,e.channelCount=l.channelCount,e.codec=l.codec,e.manifestCodec=l.manifestCodec,s.logger.log(\"parsed codec:\"+e.codec+\",rate:\"+l.samplerate+\",nb channel:\"+l.channelCount))}function p(e){return 9216e4/e}function m(e,t,r,n,i){var a=function(e,t,r,n,i){var a=e.length,o=u(e,t),s=c(e,t);if(0<(s-=o)&&t+o+s<=a)return{headerLength:o,frameLength:s,stamp:r+n*i}}(t,r,n,i,p(e.samplerate));if(a){var o=a.stamp,s=a.headerLength,l=a.frameLength,d={unit:t.subarray(r+s,r+s+l),pts:o,dts:o};return e.samples.push(d),{sample:d,length:l+s}}}var g=r(\"./src/demux/id3.js\"),y=function(){function e(e,t,r){this.observer=e,this.config=r,this.remuxer=t}var t=e.prototype;return t.resetInitSegment=function(e,t,r,n){this._audioTrack={container:\"audio/adts\",type:\"audio\",id:0,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:t,duration:n,inputTimeScale:9e4}},t.resetTimeStamp=function(){},e.probe=function(e){if(!e)return!1;for(var t=(g.default.getID3Data(e,0)||[]).length,r=e.length;t<r;t++)if(function(e,t){if(h(e,t)){var r=u(e,t);if(t+r>=e.length)return;var n=c(e,t);if(n<=r)return;var i=t+n;if(i===e.length||i+1<e.length&&d(e,i))return 1}}(e,t))return s.logger.log(\"ADTS sync word found !\"),!0;return!1},t.append=function(e,t,r,n){for(var i=this._audioTrack,a=g.default.getID3Data(e,0)||[],l=g.default.getTimeStamp(a),d=Object(o.isFiniteNumber)(l)?90*l:9e4*t,u=0,c=d,p=e.length,y=a.length,v=[{pts:c,dts:c,data:a}];y<p-1;)if(h(e,y)&&y+5<p){f(i,this.observer,e,y,i.manifestCodec);var _=m(i,e,y,d,u);if(!_){s.logger.log(\"Unable to parse AAC frame\");break}y+=_.length,c=_.sample.pts,u++}else g.default.isHeader(e,y)?(a=g.default.getID3Data(e,y),v.push({pts:c,dts:c,data:a}),y+=a.length):y++;this.remuxer.remux(i,{samples:[]},{samples:v,inputTimeScale:9e4},{samples:[]},t,r,n)},t.destroy=function(){},e}(),v=r(\"./src/demux/mp4demuxer.js\"),_={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function(e,t,r,n,i){if(!(r+24>t.length)){var a=this.parseHeader(t,r);if(a&&r+a.frameLength<=t.length){var o=n+i*(9e4*a.samplesPerFrame/a.sampleRate),s={unit:t.subarray(r,r+a.frameLength),pts:o,dts:o};return e.config=[],e.channelCount=a.channelCount,e.samplerate=a.sampleRate,e.samples.push(s),{sample:s,length:a.frameLength}}}},parseHeader:function(e,t){var r=e[t+1]>>3&3,n=e[t+1]>>1&3,i=e[t+2]>>4&15,a=e[t+2]>>2&3,o=e[t+2]>>1&1;if(1!=r&&0!=i&&15!=i&&3!=a){var s=3==r?3-n:3==n?3:4,l=1e3*_.BitratesMap[14*s+i-1],d=3==r?0:2==r?1:2,u=_.SamplingRateMap[3*d+a],c=e[t+3]>>6==3?1:2,h=_.SamplesCoefficients[r][n],f=_.BytesInSlot[n],p=8*h*f;return{sampleRate:u,channelCount:c,frameLength:parseInt(h*l/u+o,10)*f,samplesPerFrame:p}}},isHeaderPattern:function(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])},isHeader:function(e,t){return!!(t+1<e.length&&this.isHeaderPattern(e,t))},probe:function(e,t){if(t+1<e.length&&this.isHeaderPattern(e,t)){var r=this.parseHeader(e,t),n=4;r&&r.frameLength&&(n=r.frameLength);var i=t+n;if(i===e.length||i+1<e.length&&this.isHeaderPattern(e,i))return!0}return!1}},b=_,E=function(){function e(e){this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}var t=e.prototype;return t.loadWord=function(){var e=this.data,t=this.bytesAvailable,r=e.byteLength-t,n=new Uint8Array(4),i=Math.min(4,t);if(0===i)throw new Error(\"no bytes available\");n.set(e.subarray(r,r+i)),this.word=new DataView(n.buffer).getUint32(0),this.bitsAvailable=8*i,this.bytesAvailable-=i},t.skipBits=function(e){var t;this.bitsAvailable>e||(e-=this.bitsAvailable,e-=(t=e>>3)>>3,this.bytesAvailable-=t,this.loadWord()),this.word<<=e,this.bitsAvailable-=e},t.readBits=function(e){var t=Math.min(this.bitsAvailable,e),r=this.word>>>32-t;return 32<e&&s.logger.error(\"Cannot read more than 32 bits at a time\"),this.bitsAvailable-=t,0<this.bitsAvailable?this.word<<=t:0<this.bytesAvailable&&this.loadWord(),0<(t=e-t)&&this.bitsAvailable?r<<t|this.readBits(t):r},t.skipLZ=function(){for(var e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()},t.skipUEG=function(){this.skipBits(1+this.skipLZ())},t.skipEG=function(){this.skipBits(1+this.skipLZ())},t.readUEG=function(){var e=this.skipLZ();return this.readBits(e+1)-1},t.readEG=function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)},t.readBoolean=function(){return 1===this.readBits(1)},t.readUByte=function(){return this.readBits(8)},t.readUShort=function(){return this.readBits(16)},t.readUInt=function(){return this.readBits(32)},t.skipScalingList=function(e){for(var t=8,r=8,n=0;n<e;n++)0!==r&&(r=(t+this.readEG()+256)%256),t=0===r?t:r},t.readSPS=function(){var e,t,r,n,i,a,o,s=0,l=0,d=0,u=0,c=this.readUByte.bind(this),h=this.readBits.bind(this),f=this.readUEG.bind(this),p=this.readBoolean.bind(this),m=this.skipBits.bind(this),g=this.skipEG.bind(this),y=this.skipUEG.bind(this),v=this.skipScalingList.bind(this);if(c(),e=c(),h(5),m(3),c(),y(),100===e||110===e||122===e||244===e||44===e||83===e||86===e||118===e||128===e){var _=f();if(3===_&&m(1),y(),y(),m(1),p())for(a=3!==_?8:12,o=0;o<a;o++)p()&&v(o<6?16:64)}y();var b=f();if(0===b)f();else if(1===b)for(m(1),g(),g(),t=f(),o=0;o<t;o++)g();y(),m(1),r=f(),n=f(),0===(i=h(1))&&m(1),m(1),p()&&(s=f(),l=f(),d=f(),u=f());var E=[1,1];if(p()&&p())switch(c()){case 1:E=[1,1];break;case 2:E=[12,11];break;case 3:E=[10,11];break;case 4:E=[16,11];break;case 5:E=[40,33];break;case 6:E=[24,11];break;case 7:E=[20,11];break;case 8:E=[32,11];break;case 9:E=[80,33];break;case 10:E=[18,11];break;case 11:E=[15,11];break;case 12:E=[64,33];break;case 13:E=[160,99];break;case 14:E=[4,3];break;case 15:E=[3,2];break;case 16:E=[2,1];break;case 255:E=[c()<<8|c(),c()<<8|c()]}return{width:Math.ceil(16*(r+1)-2*s-2*l),height:(2-i)*(n+1)*16-(i?2:4)*(d+u),pixelRatio:E}},t.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},e}(),k=function(){function e(e,t,r,n){this.decryptdata=r,this.discardEPB=n,this.decrypter=new a.default(e,t,{removePKCS7Padding:!1})}var t=e.prototype;return t.decryptBuffer=function(e,t){this.decrypter.decrypt(e,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,t)},t.decryptAacSample=function(e,t,r,n){var i=e[t].unit,a=i.subarray(16,i.length-i.length%16),o=a.buffer.slice(a.byteOffset,a.byteOffset+a.length),s=this;this.decryptBuffer(o,(function(a){a=new Uint8Array(a),i.set(a,16),n||s.decryptAacSamples(e,t+1,r)}))},t.decryptAacSamples=function(e,t,r){for(;;t++){if(t>=e.length)return void r();if(!(e[t].unit.length<32)){var n=this.decrypter.isSync();if(this.decryptAacSample(e,t,r,n),!n)return}}},t.getAvcEncryptedData=function(e){for(var t=16*Math.floor((e.length-48)/160)+16,r=new Int8Array(t),n=0,i=32;i<=e.length-16;i+=160,n+=16)r.set(e.subarray(i,i+16),n);return r},t.getAvcDecryptedUnit=function(e,t){t=new Uint8Array(t);for(var r=0,n=32;n<=e.length-16;n+=160,r+=16)e.set(t.subarray(r,r+16),n);return e},t.decryptAvcSample=function(e,t,r,n,i,a){var o=this.discardEPB(i.data),s=this.getAvcEncryptedData(o),l=this;this.decryptBuffer(s.buffer,(function(s){i.data=l.getAvcDecryptedUnit(o,s),a||l.decryptAvcSamples(e,t,r+1,n)}))},t.decryptAvcSamples=function(e,t,r,n){for(;;t++,r=0){if(t>=e.length)return void n();for(var i=e[t].units;!(r>=i.length);r++){var a=i[r];if(!(a.length<=48||1!==a.type&&5!==a.type)){var o=this.decrypter.isSync();if(this.decryptAvcSample(e,t,r,n,a,o),!o)return}}}},e}(),w={video:1,audio:2,id3:3,text:4},S=function(){function e(e,t,r,n){this.observer=e,this.config=r,this.typeSupported=n,this.remuxer=t,this.sampleAes=null,this.pmtUnknownTypes={}}var t=e.prototype;return t.setDecryptData=function(e){null!=e&&null!=e.key&&\"SAMPLE-AES\"===e.method?this.sampleAes=new k(this.observer,this.config,e,this.discardEPB):this.sampleAes=null},e.probe=function(t){var r=e._syncOffset(t);return!(r<0||(r&&s.logger.warn(\"MPEG2-TS detected but first sync word found @ offset \"+r+\", junk ahead ?\"),0))},e._syncOffset=function(e){for(var t=Math.min(1e3,e.length-564),r=0;r<t;){if(71===e[r]&&71===e[r+188]&&71===e[r+376])return r;r++}return-1},e.createTrack=function(e,t){return{container:\"video\"===e||\"audio\"===e?\"video/mp2t\":void 0,type:e,id:w[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:\"video\"===e?0:void 0,isAAC:\"audio\"===e||void 0,duration:\"audio\"===e?t:void 0}},t.resetInitSegment=function(t,r,n,i){this.pmtParsed=!1,this._pmtId=-1,this.pmtUnknownTypes={},this._avcTrack=e.createTrack(\"video\",i),this._audioTrack=e.createTrack(\"audio\",i),this._id3Track=e.createTrack(\"id3\",i),this._txtTrack=e.createTrack(\"text\",i),this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=r,this.videoCodec=n,this._duration=i},t.resetTimeStamp=function(){},t.append=function(t,r,a,o){var l,d,u,c,h,f=t.length,p=!1;this.pmtUnknownTypes={},this.contiguous=a;var m=this.pmtParsed,g=this._avcTrack,y=this._audioTrack,v=this._id3Track,_=g.pid,b=y.pid,E=v.pid,k=this._pmtId,w=g.pesData,S=y.pesData,T=v.pesData,x=this._parsePAT,L=this._parsePMT.bind(this),A=this._parsePES,R=this._parseAVCPES.bind(this),D=this._parseAACPES.bind(this),O=this._parseMPEGPES.bind(this),C=this._parseID3PES.bind(this),I=e._syncOffset(t);for(f-=(f+I)%188,l=I;l<f;l+=188)if(71===t[l]){if(d=!!(64&t[l+1]),u=((31&t[l+1])<<8)+t[l+2],1<(48&t[l+3])>>4){if((c=l+5+t[l+4])===l+188)continue}else c=l+4;switch(u){case _:d&&(w&&(h=A(w))&&R(h,!1),w={data:[],size:0}),w&&(w.data.push(t.subarray(c,l+188)),w.size+=l+188-c);break;case b:d&&(S&&(h=A(S))&&(y.isAAC?D:O)(h),S={data:[],size:0}),S&&(S.data.push(t.subarray(c,l+188)),S.size+=l+188-c);break;case E:d&&(T&&(h=A(T))&&C(h),T={data:[],size:0}),T&&(T.data.push(t.subarray(c,l+188)),T.size+=l+188-c);break;case 0:d&&(c+=t[c]+1),k=this._pmtId=x(t,c);break;case k:d&&(c+=t[c]+1);var M=L(t,c,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,null!=this.sampleAes);0<(_=M.avc)&&(g.pid=_),0<(b=M.audio)&&(y.pid=b,y.isAAC=M.isAAC),0<(E=M.id3)&&(v.pid=E),p&&!m&&(s.logger.log(\"reparse from beginning\"),p=!1,l=I-188),m=this.pmtParsed=!0;break;case 17:case 8191:break;default:p=!0}}else this.observer.trigger(n.default.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:\"TS packet did not start with 0x47\"});w&&(h=A(w))?(R(h,!0),g.pesData=null):g.pesData=w,S&&(h=A(S))?((y.isAAC?D:O)(h),y.pesData=null):(S&&S.size&&s.logger.log(\"last AAC PES packet truncated,might overlap between fragments\"),y.pesData=S),T&&(h=A(T))?(C(h),v.pesData=null):v.pesData=T,null==this.sampleAes?this.remuxer.remux(y,g,v,this._txtTrack,r,a,o):this.decryptAndRemux(y,g,v,this._txtTrack,r,a,o)},t.decryptAndRemux=function(e,t,r,n,i,a,o){var s;e.samples&&e.isAAC?(s=this).sampleAes.decryptAacSamples(e.samples,0,(function(){s.decryptAndRemuxAvc(e,t,r,n,i,a,o)})):this.decryptAndRemuxAvc(e,t,r,n,i,a,o)},t.decryptAndRemuxAvc=function(e,t,r,n,i,a,o){var s;t.samples?(s=this).sampleAes.decryptAvcSamples(t.samples,0,0,(function(){s.remuxer.remux(e,t,r,n,i,a,o)})):this.remuxer.remux(e,t,r,n,i,a,o)},t.destroy=function(){this._initPTS=this._initDTS=void 0,this._duration=0},t._parsePAT=function(e,t){return(31&e[t+10])<<8|e[t+11]},t._trackUnknownPmt=function(e,t,r){var n=this.pmtUnknownTypes[e]||0;return 0===n&&(this.pmtUnknownTypes[e]=0,t.call(s.logger,r)),this.pmtUnknownTypes[e]++,n},t._parsePMT=function(e,t,r,n){var i,a={audio:-1,avc:-1,id3:-1,isAAC:!0},o=t+3+((15&e[t+1])<<8|e[t+2])-4;for(t+=12+((15&e[t+10])<<8|e[t+11]);t<o;){switch(i=(31&e[t+1])<<8|e[t+2],e[t]){case 207:if(!n){this._trackUnknownPmt(e[t],s.logger.warn,\"ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream\");break}case 15:-1===a.audio&&(a.audio=i);break;case 21:-1===a.id3&&(a.id3=i);break;case 219:if(!n){this._trackUnknownPmt(e[t],s.logger.warn,\"H.264 with AES-128-CBC slice encryption found in unencrypted stream\");break}case 27:-1===a.avc&&(a.avc=i);break;case 3:case 4:r?-1===a.audio&&(a.audio=i,a.isAAC=!1):this._trackUnknownPmt(e[t],s.logger.warn,\"MPEG audio found, not supported in this browser\");break;case 36:this._trackUnknownPmt(e[t],s.logger.warn,\"Unsupported HEVC stream type found\");break;default:this._trackUnknownPmt(e[t],s.logger.log,\"Unknown stream type:\"+e[t])}t+=5+((15&e[t+3])<<8|e[t+4])}return a},t._parsePES=function(e){var t,r,n,i,a,o,l,d,u=0,c=e.data;if(!e||0===e.size)return null;for(;c[0].length<19&&1<c.length;){var h=new Uint8Array(c[0].length+c[1].length);h.set(c[0]),h.set(c[1],c[0].length),c[0]=h,c.splice(1,1)}if(1!==((t=c[0])[0]<<16)+(t[1]<<8)+t[2])return null;if((n=(t[4]<<8)+t[5])&&n>e.size-6)return null;if(192&(r=t[7])&&(o=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2,64&r?54e5<o-(l=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2)&&(s.logger.warn(Math.round((o-l)/9e4)+\"s delta between PTS and DTS, align them\"),o=l):l=o),d=(i=t[8])+9,e.size<=d)return null;e.size-=d,a=new Uint8Array(e.size);for(var f=0,p=c.length;f<p;f++){var m=(t=c[f]).byteLength;if(d){if(m<d){d-=m;continue}t=t.subarray(d),m-=d,d=0}a.set(t,u),u+=m}return n&&(n-=i+3),{data:a,pts:o,dts:l,len:n}},t.pushAccesUnit=function(e,t){if(e.units.length&&e.frame){var r=t.samples,n=r.length;if(isNaN(e.pts)){if(!n)return void t.dropped++;var i=r[n-1];e.pts=i.pts,e.dts=i.dts}!this.config.forceKeyFrameOnDiscontinuity||!0===e.key||t.sps&&(n||this.contiguous)?(e.id=n,r.push(e)):t.dropped++}e.debug.length&&s.logger.log(e.pts+\"/\"+e.dts+\":\"+e.debug)},t._parseAVCPES=function(e,t){function r(e,t,r,n){return{key:e,pts:t,dts:r,units:[],debug:n}}var n,i,a,o=this,s=this._avcTrack,l=this._parseAVCNALu(e.data),d=this.avcSample,u=!1,c=this.pushAccesUnit.bind(this);e.data=null,d&&l.length&&!s.audFound&&(c(d,s),d=this.avcSample=r(!1,e.pts,e.dts,\"\")),l.forEach((function(t){switch(t.type){case 1:i=!0,(d=d||(o.avcSample=r(!0,e.pts,e.dts,\"\"))).frame=!0;var l,h=t.data;u&&4<h.length&&(2!==(l=new E(h).readSliceType())&&4!==l&&7!==l&&9!==l||(d.key=!0));break;case 5:i=!0,(d=d||(o.avcSample=r(!0,e.pts,e.dts,\"\"))).key=!0,d.frame=!0;break;case 6:i=!0,(n=new E(o.discardEPB(t.data))).readUByte();for(var f=0,p=0,m=!1,y=0;!m&&1<n.bytesAvailable;){for(f=0;f+=y=n.readUByte(),255===y;);for(p=0;p+=y=n.readUByte(),255===y;);if(4===f&&0!==n.bytesAvailable){if(m=!0,181===n.readUByte()&&49===n.readUShort()&&1195456820===n.readUInt()&&3===n.readUByte()){var v=n.readUByte(),_=31&v,b=[v,n.readUByte()];for(a=0;a<_;a++)b.push(n.readUByte()),b.push(n.readUByte()),b.push(n.readUByte());o._insertSampleInOrder(o._txtTrack.samples,{type:3,pts:e.pts,bytes:b})}}else if(5===f&&0!==n.bytesAvailable){if(m=!0,16<p){var k=[];for(a=0;a<16;a++)k.push(n.readUByte().toString(16)),3!==a&&5!==a&&7!==a&&9!==a||k.push(\"-\");var w=p-16,S=new Uint8Array(w);for(a=0;a<w;a++)S[a]=n.readUByte();o._insertSampleInOrder(o._txtTrack.samples,{pts:e.pts,payloadType:f,uuid:k.join(\"\"),userDataBytes:S,userData:Object(g.utf8ArrayToStr)(S.buffer)})}}else if(p<n.bytesAvailable)for(a=0;a<p;a++)n.readUByte()}break;case 7:if(u=i=!0,!s.sps){var T=(n=new E(t.data)).readSPS();s.width=T.width,s.height=T.height,s.pixelRatio=T.pixelRatio,s.sps=[t.data],s.duration=o._duration;var x=t.data.subarray(1,4),L=\"avc1.\";for(a=0;a<3;a++){var A=x[a].toString(16);A.length<2&&(A=\"0\"+A),L+=A}s.codec=L}break;case 8:i=!0,s.pps||(s.pps=[t.data]);break;case 9:i=!1,s.audFound=!0,d&&c(d,s),d=o.avcSample=r(!1,e.pts,e.dts,\"\");break;case 12:i=!1;break;default:i=!1,d&&(d.debug+=\"unknown NAL \"+t.type+\" \")}d&&i&&d.units.push(t)})),t&&d&&(c(d,s),this.avcSample=null)},t._insertSampleInOrder=function(e,t){var r=e.length;if(0<r){if(t.pts>=e[r-1].pts)e.push(t);else for(var n=r-1;0<=n;n--)if(t.pts<e[n].pts){e.splice(n,0,t);break}}else e.push(t)},t._getLastNalUnit=function(){var e,t,r,n=this.avcSample;return n&&0!==n.units.length||(n=(e=this._avcTrack.samples)[e.length-1]),n&&(r=(t=n.units)[t.length-1]),r},t._parseAVCNALu=function(e){var t,r,n,i,a,o=0,s=e.byteLength,l=this._avcTrack,d=p=l.naluState||0,u=[],c=-1;for(-1===p&&(n=31&e[c=0],p=0,o=1);o<s;){var h,f,p,m=e[o++];p=p?1!==p?m?1===m?(0<=c?(r={data:e.subarray(c,o-p-1),type:n},u.push(r)):(h=this._getLastNalUnit())&&(d&&o<=4-d&&h.state&&(h.data=h.data.subarray(0,h.data.byteLength-d)),0<(t=o-p-1)&&((f=new Uint8Array(h.data.byteLength+t)).set(h.data,0),f.set(e.subarray(0,t),h.data.byteLength),h.data=f)),o<s?(n=31&e[c=o],0):-1):0:3:m?0:2:m?0:1}return 0<=c&&0<=p&&(r={data:e.subarray(c,s),type:n,state:p},u.push(r)),0!==u.length||(i=this._getLastNalUnit())&&((a=new Uint8Array(i.data.byteLength+e.byteLength)).set(i.data,0),a.set(e,i.data.byteLength),i.data=a),l.naluState=p,u},t.discardEPB=function(e){for(var t,r,n=e.byteLength,i=[],a=1;a<n-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(i.push(a+2),a+=2):a++;if(0===i.length)return e;t=n-i.length,r=new Uint8Array(t);var o=0;for(a=0;a<t;o++,a++)o===i[0]&&(o++,i.shift()),r[a]=e[o];return r},t._parseAACPES=function(e){var t,r,a,o,l,d,u,c=this._audioTrack,g=e.data,y=e.pts,v=this.aacOverFlow,_=this.aacLastPTS;for(v&&((d=new Uint8Array(v.byteLength+g.byteLength)).set(v,0),d.set(g,v.byteLength),g=d),a=0,l=g.length;a<l-1&&!h(g,a);a++);if(a){var b,E=a<l-1?(b=\"AAC PES did not start with ADTS header,offset:\"+a,!1):(b=\"no ADTS header found in AAC PES\",!0);if(s.logger.warn(\"parsing error:\"+b),this.observer.trigger(n.default.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.FRAG_PARSING_ERROR,fatal:E,reason:b}),E)return}for(f(c,this.observer,g,a,this.audioCodec),r=0,t=p(c.samplerate),v&&_&&(u=_+t,1<Math.abs(u-y)&&(s.logger.log(\"AAC: align PTS for overlapping frames by \"+Math.round((u-y)/90)),y=u));a<l;){if(h(g,a)){if(a+5<l){var k=m(c,g,a,y,r);if(k){a+=k.length,o=k.sample.pts,r++;continue}}break}a++}v=a<l?g.subarray(a,l):null,this.aacOverFlow=v,this.aacLastPTS=o},t._parseMPEGPES=function(e){for(var t=e.data,r=t.length,n=0,i=0,a=e.pts;i<r;)if(b.isHeader(t,i)){var o=b.appendFrame(this._audioTrack,t,i,a,n);if(!o)break;i+=o.length,n++}else i++},t._parseID3PES=function(e){this._id3Track.samples.push(e)},e}(),T=function(){function e(e,t,r){this.observer=e,this.config=r,this.remuxer=t}var t=e.prototype;return t.resetInitSegment=function(e,t,r,n){this._audioTrack={container:\"audio/mpeg\",type:\"audio\",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:t,duration:n,inputTimeScale:9e4}},t.resetTimeStamp=function(){},e.probe=function(e){var t,r,n=g.default.getID3Data(e,0);if(n&&void 0!==g.default.getTimeStamp(n))for(t=n.length,r=Math.min(e.length-1,t+100);t<r;t++)if(b.probe(e,t))return s.logger.log(\"MPEG Audio sync word found !\"),!0;return!1},t.append=function(e,t,r,n){for(var i=g.default.getID3Data(e,0),a=g.default.getTimeStamp(i),o=void 0!==a?90*a:9e4*t,s=i.length,l=e.length,d=0,u=0,c=this._audioTrack,h=[{pts:o,dts:o,data:i}];s<l;)if(b.isHeader(e,s)){var f=b.appendFrame(c,e,s,o,d);if(!f)break;s+=f.length,u=f.sample.pts,d++}else g.default.isHeader(e,s)?(i=g.default.getID3Data(e,s),h.push({pts:u,dts:u,data:i}),s+=i.length):s++;this.remuxer.remux(c,{samples:[]},{samples:h,inputTimeScale:9e4},{samples:[]},t,r,n)},t.destroy=function(){},e}(),x=function(){function e(){}return e.getSilentFrame=function(e,t){if(\"mp4a.40.2\"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},e}(),L=Math.pow(2,32)-1,A=function(){function e(){}return e.init=function(){var t;for(t in e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],\".mp3\":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]})e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var r=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:r,audio:n};var i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=a,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var o=new Uint8Array([105,115,111,109]),s=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,o,l,o,s),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,i))},e.box=function(e){for(var t,r=Array.prototype.slice.call(arguments,1),n=8,i=r.length,a=i;i--;)n+=r[i].byteLength;for((t=new Uint8Array(n))[0]=n>>24&255,t[1]=n>>16&255,t[2]=n>>8&255,t[3]=255&n,t.set(e,4),i=0,n=8;i<a;i++)t.set(r[i],n),n+=r[i].byteLength;return t},e.hdlr=function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])},e.mdat=function(t){return e.box(e.types.mdat,t)},e.mdhd=function(t,r){r*=t;var n=Math.floor(r/(1+L)),i=Math.floor(r%(1+L));return e.box(e.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i,85,196,0,0]))},e.mdia=function(t){return e.box(e.types.mdia,e.mdhd(t.timescale,t.duration),e.hdlr(t.type),e.minf(t))},e.mfhd=function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))},e.minf=function(t){return\"audio\"===t.type?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))},e.moof=function(t,r,n){return e.box(e.types.moof,e.mfhd(t),e.traf(n,r))},e.moov=function(t){for(var r=t.length,n=[];r--;)n[r]=e.trak(t[r]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale,t[0].duration)].concat(n).concat(e.mvex(t)))},e.mvex=function(t){for(var r=t.length,n=[];r--;)n[r]=e.trex(t[r]);return e.box.apply(null,[e.types.mvex].concat(n))},e.mvhd=function(t,r){r*=t;var n=Math.floor(r/(1+L)),i=Math.floor(r%(1+L)),a=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,a)},e.sdtp=function(t){for(var r,n=t.samples||[],i=new Uint8Array(4+n.length),a=0;a<n.length;a++)r=n[a].flags,i[a+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return e.box(e.types.sdtp,i)},e.stbl=function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))},e.avc1=function(t){for(var r,n,i=[],a=[],o=0;o<t.sps.length;o++)n=(r=t.sps[o]).byteLength,i.push(n>>>8&255),i.push(255&n),i=i.concat(Array.prototype.slice.call(r));for(o=0;o<t.pps.length;o++)n=(r=t.pps[o]).byteLength,a.push(n>>>8&255),a.push(255&n),a=a.concat(Array.prototype.slice.call(r));var s=e.box(e.types.avcC,new Uint8Array([1,i[3],i[4],i[5],255,224|t.sps.length].concat(i).concat([t.pps.length]).concat(a))),l=t.width,d=t.height,u=t.pixelRatio[0],c=t.pixelRatio[1];return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,255&l,d>>8&255,255&d,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([u>>24,u>>16&255,u>>8&255,255&u,c>>24,c>>16&255,c>>8&255,255&c])))},e.esds=function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))},e.mp4a=function(t){var r=t.samplerate;return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]),e.box(e.types.esds,e.esds(t)))},e.mp3=function(t){var r=t.samplerate;return e.box(e.types[\".mp3\"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]))},e.stsd=function(t){return\"audio\"===t.type?t.isAAC||\"mp3\"!==t.codec?e.box(e.types.stsd,e.STSD,e.mp4a(t)):e.box(e.types.stsd,e.STSD,e.mp3(t)):e.box(e.types.stsd,e.STSD,e.avc1(t))},e.tkhd=function(t){var r=t.id,n=t.duration*t.timescale,i=t.width,a=t.height,o=Math.floor(n/(1+L)),s=Math.floor(n%(1+L));return e.box(e.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,r>>24&255,r>>16&255,r>>8&255,255&r,0,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,s>>24,s>>16&255,s>>8&255,255&s,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,255&i,0,0,a>>8&255,255&a,0,0]))},e.traf=function(t,r){var n=e.sdtp(t),i=t.id,a=Math.floor(r/(1+L)),o=Math.floor(r%(1+L));return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i])),e.box(e.types.tfdt,new Uint8Array([1,0,0,0,a>>24,a>>16&255,a>>8&255,255&a,o>>24,o>>16&255,o>>8&255,255&o])),e.trun(t,n.length+16+20+8+16+8+8),n)},e.trak=function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))},e.trex=function(t){var r=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},e.trun=function(t,r){var n,i,a,o,s,l,d=t.samples||[],u=d.length,c=12+16*u,h=new Uint8Array(c);for(r+=8+c,h.set([0,0,15,1,u>>>24&255,u>>>16&255,u>>>8&255,255&u,r>>>24&255,r>>>16&255,r>>>8&255,255&r],0),n=0;n<u;n++)a=(i=d[n]).duration,o=i.size,s=i.flags,l=i.cts,h.set([a>>>24&255,a>>>16&255,a>>>8&255,255&a,o>>>24&255,o>>>16&255,o>>>8&255,255&o,s.isLeading<<2|s.dependsOn,s.isDependedOn<<6|s.hasRedundancy<<4|s.paddingValue<<1|s.isNonSync,61440&s.degradPrio,15&s.degradPrio,l>>>24&255,l>>>16&255,l>>>8&255,255&l],12+16*n);return e.box(e.types.trun,h)},e.initSegment=function(t){e.types||e.init();var r=e.moov(t),n=new Uint8Array(e.FTYP.byteLength+r.byteLength);return n.set(e.FTYP),n.set(r,e.FTYP.byteLength),n},e}();function R(e,t,r,n){void 0===r&&(r=1),void 0===n&&(n=!1);var i=e*t*r;return n?Math.round(i):i}function D(e,t){return void 0===t&&(t=!1),R(e,1e3,1/9e4,t)}function O(e,t){return void 0===t&&(t=1),R(e,9e4,1/t)}var C=O(10),I=O(.2),M=null;function P(e,t){var r;if(void 0===t)return e;for(r=t<e?-8589934592:8589934592;4294967296<Math.abs(e-t);)e+=r;return e}var B,F=function(){function e(e,t,r,n){var i;this.observer=e,this.config=t,this.typeSupported=r,this.ISGenerated=!1,null===M&&(i=navigator.userAgent.match(/Chrome\\/(\\d+)/i),M=i?parseInt(i[1]):0)}var t=e.prototype;return t.destroy=function(){},t.resetTimeStamp=function(e){this._initPTS=this._initDTS=e},t.resetInitSegment=function(){this.ISGenerated=!1},t.getVideoStartPts=function(e){var t=!1,r=e.reduce((function(e,r){var n=r.pts-e;return n<-4294967296?(t=!0,e):0<n?e:r.pts}),e[0].pts);return t&&s.logger.debug(\"PTS rollover detected\"),r},t.remux=function(e,t,r,i,a,o,l){var d,u,c,h,f,p,m,g,y;this.ISGenerated||this.generateIS(e,t,a),this.ISGenerated&&(d=e.samples.length,u=t.samples.length,h=c=a,d&&u&&(f=this.getVideoStartPts(t.samples),p=(e.samples[0].pts-f)/t.inputTimeScale,c+=Math.max(0,p),h+=Math.max(0,-p)),d?(e.timescale||(s.logger.warn(\"regenerate InitSegment as audio detected\"),this.generateIS(e,t,a)),m=this.remuxAudio(e,c,o,l),u&&(m&&(g=m.endPTS-m.startPTS),t.timescale||(s.logger.warn(\"regenerate InitSegment as video detected\"),this.generateIS(e,t,a)),this.remuxVideo(t,h,o,g))):!u||(y=this.remuxVideo(t,h,o,0,l))&&e.codec&&this.remuxEmptyAudio(e,c,o,y)),r.samples.length&&this.remuxID3(r,a),i.samples.length&&this.remuxText(i,a),this.observer.trigger(n.default.FRAG_PARSED)},t.generateIS=function(e,t,r){var a,o,l,d,u,c=this.observer,h=e.samples,f=t.samples,p=this.typeSupported,m=\"audio/mp4\",g={},y={tracks:g},v=void 0===this._initPTS;v&&(u=d=1/0),e.config&&h.length&&(e.timescale=e.samplerate,s.logger.log(\"audio sampling rate : \"+e.samplerate),e.isAAC||(p.mpeg?(m=\"audio/mpeg\",e.codec=\"\"):p.mp3&&(e.codec=\"mp3\")),g.audio={container:m,codec:e.codec,initSegment:!e.isAAC&&p.mpeg?new Uint8Array:A.initSegment([e]),metadata:{channelCount:e.channelCount}},v&&(u=d=h[0].pts-Math.round(e.inputTimeScale*r))),t.sps&&t.pps&&f.length?(a=t.inputTimeScale,t.timescale=a,g.video={container:\"video/mp4\",codec:t.codec,initSegment:A.initSegment([t]),metadata:{width:t.width,height:t.height}},v&&(o=this.getVideoStartPts(f),l=Math.round(a*r),d=Math.min(d,f[0].dts-l),u=Math.min(u,o-l),this.observer.trigger(n.default.INIT_PTS_FOUND,{initPTS:u}))):v&&g.audio&&this.observer.trigger(n.default.INIT_PTS_FOUND,{initPTS:u}),Object.keys(g).length?(c.trigger(n.default.FRAG_PARSING_INIT_SEGMENT,y),this.ISGenerated=!0,v&&(this._initPTS=u,this._initDTS=d)):c.trigger(n.default.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:\"no audio/video samples found\"})},t.remuxVideo=function(e,t,r,a){var o,l,d,u,c,h=e.timescale,f=e.samples,p=[],m=f.length,g=this._initPTS,y=8,v=Number.POSITIVE_INFINITY,_=Number.NEGATIVE_INFINITY,b=0,E=!1,k=this.nextAvcDts;if(0!==m){r||(k=t*h-(f[0].pts-P(f[0].dts,f[0].pts)));for(var w=0;w<m;w++){var S=f[w];S.pts=P(S.pts-g,k),S.dts=P(S.dts-g,k),S.dts>S.pts&&(b=Math.max(Math.min(b,S.pts-S.dts),-1*I)),S.dts<f[0<w?w-1:w].dts&&(E=!0)}E&&f.sort((function(e,t){var r=e.dts-t.dts,n=e.pts-t.pts;return r||n||e.id-t.id})),u=f[0].dts,c=f[m-1].dts;var T,x,L,R=Math.round((c-u)/(m-1));if(b<0){if(b<-2*R){s.logger.warn(\"PTS < DTS detected in video samples, offsetting DTS to PTS \"+D(-R,!0)+\" ms\");for(var O=0;O<m;O++)f[O].dts=f[O].pts-R}else{s.logger.warn(\"PTS < DTS detected in video samples, shifting DTS by \"+D(b,!0)+\" ms to overcome this issue\");for(var C=0;C<m;C++)f[C].dts=f[C].dts+b}u=f[0].dts,c=f[m-1].dts}!r||((x=R<(T=u-k))||T<-1)&&(x?s.logger.warn(\"AVC: \"+D(T,!0)+\" ms (\"+T+\"dts) hole between fragments detected, filling it\"):s.logger.warn(\"AVC: \"+D(-T,!0)+\" ms (\"+T+\"dts) overlapping between fragments detected\"),u=k,L=f[0].pts-T,f[0].dts=u,f[0].pts=L,s.logger.log(\"Video: First PTS/DTS adjusted: \"+D(L,!0)+\"/\"+D(u,!0)+\", delta: \"+D(T,!0)+\" ms\")),M&&M<75&&(u=Math.max(0,u));for(var B=0,F=0,U=0;U<m;U++){for(var N=f[U],j=N.units,G=j.length,z=0,q=0;q<G;q++)z+=j[q].data.length;F+=z,B+=G,N.length=z,N.dts=Math.max(N.dts,u),N.pts=Math.max(N.pts,N.dts,0),v=Math.min(N.pts,v),_=Math.max(N.pts,_)}c=f[m-1].dts;var V=F+4*B+8;try{l=new Uint8Array(V)}catch(e){return void this.observer.trigger(n.default.ERROR,{type:i.ErrorTypes.MUX_ERROR,details:i.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:V,reason:\"fail allocating video mdat \"+V})}var Y=new DataView(l.buffer);Y.setUint32(0,V),l.set(A.types.mdat,4);for(var H=0;H<m;H++){for(var K,W,X,$,Q,J=f[H],Z=J.units,ee=0,te=0,re=Z.length;te<re;te++){var ne=Z[te],ie=ne.data,ae=ne.data.byteLength;Y.setUint32(y,ae),y+=4,l.set(ie,y),y+=ae,ee+=4+ae}H<m-1?o=f[H+1].dts-J.dts:(W=this.config,X=J.dts-f[0<H?H-1:H].dts,W.stretchShortVideoTrack?($=W.maxBufferHole,Math.floor($*h)<(Q=(a?v+a*h:this.nextAudioPts)-J.pts)?((o=Q-X)<0&&(o=X),s.logger.log(\"It is approximately \"+D(Q,!1)+\" ms to the next segment; using duration \"+D(o,!1)+\" ms for the last video frame.\")):o=X):o=X),K=Math.round(J.pts-J.dts),p.push({size:ee,duration:o,cts:K,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:J.key?2:1,isNonSync:J.key?0:1}})}this.nextAvcDts=c+o;var oe,se=e.dropped;e.nbNalu=0,e.dropped=0,p.length&&-1<navigator.userAgent.toLowerCase().indexOf(\"chrome\")&&((oe=p[0].flags).dependsOn=2,oe.isNonSync=0),e.samples=p,d=A.moof(e.sequenceNumber++,u,e),e.samples=[];var le={data1:d,data2:l,startPTS:v/h,endPTS:(_+o)/h,startDTS:u/h,endDTS:this.nextAvcDts/h,type:\"video\",hasAudio:!1,hasVideo:!0,nb:p.length,dropped:se};return this.observer.trigger(n.default.FRAG_PARSING_DATA,le),le}},t.remuxAudio=function(e,t,r,a){var o,l,d,u,c,h=e.inputTimeScale,f=e.timescale,p=h/f,m=(e.isAAC?1024:1152)*p,g=this._initPTS,y=!e.isAAC&&this.typeSupported.mpeg,v=y?0:8,_=e.samples,b=[],E=this.nextAudioPts;if(r|=_.length&&E&&(a&&Math.abs(t-E/h)<.1||Math.abs(_[0].pts-E-g)<20*m),_.forEach((function(e){e.pts=e.dts=P(e.pts-g,t*h)})),0!==(_=_.filter((function(e){return 0<=e.pts}))).length){if(r||(E=a?Math.max(0,t*h):_[0].pts),e.isAAC)for(var k=this.config.maxAudioFramesDrift,w=0,S=E;w<_.length;){var T=_[w],L=T.pts,R=L-S;if(R<=-k*m)r||0<w?(s.logger.warn(\"Dropping 1 audio frame @ \"+D(S,!0)/1e3+\"s due to \"+D(R,!0)+\" ms overlap.\"),_.splice(w,1)):(s.logger.warn(\"Audio frame @ \"+D(L,!0)/1e3+\"s overlaps nextAudioPts by \"+D(R,!0)+\" ms.\"),S=L+m,w++);else if(k*m<=R&&R<C&&S){var O=Math.round(R/m);s.logger.warn(\"Injecting \"+O+\" audio frames @ \"+D(S,!0)/1e3+\"s due to \"+D(R,!0)+\" ms gap.\");for(var I=0;I<O;I++){var M,B=Math.max(S,0);(M=x.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(s.logger.log(\"Unable to get silent frame for given audio codec; duplicating last frame instead.\"),M=T.unit.subarray()),_.splice(w,0,{unit:M,pts:B,dts:B}),S+=m,w++}T.pts=T.dts=S,S+=m,w++}else Math.abs(R),T.pts=T.dts=S,S+=m,w++}for(var F=_.length,U=0;F--;)U+=_[F].unit.byteLength;for(var N=0,j=_.length;N<j;N++){var G=_[N],z=G.unit,q=G.pts;if(void 0!==c&&o)o.duration=Math.round((q-c)/p);else{var V=q-E,Y=0;if(r&&e.isAAC&&V){if(0<V&&V<C)Y=Math.round((q-E)/m),s.logger.log(D(V,!0)+\" ms hole between AAC samples detected,filling it\"),0<Y&&(U+=Y*(M=(M=x.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||z.subarray()).length);else if(V<-12){s.logger.log(\"drop overlapping AAC sample, expected/parsed/delta: \"+D(E,!0)+\" ms / \"+D(q,!0)+\" ms / \"+D(-V,!0)+\" ms\"),U-=z.byteLength;continue}q=E}if(u=q,!(0<U))return;U+=v;try{l=new Uint8Array(U)}catch(e){return void this.observer.trigger(n.default.ERROR,{type:i.ErrorTypes.MUX_ERROR,details:i.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:U,reason:\"fail allocating audio mdat \"+U})}y||(new DataView(l.buffer).setUint32(0,U),l.set(A.types.mdat,4));for(var H=0;H<Y;H++)(M=x.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(s.logger.log(\"Unable to get silent frame for given audio codec; duplicating this frame instead.\"),M=z.subarray()),l.set(M,v),v+=M.byteLength,o={size:M.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},b.push(o)}l.set(z,v);var K=z.byteLength;v+=K,o={size:K,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},b.push(o),c=q}var W=0;if(2<=(F=b.length)&&(W=b[F-2].duration,o.duration=W),F){this.nextAudioPts=E=c+p*W,e.samples=b,d=y?new Uint8Array:A.moof(e.sequenceNumber++,u/p,e),e.samples=[];var X=u/h,$=E/h,Q={data1:d,data2:l,startPTS:X,endPTS:$,startDTS:X,endDTS:$,type:\"audio\",hasAudio:!0,hasVideo:!1,nb:F};return this.observer.trigger(n.default.FRAG_PARSING_DATA,Q),Q}return null}},t.remuxEmptyAudio=function(e,t,r,n){var i=e.inputTimeScale,a=i/(e.samplerate?e.samplerate:i),o=this.nextAudioPts,l=(void 0!==o?o:n.startDTS*i)+this._initDTS,d=n.endDTS*i+this._initDTS,u=1024*a,c=Math.ceil((d-l)/u),h=x.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(s.logger.warn(\"remux empty Audio\"),h){for(var f=[],p=0;p<c;p++){var m=l+p*u;f.push({unit:h,pts:m,dts:m})}e.samples=f,this.remuxAudio(e,t,r)}else s.logger.trace(\"Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!\")},t.remuxID3=function(e,t){var r=e.samples.length;if(r){for(var i=e.inputTimeScale,a=this._initPTS,o=this._initDTS,s=0;s<r;s++){var l=e.samples[s];l.pts=P(l.pts-a,t*i)/i,l.dts=P(l.dts-o,t*i)/i}this.observer.trigger(n.default.FRAG_PARSING_METADATA,{samples:e.samples}),e.samples=[]}},t.remuxText=function(e,t){var r=e.samples.length,i=e.inputTimeScale,a=this._initPTS;if(r){for(var o=0;o<r;o++){var s=e.samples[o];s.pts=P(s.pts-a,t*i)/i}e.samples.sort((function(e,t){return e.pts-t.pts})),this.observer.trigger(n.default.FRAG_PARSING_USERDATA,{samples:e.samples})}e.samples=[]},e}(),U=function(){function e(e){this.observer=e}var t=e.prototype;return t.destroy=function(){},t.resetTimeStamp=function(){},t.resetInitSegment=function(){},t.remux=function(e,t,r,i,a,o,s,l){var d=this.observer,u=\"\";e&&(u+=\"audio\"),t&&(u+=\"video\"),d.trigger(n.default.FRAG_PARSING_DATA,{data1:l,startPTS:a,startDTS:a,type:u,hasAudio:!!e,hasVideo:!!t,nb:1,dropped:0}),d.trigger(n.default.FRAG_PARSED)},e}(),N=Object(l.getSelfScope)();try{B=N.performance.now.bind(N.performance)}catch(e){s.logger.debug(\"Unable to use Performance API on this environment\"),B=N.Date.now}var j=function(){function e(e,t,r,n){this.observer=e,this.typeSupported=t,this.config=r,this.vendor=n}var t=e.prototype;return t.destroy=function(){var e=this.demuxer;e&&e.destroy()},t.push=function(e,t,r,i,o,s,l,d,u,c,h,f){var p,m,g=this;0<e.byteLength&&null!=t&&null!=t.key&&\"AES-128\"===t.method?(null==(p=this.decrypter)&&(p=this.decrypter=new a.default(this.observer,this.config)),m=B(),p.decrypt(e,t.key.buffer,t.iv.buffer,(function(e){var a=B();g.observer.trigger(n.default.FRAG_DECRYPTED,{stats:{tstart:m,tdecrypt:a}}),g.pushDecrypted(new Uint8Array(e),t,new Uint8Array(r),i,o,s,l,d,u,c,h,f)}))):this.pushDecrypted(new Uint8Array(e),t,new Uint8Array(r),i,o,s,l,d,u,c,h,f)},t.pushDecrypted=function(e,t,r,a,o,s,l,d,u,c,h,f){var p=this.demuxer,m=this.remuxer;if(!p||l||d){for(var g,_=this.observer,b=this.typeSupported,E=this.config,k=[{demux:S,remux:F},{demux:v.default,remux:U},{demux:y,remux:F},{demux:T,remux:F}],w=0,x=k.length;w<x&&!(g=k[w]).demux.probe(e);w++);if(!g)return void _.trigger(n.default.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:\"no demux matching with content found\"});m&&m instanceof g.remux||(m=new g.remux(_,E,b,this.vendor)),p&&p instanceof g.demux||(p=new g.demux(_,m,E,b),this.probe=g.demux.probe),this.demuxer=p,this.remuxer=m}(l||d)&&(p.resetInitSegment(r,a,o,c),m.resetInitSegment()),l&&(p.resetTimeStamp(f),m.resetTimeStamp(f)),\"function\"==typeof p.setDecryptData&&p.setDecryptData(t),p.append(e,s,u,h)},e}();t.default=j},\"./src/demux/demuxer-worker.js\":\n/*!*************************************!*\\\n  !*** ./src/demux/demuxer-worker.js ***!\n  \\*************************************/\n/*! exports provided: default */\n/*! ModuleConcatenation bailout: Module is referenced from these modules with unsupported syntax: ./src/demux/demuxer.js (referenced with require.resolve) */function(e,t,r){\"use strict\";r.r(t);var n=r(/*! ../demux/demuxer-inline */\"./src/demux/demuxer-inline.js\"),i=r(/*! ../events */\"./src/events.js\"),a=r(/*! ../utils/logger */\"./src/utils/logger.js\"),o=r(/*! eventemitter3 */\"./node_modules/eventemitter3/index.js\");t.default=function(e){var t=new o.EventEmitter;function r(t,r){e.postMessage({event:t,data:r})}t.trigger=function(e){for(var r=arguments.length,n=new Array(1<r?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];t.emit.apply(t,[e,e].concat(n))},t.off=function(e){for(var r=arguments.length,n=new Array(1<r?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];t.removeListener.apply(t,[e].concat(n))},e.addEventListener(\"message\",(function(i){var o=i.data;switch(o.cmd){case\"init\":var s=JSON.parse(o.config);e.demuxer=new n.default(t,o.typeSupported,s,o.vendor),Object(a.enableLogs)(s.debug),r(\"init\",null);break;case\"demux\":e.demuxer.push(o.data,o.decryptdata,o.initSegment,o.audioCodec,o.videoCodec,o.timeOffset,o.discontinuity,o.trackSwitch,o.contiguous,o.duration,o.accurateTimeOffset,o.defaultInitPTS)}})),t.on(i.default.FRAG_DECRYPTED,r),t.on(i.default.FRAG_PARSING_INIT_SEGMENT,r),t.on(i.default.FRAG_PARSED,r),t.on(i.default.ERROR,r),t.on(i.default.FRAG_PARSING_METADATA,r),t.on(i.default.FRAG_PARSING_USERDATA,r),t.on(i.default.INIT_PTS_FOUND,r),t.on(i.default.FRAG_PARSING_DATA,(function(t,r){var n=[],i={event:t,data:r};r.data1&&(i.data1=r.data1.buffer,n.push(r.data1.buffer),delete r.data1),r.data2&&(i.data2=r.data2.buffer,n.push(r.data2.buffer),delete r.data2),e.postMessage(i,n)}))}},\"./src/demux/id3.js\":\n/*!**************************!*\\\n  !*** ./src/demux/id3.js ***!\n  \\**************************/\n/*! exports provided: default, utf8ArrayToStr */function(e,t,r){\"use strict\";r.r(t),r.d(t,\"utf8ArrayToStr\",(function(){return o}));var n,i=r(/*! ../utils/get-self-scope */\"./src/utils/get-self-scope.js\"),a=function(){function e(){}return e.isHeader=function(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},e.isFooter=function(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},e.getID3Data=function(t,r){for(var n=r,i=0;e.isHeader(t,r);)i+=10,i+=e._readSize(t,r+6),e.isFooter(t,r+10)&&(i+=10),r+=i;if(0<i)return t.subarray(n,n+i)},e._readSize=function(e,t){var r=(127&e[t])<<21;return r|=(127&e[t+1])<<14,(r|=(127&e[t+2])<<7)|127&e[t+3]},e.getTimeStamp=function(t){for(var r=e.getID3Frames(t),n=0;n<r.length;n++){var i=r[n];if(e.isTimeStampFrame(i))return e._readTimeStamp(i)}},e.isTimeStampFrame=function(e){return e&&\"PRIV\"===e.key&&\"com.apple.streaming.transportStreamTimestamp\"===e.info},e._getFrameData=function(t){var r=String.fromCharCode(t[0],t[1],t[2],t[3]),n=e._readSize(t,4);return{type:r,size:n,data:t.subarray(10,10+n)}},e.getID3Frames=function(t){for(var r=0,n=[];e.isHeader(t,r);){for(var i=e._readSize(t,r+6),a=(r+=10)+i;r+8<a;){var o=e._getFrameData(t.subarray(r)),s=e._decodeFrame(o);s&&n.push(s),r+=o.size+10}e.isFooter(t,r)&&(r+=10)}return n},e._decodeFrame=function(t){return\"PRIV\"===t.type?e._decodePrivFrame(t):\"T\"===t.type[0]?e._decodeTextFrame(t):\"W\"===t.type[0]?e._decodeURLFrame(t):void 0},e._readTimeStamp=function(e){if(8===e.data.byteLength){var t=new Uint8Array(e.data),r=1&t[3],n=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return n/=45,r&&(n+=47721858.84),Math.round(n)}},e._decodePrivFrame=function(t){if(!(t.size<2)){var r=e._utf8ArrayToStr(t.data,!0),n=new Uint8Array(t.data.subarray(r.length+1));return{key:t.type,info:r,data:n.buffer}}},e._decodeTextFrame=function(t){if(!(t.size<2)){if(\"TXXX\"===t.type){var r=1,n=e._utf8ArrayToStr(t.data.subarray(1),!0);r+=n.length+1;var i=e._utf8ArrayToStr(t.data.subarray(r));return{key:t.type,info:n,data:i}}var a=e._utf8ArrayToStr(t.data.subarray(1));return{key:t.type,data:a}}},e._decodeURLFrame=function(t){if(\"WXXX\"===t.type){if(t.size<2)return;var r=1,n=e._utf8ArrayToStr(t.data.subarray(1));r+=n.length+1;var i=e._utf8ArrayToStr(t.data.subarray(r));return{key:t.type,info:n,data:i}}var a=e._utf8ArrayToStr(t.data);return{key:t.type,data:a}},e._utf8ArrayToStr=function(e,t){void 0===t&&(t=!1);var r=function(){var e=Object(i.getSelfScope)();return n||void 0===e.TextDecoder||(n=new e.TextDecoder(\"utf-8\")),n}();if(r){var a=r.decode(e);if(t){var o=a.indexOf(\"\\0\");return-1!==o?a.substring(0,o):a}return a.replace(/\\0/g,\"\")}for(var s,l,d,u=e.length,c=\"\",h=0;h<u;){if(0===(s=e[h++])&&t)return c;if(0!==s&&3!==s)switch(s>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:c+=String.fromCharCode(s);break;case 12:case 13:l=e[h++],c+=String.fromCharCode((31&s)<<6|63&l);break;case 14:l=e[h++],d=e[h++],c+=String.fromCharCode((15&s)<<12|(63&l)<<6|(63&d)<<0)}}return c},e}(),o=a._utf8ArrayToStr;t.default=a},\"./src/demux/mp4demuxer.js\":\n/*!*********************************!*\\\n  !*** ./src/demux/mp4demuxer.js ***!\n  \\*********************************/\n/*! exports provided: default */function(e,t,r){\"use strict\";r.r(t);var n=r(/*! ../utils/logger */\"./src/utils/logger.js\"),i=r(/*! ../events */\"./src/events.js\"),a=Math.pow(2,32)-1,o=function(){function e(e,t){this.observer=e,this.remuxer=t}var t=e.prototype;return t.resetTimeStamp=function(e){this.initPTS=e},t.resetInitSegment=function(t,r,n,a){var o,s;t&&t.byteLength?(null==r&&(r=\"mp4a.40.5\"),null==n&&(n=\"avc1.42e01e\"),s={},(o=this.initData=e.parseInitSegment(t)).audio&&o.video?s.audiovideo={container:\"video/mp4\",codec:r+\",\"+n,initSegment:a?t:null}:(o.audio&&(s.audio={container:\"audio/mp4\",codec:r,initSegment:a?t:null}),o.video&&(s.video={container:\"video/mp4\",codec:n,initSegment:a?t:null})),this.observer.trigger(i.default.FRAG_PARSING_INIT_SEGMENT,{tracks:s})):(r&&(this.audioCodec=r),n&&(this.videoCodec=n))},e.probe=function(t){return 0<e.findBox({data:t,start:0,end:Math.min(t.length,16384)},[\"moof\"]).length},e.bin2str=function(e){return String.fromCharCode.apply(null,e)},e.readUint16=function(e,t){e.data&&(t+=e.start,e=e.data);var r=e[t]<<8|e[t+1];return r<0?65536+r:r},e.readUint32=function(e,t){e.data&&(t+=e.start,e=e.data);var r=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3];return r<0?4294967296+r:r},e.writeUint32=function(e,t,r){e.data&&(t+=e.start,e=e.data),e[t]=r>>24,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r},e.findBox=function(t,r){var n,i,a,o,s,l,d=[];if(t.data?(s=t.start,a=t.end,t=t.data):(s=0,a=t.byteLength),!r.length)return null;for(n=s;n<a;)l=1<(i=e.readUint32(t,n))?n+i:a,e.bin2str(t.subarray(n+4,n+8))===r[0]&&(1===r.length?d.push({data:t,start:n+8,end:l}):(o=e.findBox({data:t,start:n+8,end:l},r.slice(1))).length&&(d=d.concat(o))),n=l;return d},e.parseSegmentIndex=function(t){var r,n=e.findBox(t,[\"moov\"])[0],i=n?n.end:null,a=0,o=e.findBox(t,[\"sidx\"]);if(!o||!o[0])return null;r=[];var s=(o=o[0]).data[0],l=e.readUint32(o,a=0===s?8:16);a+=4,a+=0===s?8:16,a+=2;var d=o.end+0,u=e.readUint16(o,a);a+=2;for(var c=0;c<u;c++){var h=a,f=e.readUint32(o,h);h+=4;var p=2147483647&f;if(1==(2147483648&f)>>>31)return void console.warn(\"SIDX has hierarchical references (not supported)\");var m=e.readUint32(o,h);h+=4,r.push({referenceSize:p,subsegmentDuration:m,info:{duration:m/l,start:d,end:d+p-1}}),d+=p,a=h+=4}return{earliestPresentationTime:0,timescale:l,version:s,referencesCount:u,references:r,moovEndOffset:i}},e.parseInitSegment=function(t){var r=[];return e.findBox(t,[\"moov\",\"trak\"]).forEach((function(t){var i,a,o,s,l,d,u,c,h=e.findBox(t,[\"tkhd\"])[0];h&&(i=h.data[h.start],a=e.readUint32(h,0===i?12:20),(o=e.findBox(t,[\"mdia\",\"mdhd\"])[0])&&(i=o.data[o.start],s=e.readUint32(o,0===i?12:20),!(l=e.findBox(t,[\"mdia\",\"hdlr\"])[0])||(d={soun:\"audio\",vide:\"video\"}[e.bin2str(l.data.subarray(l.start+8,l.start+12))])&&((u=e.findBox(t,[\"mdia\",\"minf\",\"stbl\",\"stsd\"])).length&&(u=u[0],c=e.bin2str(u.data.subarray(u.start+12,u.start+16)),n.logger.log(\"MP4Demuxer:\"+d+\":\"+c+\" found\")),r[a]={timescale:s,type:d},r[d]={timescale:s,id:a})))})),r},e.getStartDTS=function(t,r){var n=e.findBox(r,[\"moof\",\"traf\"]),i=[].concat.apply([],n.map((function(r){return e.findBox(r,[\"tfhd\"]).map((function(n){var i=e.readUint32(n,4),a=t[i].timescale||9e4;return e.findBox(r,[\"tfdt\"]).map((function(t){var r=t.data[t.start],n=e.readUint32(t,4);return 1===r&&(n*=Math.pow(2,32),n+=e.readUint32(t,8)),n}))[0]/a}))}))),a=Math.min.apply(null,i);return isFinite(a)?a:0},e.offsetStartDTS=function(t,r,n){e.findBox(r,[\"moof\",\"traf\"]).map((function(r){return e.findBox(r,[\"tfhd\"]).map((function(i){var o=e.readUint32(i,4),s=t[o].timescale||9e4;e.findBox(r,[\"tfdt\"]).map((function(t){var r,i,o=t.data[t.start],l=e.readUint32(t,4);0===o?e.writeUint32(t,4,l-n*s):(l*=Math.pow(2,32),l+=e.readUint32(t,8),l-=n*s,l=Math.max(l,0),r=Math.floor(l/(1+a)),i=Math.floor(l%(1+a)),e.writeUint32(t,4,r),e.writeUint32(t,8,i))}))}))}))},t.append=function(t,r,n,a){var o=this.initData;o||(this.resetInitSegment(t,this.audioCodec,this.videoCodec,!1),o=this.initData);var s,l,d=this.initPTS;void 0===d&&(l=e.getStartDTS(o,t),this.initPTS=d=l-r,this.observer.trigger(i.default.INIT_PTS_FOUND,{initPTS:d})),e.offsetStartDTS(o,t,d),s=e.getStartDTS(o,t),this.remuxer.remux(o.audio,o.video,null,null,s,n,a,t)},t.destroy=function(){},e}();t.default=o},\"./src/errors.ts\":\n/*!***********************!*\\\n  !*** ./src/errors.ts ***!\n  \\***********************/\n/*! exports provided: ErrorTypes, ErrorDetails */function(e,t,r){\"use strict\";var n,i,a,o;r.r(t),r.d(t,\"ErrorTypes\",(function(){return n})),r.d(t,\"ErrorDetails\",(function(){return a})),(i=n=n||{}).NETWORK_ERROR=\"networkError\",i.MEDIA_ERROR=\"mediaError\",i.KEY_SYSTEM_ERROR=\"keySystemError\",i.MUX_ERROR=\"muxError\",i.OTHER_ERROR=\"otherError\",(o=a=a||{}).KEY_SYSTEM_NO_KEYS=\"keySystemNoKeys\",o.KEY_SYSTEM_NO_ACCESS=\"keySystemNoAccess\",o.KEY_SYSTEM_NO_SESSION=\"keySystemNoSession\",o.KEY_SYSTEM_LICENSE_REQUEST_FAILED=\"keySystemLicenseRequestFailed\",o.KEY_SYSTEM_NO_INIT_DATA=\"keySystemNoInitData\",o.MANIFEST_LOAD_ERROR=\"manifestLoadError\",o.MANIFEST_LOAD_TIMEOUT=\"manifestLoadTimeOut\",o.MANIFEST_PARSING_ERROR=\"manifestParsingError\",o.MANIFEST_INCOMPATIBLE_CODECS_ERROR=\"manifestIncompatibleCodecsError\",o.LEVEL_EMPTY_ERROR=\"levelEmptyError\",o.LEVEL_LOAD_ERROR=\"levelLoadError\",o.LEVEL_LOAD_TIMEOUT=\"levelLoadTimeOut\",o.LEVEL_SWITCH_ERROR=\"levelSwitchError\",o.AUDIO_TRACK_LOAD_ERROR=\"audioTrackLoadError\",o.AUDIO_TRACK_LOAD_TIMEOUT=\"audioTrackLoadTimeOut\",o.FRAG_LOAD_ERROR=\"fragLoadError\",o.FRAG_LOAD_TIMEOUT=\"fragLoadTimeOut\",o.FRAG_DECRYPT_ERROR=\"fragDecryptError\",o.FRAG_PARSING_ERROR=\"fragParsingError\",o.REMUX_ALLOC_ERROR=\"remuxAllocError\",o.KEY_LOAD_ERROR=\"keyLoadError\",o.KEY_LOAD_TIMEOUT=\"keyLoadTimeOut\",o.BUFFER_ADD_CODEC_ERROR=\"bufferAddCodecError\",o.BUFFER_APPEND_ERROR=\"bufferAppendError\",o.BUFFER_APPENDING_ERROR=\"bufferAppendingError\",o.BUFFER_STALLED_ERROR=\"bufferStalledError\",o.BUFFER_FULL_ERROR=\"bufferFullError\",o.BUFFER_SEEK_OVER_HOLE=\"bufferSeekOverHole\",o.BUFFER_NUDGE_ON_STALL=\"bufferNudgeOnStall\",o.INTERNAL_EXCEPTION=\"internalException\"},\"./src/events.js\":\n/*!***********************!*\\\n  !*** ./src/events.js ***!\n  \\***********************/\n/*! exports provided: default */function(e,t,r){\"use strict\";r.r(t),t.default={MEDIA_ATTACHING:\"hlsMediaAttaching\",MEDIA_ATTACHED:\"hlsMediaAttached\",MEDIA_DETACHING:\"hlsMediaDetaching\",MEDIA_DETACHED:\"hlsMediaDetached\",BUFFER_RESET:\"hlsBufferReset\",BUFFER_CODECS:\"hlsBufferCodecs\",BUFFER_CREATED:\"hlsBufferCreated\",BUFFER_APPENDING:\"hlsBufferAppending\",BUFFER_APPENDED:\"hlsBufferAppended\",BUFFER_EOS:\"hlsBufferEos\",BUFFER_FLUSHING:\"hlsBufferFlushing\",BUFFER_FLUSHED:\"hlsBufferFlushed\",MANIFEST_LOADING:\"hlsManifestLoading\",MANIFEST_LOADED:\"hlsManifestLoaded\",MANIFEST_PARSED:\"hlsManifestParsed\",LEVEL_SWITCHING:\"hlsLevelSwitching\",LEVEL_SWITCHED:\"hlsLevelSwitched\",LEVEL_LOADING:\"hlsLevelLoading\",LEVEL_LOADED:\"hlsLevelLoaded\",LEVEL_UPDATED:\"hlsLevelUpdated\",LEVEL_PTS_UPDATED:\"hlsLevelPtsUpdated\",LEVELS_UPDATED:\"hlsLevelsUpdated\",AUDIO_TRACKS_UPDATED:\"hlsAudioTracksUpdated\",AUDIO_TRACK_SWITCHING:\"hlsAudioTrackSwitching\",AUDIO_TRACK_SWITCHED:\"hlsAudioTrackSwitched\",AUDIO_TRACK_LOADING:\"hlsAudioTrackLoading\",AUDIO_TRACK_LOADED:\"hlsAudioTrackLoaded\",SUBTITLE_TRACKS_UPDATED:\"hlsSubtitleTracksUpdated\",SUBTITLE_TRACK_SWITCH:\"hlsSubtitleTrackSwitch\",SUBTITLE_TRACK_LOADING:\"hlsSubtitleTrackLoading\",SUBTITLE_TRACK_LOADED:\"hlsSubtitleTrackLoaded\",SUBTITLE_FRAG_PROCESSED:\"hlsSubtitleFragProcessed\",CUES_PARSED:\"hlsCuesParsed\",NON_NATIVE_TEXT_TRACKS_FOUND:\"hlsNonNativeTextTracksFound\",INIT_PTS_FOUND:\"hlsInitPtsFound\",FRAG_LOADING:\"hlsFragLoading\",FRAG_LOAD_PROGRESS:\"hlsFragLoadProgress\",FRAG_LOAD_EMERGENCY_ABORTED:\"hlsFragLoadEmergencyAborted\",FRAG_LOADED:\"hlsFragLoaded\",FRAG_DECRYPTED:\"hlsFragDecrypted\",FRAG_PARSING_INIT_SEGMENT:\"hlsFragParsingInitSegment\",FRAG_PARSING_USERDATA:\"hlsFragParsingUserdata\",FRAG_PARSING_METADATA:\"hlsFragParsingMetadata\",FRAG_PARSING_DATA:\"hlsFragParsingData\",FRAG_PARSED:\"hlsFragParsed\",FRAG_BUFFERED:\"hlsFragBuffered\",FRAG_CHANGED:\"hlsFragChanged\",FPS_DROP:\"hlsFpsDrop\",FPS_DROP_LEVEL_CAPPING:\"hlsFpsDropLevelCapping\",ERROR:\"hlsError\",DESTROYING:\"hlsDestroying\",KEY_LOADING:\"hlsKeyLoading\",KEY_LOADED:\"hlsKeyLoaded\",STREAM_STATE_TRANSITION:\"hlsStreamStateTransition\",LIVE_BACK_BUFFER_REACHED:\"hlsLiveBackBufferReached\"}},\"./src/hls.ts\":\n/*!*********************************!*\\\n  !*** ./src/hls.ts + 50 modules ***!\n  \\*********************************/\n/*! exports provided: default */\n/*! ModuleConcatenation bailout: Cannot concat with ./src/crypt/decrypter.js because of ./src/demux/demuxer-worker.js */\n/*! ModuleConcatenation bailout: Cannot concat with ./src/demux/demuxer-inline.js because of ./src/demux/demuxer-worker.js */\n/*! ModuleConcatenation bailout: Cannot concat with ./src/demux/id3.js because of ./src/demux/demuxer-worker.js */\n/*! ModuleConcatenation bailout: Cannot concat with ./src/demux/mp4demuxer.js because of ./src/demux/demuxer-worker.js */\n/*! ModuleConcatenation bailout: Cannot concat with ./src/errors.ts because of ./src/demux/demuxer-worker.js */\n/*! ModuleConcatenation bailout: Cannot concat with ./src/events.js because of ./src/demux/demuxer-worker.js */\n/*! ModuleConcatenation bailout: Cannot concat with ./src/polyfills/number.js because of ./src/demux/demuxer-worker.js */\n/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/get-self-scope.js because of ./src/demux/demuxer-worker.js */\n/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/logger.js because of ./src/demux/demuxer-worker.js */\n/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/eventemitter3/index.js (<- Module is not an ECMAScript module) */\n/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/url-toolkit/src/url-toolkit.js (<- Module is not an ECMAScript module) */function(e,t,r){\"use strict\";r.r(t),r.d(t,\"default\",(function(){return ir}));var n={};r.r(n),r.d(n,\"newCue\",(function(){return ht}));var i,a,o,s,l=r(\"./node_modules/url-toolkit/src/url-toolkit.js\"),d=r(\"./src/errors.ts\"),u=r(\"./src/polyfills/number.js\"),c=r(\"./src/events.js\"),h=r(\"./src/utils/logger.js\"),f={hlsEventGeneric:!0,hlsHandlerDestroying:!0,hlsHandlerDestroyed:!0},p=function(){function e(e){this.hls=void 0,this.handledEvents=void 0,this.useGenericHandler=void 0,this.hls=e,this.onEvent=this.onEvent.bind(this);for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];this.handledEvents=r,this.useGenericHandler=!0,this.registerListeners()}var t=e.prototype;return t.destroy=function(){this.onHandlerDestroying(),this.unregisterListeners(),this.onHandlerDestroyed()},t.onHandlerDestroying=function(){},t.onHandlerDestroyed=function(){},t.isEventHandler=function(){return\"object\"==typeof this.handledEvents&&this.handledEvents.length&&\"function\"==typeof this.onEvent},t.registerListeners=function(){this.isEventHandler()&&this.handledEvents.forEach((function(e){if(f[e])throw new Error(\"Forbidden event-name: \"+e);this.hls.on(e,this.onEvent)}),this)},t.unregisterListeners=function(){this.isEventHandler()&&this.handledEvents.forEach((function(e){this.hls.off(e,this.onEvent)}),this)},t.onEvent=function(e,t){this.onEventGeneric(e,t)},t.onEventGeneric=function(e,t){try{(function(e,t){var r=\"on\"+e.replace(\"hls\",\"\");if(\"function\"!=typeof this[r])throw new Error(\"Event \"+e+\" has no generic handler in this \"+this.constructor.name+\" class (tried \"+r+\")\");return this[r].bind(this,t)}).call(this,e,t).call()}catch(t){h.logger.error(\"An internal error happened while handling event \"+e+'. Error message: \"'+t.message+'\". Here is a stacktrace:',t),this.hls.trigger(c.default.ERROR,{type:d.ErrorTypes.OTHER_ERROR,details:d.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:e,err:t})}},e}();(a=i=i||{}).MANIFEST=\"manifest\",a.LEVEL=\"level\",a.AUDIO_TRACK=\"audioTrack\",a.SUBTITLE_TRACK=\"subtitleTrack\",(s=o=o||{}).MAIN=\"main\",s.AUDIO=\"audio\",s.SUBTITLE=\"subtitle\";var m=r(\"./src/demux/mp4demuxer.js\");function g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var y,v,_=function(){function e(e,t){this._uri=null,this.baseuri=void 0,this.reluri=void 0,this.method=null,this.key=null,this.iv=null,this.baseuri=e,this.reluri=t}var t,r;return t=e,(r=[{key:\"uri\",get:function(){return!this._uri&&this.reluri&&(this._uri=Object(l.buildAbsoluteURL)(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri}}])&&g(t.prototype,r),e}();function b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(v=y=y||{}).AUDIO=\"audio\",v.VIDEO=\"video\";var E=function(){function e(){var e;this._url=null,this._byteRange=null,this._decryptdata=null,this._elementaryStreams=((e={})[y.AUDIO]=!1,e[y.VIDEO]=!1,e),this.deltaPTS=0,this.rawProgramDateTime=null,this.programDateTime=null,this.title=null,this.tagList=[],this.cc=void 0,this.type=void 0,this.relurl=void 0,this.baseurl=void 0,this.duration=void 0,this.start=void 0,this.sn=0,this.urlId=0,this.level=0,this.levelkey=void 0,this.loader=void 0}var t,r,n=e.prototype;return n.setByteRange=function(e,t){var r=e.split(\"@\",2),n=[];1===r.length?n[0]=t?t.byteRangeEndOffset:0:n[0]=parseInt(r[1]),n[1]=parseInt(r[0])+n[0],this._byteRange=n},n.addElementaryStream=function(e){this._elementaryStreams[e]=!0},n.hasElementaryStream=function(e){return!0===this._elementaryStreams[e]},n.createInitializationVector=function(e){for(var t=new Uint8Array(16),r=12;r<16;r++)t[r]=e>>8*(15-r)&255;return t},n.setDecryptDataFromLevelKey=function(e,t){var r=e;return null!=e&&e.method&&e.uri&&!e.iv&&((r=new _(e.baseuri,e.reluri)).method=e.method,r.iv=this.createInitializationVector(t)),r},t=e,(r=[{key:\"url\",get:function(){return!this._url&&this.relurl&&(this._url=Object(l.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(e){this._url=e}},{key:\"byteRange\",get:function(){return this._byteRange?this._byteRange:[]}},{key:\"byteRangeStartOffset\",get:function(){return this.byteRange[0]}},{key:\"byteRangeEndOffset\",get:function(){return this.byteRange[1]}},{key:\"decryptdata\",get:function(){return this.levelkey||this._decryptdata?(!this._decryptdata&&this.levelkey&&(\"number\"!=typeof(e=this.sn)&&(this.levelkey&&\"AES-128\"===this.levelkey.method&&!this.levelkey.iv&&h.logger.warn('missing IV for initialization segment with method=\"'+this.levelkey.method+'\" - compliance issue'),e=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,e)),this._decryptdata):null;var e}},{key:\"endProgramDateTime\",get:function(){if(null===this.programDateTime)return null;if(!Object(u.isFiniteNumber)(this.programDateTime))return null;var e=Object(u.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+1e3*e}},{key:\"encrypted\",get:function(){return!(!this.decryptdata||null===this.decryptdata.uri||null!==this.decryptdata.key)}}])&&b(t.prototype,r),e}();function k(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var w=function(){function e(e){this.endCC=0,this.endSN=0,this.fragments=[],this.initSegment=null,this.live=!0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=e,this.version=null}var t,r;return t=e,(r=[{key:\"hasProgramDateTime\",get:function(){return!(!this.fragments[0]||!Object(u.isFiniteNumber)(this.fragments[0].programDateTime))}}])&&k(t.prototype,r),e}(),S=/^(\\d+)x(\\d+)$/,T=/\\s*(.+?)\\s*=((?:\\\".*?\\\")|.*?)(?:,|$)/g,x=function(){function e(t){for(var r in\"string\"==typeof t&&(t=e.parseAttrList(t)),t)t.hasOwnProperty(r)&&(this[r]=t[r])}var t=e.prototype;return t.decimalInteger=function(e){var t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t},t.hexadecimalInteger=function(e){if(this[e]){for(var t=(1&(t=(this[e]||\"0x\").slice(2)).length?\"0\":\"\")+t,r=new Uint8Array(t.length/2),n=0;n<t.length/2;n++)r[n]=parseInt(t.slice(2*n,2*n+2),16);return r}return null},t.hexadecimalIntegerAsNumber=function(e){var t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t},t.decimalFloatingPoint=function(e){return parseFloat(this[e])},t.enumeratedString=function(e){return this[e]},t.decimalResolution=function(e){var t=S.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}},e.parseAttrList=function(e){var t,r={};for(T.lastIndex=0;null!==(t=T.exec(e));){var n=t[2];0===n.indexOf('\"')&&n.lastIndexOf('\"')===n.length-1&&(n=n.slice(1,-1)),r[t[1]]=n}return r},e}(),L={audio:{a3ds:!0,\"ac-3\":!0,\"ac-4\":!0,alac:!0,alaw:!0,dra1:!0,\"dts+\":!0,\"dts-\":!0,dtsc:!0,dtse:!0,dtsh:!0,\"ec-3\":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,\"raw \":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,\"vc-1\":!0,vp08:!0,vp09:!0}};function A(e,t){return MediaSource.isTypeSupported((t||\"video\")+'/mp4;codecs=\"'+e+'\"')}var R=/(?:#EXT-X-STREAM-INF:([^\\n\\r]*)[\\r\\n]+([^\\r\\n]+)|#EXT-X-SESSION-DATA:([^\\n\\r]*)[\\r\\n]+)/g,D=/#EXT-X-MEDIA:(.*)/g,O=new RegExp([/#EXTINF:\\s*(\\d*(?:\\.\\d+)?)(?:,(.*)\\s+)?/.source,/|(?!#)([\\S+ ?]+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(\"\"),\"g\"),C=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\\d+))|(?:#EXT-X-(TARGETDURATION): *(\\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)([^:]*):(.*))|(?:(#)(.*))(?:.*)\\r?\\n?/,I=/\\.(mp4|m4s|m4v|m4a)$/i,M=function(){function e(){}return e.findGroup=function(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(n.id===t)return n}},e.convertAVC1ToAVCOTI=function(e){var t,r=e.split(\".\");return 2<r.length?(t=r.shift()+\".\",t+=parseInt(r.shift()).toString(16),t+=(\"000\"+parseInt(r.shift()).toString(16)).substr(-4)):t=e,t},e.resolve=function(e,t){return l.buildAbsoluteURL(t,e,{alwaysNormalize:!0})},e.parseMasterPlaylist=function(t,r){var n,i,a,o,s,l=[],d={},u=!1;function c(e,t){[\"video\",\"audio\"].forEach((function(r){var n,i=e.filter((function(e){return!!(t=L[r])&&!0===t[e.slice(0,4)];var t}));i.length&&(n=i.filter((function(e){return 0===e.lastIndexOf(\"avc1\",0)||0===e.lastIndexOf(\"mp4a\",0)})),t[r+\"Codec\"]=0<n.length?n[0]:i[0],e=e.filter((function(e){return-1===i.indexOf(e)})))})),t.unknownCodecs=e}for(R.lastIndex=0;null!=(n=R.exec(t));)n[1]?(a=(i={}).attrs=new x(n[1]),i.url=e.resolve(n[2],r),(o=a.decimalResolution(\"RESOLUTION\"))&&(i.width=o.width,i.height=o.height),i.bitrate=a.decimalInteger(\"AVERAGE-BANDWIDTH\")||a.decimalInteger(\"BANDWIDTH\"),i.name=a.NAME,c([].concat((a.CODECS||\"\").split(/[ ,]+/)),i),i.videoCodec&&-1!==i.videoCodec.indexOf(\"avc1\")&&(i.videoCodec=e.convertAVC1ToAVCOTI(i.videoCodec)),l.push(i)):!n[3]||(s=new x(n[3]))[\"DATA-ID\"]&&(u=!0,d[s[\"DATA-ID\"]]=s);return{levels:l,sessionData:u?d:null}},e.parseMasterPlaylistMedia=function(t,r,n,i){var a;void 0===i&&(i=[]);var o=[],s=0;for(D.lastIndex=0;null!==(a=D.exec(t));){var l,d,u=new x(a[1]);u.TYPE===n&&(l={attrs:u,id:s++,groupId:u[\"GROUP-ID\"],instreamId:u[\"INSTREAM-ID\"],name:u.NAME||u.LANGUAGE,type:n,default:\"YES\"===u.DEFAULT,autoselect:\"YES\"===u.AUTOSELECT,forced:\"YES\"===u.FORCED,lang:u.LANGUAGE},u.URI&&(l.url=e.resolve(u.URI,r)),i.length&&(d=e.findGroup(i,l.groupId),l.audioCodec=d?d.codec:i[0].codec),o.push(l))}return o},e.parseLevelPlaylist=function(e,t,r,n,i){var a,o,s,l=0,d=0,c=new w(t),f=0,p=null,m=new E,g=null;for(O.lastIndex=0;null!==(a=O.exec(e));){var y,v=a[1];if(v){m.duration=parseFloat(v);var b=(\" \"+a[2]).slice(1);m.title=b||null,m.tagList.push(b?[\"INF\",v,b]:[\"INF\",v])}else if(a[3])Object(u.isFiniteNumber)(m.duration)&&(y=l++,m.type=n,m.start=d,s&&(m.levelkey=s),m.sn=y,m.level=r,m.cc=f,m.urlId=i,m.baseurl=t,m.relurl=(\" \"+a[3]).slice(1),function(e,t){e.rawProgramDateTime?e.programDateTime=Date.parse(e.rawProgramDateTime):null!=t&&t.programDateTime&&(e.programDateTime=t.endProgramDateTime),Object(u.isFiniteNumber)(e.programDateTime)||(e.programDateTime=null,e.rawProgramDateTime=null)}(m,p),c.fragments.push(m),d+=(p=m).duration,m=new E);else if(a[4]){var k=(\" \"+a[4]).slice(1);p?m.setByteRange(k,p):m.setByteRange(k)}else if(a[5])m.rawProgramDateTime=(\" \"+a[5]).slice(1),m.tagList.push([\"PROGRAM-DATE-TIME\",m.rawProgramDateTime]),null===g&&(g=c.fragments.length);else{if(!(a=a[0].match(C))){h.logger.warn(\"No matches on slow regex match for level playlist!\");continue}for(o=1;o<a.length&&void 0===a[o];o++);var S=(\" \"+a[o+1]).slice(1),T=(\" \"+a[o+2]).slice(1);switch(a[o]){case\"#\":m.tagList.push(T?[S,T]:[S]);break;case\"PLAYLIST-TYPE\":c.type=S.toUpperCase();break;case\"MEDIA-SEQUENCE\":l=c.startSN=parseInt(S);break;case\"TARGETDURATION\":c.targetduration=parseFloat(S);break;case\"VERSION\":c.version=parseInt(S);break;case\"EXTM3U\":break;case\"ENDLIST\":c.live=!1;break;case\"DIS\":f++,m.tagList.push([\"DIS\"]);break;case\"DISCONTINUITY-SEQ\":f=parseInt(S);break;case\"KEY\":var L=new x(S),A=L.enumeratedString(\"METHOD\"),R=L.URI,D=L.hexadecimalInteger(\"IV\");if(\"com.apple.streamingkeydelivery\"===(L.KEYFORMAT||\"identity\")){h.logger.warn(\"Keyformat com.apple.streamingkeydelivery is not supported\");continue}A&&(s=new _(t,R),R&&0<=[\"AES-128\",\"SAMPLE-AES\",\"SAMPLE-AES-CENC\"].indexOf(A)&&(s.method=A,s.key=null,s.iv=D));break;case\"START\":var M=new x(S).decimalFloatingPoint(\"TIME-OFFSET\");Object(u.isFiniteNumber)(M)&&(c.startTimeOffset=M);break;case\"MAP\":var P=new x(S);m.relurl=P.URI,P.BYTERANGE&&m.setByteRange(P.BYTERANGE),m.baseurl=t,m.level=r,m.type=n,m.sn=\"initSegment\",c.initSegment=m,(m=new E).rawProgramDateTime=c.initSegment.rawProgramDateTime;break;default:h.logger.warn(\"line parsed but not handled: \"+a)}}}return(m=p)&&!m.relurl&&(c.fragments.pop(),d-=m.duration),c.totalduration=d,c.averagetargetduration=d/c.fragments.length,c.endSN=l-1,c.startCC=c.fragments[0]?c.fragments[0].cc:0,c.endCC=f,!c.initSegment&&c.fragments.length&&c.fragments.every((function(e){return I.test(e.relurl)}))&&(h.logger.warn(\"MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX\"),(m=new E).relurl=c.fragments[0].relurl,m.baseurl=t,m.level=r,m.type=n,m.sn=\"initSegment\",c.initSegment=m,c.needSidxRanges=!0),g&&function(e,t){for(var r=e[t],n=t-1;0<=n;n--){var i=e[n];i.programDateTime=r.programDateTime-1e3*i.duration,r=i}}(c.fragments,g),c},e}(),P=window.performance,B=function(e){var t,r;function n(t){var r=e.call(this,t,c.default.MANIFEST_LOADING,c.default.LEVEL_LOADING,c.default.AUDIO_TRACK_LOADING,c.default.SUBTITLE_TRACK_LOADING)||this;return r.loaders={},r}r=e,(t=n).prototype=Object.create(r.prototype),(t.prototype.constructor=t).__proto__=r,n.canHaveQualityLevels=function(e){return e!==i.AUDIO_TRACK&&e!==i.SUBTITLE_TRACK},n.mapContextToLevelType=function(e){switch(e.type){case i.AUDIO_TRACK:return o.AUDIO;case i.SUBTITLE_TRACK:return o.SUBTITLE;default:return o.MAIN}},n.getResponseUrl=function(e,t){var r=e.url;return void 0!==r&&0!==r.indexOf(\"data:\")||(r=t.url),r};var a=n.prototype;return a.createInternalLoader=function(e){var t=this.hls.config,r=t.pLoader,n=t.loader,i=new(r||n)(t);return e.loader=i,this.loaders[e.type]=i},a.getInternalLoader=function(e){return this.loaders[e.type]},a.resetInternalLoader=function(e){this.loaders[e]&&delete this.loaders[e]},a.destroyInternalLoaders=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}},a.destroy=function(){this.destroyInternalLoaders(),e.prototype.destroy.call(this)},a.onManifestLoading=function(e){this.load({url:e.url,type:i.MANIFEST,level:0,id:null,responseType:\"text\"})},a.onLevelLoading=function(e){this.load({url:e.url,type:i.LEVEL,level:e.level,id:e.id,responseType:\"text\"})},a.onAudioTrackLoading=function(e){this.load({url:e.url,type:i.AUDIO_TRACK,level:null,id:e.id,responseType:\"text\"})},a.onSubtitleTrackLoading=function(e){this.load({url:e.url,type:i.SUBTITLE_TRACK,level:null,id:e.id,responseType:\"text\"})},a.load=function(e){var t=this.hls.config;h.logger.debug(\"Loading playlist of type \"+e.type+\", level: \"+e.level+\", id: \"+e.id);var r,n,a,o,s=this.getInternalLoader(e);if(s){var l=s.context;if(l&&l.url===e.url)return h.logger.trace(\"playlist request ongoing\"),!1;h.logger.warn(\"aborting previous loader for type: \"+e.type),s.abort()}switch(e.type){case i.MANIFEST:r=t.manifestLoadingMaxRetry,n=t.manifestLoadingTimeOut,a=t.manifestLoadingRetryDelay,o=t.manifestLoadingMaxRetryTimeout;break;case i.LEVEL:a=o=r=0,n=t.levelLoadingTimeOut;break;default:r=t.levelLoadingMaxRetry,n=t.levelLoadingTimeOut,a=t.levelLoadingRetryDelay,o=t.levelLoadingMaxRetryTimeout}s=this.createInternalLoader(e);var d={timeout:n,maxRetry:r,retryDelay:a,maxRetryDelay:o},u={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};return h.logger.debug(\"Calling internal loader delegate for URL: \"+e.url),s.load(e,d,u),!0},a.loadsuccess=function(e,t,r,n){if(void 0===n&&(n=null),r.isSidxRequest)return this._handleSidxRequest(e,r),void this._handlePlaylistLoaded(e,t,r,n);if(this.resetInternalLoader(r.type),\"string\"!=typeof e.data)throw new Error('expected responseType of \"text\" for PlaylistLoader');var i=e.data;t.tload=P.now(),0===i.indexOf(\"#EXTM3U\")?0<i.indexOf(\"#EXTINF:\")||0<i.indexOf(\"#EXT-X-TARGETDURATION:\")?this._handleTrackOrLevelPlaylist(e,t,r,n):this._handleMasterPlaylist(e,t,r,n):this._handleManifestParsingError(e,r,\"no EXTM3U delimiter\",n)},a.loaderror=function(e,t,r){void 0===r&&(r=null),this._handleNetworkError(t,r,!1,e)},a.loadtimeout=function(e,t,r){void 0===r&&(r=null),this._handleNetworkError(t,r,!0)},a._handleMasterPlaylist=function(e,t,r,i){var a,o,s,l,d,u=this.hls,f=e.data,p=n.getResponseUrl(e,r),m=M.parseMasterPlaylist(f,p),g=m.levels,y=m.sessionData;g.length?(a=g.map((function(e){return{id:e.attrs.AUDIO,codec:e.audioCodec}})),o=M.parseMasterPlaylistMedia(f,p,\"AUDIO\",a),s=M.parseMasterPlaylistMedia(f,p,\"SUBTITLES\"),l=M.parseMasterPlaylistMedia(f,p,\"CLOSED-CAPTIONS\"),o.length&&(d=!1,o.forEach((function(e){e.url||(d=!0)})),!1===d&&g[0].audioCodec&&!g[0].attrs.AUDIO&&(h.logger.log(\"audio codec signaled in quality level, but no embedded audio track signaled, create one\"),o.unshift({type:\"main\",name:\"main\",default:!1,autoselect:!1,forced:!1,id:-1,attrs:{},url:\"\"}))),u.trigger(c.default.MANIFEST_LOADED,{levels:g,audioTracks:o,subtitles:s,captions:l,url:p,stats:t,networkDetails:i,sessionData:y})):this._handleManifestParsingError(e,r,\"no level found in manifest\",i)},a._handleTrackOrLevelPlaylist=function(e,t,r,a){var o,s,l=this.hls,h=r.id,f=r.level,p=r.type,m=n.getResponseUrl(e,r),g=Object(u.isFiniteNumber)(h)?h:0,y=Object(u.isFiniteNumber)(f)?f:g,v=n.mapContextToLevelType(r),_=M.parseLevelPlaylist(e.data,m,y,v,g);_.tload=t.tload,_.fragments.length?(p===i.MANIFEST&&(o={url:m,details:_},l.trigger(c.default.MANIFEST_LOADED,{levels:[o],audioTracks:[],url:m,stats:t,networkDetails:a,sessionData:null})),t.tparsed=P.now(),_.needSidxRanges?(s=_.initSegment.url,this.load({url:s,isSidxRequest:!0,type:p,level:f,levelDetails:_,id:h,rangeStart:0,rangeEnd:2048,responseType:\"arraybuffer\"})):(r.levelDetails=_,this._handlePlaylistLoaded(e,t,r,a))):l.trigger(c.default.ERROR,{type:d.ErrorTypes.NETWORK_ERROR,details:d.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:m,reason:\"no fragments found in level\",level:\"number\"==typeof r.level?r.level:void 0})},a._handleSidxRequest=function(e,t){if(\"string\"==typeof e.data)throw new Error(\"sidx request must be made with responseType of array buffer\");var r,n,i=m.default.parseSegmentIndex(new Uint8Array(e.data));i&&(r=i.references,n=t.levelDetails,r.forEach((function(e,t){var r,i=e.info;!n||0===(r=n.fragments[t]).byteRange.length&&r.setByteRange(String(1+i.end-i.start)+\"@\"+String(i.start))})),n&&n.initSegment.setByteRange(String(i.moovEndOffset)+\"@0\"))},a._handleManifestParsingError=function(e,t,r,n){this.hls.trigger(c.default.ERROR,{type:d.ErrorTypes.NETWORK_ERROR,details:d.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:e.url,reason:r,networkDetails:n})},a._handleNetworkError=function(e,t,r,n){var a,o;void 0===r&&(r=!1),void 0===n&&(n=null),h.logger.info(\"A network error occured while loading a \"+e.type+\"-type playlist\");var s=this.getInternalLoader(e);switch(e.type){case i.MANIFEST:a=r?d.ErrorDetails.MANIFEST_LOAD_TIMEOUT:d.ErrorDetails.MANIFEST_LOAD_ERROR,o=!0;break;case i.LEVEL:a=r?d.ErrorDetails.LEVEL_LOAD_TIMEOUT:d.ErrorDetails.LEVEL_LOAD_ERROR,o=!1;break;case i.AUDIO_TRACK:a=r?d.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:d.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,o=!1;break;default:o=!1}s&&(s.abort(),this.resetInternalLoader(e.type));var l={type:d.ErrorTypes.NETWORK_ERROR,details:a,fatal:o,url:e.url,loader:s,context:e,networkDetails:t};n&&(l.response=n),this.hls.trigger(c.default.ERROR,l)},a._handlePlaylistLoaded=function(e,t,r,a){var o=r.type,s=r.level,l=r.id,d=r.levelDetails;if(d&&d.targetduration)if(n.canHaveQualityLevels(r.type))this.hls.trigger(c.default.LEVEL_LOADED,{details:d,level:s||0,id:l||0,stats:t,networkDetails:a});else switch(o){case i.AUDIO_TRACK:this.hls.trigger(c.default.AUDIO_TRACK_LOADED,{details:d,id:l,stats:t,networkDetails:a});break;case i.SUBTITLE_TRACK:this.hls.trigger(c.default.SUBTITLE_TRACK_LOADED,{details:d,id:l,stats:t,networkDetails:a})}else this._handleManifestParsingError(e,r,\"invalid target duration\",a)},n}(p),F=function(e){var t,r;function n(t){var r=e.call(this,t,c.default.FRAG_LOADING)||this;return r.loaders={},r}r=e,(t=n).prototype=Object.create(r.prototype),(t.prototype.constructor=t).__proto__=r;var i=n.prototype;return i.destroy=function(){var t=this.loaders;for(var r in t){var n=t[r];n&&n.destroy()}this.loaders={},e.prototype.destroy.call(this)},i.onFragLoading=function(e){var t=e.frag,r=t.type,n=this.loaders,i=this.hls.config,a=i.fLoader,o=i.loader;t.loaded=0;var s,l,d,c=n[r];c&&(h.logger.warn(\"abort previous fragment loader for type: \"+r),c.abort()),c=n[r]=t.loader=new(i.fLoader?a:o)(i),s={url:t.url,frag:t,responseType:\"arraybuffer\",progressData:!1};var f=t.byteRangeStartOffset,p=t.byteRangeEndOffset;Object(u.isFiniteNumber)(f)&&Object(u.isFiniteNumber)(p)&&(s.rangeStart=f,s.rangeEnd=p),l={timeout:i.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:i.fragLoadingMaxRetryTimeout},d={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},c.load(s,l,d)},i.loadsuccess=function(e,t,r,n){void 0===n&&(n=null);var i=e.data,a=r.frag;a.loader=void 0,this.loaders[a.type]=void 0,this.hls.trigger(c.default.FRAG_LOADED,{payload:i,frag:a,stats:t,networkDetails:n})},i.loaderror=function(e,t,r){void 0===r&&(r=null);var n=t.frag,i=n.loader;i&&i.abort(),this.loaders[n.type]=void 0,this.hls.trigger(c.default.ERROR,{type:d.ErrorTypes.NETWORK_ERROR,details:d.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:t.frag,response:e,networkDetails:r})},i.loadtimeout=function(e,t,r){void 0===r&&(r=null);var n=t.frag,i=n.loader;i&&i.abort(),this.loaders[n.type]=void 0,this.hls.trigger(c.default.ERROR,{type:d.ErrorTypes.NETWORK_ERROR,details:d.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t.frag,networkDetails:r})},i.loadprogress=function(e,t,r,n){void 0===n&&(n=null);var i=t.frag;i.loaded=e.loaded,this.hls.trigger(c.default.FRAG_LOAD_PROGRESS,{frag:i,stats:e,networkDetails:n})},n}(p),U=function(e){var t,r;function n(t){var r=e.call(this,t,c.default.KEY_LOADING)||this;return r.loaders={},r.decryptkey=null,r.decrypturl=null,r}r=e,(t=n).prototype=Object.create(r.prototype),(t.prototype.constructor=t).__proto__=r;var i=n.prototype;return i.destroy=function(){for(var t in this.loaders){var r=this.loaders[t];r&&r.destroy()}this.loaders={},e.prototype.destroy.call(this)},i.onKeyLoading=function(e){var t=e.frag,r=t.type,n=this.loaders[r];if(t.decryptdata){var i=t.decryptdata.uri;if(i!==this.decrypturl||null===this.decryptkey){var a=this.hls.config;if(n&&(h.logger.warn(\"abort previous key loader for type:\"+r),n.abort()),!i)return void h.logger.warn(\"key uri is falsy\");t.loader=this.loaders[r]=new a.loader(a),this.decrypturl=i,this.decryptkey=null;var o={url:i,frag:t,responseType:\"arraybuffer\"},s={timeout:a.fragLoadingTimeOut,maxRetry:0,retryDelay:a.fragLoadingRetryDelay,maxRetryDelay:a.fragLoadingMaxRetryTimeout},l={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};t.loader.load(o,s,l)}else this.decryptkey&&(t.decryptdata.key=this.decryptkey,this.hls.trigger(c.default.KEY_LOADED,{frag:t}))}else h.logger.warn(\"Missing decryption data on fragment in onKeyLoading\")},i.loadsuccess=function(e,t,r){var n=r.frag;n.decryptdata?(this.decryptkey=n.decryptdata.key=new Uint8Array(e.data),n.loader=void 0,delete this.loaders[n.type],this.hls.trigger(c.default.KEY_LOADED,{frag:n})):h.logger.error(\"after key load, decryptdata unset\")},i.loaderror=function(e,t){var r=t.frag,n=r.loader;n&&n.abort(),delete this.loaders[r.type],this.hls.trigger(c.default.ERROR,{type:d.ErrorTypes.NETWORK_ERROR,details:d.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:r,response:e})},i.loadtimeout=function(e,t){var r=t.frag,n=r.loader;n&&n.abort(),delete this.loaders[r.type],this.hls.trigger(c.default.ERROR,{type:d.ErrorTypes.NETWORK_ERROR,details:d.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:r})},n}(p),N=\"NOT_LOADED\",j=\"APPENDING\",G=\"PARTIAL\",z=\"OK\",q=function(e){var t,r;function n(t){var r=e.call(this,t,c.default.BUFFER_APPENDED,c.default.FRAG_BUFFERED,c.default.FRAG_LOADED)||this;return r.bufferPadding=.2,r.fragments=Object.create(null),r.timeRanges=Object.create(null),r.config=t.config,r}r=e,(t=n).prototype=Object.create(r.prototype),(t.prototype.constructor=t).__proto__=r;var i=n.prototype;return i.destroy=function(){this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.config=null,p.prototype.destroy.call(this),e.prototype.destroy.call(this)},i.getBufferedFrag=function(e,t){var r=this.fragments,n=Object.keys(r).filter((function(n){var i=r[n];if(i.body.type!==t)return!1;if(!i.buffered)return!1;var a=i.body;return a.startPTS<=e&&e<=a.endPTS}));if(0===n.length)return null;var i=n.pop();return r[i].body},i.detectEvictedFragments=function(e,t){var r=this;Object.keys(this.fragments).forEach((function(n){var i=r.fragments[n];if(i&&i.buffered){var a=i.range[e];if(a)for(var o=a.time,s=0;s<o.length;s++){var l=o[s];if(!r.isTimeBuffered(l.startPTS,l.endPTS,t)){r.removeFragment(i.body);break}}}}))},i.detectPartialFragments=function(e){var t=this,r=this.getFragmentKey(e),n=this.fragments[r];n&&(n.buffered=!0,Object.keys(this.timeRanges).forEach((function(r){var i;e.hasElementaryStream(r)&&(i=t.timeRanges[r],n.range[r]=t.getBufferedTimes(e.startPTS,e.endPTS,i))})))},i.getBufferedTimes=function(e,t,r){for(var n,i,a=[],o=!1,s=0;s<r.length;s++){if(n=r.start(s)-this.bufferPadding,i=r.end(s)+this.bufferPadding,n<=e&&t<=i){a.push({startPTS:Math.max(e,r.start(s)),endPTS:Math.min(t,r.end(s))});break}if(e<i&&n<t)a.push({startPTS:Math.max(e,r.start(s)),endPTS:Math.min(t,r.end(s))}),o=!0;else if(t<=n)break}return{time:a,partial:o}},i.getFragmentKey=function(e){return e.type+\"_\"+e.level+\"_\"+e.urlId+\"_\"+e.sn},i.getPartialFragment=function(e){var t,r,n,i=this,a=null,o=0;return Object.keys(this.fragments).forEach((function(s){var l=i.fragments[s];i.isPartial(l)&&(r=l.body.startPTS-i.bufferPadding,n=l.body.endPTS+i.bufferPadding,r<=e&&e<=n&&(t=Math.min(e-r,n-e),o<=t&&(a=l.body,o=t)))})),a},i.getState=function(e){var t=this.getFragmentKey(e),r=this.fragments[t],n=N;return void 0!==r&&(n=r.buffered?!0===this.isPartial(r)?G:z:j),n},i.isPartial=function(e){return!0===e.buffered&&(void 0!==e.range.video&&!0===e.range.video.partial||void 0!==e.range.audio&&!0===e.range.audio.partial)},i.isTimeBuffered=function(e,t,r){for(var n,i,a=0;a<r.length;a++){if(n=r.start(a)-this.bufferPadding,i=r.end(a)+this.bufferPadding,n<=e&&t<=i)return!0;if(t<=n)return!1}return!1},i.onFragLoaded=function(e){var t=e.frag;Object(u.isFiniteNumber)(t.sn)&&!t.bitrateTest&&(this.fragments[this.getFragmentKey(t)]={body:t,range:Object.create(null),buffered:!1})},i.onBufferAppended=function(e){var t=this;this.timeRanges=e.timeRanges,Object.keys(this.timeRanges).forEach((function(e){var r=t.timeRanges[e];t.detectEvictedFragments(e,r)}))},i.onFragBuffered=function(e){this.detectPartialFragments(e.frag)},i.hasFragment=function(e){var t=this.getFragmentKey(e);return void 0!==this.fragments[t]},i.removeFragment=function(e){var t=this.getFragmentKey(e);delete this.fragments[t]},i.removeAllFragments=function(){this.fragments=Object.create(null)},n}(p),V=function(e,t){for(var r,n,i=0,a=e.length-1;i<=a;){var o=t(n=e[r=(i+a)/2|0]);if(0<o)i=1+r;else{if(!(o<0))return n;a=r-1}}return null},Y=function(){function e(){}return e.isBuffered=function(e,t){try{if(e)for(var r=e.buffered,n=0;n<r.length;n++)if(t>=r.start(n)&&t<=r.end(n))return!0}catch(e){}return!1},e.bufferInfo=function(e,t,r){try{if(e){for(var n=e.buffered,i=[],a=0;a<n.length;a++)i.push({start:n.start(a),end:n.end(a)});return this.bufferedInfo(i,t,r)}}catch(e){}return{len:0,start:t,end:t,nextStart:void 0}},e.bufferedInfo=function(e,t,r){e.sort((function(e,t){return e.start-t.start||t.end-e.end}));var n=[];if(r)for(var i=0;i<e.length;i++){var a,o=n.length;o?(a=n[o-1].end,e[i].start-a<r?e[i].end>a&&(n[o-1].end=e[i].end):n.push(e[i])):n.push(e[i])}else n=e;for(var s,l=0,d=t,u=t,c=0;c<n.length;c++){var h=n[c].start,f=n[c].end;if(h<=t+r&&t<f)d=h,l=(u=f)-t;else if(t+r<h){s=h;break}}return{len:l,start:d,end:u,nextStart:s}},e}(),H=r(\"./node_modules/eventemitter3/index.js\"),K=r(\"./node_modules/webworkify-webpack/index.js\"),W=r(\"./src/demux/demuxer-inline.js\");function X(){return window.MediaSource||window.WebKitMediaSource}var $=r(\"./src/utils/get-self-scope.js\"),Q=function(e){var t,r;function n(){return e.apply(this,arguments)||this}return r=e,(t=n).prototype=Object.create(r.prototype),(t.prototype.constructor=t).__proto__=r,n.prototype.trigger=function(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];this.emit.apply(this,[e,e].concat(r))},n}(H.EventEmitter),J=Object($.getSelfScope)(),Z=X()||{isTypeSupported:function(){return!1}},ee=function(){function e(e,t){var r=this;function n(t,n){(n=n||{}).frag=r.frag,n.id=r.id,e.trigger(t,n)}this.hls=e,this.id=t;var i=this.observer=new Q,a=e.config;i.on(c.default.FRAG_DECRYPTED,n),i.on(c.default.FRAG_PARSING_INIT_SEGMENT,n),i.on(c.default.FRAG_PARSING_DATA,n),i.on(c.default.FRAG_PARSED,n),i.on(c.default.ERROR,n),i.on(c.default.FRAG_PARSING_METADATA,n),i.on(c.default.FRAG_PARSING_USERDATA,n),i.on(c.default.INIT_PTS_FOUND,n);var o,s={mp4:Z.isTypeSupported(\"video/mp4\"),mpeg:Z.isTypeSupported(\"audio/mpeg\"),mp3:Z.isTypeSupported('audio/mp4; codecs=\"mp3\"')},l=navigator.vendor;if(a.enableWorker&&\"undefined\"!=typeof Worker){h.logger.log(\"demuxing in webworker\");try{o=this.w=K(/*! ../demux/demuxer-worker.js */\"./src/demux/demuxer-worker.js\"),this.onwmsg=this.onWorkerMessage.bind(this),o.addEventListener(\"message\",this.onwmsg),o.onerror=function(t){e.trigger(c.default.ERROR,{type:d.ErrorTypes.OTHER_ERROR,details:d.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:\"demuxerWorker\",err:{message:t.message+\" (\"+t.filename+\":\"+t.lineno+\")\"}})},o.postMessage({cmd:\"init\",typeSupported:s,vendor:l,id:t,config:JSON.stringify(a)})}catch(t){h.logger.warn(\"Error in worker:\",t),h.logger.error(\"Error while initializing DemuxerWorker, fallback on DemuxerInline\"),o&&J.URL.revokeObjectURL(o.objectURL),this.demuxer=new W.default(i,s,a,l),this.w=void 0}}else this.demuxer=new W.default(i,s,a,l)}var t=e.prototype;return t.destroy=function(){var e,t=this.w;t?(t.removeEventListener(\"message\",this.onwmsg),t.terminate(),this.w=null):(e=this.demuxer)&&(e.destroy(),this.demuxer=null);var r=this.observer;r&&(r.removeAllListeners(),this.observer=null)},t.push=function(e,t,r,n,i,a,o,s){var l,d=this.w,c=Object(u.isFiniteNumber)(i.startPTS)?i.startPTS:i.start,f=i.decryptdata,p=this.frag,m=!(p&&i.cc===p.cc),g=!(p&&i.level===p.level),y=p&&i.sn===p.sn+1,v=!g&&y;m&&h.logger.log(this.id+\":discontinuity detected\"),g&&h.logger.log(this.id+\":switch detected\"),this.frag=i,d?d.postMessage({cmd:\"demux\",data:e,decryptdata:f,initSegment:t,audioCodec:r,videoCodec:n,timeOffset:c,discontinuity:m,trackSwitch:g,contiguous:v,duration:a,accurateTimeOffset:o,defaultInitPTS:s},e instanceof ArrayBuffer?[e]:[]):(l=this.demuxer)&&l.push(e,f,t,r,n,c,m,g,v,a,o,s)},t.onWorkerMessage=function(e){var t=e.data,r=this.hls;switch(t.event){case\"init\":J.URL.revokeObjectURL(this.w.objectURL);break;case c.default.FRAG_PARSING_DATA:t.data.data1=new Uint8Array(t.data1),t.data2&&(t.data.data2=new Uint8Array(t.data2));default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,r.trigger(t.event,t.data)}},e}();function te(e,t,r){switch(t){case\"audio\":e.audioGroupIds||(e.audioGroupIds=[]),e.audioGroupIds.push(r);break;case\"text\":e.textGroupIds||(e.textGroupIds=[]),e.textGroupIds.push(r)}}function re(e,t,r){var n,i=e[t],a=e[r],o=a.startPTS;Object(u.isFiniteNumber)(o)?t<r?(i.duration=o-i.start,i.duration<0&&h.logger.warn(\"negative duration computed for frag \"+i.sn+\",level \"+i.level+\", there should be some duration drift between playlist and fragment!\")):(a.duration=i.start-o,a.duration<0&&h.logger.warn(\"negative duration computed for frag \"+a.sn+\",level \"+a.level+\", there should be some duration drift between playlist and fragment!\")):t<r?(n=i.cc===a.cc,a.start=i.start+(n&&i.minEndPTS?i.minEndPTS-i.start:i.duration)):a.start=Math.max(i.start-a.duration,0)}function ne(e,t,r,n,i,a){var o,s=r,l=n;Object(u.isFiniteNumber)(t.startPTS)&&(o=Math.abs(t.startPTS-r),Object(u.isFiniteNumber)(t.deltaPTS)?t.deltaPTS=Math.max(o,t.deltaPTS):t.deltaPTS=o,s=Math.max(r,t.startPTS),r=Math.min(r,t.startPTS),l=Math.min(n,t.endPTS),n=Math.max(n,t.endPTS),i=Math.min(i,t.startDTS),a=Math.max(a,t.endDTS));var d=r-t.start;t.start=t.startPTS=r,t.maxStartPTS=s,t.endPTS=n,t.minEndPTS=l,t.startDTS=i,t.endDTS=a,t.duration=n-r;var c,h,f,p=t.sn;if(!e||p<e.startSN||p>e.endSN)return 0;for(c=p-e.startSN,(h=e.fragments)[c]=t,f=c;0<f;f--)re(h,f,f-1);for(f=c;f<h.length-1;f++)re(h,f,f+1);return e.PTSKnown=!0,d}function ie(e,t){t.initSegment&&e.initSegment&&(t.initSegment=e.initSegment);var r,n=0;if(ae(e,t,(function(e,i){n=e.cc-i.cc,Object(u.isFiniteNumber)(e.startPTS)&&(i.start=i.startPTS=e.startPTS,i.endPTS=e.endPTS,i.duration=e.duration,i.backtracked=e.backtracked,i.dropped=e.dropped,r=i),t.PTSKnown=!0})),t.PTSKnown){if(n){h.logger.log(\"discontinuity sliding from playlist, take drift into account\");for(var i=t.fragments,a=0;a<i.length;a++)i[a].cc+=n}r?ne(t,r,r.startPTS,r.endPTS,r.startDTS,r.endDTS):function(e,t){var r=t.startSN-e.startSN,n=e.fragments,i=t.fragments;if(!(r<0||r>n.length))for(var a=0;a<i.length;a++)i[a].start+=n[r].start}(e,t),t.PTSKnown=e.PTSKnown}}function ae(e,t,r){if(e&&t)for(var n=Math.max(e.startSN,t.startSN)-t.startSN,i=Math.min(e.endSN,t.endSN)-t.startSN,a=t.startSN-e.startSN,o=n;o<=i;o++){var s=e.fragments[a+o],l=t.fragments[o];if(!s||!l)break;r(s,l,o)}}function oe(e,t,r){var n=1e3*(t.averagetargetduration?t.averagetargetduration:t.targetduration),i=n/2;return e&&t.endSN===e.endSN&&(n=i),r&&(n=Math.max(i,n-(window.performance.now()-r))),Math.round(n)}var se=function(e){for(var t=\"\",r=e.length,n=0;n<r;n++)t+=\"[\"+e.start(n).toFixed(3)+\",\"+e.end(n).toFixed(3)+\"]\";return t};function le(e,t){t.fragments.forEach((function(t){var r;t&&(r=t.start+e,t.start=t.startPTS=r,t.endPTS=r+t.duration)})),t.PTSKnown=!0}function de(e,t,r){!function(e,t,r){var n;!function(e,t,r){var n=!1;return t&&t.details&&r&&(r.endCC>r.startCC||e&&e.cc<r.startCC)&&(n=!0),n}(e,r,t)||(n=function(e,t){var r=e.fragments,n=t.fragments;if(n.length&&r.length){var i=function(e,t){for(var r=null,n=0;n<e.length;n+=1){var i=e[n];if(i&&i.cc===t){r=i;break}}return r}(r,n[0].cc);if(i&&(!i||i.startPTS))return i;h.logger.log(\"No frag in previous level to align on\")}else h.logger.log(\"No fragments to align\")}(r.details,t))&&(h.logger.log(\"Adjusting PTS using last level due to CC increase within current level\"),le(n.start,t))}(e,r,t),!r.PTSKnown&&t&&function(e,t){if(t&&t.fragments.length){if(!e.hasProgramDateTime||!t.hasProgramDateTime)return;var r=t.fragments[0].programDateTime,n=(e.fragments[0].programDateTime-r)/1e3+t.fragments[0].start;Object(u.isFiniteNumber)(n)&&(h.logger.log(\"adjusting PTS using programDateTime delta, sliding:\"+n.toFixed(3)),le(n,e))}}(r,t.details)}function ue(e,t,r){if(null===t||!Array.isArray(e)||!e.length||!Object(u.isFiniteNumber)(t))return null;if(t<(e[0].programDateTime||0))return null;if((e[e.length-1].endProgramDateTime||0)<=t)return null;r=r||0;for(var n,i,a,o,s=0;s<e.length;++s){var l=e[s];if(n=t,i=r,a=l,void 0,o=1e3*Math.min(i,a.duration+(a.deltaPTS?a.deltaPTS:0)),(a.endProgramDateTime||0)-o>n)return l}return null}function ce(e,t,r,n){void 0===r&&(r=0),void 0===n&&(n=0);var i=null;return e?i=t[e.sn-t[0].sn+1]:0===r&&0===t[0].start&&(i=t[0]),i&&0===he(r,n,i)?i:V(t,he.bind(null,r,n))||i}function he(e,t,r){void 0===e&&(e=0),void 0===t&&(t=0);var n=Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0));return r.start+r.duration-n<=e?1:r.start-n>e&&r.start?-1:0}var fe=function(){function e(e,t,r,n){this.config=e,this.media=t,this.fragmentTracker=r,this.hls=n,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1}var t=e.prototype;return t.poll=function(e){var t,r=this.config,n=this.media,i=this.stalled,a=n.currentTime,o=n.seeking,s=this.seeking&&!o,l=!this.seeking&&o;if(this.seeking=o,a!==e)return this.moved=!0,void(null!==i&&(this.stallReported&&(t=self.performance.now()-i,h.logger.warn(\"playback not stuck anymore @\"+a+\", after \"+Math.round(t)+\"ms\"),this.stallReported=!1),this.stalled=null,this.nudgeRetry=0));if((l||s)&&(this.stalled=null),!n.paused&&!n.ended&&0!==n.playbackRate&&n.buffered.length){var d=Y.bufferInfo(n,a,0),u=0<d.len,c=d.nextStart||0;if(u||c){if(o){var f=2<d.len,p=!c||2<c-a&&!this.fragmentTracker.getPartialFragment(a);if(f||p)return;this.moved=!1}if(!this.moved&&this.stalled){var m=Math.max(c,d.start||0)-a;if(0<m&&m<=2)return void this._trySkipBufferHole(null)}var g,y,v=self.performance.now();null!==i?(g=v-i,!o&&250<=g&&this._reportStall(d.len),y=Y.bufferInfo(n,a,r.maxBufferHole),this._tryFixBufferStall(y,g)):this.stalled=v}}},t._tryFixBufferStall=function(e,t){var r=this.config,n=this.fragmentTracker,i=this.media.currentTime,a=n.getPartialFragment(i);a&&this._trySkipBufferHole(a)||e.len>r.maxBufferHole&&t>1e3*r.highBufferWatchdogPeriod&&(h.logger.warn(\"Trying to nudge playhead over buffer-hole\"),this.stalled=null,this._tryNudgeBuffer())},t._reportStall=function(e){var t=this.hls,r=this.media;this.stallReported||(this.stallReported=!0,h.logger.warn(\"Playback stalling at @\"+r.currentTime+\" due to low buffer (buffer=\"+e+\")\"),t.trigger(c.default.ERROR,{type:d.ErrorTypes.MEDIA_ERROR,details:d.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:e}))},t._trySkipBufferHole=function(e){for(var t=this.config,r=this.hls,n=this.media,i=n.currentTime,a=0,o=0;o<n.buffered.length;o++){var s=n.buffered.start(o);if(i+t.maxBufferHole>=a&&i<s){var l=Math.max(s+.05,n.currentTime+.1);return h.logger.warn(\"skipping hole, adjusting currentTime from \"+i+\" to \"+l),this.moved=!0,this.stalled=null,n.currentTime=l,e&&r.trigger(c.default.ERROR,{type:d.ErrorTypes.MEDIA_ERROR,details:d.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:\"fragment loaded with buffer holes, seeking from \"+i+\" to \"+l,frag:e}),l}a=n.buffered.end(o)}return 0},t._tryNudgeBuffer=function(){var e,t=this.config,r=this.hls,n=this.media,i=n.currentTime,a=(this.nudgeRetry||0)+1;(this.nudgeRetry=a)<t.nudgeMaxRetry?(e=i+a*t.nudgeOffset,h.logger.warn(\"Nudging 'currentTime' from \"+i+\" to \"+e),n.currentTime=e,r.trigger(c.default.ERROR,{type:d.ErrorTypes.MEDIA_ERROR,details:d.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})):(h.logger.error(\"Playhead still not moving while enough data buffered @\"+i+\" after \"+t.nudgeMaxRetry+\" nudges\"),r.trigger(c.default.ERROR,{type:d.ErrorTypes.MEDIA_ERROR,details:d.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0}))},e}(),pe=function(e){var t,r;function n(t){for(var r,n=arguments.length,i=new Array(1<n?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];return(r=e.call.apply(e,[this,t].concat(i))||this)._boundTick=void 0,r._tickTimer=null,r._tickInterval=null,r._tickCallCount=0,r._boundTick=r.tick.bind(function(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}(r)),r}r=e,(t=n).prototype=Object.create(r.prototype),(t.prototype.constructor=t).__proto__=r;var i=n.prototype;return i.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},i.hasInterval=function(){return!!this._tickInterval},i.hasNextTick=function(){return!!this._tickTimer},i.setInterval=function(e){return!this._tickInterval&&(this._tickInterval=self.setInterval(this._boundTick,e),!0)},i.clearInterval=function(){return!(!this._tickInterval||(self.clearInterval(this._tickInterval),this._tickInterval=null))},i.clearNextTick=function(){return!(!this._tickTimer||(self.clearTimeout(this._tickTimer),this._tickTimer=null))},i.tick=function(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),1<this._tickCallCount&&(this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)),this._tickCallCount=0)},i.doTick=function(){},n}(p),me=\"STOPPED\",ge=\"STARTING\",ye=\"IDLE\",ve=\"KEY_LOADING\",_e=\"FRAG_LOADING\",be=\"FRAG_LOADING_WAITING_RETRY\",Ee=\"WAITING_TRACK\",ke=\"PARSING\",we=\"PARSED\",Se=\"BUFFER_FLUSHING\",Te=\"ENDED\",xe=\"ERROR\",Le=\"WAITING_INIT_PTS\",Ae=\"WAITING_LEVEL\",Re=function(e){var t,r;function n(){return e.apply(this,arguments)||this}r=e,(t=n).prototype=Object.create(r.prototype),(t.prototype.constructor=t).__proto__=r;var i=n.prototype;return i.doTick=function(){},i.startLoad=function(){},i.stopLoad=function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragmentTracker.removeFragment(e)),this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=me},i._streamEnded=function(e,t){var r=this.fragCurrent,n=this.fragmentTracker;if(t.live||!r||r.backtracked||r.sn!==t.endSN||e.nextStart)return!1;var i=n.getState(r);return i===G||i===z},i.onMediaSeeking=function(){var e,t,r,n,i=this.config,a=this.media,o=this.mediaBuffer,s=this.state,l=a?a.currentTime:null,d=Y.bufferInfo(o||a,l,this.config.maxBufferHole);h.logger.log(\"media seeking to \"+(Object(u.isFiniteNumber)(l)?l.toFixed(3):l)),s===_e?(e=this.fragCurrent,0===d.len&&e&&(t=i.maxFragLookUpTolerance,r=e.start-t,n=e.start+e.duration+t,l<r||n<l?(e.loader&&(h.logger.log(\"seeking outside of buffer while fragment load in progress, cancel fragment load\"),e.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=ye):h.logger.log(\"seeking outside of buffer but within currently loaded fragment range\"))):s===Te&&(0===d.len&&(this.fragPrevious=null,this.fragCurrent=null),this.state=ye),a&&(this.lastCurrentTime=l),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=l),this.tick()},i.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},i.onHandlerDestroying=function(){this.stopLoad(),e.prototype.onHandlerDestroying.call(this)},i.onHandlerDestroyed=function(){this.state=me,this.fragmentTracker=null},i.computeLivePosition=function(e,t){var r=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*t.targetduration;return e+Math.max(0,t.totalduration-r)},n}(pe);function De(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Oe,Ce=function(e){var t,r;function n(t,r){var n=e.call(this,t,c.default.MEDIA_ATTACHED,c.default.MEDIA_DETACHING,c.default.MANIFEST_LOADING,c.default.MANIFEST_PARSED,c.default.LEVEL_LOADED,c.default.LEVELS_UPDATED,c.default.KEY_LOADED,c.default.FRAG_LOADED,c.default.FRAG_LOAD_EMERGENCY_ABORTED,c.default.FRAG_PARSING_INIT_SEGMENT,c.default.FRAG_PARSING_DATA,c.default.FRAG_PARSED,c.default.ERROR,c.default.AUDIO_TRACK_SWITCHING,c.default.AUDIO_TRACK_SWITCHED,c.default.BUFFER_CREATED,c.default.BUFFER_APPENDED,c.default.BUFFER_FLUSHED)||this;return n.fragmentTracker=r,n.config=t.config,n.audioCodecSwap=!1,n._state=me,n.stallReported=!1,n.gapController=null,n.altAudio=!1,n.audioOnly=!1,n.bitrateTest=!1,n}r=e,(t=n).prototype=Object.create(r.prototype),(t.prototype.constructor=t).__proto__=r;var i,a,s=n.prototype;return s.startLoad=function(e){var t,r,n;this.levels?(t=this.lastCurrentTime,r=this.hls,this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,this.startFragRequested||(-1===(n=r.startLevel)&&(r.config.testBandwidth?(n=0,this.bitrateTest=!0):n=r.nextAutoLevel),this.level=r.nextLoadLevel=n,this.loadedmetadata=!1),0<t&&-1===e&&(h.logger.log(\"override startPosition with lastCurrentTime @\"+t.toFixed(3)),e=t),this.state=ye,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()):(this.forceStartLoad=!0,this.state=me)},s.stopLoad=function(){this.forceStartLoad=!1,e.prototype.stopLoad.call(this)},s.doTick=function(){switch(this.state){case Se:this.fragLoadError=0;break;case ye:this._doTickIdle();break;case Ae:var e=this.levels[this.level];e&&e.details&&(this.state=ye);break;case be:var t=window.performance.now(),r=this.retryDate;(!r||r<=t||this.media&&this.media.seeking)&&(h.logger.log(\"mediaController: retryDate reached, switch back to IDLE state\"),this.state=ye)}this._checkBuffer(),this._checkFragmentChanged()},s._doTickIdle=function(){var e=this.hls,t=e.config,r=this.media;if(void 0!==this.levelLastLoaded&&(r||!this.startFragRequested&&t.startFragPrefetch))if(this.altAudio&&this.audioOnly)this.demuxer.frag=null;else{var n=this.loadedmetadata?r.currentTime:this.nextLoadPosition,i=e.nextLoadLevel,a=this.levels[i];if(a){var o=a.bitrate,s=o?Math.max(8*t.maxBufferSize/o,t.maxBufferLength):t.maxBufferLength;s=Math.min(s,t.maxMaxBufferLength);var l=n<t.maxBufferHole?Math.max(2,t.maxBufferHole):t.maxBufferHole,d=Y.bufferInfo(this.mediaBuffer?this.mediaBuffer:r,n,l),u=d.len;if(!(s<=u)){h.logger.trace(\"buffer length of \"+u.toFixed(3)+\" is below max of \"+s.toFixed(3)+\". checking for more payload ...\"),this.level=e.nextLoadLevel=i;var f=a.details;if(!f||f.live&&this.levelLastLoaded!==i)this.state=Ae;else{if(this._streamEnded(d,f)){var p={};return this.altAudio&&(p.type=\"video\"),this.hls.trigger(c.default.BUFFER_EOS,p),void(this.state=Te)}this._fetchPayloadOrEos(n,d,f)}}}}},s._fetchPayloadOrEos=function(e,t,r){var n=this.fragPrevious,i=(this.level,r.fragments),a=i.length;if(0!==a){var o,s=i[0].start,l=i[a-1].start+i[a-1].duration,d=t.end;if(r.initSegment&&!r.initSegment.data)o=r.initSegment;else if(r.live){var u=this.config.initialLiveManifestSize;if(a<u)return void h.logger.warn(\"Can not start playback of a level, reason: not enough fragments \"+a+\" < \"+u);if(null===(o=this._ensureFragmentAtLivePoint(r,d,s,l,n,i)))return}else d<s&&(o=i[0]);(o=o||this._findFragment(s,n,a,i,d,l,r))&&(o.encrypted?this._loadKey(o,r):this._loadFragment(o,r,e,d))}},s._ensureFragmentAtLivePoint=function(e,t,r,n,i,a){var o,s,l,d,c=this.hls.config,f=this.media,p=1/0;return void 0!==c.liveMaxLatencyDuration?p=c.liveMaxLatencyDuration:Object(u.isFiniteNumber)(c.liveMaxLatencyDurationCount)&&(p=c.liveMaxLatencyDurationCount*e.targetduration),t<Math.max(r-c.maxFragLookUpTolerance,n-p)&&(t=s=this.liveSyncPosition=this.computeLivePosition(r,e),f&&!f.paused&&f.readyState&&f.duration>s&&s>f.currentTime&&(h.logger.log(\"buffer end: \"+t.toFixed(3)+\" is located too far from the end of live sliding playlist, reset currentTime to : \"+s.toFixed(3)),f.currentTime=s),this.nextLoadPosition=s),e.PTSKnown&&n<t&&f&&f.readyState?null:(this.startFragRequested&&!e.PTSKnown&&i&&(e.hasProgramDateTime?(h.logger.log(\"live playlist, switching playlist, load frag with same PDT: \"+i.programDateTime),o=ue(a,i.endProgramDateTime,c.maxFragLookUpTolerance)):((l=i.sn+1)>=e.startSN&&l<=e.endSN&&(d=a[l-e.startSN],i.cc===d.cc&&(o=d,h.logger.log(\"live playlist, switching playlist, load frag with next SN: \"+o.sn))),o||(o=V(a,(function(e){return i.cc-e.cc})))&&h.logger.log(\"live playlist, switching playlist, load frag with same CC: \"+o.sn))),o)},s._findFragment=function(e,t,r,n,i,a,o){var s,l,d,u,c,f,p=this.hls.config;return(s=i<a?ce(t,n,i,i>a-p.maxFragLookUpTolerance?0:p.maxFragLookUpTolerance):n[r-1])&&(l=s.sn-o.startSN,d=t&&s.level===t.level,u=n[l-1],c=n[1+l],t&&s.sn===t.sn&&(d&&!s.backtracked?s.sn<o.endSN?(f=t.deltaPTS)&&f>p.maxBufferHole&&t.dropped&&l?(s=u,h.logger.warn(\"Previous fragment was dropped with large PTS gap between audio and video. Maybe fragment is not starting with a keyframe? Loading previous one to try to overcome this\")):(s=c,this.fragmentTracker.getState(s)!==z&&h.logger.log(\"Re-loading fragment with SN: \"+s.sn)):s=null:s.backtracked&&(c&&c.backtracked?(h.logger.warn(\"Already backtracked from fragment \"+c.sn+\", will not backtrack to fragment \"+s.sn+\". Loading fragment \"+c.sn),s=c):(h.logger.warn(\"Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe\"),s.dropped=0,u?(s=u).backtracked=!0:l&&(s=null))))),s},s._loadKey=function(e,t){h.logger.log(\"Loading key for \"+e.sn+\" of [\"+t.startSN+\"-\"+t.endSN+\"], level \"+this.level),this.state=ve,this.hls.trigger(c.default.KEY_LOADING,{frag:e})},s._loadFragment=function(e,t,r,n){var i=this.fragmentTracker.getState(e);\"initSegment\"!==(this.fragCurrent=e).sn&&(this.startFragRequested=!0),Object(u.isFiniteNumber)(e.sn)&&!e.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),e.backtracked||i===N||i===G?(e.autoLevel=this.hls.autoLevelEnabled,e.bitrateTest=this.bitrateTest,h.logger.log(\"Loading \"+e.sn+\" of [\"+t.startSN+\"-\"+t.endSN+\"], level \"+this.level+\", \"+(this.loadedmetadata?\"currentTime\":\"nextLoadPosition\")+\": \"+parseFloat(r.toFixed(3))+\", bufferEnd: \"+parseFloat(n.toFixed(3))),this.hls.trigger(c.default.FRAG_LOADING,{frag:e}),this.demuxer||(this.demuxer=new ee(this.hls,\"main\")),this.state=_e):i===j&&this._reduceMaxBufferLength(e.duration)&&this.fragmentTracker.removeFragment(e)},s.getBufferedFrag=function(e){return this.fragmentTracker.getBufferedFrag(e,o.MAIN)},s.followingBufferedFrag=function(e){return e?this.getBufferedFrag(e.endPTS+.5):null},s._checkFragmentChanged=function(){var e,t,r,n,i=this.media;i&&i.readyState&&!1===i.seeking&&((n=i.currentTime)>this.lastCurrentTime&&(this.lastCurrentTime=n),Y.isBuffered(i,n)?e=this.getBufferedFrag(n):Y.isBuffered(i,n+.1)&&(e=this.getBufferedFrag(n+.1)),!e||(t=e)!==this.fragPlaying&&(this.hls.trigger(c.default.FRAG_CHANGED,{frag:t}),r=t.level,this.fragPlaying&&this.fragPlaying.level===r||this.hls.trigger(c.default.LEVEL_SWITCHED,{level:r}),this.fragPlaying=t))},s.immediateLevelSwitch=function(){var e,t;h.logger.log(\"immediateLevelSwitch\"),this.immediateSwitch||(this.immediateSwitch=!0,(e=this.media)?(t=e.paused)||e.pause():t=!0,this.previouslyPaused=t);var r=this.fragCurrent;r&&r.loader&&r.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},s.immediateLevelSwitchEnd=function(){var e=this.media;e&&e.buffered.length&&(this.immediateSwitch=!1,0<e.currentTime&&Y.isBuffered(e,e.currentTime)&&(e.currentTime-=1e-4),this.previouslyPaused||e.play())},s.nextLevelSwitch=function(){var e,t,r,n,i,a,o,s,l,d=this.media;d&&d.readyState&&((e=this.getBufferedFrag(d.currentTime))&&1<e.startPTS&&this.flushMainBuffer(0,e.startPTS-1),i=d.paused?0:(t=this.hls.nextLoadLevel,r=this.levels[t],(n=this.fragLastKbps)&&this.fragCurrent?this.fragCurrent.duration*r.bitrate/(1e3*n)+1:0),!(a=this.getBufferedFrag(d.currentTime+i))||(o=this.followingBufferedFrag(a))&&((s=this.fragCurrent)&&s.loader&&s.loader.abort(),this.fragCurrent=null,l=Math.max(a.endPTS,o.maxStartPTS+Math.min(this.config.maxFragLookUpTolerance,o.duration)),this.flushMainBuffer(l,Number.POSITIVE_INFINITY)))},s.flushMainBuffer=function(e,t){this.state=Se;var r={startOffset:e,endOffset:t};this.altAudio&&(r.type=\"video\"),this.hls.trigger(c.default.BUFFER_FLUSHING,r)},s.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener(\"seeking\",this.onvseeking),t.addEventListener(\"seeked\",this.onvseeked),t.addEventListener(\"ended\",this.onvended);var r=this.config;this.levels&&r.autoStartLoad&&this.hls.startLoad(r.startPosition),this.gapController=new fe(r,t,this.fragmentTracker,this.hls)},s.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(h.logger.log(\"MSE detaching and video ended, reset startPosition\"),this.startPosition=this.lastCurrentTime=0);var t=this.levels;t&&t.forEach((function(e){e.details&&e.details.fragments.forEach((function(e){e.backtracked=void 0}))})),e&&(e.removeEventListener(\"seeking\",this.onvseeking),e.removeEventListener(\"seeked\",this.onvseeked),e.removeEventListener(\"ended\",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.fragmentTracker.removeAllFragments(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()},s.onMediaSeeked=function(){var e=this.media,t=e?e.currentTime:void 0;Object(u.isFiniteNumber)(t)&&h.logger.log(\"media seeked to \"+t.toFixed(3)),this.tick()},s.onManifestLoading=function(){h.logger.log(\"trigger BUFFER_RESET\"),this.hls.trigger(c.default.BUFFER_RESET),this.fragmentTracker.removeAllFragments(),this.stalled=!1,this.startPosition=this.lastCurrentTime=0},s.onManifestParsed=function(e){var t,r=!1,n=!1;e.levels.forEach((function(e){(t=e.audioCodec)&&(-1!==t.indexOf(\"mp4a.40.2\")&&(r=!0),-1!==t.indexOf(\"mp4a.40.5\")&&(n=!0))})),this.audioCodecSwitch=r&&n,this.audioCodecSwitch&&h.logger.log(\"both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC\"),this.altAudio=e.altAudio,this.levels=e.levels,this.startFragRequested=!1;var i=this.config;(i.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(i.startPosition)},s.onLevelLoaded=function(e){var t,r,n=e.details,i=e.level,a=this.levels[this.levelLastLoaded],o=this.levels[i],s=n.totalduration,l=0;h.logger.log(\"level \"+i+\" loaded [\"+n.startSN+\",\"+n.endSN+\"],duration:\"+s),n.live?(t=o.details)&&0<n.fragments.length?(ie(t,n),l=n.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(l,t),n.PTSKnown&&Object(u.isFiniteNumber)(l)?h.logger.log(\"live playlist sliding:\"+l.toFixed(3)):(h.logger.log(\"live playlist - outdated PTS, unknown sliding\"),de(this.fragPrevious,a,n))):(h.logger.log(\"live playlist - first load, unknown sliding\"),n.PTSKnown=!1,de(this.fragPrevious,a,n)):n.PTSKnown=!1,o.details=n,this.levelLastLoaded=i,this.hls.trigger(c.default.LEVEL_UPDATED,{details:n,level:i}),!1===this.startFragRequested&&(-1!==this.startPosition&&-1!==this.lastCurrentTime||(r=n.startTimeOffset,Object(u.isFiniteNumber)(r)?(r<0&&(h.logger.log(\"negative start time offset \"+r+\", count from end of last fragment\"),r=l+s+r),h.logger.log(\"start time offset found in playlist, adjust startPosition to \"+r),this.startPosition=r):n.live?(this.startPosition=this.computeLivePosition(l,n),h.logger.log(\"configure startPosition to \"+this.startPosition)):this.startPosition=0,this.lastCurrentTime=this.startPosition),this.nextLoadPosition=this.startPosition),this.state===Ae&&(this.state=ye),this.tick()},s.onKeyLoaded=function(){this.state===ve&&(this.state=ye,this.tick())},s.onFragLoaded=function(e){var t,r,n,i,a,o,s=this.fragCurrent,l=this.hls,d=this.levels,u=this.media,f=e.frag;this.state===_e&&s&&\"main\"===f.type&&f.level===s.level&&f.sn===s.sn&&(t=e.stats,n=(r=d[s.level]).details,this.bitrateTest=!1,this.stats=t,h.logger.log(\"Loaded \"+s.sn+\" of [\"+n.startSN+\" ,\"+n.endSN+\"],level \"+s.level),f.bitrateTest&&l.nextLoadLevel?(this.state=ye,this.startFragRequested=!1,t.tparsed=t.tbuffered=window.performance.now(),l.trigger(c.default.FRAG_BUFFERED,{stats:t,frag:s,id:\"main\"}),this.tick()):\"initSegment\"===f.sn?(this.state=ye,t.tparsed=t.tbuffered=window.performance.now(),n.initSegment.data=e.payload,l.trigger(c.default.FRAG_BUFFERED,{stats:t,frag:s,id:\"main\"}),this.tick()):(h.logger.log(\"Parsing \"+s.sn+\" of [\"+n.startSN+\" ,\"+n.endSN+\"],level \"+s.level+\", cc \"+s.cc),this.state=ke,this.pendingBuffering=!0,this.appended=!1,f.bitrateTest&&(f.bitrateTest=!1,this.fragmentTracker.onFragLoaded({frag:f})),i=!(u&&u.seeking)&&(n.PTSKnown||!n.live),a=n.initSegment?n.initSegment.data:[],o=this._getAudioCodec(r),(this.demuxer=this.demuxer||new ee(this.hls,\"main\")).push(e.payload,a,o,r.videoCodec,s,n.totalduration,i))),this.fragLoadError=0},s.onFragParsingInitSegment=function(e){var t=this.fragCurrent,r=e.frag;if(t&&\"main\"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===ke){var n,i,a,o,s=e.tracks;for(n in this.audioOnly=s.audio&&!s.video,this.altAudio&&!this.audioOnly&&delete s.audio,(i=s.audio)&&(a=this.levels[this.level].audioCodec,o=navigator.userAgent.toLowerCase(),a&&this.audioCodecSwap&&(h.logger.log(\"swapping playlist audio codec\"),a=-1!==a.indexOf(\"mp4a.40.5\")?\"mp4a.40.2\":\"mp4a.40.5\"),this.audioCodecSwitch&&1!==i.metadata.channelCount&&-1===o.indexOf(\"firefox\")&&(a=\"mp4a.40.5\"),-1!==o.indexOf(\"android\")&&\"audio/mpeg\"!==i.container&&(a=\"mp4a.40.2\",h.logger.log(\"Android: force audio codec to \"+a)),i.levelCodec=a,i.id=e.id),(i=s.video)&&(i.levelCodec=this.levels[this.level].videoCodec,i.id=e.id),this.hls.trigger(c.default.BUFFER_CODECS,s),s){i=s[n],h.logger.log(\"main track:\"+n+\",container:\"+i.container+\",codecs[level/parsed]=[\"+i.levelCodec+\"/\"+i.codec+\"]\");var l=i.initSegment;l&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(c.default.BUFFER_APPENDING,{type:n,data:l,parent:\"main\",content:\"initSegment\"}))}this.tick()}},s.onFragParsingData=function(e){var t=this,r=this.fragCurrent,n=e.frag;if(r&&\"main\"===e.id&&n.sn===r.sn&&n.level===r.level&&(\"audio\"!==e.type||!this.altAudio)&&this.state===ke){var i=this.levels[this.level],a=r;if(Object(u.isFiniteNumber)(e.endPTS)||(e.endPTS=e.startPTS+r.duration,e.endDTS=e.startDTS+r.duration),!0===e.hasAudio&&a.addElementaryStream(y.AUDIO),!0===e.hasVideo&&a.addElementaryStream(y.VIDEO),h.logger.log(\"Parsed \"+e.type+\",PTS:[\"+e.startPTS.toFixed(3)+\",\"+e.endPTS.toFixed(3)+\"],DTS:[\"+e.startDTS.toFixed(3)+\"/\"+e.endDTS.toFixed(3)+\"],nb:\"+e.nb+\",dropped:\"+(e.dropped||0)),\"video\"===e.type)if(a.dropped=e.dropped,a.dropped)if(a.backtracked)h.logger.warn(\"Already backtracked on this fragment, appending with the gap\",a.sn);else{var o=i.details;if(!o||a.sn!==o.startSN)return h.logger.warn(\"missing video frame(s), backtracking fragment\",a.sn),this.fragmentTracker.removeFragment(a),a.backtracked=!0,this.nextLoadPosition=e.startPTS,this.state=ye,this.fragPrevious=a,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),void this.tick();h.logger.warn(\"missing video frame(s) on first frag, appending with gap\",a.sn)}else a.backtracked=!1;var s=ne(i.details,a,e.startPTS,e.endPTS,e.startDTS,e.endDTS),l=this.hls;l.trigger(c.default.LEVEL_PTS_UPDATED,{details:i.details,level:this.level,drift:s,type:e.type,start:e.startPTS,end:e.endPTS}),[e.data1,e.data2].forEach((function(r){r&&r.length&&t.state===ke&&(t.appended=!0,t.pendingBuffering=!0,l.trigger(c.default.BUFFER_APPENDING,{type:e.type,data:r,parent:\"main\",content:\"data\"}))})),this.tick()}},s.onFragParsed=function(e){var t=this.fragCurrent,r=e.frag;t&&\"main\"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===ke&&(this.stats.tparsed=window.performance.now(),this.state=we,this._checkAppendedParsed())},s.onAudioTrackSwitching=function(e){var t,r,n=this.altAudio,i=!!e.url,a=e.id;i||(this.mediaBuffer!==this.media&&(h.logger.log(\"switching on main audio, use media.buffered to schedule main fragment loading\"),this.mediaBuffer=this.media,(t=this.fragCurrent).loader&&(h.logger.log(\"switching to main audio track, cancel main fragment load\"),t.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=ye),r=this.hls,n&&r.trigger(c.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:\"audio\"}),r.trigger(c.default.AUDIO_TRACK_SWITCHED,{id:a}))},s.onAudioTrackSwitched=function(e){var t,r=e.id,n=!!this.hls.audioTracks[r].url;!n||(t=this.videoBuffer)&&this.mediaBuffer!==t&&(h.logger.log(\"switching on alternate audio, use video.buffered to schedule main fragment loading\"),this.mediaBuffer=t),this.altAudio=n,this.tick()},s.onBufferCreated=function(e){var t,r,n=e.tracks,i=!1;for(var a in n){var o=n[a];\"main\"===o.id?(t=o,\"video\"===(r=a)&&(this.videoBuffer=n[a].buffer)):i=!0}i&&t?(h.logger.log(\"alternate track found, use \"+r+\".buffered to schedule main fragment loading\"),this.mediaBuffer=t.buffer):this.mediaBuffer=this.media},s.onBufferAppended=function(e){var t;\"main\"===e.parent&&((t=this.state)!==ke&&t!==we||(this.pendingBuffering=0<e.pending,this._checkAppendedParsed()))},s._checkAppendedParsed=function(){var e,t,r;this.state!==we||this.appended&&this.pendingBuffering||((e=this.fragCurrent)&&(t=this.mediaBuffer?this.mediaBuffer:this.media,h.logger.log(\"main buffered : \"+se(t.buffered)),this.fragPrevious=e,(r=this.stats).tbuffered=window.performance.now(),this.fragLastKbps=Math.round(8*r.total/(r.tbuffered-r.tfirst)),this.hls.trigger(c.default.FRAG_BUFFERED,{stats:r,frag:e,id:\"main\"}),this.state=ye),(this.loadedmetadata||this.startPosition<=0)&&this.tick())},s.onError=function(e){var t=e.frag||this.fragCurrent;if(!t||\"main\"===t.type){var r,n=!!this.media&&Y.isBuffered(this.media,this.media.currentTime)&&Y.isBuffered(this.media,this.media.currentTime+.5);switch(e.details){case d.ErrorDetails.FRAG_LOAD_ERROR:case d.ErrorDetails.FRAG_LOAD_TIMEOUT:case d.ErrorDetails.KEY_LOAD_ERROR:case d.ErrorDetails.KEY_LOAD_TIMEOUT:e.fatal||(this.fragLoadError+1<=this.config.fragLoadingMaxRetry?(r=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout),h.logger.warn(\"mediaController: frag loading failed, retry in \"+r+\" ms\"),this.retryDate=window.performance.now()+r,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.fragLoadError++,this.state=be):(h.logger.error(\"mediaController: \"+e.details+\" reaches max retry, redispatch as fatal ...\"),e.fatal=!0,this.state=xe));break;case d.ErrorDetails.LEVEL_LOAD_ERROR:case d.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==xe&&(e.fatal?(this.state=xe,h.logger.warn(\"streamController: \"+e.details+\",switch to \"+this.state+\" state ...\")):e.levelRetry||this.state!==Ae||(this.state=ye));break;case d.ErrorDetails.BUFFER_FULL_ERROR:\"main\"!==e.parent||this.state!==ke&&this.state!==we||(n?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=ye):(h.logger.warn(\"buffer full error also media.currentTime is not buffered, flush everything\"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)))}}},s._reduceMaxBufferLength=function(e){var t=this.config;return t.maxMaxBufferLength>=e&&(t.maxMaxBufferLength/=2,h.logger.warn(\"main:reduce max buffer length to \"+t.maxMaxBufferLength+\"s\"),!0)},s._checkBuffer=function(){var e,t=this.media;t&&0!==t.readyState&&(e=(this.mediaBuffer?this.mediaBuffer:t).buffered,!this.loadedmetadata&&e.length?(this.loadedmetadata=!0,this._seekToStartPos()):this.immediateSwitch?this.immediateLevelSwitchEnd():this.gapController.poll(this.lastCurrentTime,e))},s.onFragLoadEmergencyAborted=function(){this.state=ye,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()},s.onBufferFlushed=function(){var e,t=this.mediaBuffer?this.mediaBuffer:this.media;t&&(e=this.audioOnly?y.AUDIO:y.VIDEO,this.fragmentTracker.detectEvictedFragments(e,t.buffered)),this.state=ye,this.fragPrevious=null},s.onLevelsUpdated=function(e){this.levels=e.levels},s.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},s._seekToStartPos=function(){var e=this.media,t=e.currentTime,r=this.startPosition;if(t!==r&&0<=r){if(e.seeking)return void h.logger.log(\"could not seek to \"+r+\", already seeking at \"+t);var n=(e.buffered.length?e.buffered.start(0):0)-r;0<n&&n<this.config.maxBufferHole&&(h.logger.log(\"adjusting start position by \"+n+\" to match buffer start\"),r+=n,this.startPosition=r),h.logger.log(\"seek to target start position \"+r+\" from current time \"+t+\". ready state \"+e.readyState),e.currentTime=r}},s._getAudioCodec=function(e){var t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&(h.logger.log(\"swapping playlist audio codec\"),t=t&&(-1!==t.indexOf(\"mp4a.40.5\")?\"mp4a.40.2\":\"mp4a.40.5\")),t},i=n,(a=[{key:\"state\",set:function(e){var t;this.state!==e&&(t=this.state,this._state=e,h.logger.log(\"main stream-controller: \"+t+\"->\"+e),this.hls.trigger(c.default.STREAM_STATE_TRANSITION,{previousState:t,nextState:e}))},get:function(){return this._state}},{key:\"currentLevel\",get:function(){var e=this.media;if(e){var t=this.getBufferedFrag(e.currentTime);if(t)return t.level}return-1}},{key:\"nextBufferedFrag\",get:function(){var e=this.media;return e?this.followingBufferedFrag(this.getBufferedFrag(e.currentTime)):null}},{key:\"nextLevel\",get:function(){var e=this.nextBufferedFrag;return e?e.level:-1}},{key:\"liveSyncPosition\",get:function(){return this._liveSyncPosition},set:function(e){this._liveSyncPosition=e}}])&&De(i.prototype,a),n}(Re);function Ie(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Me=function(e){var t,r;function n(t){var r=e.call(this,t,c.default.MANIFEST_LOADED,c.default.LEVEL_LOADED,c.default.AUDIO_TRACK_SWITCHED,c.default.FRAG_LOADED,c.default.ERROR)||this;return r.canload=!1,r.currentLevelIndex=null,r.manualLevelIndex=-1,r.timer=null,Oe=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),r}r=e,(t=n).prototype=Object.create(r.prototype),(t.prototype.constructor=t).__proto__=r;var i,a,o=n.prototype;return o.onHandlerDestroying=function(){this.clearTimer(),this.manualLevelIndex=-1},o.clearTimer=function(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null)},o.startLoad=function(){var e=this._levels;this.canload=!0,this.levelRetryCount=0,e&&e.forEach((function(e){e.loadError=0;var t=e.details;t&&t.live&&(e.details=void 0)})),null!==this.timer&&this.loadLevel()},o.stopLoad=function(){this.canload=!1},o.onManifestLoaded=function(e){var t,r=[],n=[],i={},a=null,o=!1,s=!1;if(e.levels.forEach((function(e){var t=e.attrs;e.loadError=0,e.fragmentError=!1,o=o||!!e.videoCodec,s=s||!!e.audioCodec,Oe&&e.audioCodec&&-1!==e.audioCodec.indexOf(\"mp4a.40.34\")&&(e.audioCodec=void 0),(a=i[e.bitrate])?a.url.push(e.url):(e.url=[e.url],e.urlId=0,i[e.bitrate]=e,r.push(e)),t&&(t.AUDIO&&te(a||e,\"audio\",t.AUDIO),t.SUBTITLES&&te(a||e,\"text\",t.SUBTITLES))})),o&&s&&(r=r.filter((function(e){return!!e.videoCodec}))),r=r.filter((function(e){var t=e.audioCodec,r=e.videoCodec;return(!t||A(t,\"audio\"))&&(!r||A(r,\"video\"))})),e.audioTracks&&(n=e.audioTracks.filter((function(e){return!e.audioCodec||A(e.audioCodec,\"audio\")}))).forEach((function(e,t){e.id=t})),0<r.length){t=r[0].bitrate,r.sort((function(e,t){return e.bitrate-t.bitrate})),this._levels=r;for(var l=0;l<r.length;l++)if(r[l].bitrate===t){this._firstLevel=l,h.logger.log(\"manifest loaded,\"+r.length+\" level(s) found, first bitrate:\"+t);break}var u=s&&!o;this.hls.trigger(c.default.MANIFEST_PARSED,{levels:r,audioTracks:n,firstLevel:this._firstLevel,stats:e.stats,audio:s,video:o,altAudio:!u&&n.some((function(e){return!!e.url}))})}else this.hls.trigger(c.default.ERROR,{type:d.ErrorTypes.MEDIA_ERROR,details:d.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:this.hls.url,reason:\"no level with compatible codecs found in manifest\"})},o.setLevelInternal=function(e){var t,r,n,i,a=this._levels,o=this.hls;0<=e&&e<a.length?(this.clearTimer(),this.currentLevelIndex!==e&&(h.logger.log(\"switching to level \"+e),(t=a[this.currentLevelIndex=e]).level=e,o.trigger(c.default.LEVEL_SWITCHING,t)),(n=(r=a[e]).details)&&!n.live||(i=r.urlId,o.trigger(c.default.LEVEL_LOADING,{url:r.url[i],level:e,id:i}))):o.trigger(c.default.ERROR,{type:d.ErrorTypes.OTHER_ERROR,details:d.ErrorDetails.LEVEL_SWITCH_ERROR,level:e,fatal:!1,reason:\"invalid level idx\"})},o.onError=function(e){if(e.fatal)e.type===d.ErrorTypes.NETWORK_ERROR&&this.clearTimer();else{var t,r=!1,n=!1;switch(e.details){case d.ErrorDetails.FRAG_LOAD_ERROR:case d.ErrorDetails.FRAG_LOAD_TIMEOUT:case d.ErrorDetails.KEY_LOAD_ERROR:case d.ErrorDetails.KEY_LOAD_TIMEOUT:t=e.frag.level,n=!0;break;case d.ErrorDetails.LEVEL_LOAD_ERROR:case d.ErrorDetails.LEVEL_LOAD_TIMEOUT:t=e.context.level,r=!0;break;case d.ErrorDetails.REMUX_ALLOC_ERROR:t=e.level,r=!0}void 0!==t&&this.recoverLevel(e,t,r,n)}},o.recoverLevel=function(e,t,r,n){var i,a,o,s=this,l=this.hls.config,d=e.details,u=this._levels[t];if(u.loadError++,u.fragmentError=n,r){if(!(this.levelRetryCount+1<=l.levelLoadingMaxRetry))return h.logger.error(\"level controller, cannot recover from \"+d+\" error\"),this.currentLevelIndex=null,this.clearTimer(),void(e.fatal=!0);a=Math.min(Math.pow(2,this.levelRetryCount)*l.levelLoadingRetryDelay,l.levelLoadingMaxRetryTimeout),this.timer=setTimeout((function(){return s.loadLevel()}),a),e.levelRetry=!0,this.levelRetryCount++,h.logger.warn(\"level controller, \"+d+\", retry in \"+a+\" ms, current retry count is \"+this.levelRetryCount)}(r||n)&&(1<(i=u.url.length)&&u.loadError<i?(u.urlId=(u.urlId+1)%i,u.details=void 0,h.logger.warn(\"level controller, \"+d+\" for level \"+t+\": switching to redundant URL-id \"+u.urlId)):-1===this.manualLevelIndex?(o=0===t?this._levels.length-1:t-1,h.logger.warn(\"level controller, \"+d+\": switch to \"+o),this.hls.nextAutoLevel=this.currentLevelIndex=o):n&&(h.logger.warn(\"level controller, \"+d+\": reload a fragment\"),this.currentLevelIndex=null))},o.onFragLoaded=function(e){var t,r=e.frag;void 0===r||\"main\"!==r.type||void 0!==(t=this._levels[r.level])&&(t.fragmentError=!1,t.loadError=0,this.levelRetryCount=0)},o.onLevelLoaded=function(e){var t,r,n=this,i=e.level,a=e.details;i===this.currentLevelIndex&&((t=this._levels[i]).fragmentError||(t.loadError=0,this.levelRetryCount=0),a.live?(r=oe(t.details,a,e.stats.trequest),h.logger.log(\"live playlist, reload in \"+Math.round(r)+\" ms\"),this.timer=setTimeout((function(){return n.loadLevel()}),r)):this.clearTimer())},o.onAudioTrackSwitched=function(e){var t=this.hls.audioTracks[e.id].groupId,r=this.hls.levels[this.currentLevelIndex];if(r&&r.audioGroupIds){for(var n=-1,i=0;i<r.audioGroupIds.length;i++)if(r.audioGroupIds[i]===t){n=i;break}n!==r.urlId&&(r.urlId=n,this.startLoad())}},o.loadLevel=function(){var e,t,r,n;h.logger.debug(\"call to loadLevel\"),null===this.currentLevelIndex||!this.canload||\"object\"==typeof(e=this._levels[this.currentLevelIndex])&&0<e.url.length&&(t=this.currentLevelIndex,r=e.urlId,n=e.url[r],h.logger.log(\"Attempt loading level index \"+t+\" with URL-id \"+r),this.hls.trigger(c.default.LEVEL_LOADING,{url:n,level:t,id:r}))},o.removeLevel=function(e,t){var r=this.levels.filter((function(r,n){return n!==e||1<r.url.length&&void 0!==t&&(r.url=r.url.filter((function(e,r){return r!==t})),!(r.urlId=0))})).map((function(e,t){var r=e.details;return r&&r.fragments&&r.fragments.forEach((function(e){e.level=t})),e}));this._levels=r,this.hls.trigger(c.default.LEVELS_UPDATED,{levels:r})},i=n,(a=[{key:\"levels\",get:function(){return this._levels}},{key:\"level\",get:function(){return this.currentLevelIndex},set:function(e){var t=this._levels;t&&(e=Math.min(e,t.length-1),this.currentLevelIndex===e&&t[e].details||this.setLevelInternal(e))}},{key:\"manualLevel\",get:function(){return this.manualLevelIndex},set:function(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}},{key:\"firstLevel\",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:\"startLevel\",get:function(){if(void 0!==this._startLevel)return this._startLevel;var e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel},set:function(e){this._startLevel=e}},{key:\"nextLoadLevel\",get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}}])&&Ie(i.prototype,a),n}(p),Pe=r(\"./src/demux/id3.js\");function Be(e,t){var r;try{r=new Event(\"addtrack\")}catch(e){(r=document.createEvent(\"Event\")).initEvent(\"addtrack\",!1,!1)}r.track=e,t.dispatchEvent(r)}function Fe(e){if(null!=e&&e.cues)for(;0<e.cues.length;)e.removeCue(e.cues[0])}var Ue=function(e){var t,r;function n(t){var r=e.call(this,t,c.default.MEDIA_ATTACHED,c.default.MEDIA_DETACHING,c.default.FRAG_PARSING_METADATA,c.default.LIVE_BACK_BUFFER_REACHED)||this;return r.id3Track=void 0,r.media=void 0,r}r=e,(t=n).prototype=Object.create(r.prototype),(t.prototype.constructor=t).__proto__=r;var i=n.prototype;return i.destroy=function(){p.prototype.destroy.call(this)},i.onMediaAttached=function(e){this.media=e.media,this.media},i.onMediaDetaching=function(){Fe(this.id3Track),this.id3Track=void 0,this.media=void 0},i.getID3Track=function(e){for(var t=0;t<e.length;t++){var r=e[t];if(\"metadata\"===r.kind&&\"id3\"===r.label)return Be(r,this.media),r}return this.media.addTextTrack(\"metadata\",\"id3\")},i.onFragParsingMetadata=function(e){var t=e.frag,r=e.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode=\"hidden\");for(var n=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,i=0;i<r.length;i++){var a=Pe.default.getID3Frames(r[i].data);if(a){var o=Math.max(r[i].pts,0),s=i<r.length-1?r[i+1].pts:t.endPTS;(s=s||t.start+t.duration)-o<=0&&(s=o+.25);for(var l=0;l<a.length;l++){var d,u=a[l];Pe.default.isTimeStampFrame(u)||((d=new n(o,s,\"\")).value=u,this.id3Track.addCue(d))}}}},i.onLiveBackBufferReached=function(e){var t=e.bufferEnd,r=this.id3Track;if(r&&r.cues&&r.cues.length){var n=function(e,t){if(t<e[0].endTime)return e[0];if(t>e[e.length-1].endTime)return e[e.length-1];for(var r=0,n=e.length-1;r<=n;){var i=Math.floor((n+r)/2);if(t<e[i].endTime)n=i-1;else{if(!(t>e[i].endTime))return e[i];r=i+1}}return e[r].endTime-t<t-e[n].endTime?e[r]:e[n]}(r.cues,t);if(n)for(;r.cues[0]!==n;)r.removeCue(r.cues[0])}},n}(p),Ne=function(){function e(e){this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=0,this.totalWeight_=0}var t=e.prototype;return t.sample=function(e,t){var r=Math.pow(this.alpha_,e);this.estimate_=t*(1-r)+r*this.estimate_,this.totalWeight_+=e},t.getTotalWeight=function(){return this.totalWeight_},t.getEstimate=function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/e}return this.estimate_},e}(),je=function(){function e(e,t,r,n){this.hls=void 0,this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.hls=e,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Ne(t),this.fast_=new Ne(r)}var t=e.prototype;return t.sample=function(e,t){var r=(e=Math.max(e,this.minDelayMs_))/1e3,n=8*t/r;this.fast_.sample(r,n),this.slow_.sample(r,n)},t.canEstimate=function(){var e=this.fast_;return e&&e.getTotalWeight()>=this.minWeight_},t.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},t.destroy=function(){},e}();function Ge(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var ze=window.performance,qe=function(e){var t,r;function n(t){var r=e.call(this,t,c.default.FRAG_LOADING,c.default.FRAG_LOADED,c.default.FRAG_BUFFERED,c.default.ERROR)||this;return r.lastLoadedFragLevel=0,r._nextAutoLevel=-1,r.hls=t,r.timer=null,r._bwEstimator=null,r.onCheck=r._abandonRulesCheck.bind(function(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}(r)),r}r=e,(t=n).prototype=Object.create(r.prototype),(t.prototype.constructor=t).__proto__=r;var i,a,o=n.prototype;return o.destroy=function(){this.clearTimer(),p.prototype.destroy.call(this)},o.onFragLoading=function(e){var t,r,n,i,a,o=e.frag;\"main\"===o.type&&(this.timer||(this.fragCurrent=o,this.timer=setInterval(this.onCheck,100)),this._bwEstimator||(r=(t=this.hls).config,n=o.level,a=t.levels[n].details.live?(i=r.abrEwmaFastLive,r.abrEwmaSlowLive):(i=r.abrEwmaFastVoD,r.abrEwmaSlowVoD),this._bwEstimator=new je(t,a,i,r.abrEwmaDefaultEstimate)))},o._abandonRulesCheck=function(){var e=this.hls,t=e.media,r=this.fragCurrent;if(r){var n=r.loader;if(!n||n.stats&&n.stats.aborted)return h.logger.warn(\"frag loader destroy or aborted, disarm abandonRules\"),this.clearTimer(),void(this._nextAutoLevel=-1);var i=n.stats;if(t&&i&&(!t.paused&&0!==t.playbackRate||!t.readyState)&&r.autoLevel&&r.level){var a=ze.now()-i.trequest,o=Math.abs(t.playbackRate);if(a>500*r.duration/o){var s=e.levels,l=Math.max(1,i.bw?i.bw/8:1e3*i.loaded/a),d=s[r.level];if(!d)return;var u=d.realBitrate?Math.max(d.realBitrate,d.bitrate):d.bitrate,f=i.total?i.total:Math.max(i.loaded,Math.round(r.duration*u/8)),p=t.currentTime,m=(f-i.loaded)/l,g=(Y.bufferInfo(t,p,e.config.maxBufferHole).end-p)/o;if(g<2*r.duration/o&&g<m){for(var y=e.minAutoLevel,v=r.level-1;y<v;v--){var _=s[v].realBitrate?Math.max(s[v].realBitrate,s[v].bitrate):s[v].bitrate;if(r.duration*_/(6.4*l)<g)break}void 0<m&&(h.logger.warn(\"loading too slow, abort fragment loading and switch to level \"+v+\":fragLoadedDelay[\"+v+\"]<fragLoadedDelay[\"+(r.level-1)+\"];bufferStarvationDelay:\"+(void 0).toFixed(1)+\"<\"+m.toFixed(1)+\":\"+g.toFixed(1)),e.nextLoadLevel=v,this._bwEstimator.sample(a,i.loaded),n.abort(),this.clearTimer(),e.trigger(c.default.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r,stats:i}))}}}}},o.onFragLoaded=function(e){var t,r,n,i,a=e.frag;\"main\"===a.type&&Object(u.isFiniteNumber)(a.sn)&&(this.clearTimer(),this.lastLoadedFragLevel=a.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate&&(r=((t=this.hls.levels[a.level]).loaded?t.loaded.bytes:0)+e.stats.loaded,n=(t.loaded?t.loaded.duration:0)+e.frag.duration,t.loaded={bytes:r,duration:n},t.realBitrate=Math.round(8*r/n)),e.frag.bitrateTest&&((i=e.stats).tparsed=i.tbuffered=i.tload,this.onFragBuffered(e)))},o.onFragBuffered=function(e){var t,r=e.stats,n=e.frag;!0===r.aborted||\"main\"!==n.type||!Object(u.isFiniteNumber)(n.sn)||n.bitrateTest&&r.tload!==r.tbuffered||(t=r.tparsed-r.trequest,h.logger.log(\"latency/loading/parsing/append/kbps:\"+Math.round(r.tfirst-r.trequest)+\"/\"+Math.round(r.tload-r.tfirst)+\"/\"+Math.round(r.tparsed-r.tload)+\"/\"+Math.round(r.tbuffered-r.tparsed)+\"/\"+Math.round(8*r.loaded/(r.tbuffered-r.trequest))),this._bwEstimator.sample(t,r.loaded),r.bwEstimate=this._bwEstimator.getEstimate(),n.bitrateTest?this.bitrateTestDelay=t/1e3:this.bitrateTestDelay=0)},o.onError=function(e){switch(e.details){case d.ErrorDetails.FRAG_LOAD_ERROR:case d.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}},o.clearTimer=function(){clearInterval(this.timer),this.timer=null},o._findBestLevel=function(e,t,r,n,i,a,o,s,l){for(var d=i;n<=d;d--){var u=l[d];if(u){var c=u.details,f=c?c.totalduration/c.fragments.length:t,p=!!c&&c.live,m=d<=e?o*r:s*r,g=l[d].realBitrate?Math.max(l[d].realBitrate,l[d].bitrate):l[d].bitrate,y=g*f/m;if(h.logger.trace(\"level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: \"+d+\"/\"+Math.round(m)+\"/\"+g+\"/\"+f+\"/\"+a+\"/\"+y),g<m&&(!y||p&&!this.bitrateTestDelay||y<a))return d}}return-1},i=n,(a=[{key:\"nextAutoLevel\",get:function(){var e=this._nextAutoLevel,t=this._bwEstimator;if(!(-1===e||t&&t.canEstimate()))return e;var r=this._nextABRAutoLevel;return-1!==e&&(r=Math.min(e,r)),r},set:function(e){this._nextAutoLevel=e}},{key:\"_nextABRAutoLevel\",get:function(){var e=this.hls,t=e.maxAutoLevel,r=e.levels,n=e.config,i=e.minAutoLevel,a=e.media,o=this.lastLoadedFragLevel,s=this.fragCurrent?this.fragCurrent.duration:0,l=a?a.currentTime:0,d=a&&0!==a.playbackRate?Math.abs(a.playbackRate):1,u=this._bwEstimator?this._bwEstimator.getEstimate():n.abrEwmaDefaultEstimate,c=(Y.bufferInfo(a,l,n.maxBufferHole).end-l)/d,f=this._findBestLevel(o,s,u,i,t,c,n.abrBandWidthFactor,n.abrBandWidthUpFactor,r);if(0<=f)return f;h.logger.trace(\"rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering\");var p,m=s?Math.min(s,n.maxStarvationDelay):n.maxStarvationDelay,g=n.abrBandWidthFactor,y=n.abrBandWidthUpFactor;return 0!=c||(p=this.bitrateTestDelay)&&(m=(s?Math.min(s,n.maxLoadingDelay):n.maxLoadingDelay)-p,h.logger.trace(\"bitrate test took \"+Math.round(1e3*p)+\"ms, set first fragment max fetchDuration to \"+Math.round(1e3*m)+\" ms\"),g=y=1),f=this._findBestLevel(o,s,u,i,t,c+m,g,y,r),Math.max(f,0)}}])&&Ge(i.prototype,a),n}(p),Ve=X(),Ye=function(e){var t,r;function n(t){var r=e.call(this,t,c.default.MEDIA_ATTACHING,c.default.MEDIA_DETACHING,c.default.MANIFEST_PARSED,c.default.BUFFER_RESET,c.default.BUFFER_APPENDING,c.default.BUFFER_CODECS,c.default.BUFFER_EOS,c.default.BUFFER_FLUSHING,c.default.LEVEL_PTS_UPDATED,c.default.LEVEL_UPDATED)||this;return r._msDuration=null,r._levelDuration=null,r._levelTargetDuration=10,r._live=null,r._objectUrl=null,r._needsFlush=!1,r._needsEos=!1,r.config=void 0,r.audioTimestampOffset=void 0,r.bufferCodecEventsExpected=0,r._bufferCodecEventsTotal=0,r.media=null,r.mediaSource=null,r.segments=[],r.parent=void 0,r.appending=!1,r.appended=0,r.appendError=0,r.flushBufferCounter=0,r.tracks={},r.pendingTracks={},r.sourceBuffer={},r.flushRange=[],r._onMediaSourceOpen=function(){h.logger.log(\"media source opened\"),r.hls.trigger(c.default.MEDIA_ATTACHED,{media:r.media});var e=r.mediaSource;e&&e.removeEventListener(\"sourceopen\",r._onMediaSourceOpen),r.checkPendingTracks()},r._onMediaSourceClose=function(){h.logger.log(\"media source closed\")},r._onMediaSourceEnded=function(){h.logger.log(\"media source ended\")},r._onSBUpdateEnd=function(){var e;r.audioTimestampOffset&&r.sourceBuffer.audio&&(e=r.sourceBuffer.audio,h.logger.warn(\"change mpeg audio timestamp offset from \"+e.timestampOffset+\" to \"+r.audioTimestampOffset),e.timestampOffset=r.audioTimestampOffset,delete r.audioTimestampOffset),r._needsFlush&&r.doFlush(),r._needsEos&&r.checkEos(),r.appending=!1;var t=r.parent,n=r.segments.reduce((function(e,r){return r.parent===t?e+1:e}),0),i={},a=r.sourceBuffer;for(var o in a){var s=a[o];if(!s)throw Error(\"handling source buffer update end error: source buffer for \"+o+\" uninitilized and unable to update buffered TimeRanges.\");i[o]=s.buffered}r.hls.trigger(c.default.BUFFER_APPENDED,{parent:t,pending:n,timeRanges:i}),r._needsFlush||r.doAppending(),r.updateMediaElementDuration(),0===n&&r.flushLiveBackBuffer()},r._onSBUpdateError=function(e){h.logger.error(\"sourceBuffer error:\",e),r.hls.trigger(c.default.ERROR,{type:d.ErrorTypes.MEDIA_ERROR,details:d.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})},r.config=t.config,r}r=e,(t=n).prototype=Object.create(r.prototype),(t.prototype.constructor=t).__proto__=r;var i=n.prototype;return i.destroy=function(){p.prototype.destroy.call(this)},i.onLevelPtsUpdated=function(e){var t=e.type,r=this.tracks.audio;if(\"audio\"===t&&r&&\"audio/mpeg\"===r.container){var n=this.sourceBuffer.audio;if(!n)throw Error(\"Level PTS Updated and source buffer for audio uninitalized\");if(.1<Math.abs(n.timestampOffset-e.start)){var i=n.updating;try{n.abort()}catch(e){h.logger.warn(\"can not abort audio buffer: \"+e)}i?this.audioTimestampOffset=e.start:(h.logger.warn(\"change mpeg audio timestamp offset from \"+n.timestampOffset+\" to \"+e.start),n.timestampOffset=e.start)}}},i.onManifestParsed=function(e){var t=2;(!e.audio||e.video)&&e.altAudio||(t=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=t,h.logger.log(this.bufferCodecEventsExpected+\" bufferCodec event(s) expected\")},i.onMediaAttaching=function(e){var t,r=this.media=e.media;r&&Ve&&((t=this.mediaSource=new Ve).addEventListener(\"sourceopen\",this._onMediaSourceOpen),t.addEventListener(\"sourceended\",this._onMediaSourceEnded),t.addEventListener(\"sourceclose\",this._onMediaSourceClose),r.src=window.URL.createObjectURL(t),this._objectUrl=r.src)},i.onMediaDetaching=function(){h.logger.log(\"media source detaching\");var e=this.mediaSource;if(e){if(\"open\"===e.readyState)try{e.endOfStream()}catch(e){h.logger.warn(\"onMediaDetaching:\"+e.message+\" while calling endOfStream\")}e.removeEventListener(\"sourceopen\",this._onMediaSourceOpen),e.removeEventListener(\"sourceended\",this._onMediaSourceEnded),e.removeEventListener(\"sourceclose\",this._onMediaSourceClose),this.media&&(this._objectUrl&&window.URL.revokeObjectURL(this._objectUrl),this.media.src===this._objectUrl?(this.media.removeAttribute(\"src\"),this.media.load()):h.logger.warn(\"media.src was changed by a third party - skip cleanup\")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.hls.trigger(c.default.MEDIA_DETACHED)},i.checkPendingTracks=function(){var e=this.bufferCodecEventsExpected,t=this.pendingTracks,r=Object.keys(t).length;(r&&!e||2===r)&&(this.createSourceBuffers(t),this.pendingTracks={},this.doAppending())},i.onBufferReset=function(){var e=this.sourceBuffer;for(var t in e){var r=e[t];try{r&&(this.mediaSource&&this.mediaSource.removeSourceBuffer(r),r.removeEventListener(\"updateend\",this._onSBUpdateEnd),r.removeEventListener(\"error\",this._onSBUpdateError))}catch(e){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0},i.onBufferCodecs=function(e){var t=this;Object.keys(this.sourceBuffer).length||(Object.keys(e).forEach((function(r){t.pendingTracks[r]=e[r]})),this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&\"open\"===this.mediaSource.readyState&&this.checkPendingTracks())},i.createSourceBuffers=function(e){var t=this.sourceBuffer,r=this.mediaSource;if(!r)throw Error(\"createSourceBuffers called when mediaSource was null\");for(var n in e)if(!t[n]){var i=e[n];if(!i)throw Error(\"source buffer exists for track \"+n+\", however track does not\");var a=i.levelCodec||i.codec,o=i.container+\";codecs=\"+a;h.logger.log(\"creating sourceBuffer(\"+o+\")\");try{var s=t[n]=r.addSourceBuffer(o);s.addEventListener(\"updateend\",this._onSBUpdateEnd),s.addEventListener(\"error\",this._onSBUpdateError),this.tracks[n]={buffer:s,codec:a,id:i.id,container:i.container,levelCodec:i.levelCodec}}catch(e){h.logger.error(\"error while trying to add sourceBuffer:\"+e.message),this.hls.trigger(c.default.ERROR,{type:d.ErrorTypes.MEDIA_ERROR,details:d.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:e,mimeType:o})}}this.hls.trigger(c.default.BUFFER_CREATED,{tracks:this.tracks})},i.onBufferAppending=function(e){this._needsFlush||(this.segments?this.segments.push(e):this.segments=[e],this.doAppending())},i.onBufferEos=function(e){for(var t in this.sourceBuffer){var r;e.type&&e.type!==t||(r=this.sourceBuffer[t])&&!r.ended&&(r.ended=!0,h.logger.log(t+\" sourceBuffer now EOS\"))}this.checkEos()},i.checkEos=function(){var e=this.sourceBuffer,t=this.mediaSource;if(t&&\"open\"===t.readyState){for(var r in e){var n=e[r];if(n){if(!n.ended)return;if(n.updating)return void(this._needsEos=!0)}}h.logger.log(\"all media data are available, signal endOfStream() to MediaSource and stop loading fragment\");try{t.endOfStream()}catch(e){h.logger.warn(\"exception while calling mediaSource.endOfStream()\")}this._needsEos=!1}else this._needsEos=!1},i.onBufferFlushing=function(e){e.type?this.flushRange.push({start:e.startOffset,end:e.endOffset,type:e.type}):(this.flushRange.push({start:e.startOffset,end:e.endOffset,type:\"video\"}),this.flushRange.push({start:e.startOffset,end:e.endOffset,type:\"audio\"})),this.flushBufferCounter=0,this.doFlush()},i.flushLiveBackBuffer=function(){if(this._live){var e=this.config.liveBackBufferLength;if(isFinite(e)&&!(e<0))if(this.media)for(var t=this.media.currentTime,r=this.sourceBuffer,n=Object.keys(r),i=t-Math.max(e,this._levelTargetDuration),a=n.length-1;0<=a;a--){var o,s=n[a],l=r[s];!l||0<(o=l.buffered).length&&i>o.start(0)&&this.removeBufferRange(s,l,0,i)&&this.hls.trigger(c.default.LIVE_BACK_BUFFER_REACHED,{bufferEnd:i})}else h.logger.error(\"flushLiveBackBuffer called without attaching media\")}},i.onLevelUpdated=function(e){var t=e.details;0<t.fragments.length&&(this._levelDuration=t.totalduration+t.fragments[0].start,this._levelTargetDuration=t.averagetargetduration||t.targetduration||10,this._live=t.live,this.updateMediaElementDuration())},i.updateMediaElementDuration=function(){var e,t=this.config;if(null!==this._levelDuration&&this.media&&this.mediaSource&&this.sourceBuffer&&0!==this.media.readyState&&\"open\"===this.mediaSource.readyState){for(var r in this.sourceBuffer){var n=this.sourceBuffer[r];if(n&&!0===n.updating)return}e=this.media.duration,null===this._msDuration&&(this._msDuration=this.mediaSource.duration),!0===this._live&&!0===t.liveDurationInfinity?(h.logger.log(\"Media Source duration is set to Infinity\"),this._msDuration=this.mediaSource.duration=1/0):(this._levelDuration>this._msDuration&&this._levelDuration>e||!Object(u.isFiniteNumber)(e))&&(h.logger.log(\"Updating Media Source duration to \"+this._levelDuration.toFixed(3)),this._msDuration=this.mediaSource.duration=this._levelDuration)}},i.doFlush=function(){for(;this.flushRange.length;){var e=this.flushRange[0];if(!this.flushBuffer(e.start,e.end,e.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var t=0,r=this.sourceBuffer;try{for(var n in r){var i=r[n];i&&(t+=i.buffered.length)}}catch(e){h.logger.error(\"error while accessing sourceBuffer.buffered\")}this.appended=t,this.hls.trigger(c.default.BUFFER_FLUSHED)}},i.doAppending=function(){var e=this.config,t=this.hls,r=this.segments,n=this.sourceBuffer;if(Object.keys(n).length){if(!this.media||this.media.error)return this.segments=[],void h.logger.error(\"trying to append although a media error occured, flush segment and abort\");if(!this.appending){var i=r.shift();if(i)try{var a=n[i.type];if(!a)return void this._onSBUpdateEnd();if(a.updating)return void r.unshift(i);a.ended=!1,this.parent=i.parent,a.appendBuffer(i.data),this.appendError=0,this.appended++,this.appending=!0}catch(n){h.logger.error(\"error while trying to append buffer:\"+n.message),r.unshift(i);var o={type:d.ErrorTypes.MEDIA_ERROR,parent:i.parent,details:\"\",fatal:!1};22===n.code?(this.segments=[],o.details=d.ErrorDetails.BUFFER_FULL_ERROR):(this.appendError++,o.details=d.ErrorDetails.BUFFER_APPEND_ERROR,this.appendError>e.appendErrorMaxRetry&&(h.logger.log(\"fail \"+e.appendErrorMaxRetry+\" times to append segment in sourceBuffer\"),this.segments=[],o.fatal=!0)),t.trigger(c.default.ERROR,o)}}}},i.flushBuffer=function(e,t,r){var n=this.sourceBuffer;if(!Object.keys(n).length)return!0;var i=\"null\";if(this.media&&(i=this.media.currentTime.toFixed(3)),h.logger.log(\"flushBuffer,pos/start/end: \"+i+\"/\"+e+\"/\"+t),this.flushBufferCounter>=this.appended)return h.logger.warn(\"abort flushing too many retries\"),!0;var a=n[r];if(a){if(a.ended=!1,a.updating)return h.logger.warn(\"cannot flush, sb updating in progress\"),!1;if(this.removeBufferRange(r,a,e,t))return this.flushBufferCounter++,!1}return h.logger.log(\"buffer flushed\"),!0},i.removeBufferRange=function(e,t,r,n){try{for(var i=0;i<t.buffered.length;i++){var a=t.buffered.start(i),o=t.buffered.end(i),s=Math.max(a,r),l=Math.min(o,n);if(.5<Math.min(l,o)-s){var d=\"null\";return this.media&&(d=this.media.currentTime.toString()),h.logger.log(\"sb remove \"+e+\" [\"+s+\",\"+l+\"], of [\"+a+\",\"+o+\"], pos:\"+d),t.remove(s,l),!0}}}catch(e){h.logger.warn(\"removeBufferRange failed\",e)}return!1},n}(p);function He(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ke=function(e){var t,r;function n(t){var r=e.call(this,t,c.default.FPS_DROP_LEVEL_CAPPING,c.default.MEDIA_ATTACHING,c.default.MANIFEST_PARSED,c.default.LEVELS_UPDATED,c.default.BUFFER_CODECS,c.default.MEDIA_DETACHING)||this;return r.autoLevelCapping=Number.POSITIVE_INFINITY,r.firstLevel=null,r.levels=[],r.media=null,r.restrictedLevels=[],r.timer=null,r.clientRect=null,r}r=e,(t=n).prototype=Object.create(r.prototype),(t.prototype.constructor=t).__proto__=r;var i,a,o,s=n.prototype;return s.destroy=function(){this.hls.config.capLevelToPlayerSize&&(this.media=null,this.clientRect=null,this.stopCapping())},s.onFpsDropLevelCapping=function(e){n.isLevelAllowed(e.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(e.droppedLevel)},s.onMediaAttaching=function(e){this.media=e.media instanceof window.HTMLVideoElement?e.media:null},s.onManifestParsed=function(e){var t=this.hls;this.restrictedLevels=[],this.levels=e.levels,this.firstLevel=e.firstLevel,t.config.capLevelToPlayerSize&&e.video&&this.startCapping()},s.onBufferCodecs=function(e){this.hls.config.capLevelToPlayerSize&&e.video&&this.startCapping()},s.onLevelsUpdated=function(e){this.levels=e.levels},s.onMediaDetaching=function(){this.stopCapping()},s.detectPlayerSize=function(){var e,t;!this.media||(e=this.levels?this.levels.length:0)&&((t=this.hls).autoLevelCapping=this.getMaxLevel(e-1),t.autoLevelCapping>this.autoLevelCapping&&t.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping)},s.getMaxLevel=function(e){var t=this;if(!this.levels)return-1;var r=this.levels.filter((function(r,i){return n.isLevelAllowed(i,t.restrictedLevels)&&i<=e}));return this.clientRect=null,n.getMaxLevelByMediaSize(r,this.mediaWidth,this.mediaHeight)},s.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},s.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer),this.timer=null)},s.getDimensions=function(){if(this.clientRect)return this.clientRect;var e,t=this.media,r={width:0,height:0};return t&&(e=t.getBoundingClientRect(),r.width=e.width,r.height=e.height,r.width||r.height||(r.width=e.right-e.left||t.width||0,r.height=e.bottom-e.top||t.height||0)),this.clientRect=r},n.isLevelAllowed=function(e,t){return void 0===t&&(t=[]),-1===t.indexOf(e)},n.getMaxLevelByMediaSize=function(e,t,r){if(!e||e&&!e.length)return-1;for(var n,i,a=e.length-1,o=0;o<e.length;o+=1){var s=e[o];if((s.width>=t||s.height>=r)&&(n=s,!(i=e[o+1])||n.width!==i.width||n.height!==i.height)){a=o;break}}return a},i=n,o=[{key:\"contentScaleFactor\",get:function(){var e=1;try{e=window.devicePixelRatio}catch(e){}return e}}],(a=[{key:\"mediaWidth\",get:function(){return this.getDimensions().width*n.contentScaleFactor}},{key:\"mediaHeight\",get:function(){return this.getDimensions().height*n.contentScaleFactor}}])&&He(i.prototype,a),o&&He(i,o),n}(p),We=window.performance,Xe=function(e){var t,r;function n(t){return e.call(this,t,c.default.MEDIA_ATTACHING)||this}r=e,(t=n).prototype=Object.create(r.prototype),(t.prototype.constructor=t).__proto__=r;var i=n.prototype;return i.destroy=function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1},i.onMediaAttaching=function(e){var t=this.hls.config;t.capLevelOnFPSDrop&&(\"function\"==typeof(this.video=e.media instanceof window.HTMLVideoElement?e.media:null).getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),t.fpsDroppedMonitoringPeriod))},i.checkFPS=function(e,t,r){var n,i,a,o,s,l,d=We.now();t&&(this.lastTime&&(n=d-this.lastTime,i=r-this.lastDroppedFrames,a=t-this.lastDecodedFrames,o=1e3*i/n,(s=this.hls).trigger(c.default.FPS_DROP,{currentDropped:i,currentDecoded:a,totalDroppedFrames:r}),0<o&&i>s.config.fpsDroppedMonitoringThreshold*a&&(l=s.currentLevel,h.logger.warn(\"drop FPS ratio greater than max allowed value for currentLevel: \"+l),0<l&&(-1===s.autoLevelCapping||s.autoLevelCapping>=l)&&(--l,s.trigger(c.default.FPS_DROP_LEVEL_CAPPING,{level:l,droppedLevel:s.currentLevel}),s.autoLevelCapping=l,s.streamController.nextLevelSwitch()))),this.lastTime=d,this.lastDroppedFrames=r,this.lastDecodedFrames=t)},i.checkFPSInterval=function(){var e,t=this.video;t&&(this.isVideoPlaybackQualityAvailable?(e=t.getVideoPlaybackQuality(),this.checkFPS(t,e.totalVideoFrames,e.droppedVideoFrames)):this.checkFPS(t,t.webkitDecodedFrameCount,t.webkitDroppedFrameCount))},n}(p),$e=function(){function e(e){e&&e.xhrSetup&&(this.xhrSetup=e.xhrSetup)}var t=e.prototype;return t.destroy=function(){this.abort(),this.loader=null},t.abort=function(){var e=this.loader;e&&4!==e.readyState&&(this.stats.aborted=!0,e.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null},t.load=function(e,t,r){this.context=e,this.config=t,this.callbacks=r,this.stats={trequest:window.performance.now(),retry:0},this.retryDelay=t.retryDelay,this.loadInternal()},t.loadInternal=function(){var e=this.context,t=this.loader=new window.XMLHttpRequest,r=this.stats;r.tfirst=0,r.loaded=0;var n=this.xhrSetup;try{if(n)try{n(t,e.url)}catch(r){t.open(\"GET\",e.url,!0),n(t,e.url)}t.readyState||t.open(\"GET\",e.url,!0)}catch(r){return void this.callbacks.onError({code:t.status,text:r.message},e,t)}e.rangeEnd&&t.setRequestHeader(\"Range\",\"bytes=\"+e.rangeStart+\"-\"+(e.rangeEnd-1)),t.onreadystatechange=this.readystatechange.bind(this),t.onprogress=this.loadprogress.bind(this),t.responseType=e.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),t.send()},t.readystatechange=function(e){var t,r,n,i,a=e.currentTarget,o=a.readyState,s=this.stats,l=this.context,d=this.config;s.aborted||2<=o&&(window.clearTimeout(this.requestTimeout),0===s.tfirst&&(s.tfirst=Math.max(window.performance.now(),s.trequest)),4===o?200<=(t=a.status)&&t<300?(s.tload=Math.max(s.tfirst,window.performance.now()),n=\"arraybuffer\"===l.responseType?(r=a.response).byteLength:(r=a.responseText).length,s.loaded=s.total=n,i={url:a.responseURL,data:r},this.callbacks.onSuccess(i,s,l,a)):s.retry>=d.maxRetry||400<=t&&t<499?(h.logger.error(t+\" while loading \"+l.url),this.callbacks.onError({code:t,text:a.statusText},l,a)):(h.logger.warn(t+\" while loading \"+l.url+\", retrying in \"+this.retryDelay+\"...\"),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,d.maxRetryDelay),s.retry++):this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),d.timeout))},t.loadtimeout=function(){h.logger.warn(\"timeout while loading \"+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)},t.loadprogress=function(e){var t=e.currentTarget,r=this.stats;r.loaded=e.loaded,e.lengthComputable&&(r.total=e.total);var n=this.callbacks.onProgress;n&&n(r,this.context,null,t)},e}();function Qe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Je=function(e){var t,r;function n(t){var r=e.call(this,t,c.default.MANIFEST_LOADING,c.default.MANIFEST_PARSED,c.default.AUDIO_TRACK_LOADED,c.default.AUDIO_TRACK_SWITCHED,c.default.LEVEL_LOADED,c.default.ERROR)||this;return r._trackId=-1,r._selectDefaultTrack=!0,r.tracks=[],r.trackIdBlacklist=Object.create(null),r.audioGroupId=null,r}r=e,(t=n).prototype=Object.create(r.prototype),(t.prototype.constructor=t).__proto__=r;var i,a,o=n.prototype;return o.onManifestLoading=function(){this.tracks=[],this._trackId=-1,this._selectDefaultTrack=!0},o.onManifestParsed=function(e){var t=this.tracks=e.audioTracks||[];this.hls.trigger(c.default.AUDIO_TRACKS_UPDATED,{audioTracks:t}),this._selectAudioGroup(this.hls.nextLoadLevel)},o.onAudioTrackLoaded=function(e){var t;e.id>=this.tracks.length?h.logger.warn(\"Invalid audio track id:\",e.id):(h.logger.log(\"audioTrack \"+e.id+\" loaded\"),this.tracks[e.id].details=e.details,e.details.live&&!this.hasInterval()&&(t=1e3*e.details.targetduration,this.setInterval(t)),!e.details.live&&this.hasInterval()&&this.clearInterval())},o.onAudioTrackSwitched=function(e){var t=this.tracks[e.id].groupId;t&&this.audioGroupId!==t&&(this.audioGroupId=t)},o.onLevelLoaded=function(e){this._selectAudioGroup(e.level)},o.onError=function(e){e.type===d.ErrorTypes.NETWORK_ERROR&&(e.fatal&&this.clearInterval(),e.details===d.ErrorDetails.AUDIO_TRACK_LOAD_ERROR&&(h.logger.warn(\"Network failure on audio-track id:\",e.context.id),this._handleLoadError()))},o._setAudioTrack=function(e){var t,r,n,i;this._trackId===e&&this.tracks[this._trackId].details?h.logger.debug(\"Same id as current audio-track passed, and track details available -> no-op\"):e<0||e>=this.tracks.length?h.logger.warn(\"Invalid id passed to audio-track controller\"):(t=this.tracks[e],h.logger.log(\"Now switching to audio-track index \"+e),this.clearInterval(),this._trackId=e,r=t.url,n=t.type,i=t.id,this.hls.trigger(c.default.AUDIO_TRACK_SWITCHING,{id:i,type:n,url:r}),this._loadTrackDetailsIfNeeded(t))},o.doTick=function(){this._updateTrack(this._trackId)},o._selectAudioGroup=function(e){var t,r=this.hls.levels[e];r&&r.audioGroupIds&&(t=r.audioGroupIds[r.urlId],this.audioGroupId!==t&&(this.audioGroupId=t,this._selectInitialAudioTrack()))},o._selectInitialAudioTrack=function(){var e,t,r,n,i,a=this,o=this.tracks;o.length&&(e=this.tracks[this._trackId],t=null,e&&(t=e.name),this._selectDefaultTrack&&((r=o.filter((function(e){return e.default}))).length?o=r:h.logger.warn(\"No default audio tracks defined\")),n=!1,(i=function(){o.forEach((function(e){n||a.audioGroupId&&e.groupId!==a.audioGroupId||t&&t!==e.name||(a._setAudioTrack(e.id),n=!0)}))})(),n||(t=null,i()),n||(h.logger.error(\"No track found for running audio group-ID: \"+this.audioGroupId),this.hls.trigger(c.default.ERROR,{type:d.ErrorTypes.MEDIA_ERROR,details:d.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0})))},o._needsTrackLoading=function(e){var t=e.details,r=e.url;return!(t&&!t.live||!r)},o._loadTrackDetailsIfNeeded=function(e){var t,r;this._needsTrackLoading(e)&&(t=e.url,r=e.id,h.logger.log(\"loading audio-track playlist for id: \"+r),this.hls.trigger(c.default.AUDIO_TRACK_LOADING,{url:t,id:r}))},o._updateTrack=function(e){var t;e<0||e>=this.tracks.length||(this.clearInterval(),this._trackId=e,h.logger.log(\"trying to update audio-track \"+e),t=this.tracks[e],this._loadTrackDetailsIfNeeded(t))},o._handleLoadError=function(){this.trackIdBlacklist[this._trackId]=!0;var e=this._trackId,t=this.tracks[e],r=t.name,n=t.language,i=t.groupId;h.logger.warn(\"Loading failed on audio track id: \"+e+\", group-id: \"+i+', name/language: \"'+r+'\" / \"'+n+'\"');for(var a=e,o=0;o<this.tracks.length;o++)if(!this.trackIdBlacklist[o]&&this.tracks[o].name===r){a=o;break}a!==e?(h.logger.log(\"Attempting audio-track fallback id:\",a,\"group-id:\",this.tracks[a].groupId),this._setAudioTrack(a)):h.logger.warn('No fallback audio-track found for name/language: \"'+r+'\" / \"'+n+'\"')},i=n,(a=[{key:\"audioTracks\",get:function(){return this.tracks}},{key:\"audioTrack\",get:function(){return this._trackId},set:function(e){this._setAudioTrack(e),this._selectDefaultTrack=!1}}])&&Qe(i.prototype,a),n}(pe);function Ze(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function et(){return{decode:function(e){if(!e)return\"\";if(\"string\"!=typeof e)throw new Error(\"Error - expected string data.\");return decodeURIComponent(encodeURIComponent(e))}}}var tt=window.performance,rt=function(e){var t,r;function n(t,r){var n=e.call(this,t,c.default.MEDIA_ATTACHED,c.default.MEDIA_DETACHING,c.default.AUDIO_TRACKS_UPDATED,c.default.AUDIO_TRACK_SWITCHING,c.default.AUDIO_TRACK_LOADED,c.default.KEY_LOADED,c.default.FRAG_LOADED,c.default.FRAG_PARSING_INIT_SEGMENT,c.default.FRAG_PARSING_DATA,c.default.FRAG_PARSED,c.default.ERROR,c.default.BUFFER_RESET,c.default.BUFFER_CREATED,c.default.BUFFER_APPENDED,c.default.BUFFER_FLUSHED,c.default.INIT_PTS_FOUND)||this;return n.fragmentTracker=r,n.config=t.config,n.audioCodecSwap=!1,n._state=me,n.initPTS=[],n.waitingFragment=null,n.videoTrackCC=null,n.waitingVideoCC=null,n}r=e,(t=n).prototype=Object.create(r.prototype),(t.prototype.constructor=t).__proto__=r;var i,a,o=n.prototype;return o.onInitPtsFound=function(e){var t=e.id,r=e.frag.cc,n=e.initPTS;\"main\"===t&&(this.initPTS[r]=n,this.videoTrackCC=r,h.logger.log(\"InitPTS for cc: \"+r+\" found from main: \"+n),this.state===Le&&this.tick())},o.startLoad=function(e){var t;this.tracks?(t=this.lastCurrentTime,this.stopLoad(),this.setInterval(100),(this.fragLoadError=0)<t&&-1===e?(h.logger.log(\"audio:override startPosition with lastCurrentTime @\"+t.toFixed(3)),this.state=ye):(this.lastCurrentTime=this.startPosition?this.startPosition:e,this.state=ge),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()):(this.startPosition=e,this.state=me)},o.doTick=function(){var e,t,r,n,i,a=this.hls,o=a.config;switch(this.state){case xe:case\"PAUSED\":case Se:break;case ge:this.state=Ee,this.loadedmetadata=!1;break;case ye:var s=this.tracks;if(!s)break;if(!this.media&&(this.startFragRequested||!o.startFragPrefetch))break;if(this.loadedmetadata)e=this.media.currentTime;else if(void 0===(e=this.nextLoadPosition))break;var l=this.mediaBuffer?this.mediaBuffer:this.media,d=this.videoBuffer?this.videoBuffer:this.media,f=e<o.maxBufferHole?Math.max(2,o.maxBufferHole):o.maxBufferHole,p=Y.bufferInfo(l,e,f),m=Y.bufferInfo(d,e,f),g=p.len,y=p.end,v=this.fragPrevious,_=Math.min(o.maxBufferLength,o.maxMaxBufferLength),b=Math.max(_,m.len),E=this.audioSwitch,k=this.trackId;if((g<b||E)&&k<s.length){if(void 0===(r=s[k].details)){this.state=Ee;break}if(!E&&this._streamEnded(p,r))return this.hls.trigger(c.default.BUFFER_EOS,{type:\"audio\"}),void(this.state=Te);var w,S=r.fragments,T=S.length,x=S[0].start,L=S[T-1].start+S[T-1].duration;if(E)if(r.live&&!r.PTSKnown)h.logger.log(\"switching audiotrack, live stream, unknown PTS,load first fragment\"),y=0;else if(y=e,r.PTSKnown&&e<x){if(!(p.end>x||p.nextStart))return;h.logger.log(\"alt audio track ahead of main track, seek to start of alt audio track\"),this.media.currentTime=x+.05}if(r.initSegment&&!r.initSegment.data)w=r.initSegment;else if(y<=x){if(w=S[0],null!==this.videoTrackCC&&w.cc!==this.videoTrackCC&&(n=S,i=this.videoTrackCC,w=V(n,(function(e){return e.cc<i?1:e.cc>i?-1:0}))),r.live&&w.loadIdx&&w.loadIdx===this.fragLoadIdx){var A=p.nextStart?p.nextStart:x;return h.logger.log(\"no alt audio available @currentTime:\"+this.media.currentTime+\", seeking @\"+(A+.05)),void(this.media.currentTime=A+.05)}}else{var R=o.maxFragLookUpTolerance,D=v?S[v.sn-S[0].sn+1]:void 0,O=y<L?(L-R<y&&(R=0),D&&!he(y,R,D)?D:V(S,(function(e){return he(y,R,e)}))):S[T-1];O&&(x=(w=O).start,v&&w.level===v.level&&w.sn===v.sn&&(w.sn<r.endSN?(w=S[w.sn+1-r.startSN],this.fragmentTracker.getState(w)!==z&&h.logger.log(\"SN just loaded, load next one: \"+w.sn)):w=null))}w&&(w.encrypted?(h.logger.log(\"Loading key for \"+w.sn+\" of [\"+r.startSN+\" ,\"+r.endSN+\"],track \"+k),this.state=ve,a.trigger(c.default.KEY_LOADING,{frag:w})):(this.fragCurrent=w,!E&&this.fragmentTracker.getState(w)!==N||(h.logger.log(\"Loading \"+w.sn+\", cc: \"+w.cc+\" of [\"+r.startSN+\" ,\"+r.endSN+\"],track \"+k+\", \"+(this.loadedmetadata?\"currentTime\":\"nextLoadPosition\")+\": \"+e+\", bufferEnd: \"+y.toFixed(3)),\"initSegment\"!==w.sn&&(this.startFragRequested=!0),Object(u.isFiniteNumber)(w.sn)&&(this.nextLoadPosition=w.start+w.duration),a.trigger(c.default.FRAG_LOADING,{frag:w}),this.state=_e)))}break;case Ee:(t=this.tracks[this.trackId])&&t.details&&(this.state=ye);break;case be:var C=tt.now(),I=this.retryDate,M=(l=this.media)&&l.seeking;(!I||I<=C||M)&&(h.logger.log(\"audioStreamController: retryDate reached, switch back to IDLE state\"),this.state=ye);break;case Le:var P,B,F=this.waitingFragment;F?(P=F.frag.cc,void 0!==this.initPTS[P]?(this.waitingFragment=null,this.state=_e,this.onFragLoaded(F)):this.videoTrackCC!==this.waitingVideoCC?(h.logger.log(\"Waiting fragment cc (\"+P+\") cancelled because video is at cc \"+this.videoTrackCC),this.clearWaitingFragment()):he((B=Y.bufferInfo(this.mediaBuffer,this.media.currentTime,o.maxBufferHole)).end,o.maxFragLookUpTolerance,F.frag)<0&&(h.logger.log(\"Waiting fragment cc (\"+P+\") @ \"+F.frag.start+\" cancelled because another fragment at \"+B.end+\" is needed\"),this.clearWaitingFragment())):this.state=ye}},o.clearWaitingFragment=function(){var e=this.waitingFragment;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingFragment=null,this.waitingVideoCC=null,this.state=ye)},o.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener(\"seeking\",this.onvseeking),t.addEventListener(\"ended\",this.onvended);var r=this.config;this.tracks&&r.autoStartLoad&&this.startLoad(r.startPosition)},o.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(h.logger.log(\"MSE detaching and video ended, reset startPosition\"),this.startPosition=this.lastCurrentTime=0),e&&(e.removeEventListener(\"seeking\",this.onvseeking),e.removeEventListener(\"ended\",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},o.onAudioTracksUpdated=function(e){h.logger.log(\"audio tracks updated\"),this.tracks=e.audioTracks},o.onAudioTrackSwitching=function(e){var t=!!e.url;this.trackId=e.id,this.fragCurrent=null,this.clearWaitingFragment(),this.state=\"PAUSED\",t?this.setInterval(100):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),t&&(this.audioSwitch=!0,this.state=ye),this.tick()},o.onAudioTrackLoaded=function(e){var t,r,n=e.details,i=e.id,a=this.tracks[i],o=n.totalduration,s=0;h.logger.log(\"track \"+i+\" loaded [\"+n.startSN+\",\"+n.endSN+\"],duration:\"+o),n.live?(t=a.details)&&0<n.fragments.length?(ie(t,n),s=n.fragments[0].start,n.PTSKnown?h.logger.log(\"live audio playlist sliding:\"+s.toFixed(3)):h.logger.log(\"live audio playlist - outdated PTS, unknown sliding\")):(n.PTSKnown=!1,h.logger.log(\"live audio playlist - first load, unknown sliding\")):n.PTSKnown=!1,a.details=n,this.startFragRequested||(-1===this.startPosition&&(r=n.startTimeOffset,Object(u.isFiniteNumber)(r)?(h.logger.log(\"start time offset found in playlist, adjust startPosition to \"+r),this.startPosition=r):n.live?(this.startPosition=this.computeLivePosition(s,n),h.logger.log(\"compute startPosition for audio-track to \"+this.startPosition)):this.startPosition=0),this.nextLoadPosition=this.startPosition),this.state===Ee&&(this.state=ye),this.tick()},o.onKeyLoaded=function(){this.state===ve&&(this.state=ye,this.tick())},o.onFragLoaded=function(e){var t,r,n,i,a,o,s,l,d,u,f=this.fragCurrent,p=e.frag;this.state===_e&&f&&\"audio\"===p.type&&p.level===f.level&&p.sn===f.sn&&(n=(r=(t=this.tracks[this.trackId]).details).totalduration,i=f.level,a=f.sn,o=f.cc,s=this.config.defaultAudioCodec||t.audioCodec||\"mp4a.40.2\",l=this.stats=e.stats,\"initSegment\"===a?(this.state=ye,l.tparsed=l.tbuffered=tt.now(),r.initSegment.data=e.payload,this.hls.trigger(c.default.FRAG_BUFFERED,{stats:l,frag:f,id:\"audio\"}),this.tick()):(this.state=ke,this.appended=!1,this.demuxer||(this.demuxer=new ee(this.hls,\"audio\")),d=this.initPTS[o],u=r.initSegment?r.initSegment.data:[],void 0!==d?(this.pendingBuffering=!0,h.logger.log(\"Demuxing \"+a+\" of [\"+r.startSN+\" ,\"+r.endSN+\"],track \"+i),this.demuxer.push(e.payload,u,s,null,f,n,!1,d)):(h.logger.log(\"Unknown video PTS for cc \"+o+\", waiting for video PTS before demuxing audio frag \"+a+\" of [\"+r.startSN+\" ,\"+r.endSN+\"],track \"+i),this.waitingFragment=e,this.waitingVideoCC=this.videoTrackCC,this.state=Le))),this.fragLoadError=0},o.onFragParsingInitSegment=function(e){var t,r,n,i,a=this.fragCurrent,o=e.frag;a&&\"audio\"===e.id&&o.sn===a.sn&&o.level===a.level&&this.state===ke&&((t=e.tracks).video&&delete t.video,(r=t.audio)&&(r.levelCodec=r.codec,r.id=e.id,this.hls.trigger(c.default.BUFFER_CODECS,t),h.logger.log(\"audio track:audio,container:\"+r.container+\",codecs[level/parsed]=[\"+r.levelCodec+\"/\"+r.codec+\"]\"),(n=r.initSegment)&&(i={type:\"audio\",data:n,parent:\"audio\",content:\"initSegment\"},this.audioSwitch?this.pendingData=[i]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(c.default.BUFFER_APPENDING,i))),this.tick()))},o.onFragParsingData=function(e){var t=this,r=this.fragCurrent,n=e.frag;if(r&&\"audio\"===e.id&&\"audio\"===e.type&&n.sn===r.sn&&n.level===r.level&&this.state===ke){var i=this.trackId,a=this.tracks[i],o=this.hls;Object(u.isFiniteNumber)(e.endPTS)||(e.endPTS=e.startPTS+r.duration,e.endDTS=e.startDTS+r.duration),r.addElementaryStream(y.AUDIO),h.logger.log(\"parsed \"+e.type+\",PTS:[\"+e.startPTS.toFixed(3)+\",\"+e.endPTS.toFixed(3)+\"],DTS:[\"+e.startDTS.toFixed(3)+\"/\"+e.endDTS.toFixed(3)+\"],nb:\"+e.nb),ne(a.details,r,e.startPTS,e.endPTS);var s,l=this.media,f=!1;this.audioSwitch&&(l&&l.readyState?(s=l.currentTime,h.logger.log(\"switching audio track : currentTime:\"+s),s>=e.startPTS&&(h.logger.log(\"switching audio track : flushing all audio\"),this.state=Se,o.trigger(c.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:\"audio\"}),f=!0,this.audioSwitch=!1,o.trigger(c.default.AUDIO_TRACK_SWITCHED,{id:i}))):(this.audioSwitch=!1,o.trigger(c.default.AUDIO_TRACK_SWITCHED,{id:i})));var p=this.pendingData;if(!p)return h.logger.warn(\"Apparently attempt to enqueue media payload without codec initialization data upfront\"),void o.trigger(c.default.ERROR,{type:d.ErrorTypes.MEDIA_ERROR,details:null,fatal:!0});this.audioSwitch||([e.data1,e.data2].forEach((function(t){t&&t.length&&p.push({type:e.type,data:t,parent:\"audio\",content:\"data\"})})),!f&&p.length&&(p.forEach((function(e){t.state===ke&&(t.pendingBuffering=!0,t.hls.trigger(c.default.BUFFER_APPENDING,e))})),this.pendingData=[],this.appended=!0)),this.tick()}},o.onFragParsed=function(e){var t=this.fragCurrent,r=e.frag;t&&\"audio\"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===ke&&(this.stats.tparsed=tt.now(),this.state=we,this._checkAppendedParsed())},o.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},o.onBufferCreated=function(e){var t=e.tracks.audio;t&&(this.mediaBuffer=t.buffer,this.loadedmetadata=!0),e.tracks.video&&(this.videoBuffer=e.tracks.video.buffer)},o.onBufferAppended=function(e){var t;\"audio\"===e.parent&&((t=this.state)!==ke&&t!==we||(this.pendingBuffering=0<e.pending,this._checkAppendedParsed()))},o._checkAppendedParsed=function(){var e,t,r,n;this.state!==we||this.appended&&this.pendingBuffering||(e=this.fragCurrent,t=this.stats,r=this.hls,e&&(this.fragPrevious=e,t.tbuffered=tt.now(),r.trigger(c.default.FRAG_BUFFERED,{stats:t,frag:e,id:\"audio\"}),(n=this.mediaBuffer?this.mediaBuffer:this.media)&&h.logger.log(\"audio buffered : \"+se(n.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,r.trigger(c.default.AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=ye),this.tick())},o.onError=function(e){var t,r,n,i=e.frag;if(!i||\"audio\"===i.type)switch(e.details){case d.ErrorDetails.FRAG_LOAD_ERROR:case d.ErrorDetails.FRAG_LOAD_TIMEOUT:var a,o,s,l=e.frag;if(l&&\"audio\"!==l.type)break;e.fatal||((a=this.fragLoadError)?a++:a=1,a<=(o=this.config).fragLoadingMaxRetry?(this.fragLoadError=a,s=Math.min(Math.pow(2,a-1)*o.fragLoadingRetryDelay,o.fragLoadingMaxRetryTimeout),h.logger.warn(\"AudioStreamController: frag loading failed, retry in \"+s+\" ms\"),this.retryDate=tt.now()+s,this.state=be):(h.logger.error(\"AudioStreamController: \"+e.details+\" reaches max retry, redispatch as fatal ...\"),e.fatal=!0,this.state=xe));break;case d.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case d.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case d.ErrorDetails.KEY_LOAD_ERROR:case d.ErrorDetails.KEY_LOAD_TIMEOUT:this.state!==xe&&(this.state=e.fatal?xe:ye,h.logger.warn(\"AudioStreamController: \"+e.details+\" while loading frag, now switching to \"+this.state+\" state ...\"));break;case d.ErrorDetails.BUFFER_FULL_ERROR:\"audio\"!==e.parent||this.state!==ke&&this.state!==we||(t=this.mediaBuffer,r=this.media.currentTime,t&&Y.isBuffered(t,r)&&Y.isBuffered(t,r+.5)?((n=this.config).maxMaxBufferLength>=n.maxBufferLength&&(n.maxMaxBufferLength/=2,h.logger.warn(\"AudioStreamController: reduce max buffer length to \"+n.maxMaxBufferLength+\"s\")),this.state=ye):(h.logger.warn(\"AudioStreamController: buffer full error also media.currentTime is not buffered, flush audio buffer\"),this.fragCurrent=null,this.state=Se,this.hls.trigger(c.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:\"audio\"})))}},o.onBufferFlushed=function(){var e=this,t=this.pendingData;t&&t.length?(h.logger.log(\"AudioStreamController: appending pending audio data after buffer flushed\"),t.forEach((function(t){e.hls.trigger(c.default.BUFFER_APPENDING,t)})),this.appended=!0,this.pendingData=[],this.state=we):(this.state=ye,this.fragPrevious=null,this.tick())},i=n,(a=[{key:\"state\",set:function(e){var t;this.state!==e&&(t=this.state,this._state=e,h.logger.log(\"audio stream:\"+t+\"->\"+e))},get:function(){return this._state}}])&&Ze(i.prototype,a),n}(Re),nt=function(){if(\"undefined\"!=typeof window&&window.VTTCue)return window.VTTCue;var e={\"\":!0,lr:!0,rl:!0},t={start:!0,middle:!0,end:!0,left:!0,right:!0};function r(e){return\"string\"==typeof e&&!!t[e.toLowerCase()]&&e.toLowerCase()}function n(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)e[n]=r[n]}return e}function i(t,i,a){var o=this,s={enumerable:!0};o.hasBeenReset=!1;var l=\"\",d=!1,u=t,c=i,h=a,f=null,p=\"\",m=!0,g=\"auto\",y=\"start\",v=50,_=\"middle\",b=50,E=\"middle\";Object.defineProperty(o,\"id\",n({},s,{get:function(){return l},set:function(e){l=\"\"+e}})),Object.defineProperty(o,\"pauseOnExit\",n({},s,{get:function(){return d},set:function(e){d=!!e}})),Object.defineProperty(o,\"startTime\",n({},s,{get:function(){return u},set:function(e){if(\"number\"!=typeof e)throw new TypeError(\"Start time must be set to a number.\");u=e,this.hasBeenReset=!0}})),Object.defineProperty(o,\"endTime\",n({},s,{get:function(){return c},set:function(e){if(\"number\"!=typeof e)throw new TypeError(\"End time must be set to a number.\");c=e,this.hasBeenReset=!0}})),Object.defineProperty(o,\"text\",n({},s,{get:function(){return h},set:function(e){h=\"\"+e,this.hasBeenReset=!0}})),Object.defineProperty(o,\"region\",n({},s,{get:function(){return f},set:function(e){f=e,this.hasBeenReset=!0}})),Object.defineProperty(o,\"vertical\",n({},s,{get:function(){return p},set:function(t){var r,n=\"string\"==typeof(r=t)&&!!e[r.toLowerCase()]&&r.toLowerCase();if(!1===n)throw new SyntaxError(\"An invalid or illegal string was specified.\");p=n,this.hasBeenReset=!0}})),Object.defineProperty(o,\"snapToLines\",n({},s,{get:function(){return m},set:function(e){m=!!e,this.hasBeenReset=!0}})),Object.defineProperty(o,\"line\",n({},s,{get:function(){return g},set:function(e){if(\"number\"!=typeof e&&\"auto\"!==e)throw new SyntaxError(\"An invalid number or illegal string was specified.\");g=e,this.hasBeenReset=!0}})),Object.defineProperty(o,\"lineAlign\",n({},s,{get:function(){return y},set:function(e){var t=r(e);if(!t)throw new SyntaxError(\"An invalid or illegal string was specified.\");y=t,this.hasBeenReset=!0}})),Object.defineProperty(o,\"position\",n({},s,{get:function(){return v},set:function(e){if(e<0||100<e)throw new Error(\"Position must be between 0 and 100.\");v=e,this.hasBeenReset=!0}})),Object.defineProperty(o,\"positionAlign\",n({},s,{get:function(){return _},set:function(e){var t=r(e);if(!t)throw new SyntaxError(\"An invalid or illegal string was specified.\");_=t,this.hasBeenReset=!0}})),Object.defineProperty(o,\"size\",n({},s,{get:function(){return b},set:function(e){if(e<0||100<e)throw new Error(\"Size must be between 0 and 100.\");b=e,this.hasBeenReset=!0}})),Object.defineProperty(o,\"align\",n({},s,{get:function(){return E},set:function(e){var t=r(e);if(!t)throw new SyntaxError(\"An invalid or illegal string was specified.\");E=t,this.hasBeenReset=!0}})),o.displayState=void 0}return i.prototype.getCueAsHTML=function(){return window.WebVTT.convertCueToDOMTree(window,this.text)},i}();function it(){this.window=window,this.state=\"INITIAL\",this.buffer=\"\",this.decoder=new et,this.regionList=[]}function at(){this.values=Object.create(null)}function ot(e,t,r,n){var i,a=n?e.split(n):[e];for(var o in a)\"string\"==typeof a[o]&&2===(i=a[o].split(r)).length&&t(i[0],i[1])}at.prototype={set:function(e,t){this.get(e)||\"\"===t||(this.values[e]=t)},get:function(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,r){for(var n=0;n<r.length;++n)if(t===r[n]){this.set(e,t);break}},integer:function(e,t){/^-?\\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\\d]{1,3})(\\.[\\d]*)?%$/)&&0<=(t=parseFloat(t))&&t<=100)&&(this.set(e,t),!0)}};var st=new nt(0,0,0),lt=\"middle\"===st.align?\"middle\":\"center\";function dt(e,t,r){var n=e;function i(){var t,r=(t=e.match(/^(\\d+):(\\d{2})(:\\d{2})?\\.(\\d{3})/))?t[3]?i(t[1],t[2],t[3].replace(\":\",\"\"),t[4]):59<t[1]?i(t[1],t[2],0,t[4]):i(0,t[1],t[2],t[4]):null;function i(e,t,r,n){return 3600*(0|e)+60*(0|t)+(0|r)+(0|n)/1e3}if(null===r)throw new Error(\"Malformed timestamp: \"+n);return e=e.replace(/^[^\\sa-zA-Z-]+/,\"\"),r}function a(){e=e.replace(/^\\s+/,\"\")}if(a(),t.startTime=i(),a(),\"--\\x3e\"!==e.substr(0,3))throw new Error(\"Malformed time stamp (time stamps must be separated by '--\\x3e'): \"+n);e=e.substr(3),a(),t.endTime=i(),a(),function(e,t){var n=new at;ot(e,(function(e,t){switch(e){case\"region\":for(var i=r.length-1;0<=i;i--)if(r[i].id===t){n.set(e,r[i].region);break}break;case\"vertical\":n.alt(e,t,[\"rl\",\"lr\"]);break;case\"line\":var a=t.split(\",\"),o=a[0];n.integer(e,o),n.percent(e,o)&&n.set(\"snapToLines\",!1),n.alt(e,o,[\"auto\"]),2===a.length&&n.alt(\"lineAlign\",a[1],[\"start\",lt,\"end\"]);break;case\"position\":a=t.split(\",\"),n.percent(e,a[0]),2===a.length&&n.alt(\"positionAlign\",a[1],[\"start\",lt,\"end\",\"line-left\",\"line-right\",\"auto\"]);break;case\"size\":n.percent(e,t);break;case\"align\":n.alt(e,t,[\"start\",lt,\"end\",\"left\",\"right\"])}}),/:/,/\\s/),t.region=n.get(\"region\",null),t.vertical=n.get(\"vertical\",\"\");var i=n.get(\"line\",\"auto\");\"auto\"===i&&-1===st.line&&(i=-1),t.line=i,t.lineAlign=n.get(\"lineAlign\",\"start\"),t.snapToLines=n.get(\"snapToLines\",!0),t.size=n.get(\"size\",100),t.align=n.get(\"align\",lt);var a=n.get(\"position\",\"auto\");\"auto\"===a&&50===st.position&&(a=\"start\"===t.align||\"left\"===t.align?0:\"end\"===t.align||\"right\"===t.align?100:50),t.position=a}(e,t)}function ut(e){return e.replace(/<br(?: \\/)?>/gi,\"\\n\")}it.prototype={parse:function(e){var t,r=this;function n(){for(var e=0,t=ut(t=r.buffer);e<t.length&&\"\\r\"!==t[e]&&\"\\n\"!==t[e];)++e;var n=t.substr(0,e);return\"\\r\"===t[e]&&++e,\"\\n\"===t[e]&&++e,r.buffer=t.substr(e),n}e&&(r.buffer+=r.decoder.decode(e,{stream:!0}));try{if(\"INITIAL\"===r.state){if(!/\\r\\n|\\n/.test(r.buffer))return this;var i=(t=n()).match(/^(ï»¿)?WEBVTT([ \\t].*)?$/);if(!i||!i[0])throw new Error(\"Malformed WebVTT signature.\");r.state=\"HEADER\"}for(var a=!1;r.buffer;){if(!/\\r\\n|\\n/.test(r.buffer))return this;switch(a?a=!1:t=n(),r.state){case\"HEADER\":/:/.test(t)?ot(t,(function(e,t){}),/:/):t||(r.state=\"ID\");continue;case\"NOTE\":t||(r.state=\"ID\");continue;case\"ID\":if(/^NOTE($|[ \\t])/.test(t)){r.state=\"NOTE\";break}if(!t)continue;if(r.cue=new nt(0,0,\"\"),r.state=\"CUE\",-1===t.indexOf(\"--\\x3e\")){r.cue.id=t;continue}case\"CUE\":try{dt(t,r.cue,r.regionList)}catch(e){r.cue=null,r.state=\"BADCUE\";continue}r.state=\"CUETEXT\";continue;case\"CUETEXT\":var o=-1!==t.indexOf(\"--\\x3e\");if(!t||o&&(a=!0)){r.oncue&&r.oncue(r.cue),r.cue=null,r.state=\"ID\";continue}r.cue.text&&(r.cue.text+=\"\\n\"),r.cue.text+=t;continue;case\"BADCUE\":t||(r.state=\"ID\");continue}}}catch(e){\"CUETEXT\"===r.state&&r.cue&&r.oncue&&r.oncue(r.cue),r.cue=null,r.state=\"INITIAL\"===r.state?\"BADWEBVTT\":\"BADCUE\"}return this},flush:function(){try{if(this.buffer+=this.decoder.decode(),!this.cue&&\"HEADER\"!==this.state||(this.buffer+=\"\\n\\n\",this.parse()),\"INITIAL\"===this.state)throw new Error(\"Malformed WebVTT signature.\")}catch(e){throw e}return this.onflush&&this.onflush(),this}};var ct=it;function ht(e,t,r,n){for(var i,a,o,s,l,d=[],u=window.VTTCue||TextTrackCue,c=0;c<n.rows.length;c++)if(o=!0,s=0,l=\"\",!(i=n.rows[c]).isEmpty()){for(var h=0;h<i.chars.length;h++)i.chars[h].uchar.match(/\\s/)&&o?s++:(l+=i.chars[h].uchar,o=!1);(i.cueStartTime=t)===r&&(r+=1e-4),a=new u(t,r,ut(l.trim())),16<=s?s--:s++,navigator.userAgent.match(/Firefox\\//)?a.line=c+1:a.line=7<c?c-2:c+1,a.align=\"left\",a.position=Math.max(0,Math.min(100,s/32*100)),d.push(a),e&&e.addCue(a)}return d}function ft(e){var t=e;return gt.hasOwnProperty(e)&&(t=gt[e]),String.fromCharCode(t)}var pt,mt,gt={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},yt=100,vt={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},_t={17:2,18:4,21:6,22:8,23:10,19:13,20:15},bt={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},Et={25:2,26:4,29:6,30:8,31:10,27:13,28:15},kt=[\"white\",\"green\",\"blue\",\"cyan\",\"red\",\"yellow\",\"magenta\",\"black\",\"transparent\"];function wt(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r].toString(16));return t}(mt=pt=pt||{})[mt.ERROR=0]=\"ERROR\",mt[mt.TEXT=1]=\"TEXT\",mt[mt.WARNING=2]=\"WARNING\",mt[mt.INFO=2]=\"INFO\",mt[mt.DEBUG=3]=\"DEBUG\",mt[mt.DATA=3]=\"DATA\";var St=function(){function e(){this.time=null,this.verboseLevel=pt.ERROR}return e.prototype.log=function(e,t){this.verboseLevel>=e&&h.logger.log(this.time+\" [\"+e+\"] \"+t)},e}(),Tt=function(){function e(e,t,r,n,i){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=e||\"white\",this.underline=t||!1,this.italics=r||!1,this.background=n||\"black\",this.flash=i||!1}var t=e.prototype;return t.reset=function(){this.foreground=\"white\",this.underline=!1,this.italics=!1,this.background=\"black\",this.flash=!1},t.setStyles=function(e){for(var t=[\"foreground\",\"underline\",\"italics\",\"background\",\"flash\"],r=0;r<t.length;r++){var n=t[r];e.hasOwnProperty(n)&&(this[n]=e[n])}},t.isDefault=function(){return\"white\"===this.foreground&&!this.underline&&!this.italics&&\"black\"===this.background&&!this.flash},t.equals=function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},t.copy=function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},t.toString=function(){return\"color=\"+this.foreground+\", underline=\"+this.underline+\", italics=\"+this.italics+\", background=\"+this.background+\", flash=\"+this.flash},e}(),xt=function(){function e(e,t,r,n,i,a){this.uchar=void 0,this.penState=void 0,this.uchar=e||\" \",this.penState=new Tt(t,r,n,i,a)}var t=e.prototype;return t.reset=function(){this.uchar=\" \",this.penState.reset()},t.setChar=function(e,t){this.uchar=e,this.penState.copy(t)},t.setPenState=function(e){this.penState.copy(e)},t.equals=function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},t.copy=function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},t.isEmpty=function(){return\" \"===this.uchar&&this.penState.isDefault()},e}(),Lt=function(){function e(e){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var t=0;t<yt;t++)this.chars.push(new xt);this.logger=e,this.pos=0,this.currPenState=new Tt}var t=e.prototype;return t.equals=function(e){for(var t=!0,r=0;r<yt;r++)if(!this.chars[r].equals(e.chars[r])){t=!1;break}return t},t.copy=function(e){for(var t=0;t<yt;t++)this.chars[t].copy(e.chars[t])},t.isEmpty=function(){for(var e=!0,t=0;t<yt;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},t.setCursor=function(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(pt.DEBUG,\"Negative cursor position \"+this.pos),this.pos=0):this.pos>yt&&(this.logger.log(pt.DEBUG,\"Too large cursor position \"+this.pos),this.pos=yt)},t.moveCursor=function(e){var t=this.pos+e;if(1<e)for(var r=this.pos+1;r<t+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(t)},t.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(\" \",this.currPenState)},t.insertChar=function(e){144<=e&&this.backSpace();var t=ft(e);this.pos>=yt?this.logger.log(pt.ERROR,\"Cannot insert \"+e.toString(16)+\" (\"+t+\") at position \"+this.pos+\". Skipping it!\"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))},t.clearFromPos=function(e){for(var t=e;t<yt;t++)this.chars[t].reset()},t.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},t.clearToEndOfRow=function(){this.clearFromPos(this.pos)},t.getTextString=function(){for(var e=[],t=!0,r=0;r<yt;r++){var n=this.chars[r].uchar;\" \"!==n&&(t=!1),e.push(n)}return t?\"\":e.join(\"\")},t.setPenStyles=function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)},e}(),At=function(){function e(e){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var t=0;t<15;t++)this.rows.push(new Lt(e));this.logger=e,this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var t=e.prototype;return t.reset=function(){for(var e=0;e<15;e++)this.rows[e].clear();this.currRow=14},t.equals=function(e){for(var t=!0,r=0;r<15;r++)if(!this.rows[r].equals(e.rows[r])){t=!1;break}return t},t.copy=function(e){for(var t=0;t<15;t++)this.rows[t].copy(e.rows[t])},t.isEmpty=function(){for(var e=!0,t=0;t<15;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},t.backSpace=function(){this.rows[this.currRow].backSpace()},t.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},t.insertChar=function(e){this.rows[this.currRow].insertChar(e)},t.setPen=function(e){this.rows[this.currRow].setPenStyles(e)},t.moveCursor=function(e){this.rows[this.currRow].moveCursor(e)},t.setCursor=function(e){this.logger.log(pt.INFO,\"setCursor: \"+e),this.rows[this.currRow].setCursor(e)},t.setPAC=function(e){this.logger.log(pt.INFO,\"pacData = \"+JSON.stringify(e));var t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(var r=0;r<15;r++)this.rows[r].clear();var n=this.currRow+1-this.nrRollUpRows,i=this.lastOutputScreen;if(i){var a=i.rows[n].cueStartTime,o=this.logger.time;if(a&&null!==o&&a<o)for(var s=0;s<this.nrRollUpRows;s++)this.rows[t-this.nrRollUpRows+s+1].copy(i.rows[n+s])}}this.currRow=t;var l,d,u=this.rows[this.currRow];null!==e.indent&&(l=e.indent,d=Math.max(l-1,0),u.setCursor(e.indent),e.color=u.chars[d].penState.foreground);var c={foreground:e.color,underline:e.underline,italics:e.italics,background:\"black\",flash:!1};this.setPen(c)},t.setBkgData=function(e){this.logger.log(pt.INFO,\"bkgData = \"+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)},t.setRollUpRows=function(e){this.nrRollUpRows=e},t.rollUp=function(){var e,t;null!==this.nrRollUpRows?(this.logger.log(pt.TEXT,this.getDisplayText()),e=this.currRow+1-this.nrRollUpRows,(t=this.rows.splice(e,1)[0]).clear(),this.rows.splice(this.currRow,0,t),this.logger.log(pt.INFO,\"Rolling up\")):this.logger.log(pt.DEBUG,\"roll_up but nrRollUpRows not set yet\")},t.getDisplayText=function(e){e=e||!1;for(var t,r=[],n=\"\",i=0;i<15;i++){var a=this.rows[i].getTextString();a&&(t=i+1,e?r.push(\"Row \"+t+\": '\"+a+\"'\"):r.push(a.trim()))}return 0<r.length&&(n=e?\"[\"+r.join(\" | \")+\"]\":r.join(\"\\n\")),n},t.getTextAndFormat=function(){return this.rows},e}(),Rt=function(){function e(e,t,r){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new At(r),this.nonDisplayedMemory=new At(r),this.lastOutputScreen=new At(r),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=r}var t=e.prototype;return t.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},t.getHandler=function(){return this.outputFilter},t.setHandler=function(e){this.outputFilter=e},t.setPAC=function(e){this.writeScreen.setPAC(e)},t.setBkgData=function(e){this.writeScreen.setBkgData(e)},t.setMode=function(e){e!==this.mode&&(this.mode=e,this.logger.log(pt.INFO,\"MODE=\"+e),\"MODE_POP-ON\"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),\"MODE_ROLL-UP\"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},t.insertChars=function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var r=this.writeScreen===this.displayedMemory?\"DISP\":\"NON_DISP\";this.logger.log(pt.INFO,r+\": \"+this.writeScreen.getDisplayText(!0)),\"MODE_PAINT-ON\"!==this.mode&&\"MODE_ROLL-UP\"!==this.mode||(this.logger.log(pt.TEXT,\"DISPLAYED: \"+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},t.ccRCL=function(){this.logger.log(pt.INFO,\"RCL - Resume Caption Loading\"),this.setMode(\"MODE_POP-ON\")},t.ccBS=function(){this.logger.log(pt.INFO,\"BS - BackSpace\"),\"MODE_TEXT\"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},t.ccAOF=function(){},t.ccAON=function(){},t.ccDER=function(){this.logger.log(pt.INFO,\"DER- Delete to End of Row\"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},t.ccRU=function(e){this.logger.log(pt.INFO,\"RU(\"+e+\") - Roll Up\"),this.writeScreen=this.displayedMemory,this.setMode(\"MODE_ROLL-UP\"),this.writeScreen.setRollUpRows(e)},t.ccFON=function(){this.logger.log(pt.INFO,\"FON - Flash On\"),this.writeScreen.setPen({flash:!0})},t.ccRDC=function(){this.logger.log(pt.INFO,\"RDC - Resume Direct Captioning\"),this.setMode(\"MODE_PAINT-ON\")},t.ccTR=function(){this.logger.log(pt.INFO,\"TR\"),this.setMode(\"MODE_TEXT\")},t.ccRTD=function(){this.logger.log(pt.INFO,\"RTD\"),this.setMode(\"MODE_TEXT\")},t.ccEDM=function(){this.logger.log(pt.INFO,\"EDM - Erase Displayed Memory\"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},t.ccCR=function(){this.logger.log(pt.INFO,\"CR - Carriage Return\"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},t.ccENM=function(){this.logger.log(pt.INFO,\"ENM - Erase Non-displayed Memory\"),this.nonDisplayedMemory.reset()},t.ccEOC=function(){var e;this.logger.log(pt.INFO,\"EOC - End Of Caption\"),\"MODE_POP-ON\"===this.mode&&(e=this.displayedMemory,this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(pt.TEXT,\"DISP: \"+this.displayedMemory.getDisplayText())),this.outputDataUpdate(!0)},t.ccTO=function(e){this.logger.log(pt.INFO,\"TO(\"+e+\") - Tab Offset\"),this.writeScreen.moveCursor(e)},t.ccMIDROW=function(e){var t,r={flash:!1};r.underline=e%2==1,r.italics=46<=e,r.italics?r.foreground=\"white\":(t=Math.floor(e/2)-16,r.foreground=[\"white\",\"green\",\"blue\",\"cyan\",\"red\",\"yellow\",\"magenta\"][t]),this.logger.log(pt.INFO,\"MIDROW: \"+JSON.stringify(r)),this.writeScreen.setPen(r)},t.outputDataUpdate=function(e){void 0===e&&(e=!1);var t=this.logger.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))},t.cueSplitAtTime=function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))},e}();function Dt(e,t,r){r.a=e,r.b=t}function Ot(e,t,r){return r.a===e&&r.b===t}function Ct(e,t,r){return e.substr(r||0,t.length)===t}function It(e){for(var t=5381,r=e.length;r;)t=33*t^e.charCodeAt(--r);return(t>>>0).toString()}var Mt=function(){function e(e,t,r){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var n=new St;this.channels=[null,new Rt(e,t,n),new Rt(e+1,r,n)],this.cmdHistory={a:null,b:null},this.logger=n}var t=e.prototype;return t.getHandler=function(e){return this.channels[e].getHandler()},t.setHandler=function(e,t){this.channels[e].setHandler(t)},t.addData=function(e,t){var r,n=!1;this.logger.time=e;for(var i=0;i<t.length;i+=2){var a,o=127&t[i],s=127&t[i+1];0==o&&0==s||(this.logger.log(pt.DATA,\"[\"+wt([t[i],t[i+1]])+\"] -> (\"+wt([o,s])+\")\"),(r=(r=(r=(r=this.parseCmd(o,s))||this.parseMidrow(o,s))||this.parsePAC(o,s))||this.parseBackgroundAttributes(o,s))||(n=this.parseChars(o,s))&&((a=this.currentChannel)&&0<a?this.channels[a].insertChars(n):this.logger.log(pt.WARNING,\"No channel found yet. TEXT-MODE?\")),r||n||this.logger.log(pt.WARNING,\"Couldn't parse cleaned data \"+wt([o,s])+\" orig: \"+wt([t[i],t[i+1]])))}},t.parseCmd=function(e,t){var r=this.cmdHistory;if(!((20===e||28===e||21===e||29===e)&&32<=t&&t<=47||(23===e||31===e)&&33<=t&&t<=35))return!1;if(Ot(e,t,r))return Dt(null,null,r),this.logger.log(pt.DEBUG,\"Repeated command (\"+wt([e,t])+\") is dropped\"),!0;var n=20===e||21===e||23===e?1:2,i=this.channels[n];return 20===e||21===e||28===e||29===e?32===t?i.ccRCL():33===t?i.ccBS():34===t?i.ccAOF():35===t?i.ccAON():36===t?i.ccDER():37===t?i.ccRU(2):38===t?i.ccRU(3):39===t?i.ccRU(4):40===t?i.ccFON():41===t?i.ccRDC():42===t?i.ccTR():43===t?i.ccRTD():44===t?i.ccEDM():45===t?i.ccCR():46===t?i.ccENM():47===t&&i.ccEOC():i.ccTO(t-32),Dt(e,t,r),this.currentChannel=n,!0},t.parseMidrow=function(e,t){var r=0;if((17===e||25===e)&&32<=t&&t<=47){if((r=17===e?1:2)!==this.currentChannel)return this.logger.log(pt.ERROR,\"Mismatch channel in midrow parsing\"),!1;var n=this.channels[r];return!!n&&(n.ccMIDROW(t),this.logger.log(pt.DEBUG,\"MIDROW (\"+wt([e,t])+\")\"),!0)}return!1},t.parsePAC=function(e,t){var r=this.cmdHistory;if(!((17<=e&&e<=23||25<=e&&e<=31)&&64<=t&&t<=127||(16===e||24===e)&&64<=t&&t<=95))return!1;if(Ot(e,t,r))return Dt(null,null,r),!0;var n=e<=23?1:2,i=64<=t&&t<=95?1==n?vt[e]:bt[e]:1==n?_t[e]:Et[e],a=this.channels[n];return!!a&&(a.setPAC(this.interpretPAC(i,t)),Dt(e,t,r),this.currentChannel=n,!0)},t.interpretPAC=function(e,t){var r={color:null,italics:!1,indent:null,underline:!1,row:e},n=95<t?t-96:t-64;return r.underline=1==(1&n),n<=13?r.color=[\"white\",\"green\",\"blue\",\"cyan\",\"red\",\"yellow\",\"magenta\",\"white\"][Math.floor(n/2)]:n<=15?(r.italics=!0,r.color=\"white\"):r.indent=4*Math.floor((n-16)/2),r},t.parseChars=function(e,t){var r,n,i,a,o=null;return 17<=(a=25<=e?(r=2,e-8):(r=1,e))&&a<=19?(t,n=17===a?t+80:18===a?t+112:t+144,this.logger.log(pt.INFO,\"Special char '\"+ft(n)+\"' in channel \"+r),o=[n]):32<=e&&e<=127&&(o=0===t?[e]:[e,t]),o&&(i=wt(o),this.logger.log(pt.DEBUG,\"Char codes =  \"+i.join(\",\")),Dt(e,t,this.cmdHistory)),o},t.parseBackgroundAttributes=function(e,t){var r;if(!((16===e||24===e)&&32<=t&&t<=47||(23===e||31===e)&&45<=t&&t<=47))return!1;var n={};16===e||24===e?(r=Math.floor((t-32)/2),n.background=kt[r],t%2==1&&(n.background=n.background+\"_semi\")):45===t?n.background=\"transparent\":(n.foreground=\"black\",47===t&&(n.underline=!0));var i=e<=23?1:2;return this.channels[i].setBkgData(n),Dt(e,t,this.cmdHistory),!0},t.reset=function(){for(var e=0;e<Object.keys(this.channels).length;e++){var t=this.channels[e];t&&t.reset()}this.cmdHistory={a:null,b:null}},t.cueSplitAtTime=function(e){for(var t=0;t<this.channels.length;t++){var r=this.channels[t];r&&r.cueSplitAtTime(e)}},e}(),Pt=function(){function e(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}var t=e.prototype;return t.dispatchCue=function(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},t.newCue=function(e,t,r){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=r,this.timelineController.createCaptionsTrack(this.trackName)},t.reset=function(){this.cueRanges=[]},e}(),Bt=function(e,t,r,n,i,a){var o,s=Object(Pe.utf8ArrayToStr)(new Uint8Array(e)).trim().replace(/\\r\\n|\\n\\r|\\n|\\r/g,\"\\n\").split(\"\\n\"),l=\"00:00.000\",d=0,c=0,h=0,f=[],p=!0,m=!1,g=new ct;g.oncue=function(e){var t=r[n],i=r.ccOffset;t&&t.new&&(void 0!==c?i=r.ccOffset=t.start:function(e,t,r){var n=e[t],i=e[n.prevCC];if(!i||!i.new&&n.new)return e.ccOffset=e.presentationOffset=n.start,n.new=!1;for(;i&&i.new;)e.ccOffset+=n.start-i.start,n.new=!1,i=e[(n=i).prevCC];e.presentationOffset=r}(r,n,h)),h&&(i=h-r.presentationOffset),m&&(e.startTime+=i-c,e.endTime+=i-c),e.id=It(e.startTime.toString())+It(e.endTime.toString())+It(e.text),e.text=decodeURIComponent(encodeURIComponent(e.text)),0<e.endTime&&f.push(e)},g.onparsingerror=function(e){o=e},g.onflush=function(){o&&a?a(o):i(f)},s.forEach((function(e){if(p){if(Ct(e,\"X-TIMESTAMP-MAP=\")){m=!(p=!1),e.substr(16).split(\",\").forEach((function(e){Ct(e,\"LOCAL:\")?l=e.substr(6):Ct(e,\"MPEGTS:\")&&(d=parseInt(e.substr(7)))}));try{t+(9e4*r[n].start||0)<0&&(t+=8589934592),d-=t,c=function(e){var t=parseInt(e.substr(-3)),r=parseInt(e.substr(-6,2)),n=parseInt(e.substr(-9,2)),i=9<e.length?parseInt(e.substr(0,e.indexOf(\":\"))):0;if(!(Object(u.isFiniteNumber)(t)&&Object(u.isFiniteNumber)(r)&&Object(u.isFiniteNumber)(n)&&Object(u.isFiniteNumber)(i)))throw Error(\"Malformed X-TIMESTAMP-MAP: Local:\"+e);return t+=1e3*r,(t+=6e4*n)+36e5*i}(l)/1e3,h=d/9e4}catch(e){m=!1,o=e}return}\"\"===e&&(p=!1)}g.parse(e+\"\\n\")})),g.flush()};function Ft(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}var Ut=function(e){var t,r;function n(t){var r,n,i,a,o=e.call(this,t,c.default.MEDIA_ATTACHING,c.default.MEDIA_DETACHING,c.default.FRAG_PARSING_USERDATA,c.default.FRAG_DECRYPTED,c.default.MANIFEST_LOADING,c.default.MANIFEST_LOADED,c.default.FRAG_LOADED,c.default.INIT_PTS_FOUND)||this;return o.media=null,o.config=void 0,o.enabled=!0,o.Cues=void 0,o.textTracks=[],o.tracks=[],o.initPTS=[],o.unparsedVttFrags=[],o.captionsTracks={},o.nonNativeCaptionsTracks={},o.captionsProperties=void 0,o.cea608Parser1=void 0,o.cea608Parser2=void 0,o.lastSn=-1,o.prevCC=-1,o.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}},o.hls=t,o.config=t.config,o.Cues=t.config.cueHandler,o.captionsProperties={textTrack1:{label:o.config.captionsTextTrack1Label,languageCode:o.config.captionsTextTrack1LanguageCode},textTrack2:{label:o.config.captionsTextTrack2Label,languageCode:o.config.captionsTextTrack2LanguageCode},textTrack3:{label:o.config.captionsTextTrack3Label,languageCode:o.config.captionsTextTrack3LanguageCode},textTrack4:{label:o.config.captionsTextTrack4Label,languageCode:o.config.captionsTextTrack4LanguageCode}},o.config.enableCEA708Captions&&(r=new Pt(Ft(o),\"textTrack1\"),n=new Pt(Ft(o),\"textTrack2\"),i=new Pt(Ft(o),\"textTrack3\"),a=new Pt(Ft(o),\"textTrack4\"),o.cea608Parser1=new Mt(1,r,n),o.cea608Parser2=new Mt(3,i,a)),o}r=e,(t=n).prototype=Object.create(r.prototype),(t.prototype.constructor=t).__proto__=r;var i=n.prototype;return i.addCues=function(e,t,r,n,i){for(var a,o,s,l,d,u=!1,h=i.length;h--;){var f=i[h],p=(a=f[0],o=f[1],s=t,l=r,Math.min(o,l)-Math.max(a,s));if(0<=p&&(f[0]=Math.min(f[0],t),f[1]=Math.max(f[1],r),u=!0,.5<p/(r-t)))return}u||i.push([t,r]),this.config.renderTextTracksNatively?this.Cues.newCue(this.captionsTracks[e],t,r,n):(d=this.Cues.newCue(null,t,r,n),this.hls.trigger(c.default.CUES_PARSED,{type:\"captions\",cues:d,track:e}))},i.onInitPtsFound=function(e){var t=this,r=e.frag,n=e.id,i=e.initPTS,a=this.unparsedVttFrags;\"main\"===n&&(this.initPTS[r.cc]=i),a.length&&(this.unparsedVttFrags=[],a.forEach((function(e){t.onFragLoaded(e)})))},i.getExistingTrack=function(e){var t=this.media;if(t)for(var r=0;r<t.textTracks.length;r++){var n=t.textTracks[r];if(n[e])return n}return null},i.createCaptionsTrack=function(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)},i.createNativeTrack=function(e){var t,r,n,i,a,o,s,l;this.captionsTracks[e]||(t=this.captionsProperties,r=this.captionsTracks,n=this.media,a=(i=t[e]).label,o=i.languageCode,(s=this.getExistingTrack(e))?(r[e]=s,Fe(r[e]),Be(r[e],n)):(l=this.createTextTrack(\"captions\",a,o))&&(l[e]=!0,r[e]=l))},i.createNonNativeTrack=function(e){var t,r;this.nonNativeCaptionsTracks[e]||(t=this.captionsProperties[e])&&(r={_id:e,label:t.label,kind:\"captions\",default:!!t.media&&!!t.media.default,closedCaptions:t.media},this.nonNativeCaptionsTracks[e]=r,this.hls.trigger(c.default.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[r]}))},i.createTextTrack=function(e,t,r){var n=this.media;if(n)return n.addTextTrack(e,t,r)},i.destroy=function(){e.prototype.destroy.call(this)},i.onMediaAttaching=function(e){this.media=e.media,this._cleanTracks()},i.onMediaDetaching=function(){var e=this.captionsTracks;Object.keys(e).forEach((function(t){Fe(e[t]),delete e[t]})),this.nonNativeCaptionsTracks={}},i.onManifestLoading=function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={}},i._cleanTracks=function(){var e=this.media;if(e){var t=e.textTracks;if(t)for(var r=0;r<t.length;r++)Fe(t[r])}},i.onManifestLoaded=function(e){var t,r,n,i,a=this;this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset()),this.config.enableWebVTT&&(t=e.subtitles||[],r=this.tracks&&t&&this.tracks.length===t.length,this.tracks=e.subtitles||[],this.config.renderTextTracksNatively?(n=this.media?this.media.textTracks:[],this.tracks.forEach((function(e,t){var r,i,o;if(t<n.length){for(var s=null,l=0;l<n.length;l++)if(o=e,(i=n[l])&&i.label===o.name&&!i.textTrack1&&!i.textTrack2){s=n[l];break}s&&(r=s)}r=r||a.createTextTrack(\"subtitles\",e.name,e.lang),e.default?r.mode=a.hls.subtitleDisplay?\"showing\":\"hidden\":r.mode=\"disabled\",a.textTracks.push(r)}))):!r&&this.tracks&&this.tracks.length&&(i=this.tracks.map((function(e){return{label:e.name,kind:e.type.toLowerCase(),default:e.default,subtitleTrack:e}})),this.hls.trigger(c.default.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:i}))),this.config.enableCEA708Captions&&e.captions&&e.captions.forEach((function(e){var t,r,n=/(?:CC|SERVICE)([1-4])/.exec(e.instreamId);n&&(t=\"textTrack\"+n[1],(r=a.captionsProperties[t])&&(r.label=e.name,e.lang&&(r.languageCode=e.lang),r.media=e))}))},i.onFragLoaded=function(e){var t=e.frag,r=e.payload,n=this.cea608Parser1,i=this.cea608Parser2,a=this.initPTS,o=this.lastSn,s=this.unparsedVttFrags;if(\"main\"===t.type){var l=t.sn;t.sn!==o+1&&n&&i&&(n.reset(),i.reset()),this.lastSn=l}else if(\"subtitle\"===t.type)if(r.byteLength){if(!Object(u.isFiniteNumber)(a[t.cc]))return s.push(e),void(a.length&&this.hls.trigger(c.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t}));var d=t.decryptdata;null!=d&&null!=d.key&&\"AES-128\"===d.method||this._parseVTTs(t,r)}else this.hls.trigger(c.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})},i._parseVTTs=function(e,t){var r=this,n=this.hls,i=this.prevCC,a=this.textTracks,o=this.vttCCs;o[e.cc]||(o[e.cc]={start:e.start,prevCC:i,new:!0},this.prevCC=e.cc),Bt(t,this.initPTS[e.cc],o,e.cc,(function(t){if(r.config.renderTextTracksNatively){var i=a[e.level];if(\"disabled\"===i.mode)return void n.trigger(c.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e});t.forEach((function(e){if(!i.cues.getCueById(e.id))try{if(i.addCue(e),!i.cues.getCueById(e.id))throw new Error(\"addCue is failed for: \"+e)}catch(r){h.logger.debug(\"Failed occurred on adding cues: \"+r);var t=new window.TextTrackCue(e.startTime,e.endTime,e.text);t.id=e.id,i.addCue(t)}}))}else{var o=r.tracks[e.level].default?\"default\":\"subtitles\"+e.level;n.trigger(c.default.CUES_PARSED,{type:\"subtitles\",cues:t,track:o})}n.trigger(c.default.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})}),(function(t){h.logger.log(\"Failed to parse VTT cue: \"+t),n.trigger(c.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e})}))},i.onFragDecrypted=function(e){var t=e.frag,r=e.payload;if(\"subtitle\"===t.type){if(!Object(u.isFiniteNumber)(this.initPTS[t.cc]))return void this.unparsedVttFrags.push(e);this._parseVTTs(t,r)}},i.onFragParsingUserdata=function(e){var t=this.cea608Parser1,r=this.cea608Parser2;if(this.enabled&&t&&r)for(var n=0;n<e.samples.length;n++){var i,a=e.samples[n].bytes;a&&(i=this.extractCea608Data(a),t.addData(e.samples[n].pts,i[0]),r.addData(e.samples[n].pts,i[1]))}},i.extractCea608Data=function(e){for(var t=31&e[0],r=2,n=[[],[]],i=0;i<t;i++){var a=e[r++],o=127&e[r++],s=127&e[r++],l=3&a;0==o&&0==s||0!=(4&a)&&(0!=l&&1!=l||(n[l].push(o),n[l].push(s)))}return n},n}(p);function Nt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function jt(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];\"subtitles\"===n.kind&&n.label&&t.push(e[r])}return t}var Gt,zt,qt=function(e){var t,r;function n(t){var r=e.call(this,t,c.default.MEDIA_ATTACHED,c.default.MEDIA_DETACHING,c.default.MANIFEST_LOADED,c.default.SUBTITLE_TRACK_LOADED)||this;return r.tracks=[],r.trackId=-1,r.media=null,r.stopped=!0,r.subtitleDisplay=!0,r.queuedDefaultTrack=null,r}r=e,(t=n).prototype=Object.create(r.prototype),(t.prototype.constructor=t).__proto__=r;var i,a,o=n.prototype;return o.destroy=function(){p.prototype.destroy.call(this)},o.onMediaAttached=function(e){var t=this;this.media=e.media,this.media&&(Object(u.isFiniteNumber)(this.queuedDefaultTrack)&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=null),this.trackChangeListener=this._onTextTracksChanged.bind(this),this.useTextTrackPolling=!(this.media.textTracks&&\"onchange\"in this.media.textTracks),this.useTextTrackPolling?this.subtitlePollingInterval=setInterval((function(){t.trackChangeListener()}),500):this.media.textTracks.addEventListener(\"change\",this.trackChangeListener))},o.onMediaDetaching=function(){this.media&&(this.useTextTrackPolling?clearInterval(this.subtitlePollingInterval):this.media.textTracks.removeEventListener(\"change\",this.trackChangeListener),Object(u.isFiniteNumber)(this.subtitleTrack)&&(this.queuedDefaultTrack=this.subtitleTrack),jt(this.media.textTracks).forEach((function(e){Fe(e)})),this.subtitleTrack=-1,this.media=null)},o.onManifestLoaded=function(e){var t=this,r=e.subtitles||[];this.tracks=r,this.hls.trigger(c.default.SUBTITLE_TRACKS_UPDATED,{subtitleTracks:r}),r.forEach((function(e){e.default&&(t.media?t.subtitleTrack=e.id:t.queuedDefaultTrack=e.id)}))},o.onSubtitleTrackLoaded=function(e){var t,r=this,n=e.id,i=e.details,a=this.trackId,o=this.tracks,s=o[a];n>=o.length||n!==a||!s||this.stopped?this._clearReloadTimer():(h.logger.log(\"subtitle track \"+n+\" loaded\"),i.live?(t=oe(s.details,i,e.stats.trequest),h.logger.log(\"Reloading live subtitle playlist in \"+t+\"ms\"),this.timer=setTimeout((function(){r._loadCurrentTrack()}),t)):this._clearReloadTimer())},o.startLoad=function(){this.stopped=!1,this._loadCurrentTrack()},o.stopLoad=function(){this.stopped=!0,this._clearReloadTimer()},o._clearReloadTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},o._loadCurrentTrack=function(){var e=this.trackId,t=this.tracks,r=this.hls,n=t[e];e<0||!n||n.details&&!n.details.live||(h.logger.log(\"Loading subtitle track \"+e),r.trigger(c.default.SUBTITLE_TRACK_LOADING,{url:n.url,id:e}))},o._toggleTrackModes=function(e){var t,r,n,i=this.media,a=this.subtitleDisplay,o=this.trackId;i&&(t=jt(i.textTracks),-1===e?[].slice.call(t).forEach((function(e){e.mode=\"disabled\"})):(r=t[o])&&(r.mode=\"disabled\"),(n=t[e])&&(n.mode=a?\"showing\":\"hidden\"))},o._setSubtitleTrackInternal=function(e){var t=this.hls,r=this.tracks;!Object(u.isFiniteNumber)(e)||e<-1||e>=r.length||(this.trackId=e,h.logger.log(\"Switching to subtitle track \"+e),t.trigger(c.default.SUBTITLE_TRACK_SWITCH,{id:e}),this._loadCurrentTrack())},o._onTextTracksChanged=function(){if(this.media&&this.hls.config.renderTextTracksNatively){for(var e=-1,t=jt(this.media.textTracks),r=0;r<t.length;r++)if(\"hidden\"===t[r].mode)e=r;else if(\"showing\"===t[r].mode){e=r;break}this.subtitleTrack=e}},i=n,(a=[{key:\"subtitleTracks\",get:function(){return this.tracks}},{key:\"subtitleTrack\",get:function(){return this.trackId},set:function(e){this.trackId!==e&&(this._toggleTrackModes(e),this._setSubtitleTrackInternal(e))}}])&&Nt(i.prototype,a),n}(p),Vt=r(\"./src/crypt/decrypter.js\"),Yt=window.performance,Ht=function(e){var t,r;function n(t,r){var n=e.call(this,t,c.default.MEDIA_ATTACHED,c.default.MEDIA_DETACHING,c.default.ERROR,c.default.KEY_LOADED,c.default.FRAG_LOADED,c.default.SUBTITLE_TRACKS_UPDATED,c.default.SUBTITLE_TRACK_SWITCH,c.default.SUBTITLE_TRACK_LOADED,c.default.SUBTITLE_FRAG_PROCESSED,c.default.LEVEL_UPDATED)||this;return n.fragmentTracker=r,n.config=t.config,n.state=me,n.tracks=[],n.tracksBuffered=[],n.currentTrackId=-1,n.decrypter=new Vt.default(t,t.config),n.lastAVStart=0,n._onMediaSeeking=n.onMediaSeeking.bind(function(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}(n)),n}r=e,(t=n).prototype=Object.create(r.prototype),(t.prototype.constructor=t).__proto__=r;var i=n.prototype;return i.onSubtitleFragProcessed=function(e){var t=e.frag,r=e.success;if(this.fragPrevious=t,this.state=ye,r){var n=this.tracksBuffered[this.currentTrackId];if(n){for(var i,a=t.start,o=0;o<n.length;o++)if(a>=n[o].start&&a<=n[o].end){i=n[o];break}var s=t.start+t.duration;i?i.end=s:(i={start:a,end:s},n.push(i))}}},i.onMediaAttached=function(e){var t=e.media;(this.media=t).addEventListener(\"seeking\",this._onMediaSeeking),this.state=ye},i.onMediaDetaching=function(){var e=this;this.media&&(this.media.removeEventListener(\"seeking\",this._onMediaSeeking),this.fragmentTracker.removeAllFragments(),this.currentTrackId=-1,this.tracks.forEach((function(t){e.tracksBuffered[t.id]=[]})),this.media=null,this.state=me)},i.onError=function(e){var t=e.frag;t&&\"subtitle\"===t.type&&(this.state=ye)},i.onSubtitleTracksUpdated=function(e){var t=this;h.logger.log(\"subtitle tracks updated\"),this.tracksBuffered=[],this.tracks=e.subtitleTracks,this.tracks.forEach((function(e){t.tracksBuffered[e.id]=[]}))},i.onSubtitleTrackSwitch=function(e){var t;this.currentTrackId=e.id,this.tracks&&this.tracks.length&&-1!==this.currentTrackId?(t=this.tracks[this.currentTrackId])&&t.details&&this.setInterval(500):this.clearInterval()},i.onSubtitleTrackLoaded=function(e){var t=e.id,r=e.details,n=this.currentTrackId,i=this.tracks,a=i[n];t>=i.length||t!==n||!a||(r.live&&function(e,t,r){void 0===r&&(r=0);var n=-1;ae(e,t,(function(e,t,r){t.start=e.start,n=r}));var i=t.fragments;if(n<0)i.forEach((function(e){e.start+=r}));else for(var a=n+1;a<i.length;a++)i[a].start=i[a-1].start+i[a-1].duration}(a.details,r,this.lastAVStart),a.details=r,this.setInterval(500))},i.onKeyLoaded=function(){this.state===ve&&(this.state=ye)},i.onFragLoaded=function(e){var t,r=this.fragCurrent,n=e.frag.decryptdata,i=e.frag,a=this.hls;this.state===_e&&r&&\"subtitle\"===e.frag.type&&r.sn===e.frag.sn&&0<e.payload.byteLength&&n&&n.key&&\"AES-128\"===n.method&&(t=Yt.now(),this.decrypter.decrypt(e.payload,n.key.buffer,n.iv.buffer,(function(e){var r=Yt.now();a.trigger(c.default.FRAG_DECRYPTED,{frag:i,payload:e,stats:{tstart:t,tdecrypt:r}})})))},i.onLevelUpdated=function(e){var t=e.details.fragments;this.lastAVStart=t.length?t[0].start:0},i.doTick=function(){if(this.media)switch(this.state){case ye:var e=this.config,t=this.currentTrackId,r=this.fragmentTracker,n=this.media,i=this.tracks;if(!i||!i[t]||!i[t].details)break;var a=e.maxBufferHole,o=e.maxFragLookUpTolerance,s=Math.min(e.maxBufferLength,e.maxMaxBufferLength),l=Y.bufferedInfo(this._getBuffered(),n.currentTime,a),d=l.end,u=l.len,f=i[t].details,p=f.fragments,m=p.length,g=p[m-1].start+p[m-1].duration;if(s<u)return;var y,v=this.fragPrevious;(y=d<g?(v&&f.hasProgramDateTime&&(y=ue(p,v.endProgramDateTime,o)),y||ce(v,p,d,o)):p[m-1])&&y.encrypted?(h.logger.log(\"Loading key for \"+y.sn),this.state=ve,this.hls.trigger(c.default.KEY_LOADING,{frag:y})):y&&r.getState(y)===N&&(this.fragCurrent=y,this.state=_e,this.hls.trigger(c.default.FRAG_LOADING,{frag:y}))}else this.state=ye},i.stopLoad=function(){this.lastAVStart=0,e.prototype.stopLoad.call(this)},i._getBuffered=function(){return this.tracksBuffered[this.currentTrackId]||[]},i.onMediaSeeking=function(){this.fragPrevious=null},n}(Re);(zt=Gt=Gt||{}).WIDEVINE=\"com.widevine.alpha\",zt.PLAYREADY=\"com.microsoft.playready\";var Kt=\"undefined\"!=typeof window&&window.navigator&&window.navigator.requestMediaKeySystemAccess?window.navigator.requestMediaKeySystemAccess.bind(window.navigator):null;function Wt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Xt=function(e){var t,r;function n(t){var r=e.call(this,t,c.default.MEDIA_ATTACHED,c.default.MEDIA_DETACHED,c.default.MANIFEST_PARSED)||this;return r._widevineLicenseUrl=void 0,r._licenseXhrSetup=void 0,r._emeEnabled=void 0,r._requestMediaKeySystemAccess=void 0,r._drmSystemOptions=void 0,r._config=void 0,r._mediaKeysList=[],r._media=null,r._hasSetMediaKeys=!1,r._requestLicenseFailureCount=0,r.mediaKeysPromise=null,r._onMediaEncrypted=function(e){if(h.logger.log('Media is encrypted using \"'+e.initDataType+'\" init data type'),!r.mediaKeysPromise)return h.logger.error(\"Fatal: Media is encrypted but no CDM access or no keys have been requested\"),void r.hls.trigger(c.default.ERROR,{type:d.ErrorTypes.KEY_SYSTEM_ERROR,details:d.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});function t(t){r._media&&(r._attemptSetMediaKeys(t),r._generateRequestWithPreferredKeySession(e.initDataType,e.initData))}r.mediaKeysPromise.then(t).catch(t)},r._config=t.config,r._widevineLicenseUrl=r._config.widevineLicenseUrl,r._licenseXhrSetup=r._config.licenseXhrSetup,r._emeEnabled=r._config.emeEnabled,r._requestMediaKeySystemAccess=r._config.requestMediaKeySystemAccessFunc,r._drmSystemOptions=t.config.drmSystemOptions,r}r=e,(t=n).prototype=Object.create(r.prototype),(t.prototype.constructor=t).__proto__=r;var i,a,o=n.prototype;return o.getLicenseServerUrl=function(e){switch(e){case Gt.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system \"'+e+'\"')},o._attemptKeySystemAccess=function(e,t,r){var n=this,i=function(e,t,r,n){if(e!==Gt.WIDEVINE)throw new Error(\"Unknown key-system: \"+e);return i=r,a=n,o={audioCapabilities:[],videoCapabilities:[]},t.forEach((function(e){o.audioCapabilities.push({contentType:'audio/mp4; codecs=\"'+e+'\"',robustness:a.audioRobustness||\"\"})})),i.forEach((function(e){o.videoCapabilities.push({contentType:'video/mp4; codecs=\"'+e+'\"',robustness:a.videoRobustness||\"\"})})),[o];var i,a,o}(e,t,r,this._drmSystemOptions);h.logger.log(\"Requesting encrypted media key-system access\");var a=this.requestMediaKeySystemAccess(e,i);this.mediaKeysPromise=a.then((function(t){return n._onMediaKeySystemAccessObtained(e,t)})),a.catch((function(t){h.logger.error('Failed to obtain key-system \"'+e+'\" access:',t)}))},o._onMediaKeySystemAccessObtained=function(e,t){var r=this;h.logger.log('Access for key-system \"'+e+'\" obtained');var n={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:t,mediaKeySystemDomain:e};this._mediaKeysList.push(n);var i=Promise.resolve().then((function(){return t.createMediaKeys()})).then((function(t){return n.mediaKeys=t,h.logger.log('Media-keys created for key-system \"'+e+'\"'),r._onMediaKeysCreated(),t}));return i.catch((function(e){h.logger.error(\"Failed to create media-keys:\",e)})),i},o._onMediaKeysCreated=function(){var e=this;this._mediaKeysList.forEach((function(t){t.mediaKeysSession||(t.mediaKeysSession=t.mediaKeys.createSession(),e._onNewMediaKeySession(t.mediaKeysSession))}))},o._onNewMediaKeySession=function(e){var t=this;h.logger.log(\"New key-system session \"+e.sessionId),e.addEventListener(\"message\",(function(r){t._onKeySessionMessage(e,r.message)}),!1)},o._onKeySessionMessage=function(e,t){h.logger.log(\"Got EME message event, creating license request\"),this._requestLicense(t,(function(t){h.logger.log(\"Received license data (length: \"+(t?t.byteLength:t)+\"), updating key-session\"),e.update(t)}))},o._attemptSetMediaKeys=function(){if(!this._media)throw new Error(\"Attempted to set mediaKeys without first attaching a media element\");if(!this._hasSetMediaKeys){var e=this._mediaKeysList[0];if(!e||!e.mediaKeys)return h.logger.error(\"Fatal: Media is encrypted but no CDM access or no keys have been obtained yet\"),void this.hls.trigger(c.default.ERROR,{type:d.ErrorTypes.KEY_SYSTEM_ERROR,details:d.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});h.logger.log(\"Setting keys for encrypted media\"),this._media.setMediaKeys(e.mediaKeys),this._hasSetMediaKeys=!0}},o._generateRequestWithPreferredKeySession=function(e,t){var r=this,n=this._mediaKeysList[0];if(!n)return h.logger.error(\"Fatal: Media is encrypted but not any key-system access has been obtained yet\"),void this.hls.trigger(c.default.ERROR,{type:d.ErrorTypes.KEY_SYSTEM_ERROR,details:d.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});if(n.mediaKeysSessionInitialized)h.logger.warn(\"Key-Session already initialized but requested again\");else{var i=n.mediaKeysSession;if(!i)return h.logger.error(\"Fatal: Media is encrypted but no key-session existing\"),void this.hls.trigger(c.default.ERROR,{type:d.ErrorTypes.KEY_SYSTEM_ERROR,details:d.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0});if(!t)return h.logger.warn(\"Fatal: initData required for generating a key session is null\"),void this.hls.trigger(c.default.ERROR,{type:d.ErrorTypes.KEY_SYSTEM_ERROR,details:d.ErrorDetails.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});h.logger.log('Generating key-session request for \"'+e+'\" init data type'),n.mediaKeysSessionInitialized=!0,i.generateRequest(e,t).then((function(){h.logger.debug(\"Key-session generation succeeded\")})).catch((function(e){h.logger.error(\"Error generating key-session request:\",e),r.hls.trigger(c.default.ERROR,{type:d.ErrorTypes.KEY_SYSTEM_ERROR,details:d.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})}))}},o._createLicenseXhr=function(e,t,r){var n=new XMLHttpRequest,i=this._licenseXhrSetup;try{if(i)try{i(n,e)}catch(t){n.open(\"POST\",e,!0),i(n,e)}n.readyState||n.open(\"POST\",e,!0)}catch(t){throw new Error(\"issue setting up KeySystem license XHR \"+t)}return n.responseType=\"arraybuffer\",n.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,n,e,t,r),n},o._onLicenseRequestReadyStageChange=function(e,t,r,n){if(4===e.readyState)if(200===e.status)this._requestLicenseFailureCount=0,h.logger.log(\"License request succeeded\"),\"arraybuffer\"!==e.responseType&&h.logger.warn(\"xhr response type was not set to the expected arraybuffer for license request\"),n(e.response);else{if(h.logger.error(\"License Request XHR failed (\"+t+\"). Status: \"+e.status+\" (\"+e.statusText+\")\"),this._requestLicenseFailureCount++,3<this._requestLicenseFailureCount)return void this.hls.trigger(c.default.ERROR,{type:d.ErrorTypes.KEY_SYSTEM_ERROR,details:d.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});var i=3-this._requestLicenseFailureCount+1;h.logger.warn(\"Retrying license request, \"+i+\" attempts left\"),this._requestLicense(r,n)}},o._generateLicenseRequestChallenge=function(e,t){if(e.mediaKeySystemDomain===Gt.WIDEVINE)return t;throw new Error(\"unsupported key-system: \"+e.mediaKeySystemDomain)},o._requestLicense=function(e,t){h.logger.log(\"Requesting content license for key-system\");var r=this._mediaKeysList[0];if(!r)return h.logger.error(\"Fatal error: Media is encrypted but no key-system access has been obtained yet\"),void this.hls.trigger(c.default.ERROR,{type:d.ErrorTypes.KEY_SYSTEM_ERROR,details:d.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});try{var n=this.getLicenseServerUrl(r.mediaKeySystemDomain),i=this._createLicenseXhr(n,e,t);h.logger.log(\"Sending license request to URL: \"+n);var a=this._generateLicenseRequestChallenge(r,e);i.send(a)}catch(e){h.logger.error(\"Failure requesting DRM license: \"+e),this.hls.trigger(c.default.ERROR,{type:d.ErrorTypes.KEY_SYSTEM_ERROR,details:d.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},o.onMediaAttached=function(e){var t;this._emeEnabled&&(t=e.media,(this._media=t).addEventListener(\"encrypted\",this._onMediaEncrypted))},o.onMediaDetached=function(){var e=this._media,t=this._mediaKeysList;e&&(e.removeEventListener(\"encrypted\",this._onMediaEncrypted),this._media=null,this._mediaKeysList=[],Promise.all(t.map((function(e){if(e.mediaKeysSession)return e.mediaKeysSession.close().catch((function(){}))}))).then((function(){return e.setMediaKeys(null)})).catch((function(){})))},o.onManifestParsed=function(e){var t,r;this._emeEnabled&&(t=e.levels.map((function(e){return e.audioCodec})),r=e.levels.map((function(e){return e.videoCodec})),this._attemptKeySystemAccess(Gt.WIDEVINE,t,r))},i=n,(a=[{key:\"requestMediaKeySystemAccess\",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error(\"No requestMediaKeySystemAccess function configured\");return this._requestMediaKeySystemAccess}}])&&Wt(i.prototype,a),n}(p);function $t(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function Qt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$t(Object(r),!0).forEach((function(t){var n,i,a;n=e,a=r[i=t],i in n?Object.defineProperty(n,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[i]=a})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$t(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Jt=Qt(Qt({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,liveDurationInfinity:!1,liveBackBufferLength:1/0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:$e,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,abrController:qe,bufferController:Ye,capLevelController:Ke,fpsController:Xe,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:Kt,testBandwidth:!0},{cueHandler:n,enableCEA708Captions:!0,enableWebVTT:!0,captionsTextTrack1Label:\"English\",captionsTextTrack1LanguageCode:\"en\",captionsTextTrack2Label:\"Spanish\",captionsTextTrack2LanguageCode:\"es\",captionsTextTrack3Label:\"Unknown CC\",captionsTextTrack3LanguageCode:\"\",captionsTextTrack4Label:\"Unknown CC\",captionsTextTrack4LanguageCode:\"\",renderTextTracksNatively:!0}),{},{subtitleStreamController:Ht,subtitleTrackController:qt,timelineController:Ut,audioStreamController:rt,audioTrackController:Je,emeController:Xt});function Zt(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function er(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Zt(Object(r),!0).forEach((function(t){var n,i,a;n=e,a=r[i=t],i in n?Object.defineProperty(n,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[i]=a})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Zt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function tr(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}function rr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function nr(e,t,r){return t&&rr(e.prototype,t),r&&rr(e,r),e}var ir=function(e){var t,r;function n(t){var r;void 0===t&&(t={}),(r=e.call(this)||this).config=void 0,r._autoLevelCapping=void 0,r.abrController=void 0,r.capLevelController=void 0,r.levelController=void 0,r.streamController=void 0,r.networkControllers=void 0,r.audioTrackController=void 0,r.subtitleTrackController=void 0,r.emeController=void 0,r.coreComponents=void 0,r.media=null,r.url=null;var i=n.DefaultConfig;if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error(\"Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration\");r.config=er(er({},i),t);var a=tr(r).config;if(void 0!==a.liveMaxLatencyDurationCount&&a.liveMaxLatencyDurationCount<=a.liveSyncDurationCount)throw new Error('Illegal hls.js config: \"liveMaxLatencyDurationCount\" must be gt \"liveSyncDurationCount\"');if(void 0!==a.liveMaxLatencyDuration&&(void 0===a.liveSyncDuration||a.liveMaxLatencyDuration<=a.liveSyncDuration))throw new Error('Illegal hls.js config: \"liveMaxLatencyDuration\" must be gt \"liveSyncDuration\"');Object(h.enableLogs)(a.debug),r._autoLevelCapping=-1;var o=r.abrController=new a.abrController(tr(r)),s=new a.bufferController(tr(r)),l=r.capLevelController=new a.capLevelController(tr(r)),d=new a.fpsController(tr(r)),u=new B(tr(r)),c=new F(tr(r)),f=new U(tr(r)),p=new Ue(tr(r)),m=r.levelController=new Me(tr(r)),g=new q(tr(r)),y=[m,r.streamController=new Ce(tr(r),g)],v=a.audioStreamController;v&&y.push(new v(tr(r),g)),r.networkControllers=y;var _,b,E,k=[u,c,f,o,s,l,d,p,g];return(v=a.audioTrackController)&&(_=new v(tr(r)),r.audioTrackController=_,k.push(_)),(v=a.subtitleTrackController)&&(b=new v(tr(r)),r.subtitleTrackController=b,y.push(b)),(v=a.emeController)&&(E=new v(tr(r)),r.emeController=E,k.push(E)),(v=a.subtitleStreamController)&&y.push(new v(tr(r),g)),(v=a.timelineController)&&k.push(new v(tr(r))),r.coreComponents=k,r}r=e,(t=n).prototype=Object.create(r.prototype),(t.prototype.constructor=t).__proto__=r,n.isSupported=function(){var e=X();if(!e)return!1;var t=self.SourceBuffer||self.WebKitSourceBuffer,r=e&&\"function\"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs=\"avc1.42E01E,mp4a.40.2\"'),n=!t||t.prototype&&\"function\"==typeof t.prototype.appendBuffer&&\"function\"==typeof t.prototype.remove;return!!r&&!!n},nr(n,null,[{key:\"version\",get:function(){return\"0.14.10\"}},{key:\"Events\",get:function(){return c.default}},{key:\"ErrorTypes\",get:function(){return d.ErrorTypes}},{key:\"ErrorDetails\",get:function(){return d.ErrorDetails}},{key:\"DefaultConfig\",get:function(){return n.defaultConfig?n.defaultConfig:Jt},set:function(e){n.defaultConfig=e}}]);var i=n.prototype;return i.destroy=function(){h.logger.log(\"destroy\"),this.trigger(c.default.DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach((function(e){e.destroy()})),this.url=null,this.removeAllListeners(),this._autoLevelCapping=-1},i.attachMedia=function(e){h.logger.log(\"attachMedia\"),this.media=e,this.trigger(c.default.MEDIA_ATTACHING,{media:e})},i.detachMedia=function(){h.logger.log(\"detachMedia\"),this.trigger(c.default.MEDIA_DETACHING),this.media=null},i.loadSource=function(e){e=l.buildAbsoluteURL(window.location.href,e,{alwaysNormalize:!0}),h.logger.log(\"loadSource:\"+e),this.url=e,this.trigger(c.default.MANIFEST_LOADING,{url:e})},i.startLoad=function(e){void 0===e&&(e=-1),h.logger.log(\"startLoad(\"+e+\")\"),this.networkControllers.forEach((function(t){t.startLoad(e)}))},i.stopLoad=function(){h.logger.log(\"stopLoad\"),this.networkControllers.forEach((function(e){e.stopLoad()}))},i.swapAudioCodec=function(){h.logger.log(\"swapAudioCodec\"),this.streamController.swapAudioCodec()},i.recoverMediaError=function(){h.logger.log(\"recoverMediaError\");var e=this.media;this.detachMedia(),e&&this.attachMedia(e)},i.removeLevel=function(e,t){void 0===t&&(t=0),this.levelController.removeLevel(e,t)},nr(n,[{key:\"levels\",get:function(){return this.levelController.levels}},{key:\"currentLevel\",get:function(){return this.streamController.currentLevel},set:function(e){h.logger.log(\"set currentLevel:\"+e),this.loadLevel=e,this.streamController.immediateLevelSwitch()}},{key:\"nextLevel\",get:function(){return this.streamController.nextLevel},set:function(e){h.logger.log(\"set nextLevel:\"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:\"loadLevel\",get:function(){return this.levelController.level},set:function(e){h.logger.log(\"set loadLevel:\"+e),this.levelController.manualLevel=e}},{key:\"nextLoadLevel\",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:\"firstLevel\",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(e){h.logger.log(\"set firstLevel:\"+e),this.levelController.firstLevel=e}},{key:\"startLevel\",get:function(){return this.levelController.startLevel},set:function(e){h.logger.log(\"set startLevel:\"+e),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}},{key:\"capLevelToPlayerSize\",set:function(e){var t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}},{key:\"autoLevelCapping\",get:function(){return this._autoLevelCapping},set:function(e){h.logger.log(\"set autoLevelCapping:\"+e),this._autoLevelCapping=e}},{key:\"bandwidthEstimate\",get:function(){var e=this.abrController._bwEstimator;return e?e.getEstimate():NaN}},{key:\"autoLevelEnabled\",get:function(){return-1===this.levelController.manualLevel}},{key:\"manualLevel\",get:function(){return this.levelController.manualLevel}},{key:\"minAutoLevel\",get:function(){for(var e=this.levels,t=this.config.minAutoBitrate,r=e?e.length:0,n=0;n<r;n++)if(t<(e[n].realBitrate?Math.max(e[n].realBitrate,e[n].bitrate):e[n].bitrate))return n;return 0}},{key:\"maxAutoLevel\",get:function(){var e=this.levels,t=this.autoLevelCapping;return-1===t&&e&&e.length?e.length-1:t}},{key:\"nextAutoLevel\",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)}},{key:\"audioTracks\",get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]}},{key:\"audioTrack\",get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var t=this.audioTrackController;t&&(t.audioTrack=e)}},{key:\"liveSyncPosition\",get:function(){return this.streamController.liveSyncPosition}},{key:\"subtitleTracks\",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTracks:[]}},{key:\"subtitleTrack\",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}},{key:\"subtitleDisplay\",get:function(){var e=this.subtitleTrackController;return!!e&&e.subtitleDisplay},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}}]),n}(Q);ir.defaultConfig=void 0},\"./src/polyfills/number.js\":\n/*!*********************************!*\\\n  !*** ./src/polyfills/number.js ***!\n  \\*********************************/\n/*! exports provided: isFiniteNumber, MAX_SAFE_INTEGER */function(e,t,r){\"use strict\";r.r(t),r.d(t,\"isFiniteNumber\",(function(){return n})),r.d(t,\"MAX_SAFE_INTEGER\",(function(){return i}));var n=Number.isFinite||function(e){return\"number\"==typeof e&&isFinite(e)},i=Number.MAX_SAFE_INTEGER||9007199254740991},\"./src/utils/get-self-scope.js\":\n/*!*************************************!*\\\n  !*** ./src/utils/get-self-scope.js ***!\n  \\*************************************/\n/*! exports provided: getSelfScope */function(e,t,r){\"use strict\";function n(){return\"undefined\"==typeof window?self:window}r.r(t),r.d(t,\"getSelfScope\",(function(){return n}))},\"./src/utils/logger.js\":\n/*!*****************************!*\\\n  !*** ./src/utils/logger.js ***!\n  \\*****************************/\n/*! exports provided: enableLogs, logger */function(e,t,r){\"use strict\";r.r(t),r.d(t,\"enableLogs\",(function(){return d})),r.d(t,\"logger\",(function(){return u}));var n=r(/*! ./get-self-scope */\"./src/utils/get-self-scope.js\");function i(){}var a={trace:i,debug:i,log:i,warn:i,info:i,error:i},o=a,s=Object(n.getSelfScope)();function l(e){var t=s.console[e];return t?function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];n[0]&&(n[0]=\"[\"+e+\"] > \"+n[0]),t.apply(s.console,n)}:i}var d=function(e){if(s.console&&!0===e||\"object\"==typeof e){!function(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];r.forEach((function(t){o[t]=e[t]?e[t].bind(e):l(t)}))}(e,\"debug\",\"log\",\"info\",\"warn\",\"error\");try{o.log()}catch(e){o=a}}else o=a},u=o}},e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:n})},e.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},e.t=function(t,r){if(1&r&&(t=e(t)),8&r)return t;if(4&r&&\"object\"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:t}),2&r&&\"string\"!=typeof t)for(var i in t)e.d(n,i,function(e){return t[e]}.bind(null,i));return n},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,\"a\",r),r},e.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},e.p=\"/dist/\",e(e.s=\"./src/hls.ts\").default;function e(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var t,r},e.exports=n())},\"./node_modules/process/browser.js\":function(e,t){var r,n,i=e.exports={};function a(){throw new Error(\"setTimeout has not been defined\")}function o(){throw new Error(\"clearTimeout has not been defined\")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r=\"function\"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{n=\"function\"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var l,d=[],u=!1,c=-1;function h(){u&&l&&(u=!1,l.length?d=l.concat(d):c=-1,d.length&&f())}function f(){if(!u){var e=s(h);u=!0;for(var t=d.length;t;){for(l=d,d=[];++c<t;)l&&l[c].run();c=-1,t=d.length}l=null,u=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];d.push(new p(e,t)),1!==d.length||u||s(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title=\"browser\",i.browser=!0,i.env={},i.argv=[],i.version=\"\",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error(\"process.binding is not supported\")},i.cwd=function(){return\"/\"},i.chdir=function(e){throw new Error(\"process.chdir is not supported\")},i.umask=function(){return 0}},\"./node_modules/setimmediate/setImmediate.js\":function(e,t,r){(function(e,t){!function(e,r){\"use strict\";var n,i,a,o,s,l,d,u,c;function h(e){delete i[e]}function f(e){if(a)setTimeout(f,0,e);else{var t=i[e];if(t){a=!0;try{!function(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(void 0,r)}}(t)}finally{h(e),a=!1}}}}function p(t){t.source===e&&\"string\"==typeof t.data&&0===t.data.indexOf(u)&&f(+t.data.slice(u.length))}e.setImmediate||(n=1,a=!(i={}),o=e.document,c=(c=Object.getPrototypeOf&&Object.getPrototypeOf(e))&&c.setTimeout?c:e,s=\"[object process]\"==={}.toString.call(e.process)?function(e){t.nextTick((function(){f(e)}))}:function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage(\"\",\"*\"),e.onmessage=r,t}}()?(u=\"setImmediate$\"+Math.random()+\"$\",e.addEventListener?e.addEventListener(\"message\",p,!1):e.attachEvent(\"onmessage\",p),function(t){e.postMessage(u+t,\"*\")}):e.MessageChannel?((d=new MessageChannel).port1.onmessage=function(e){f(e.data)},function(e){d.port2.postMessage(e)}):o&&\"onreadystatechange\"in o.createElement(\"script\")?(l=o.documentElement,function(e){var t=o.createElement(\"script\");t.onreadystatechange=function(){f(e),t.onreadystatechange=null,l.removeChild(t),t=null},l.appendChild(t)}):function(e){setTimeout(f,0,e)},c.setImmediate=function(e){\"function\"!=typeof e&&(e=new Function(\"\"+e));for(var t=new Array(arguments.length-1),r=0;r<t.length;r++)t[r]=arguments[r+1];var a={callback:e,args:t};return i[n]=a,s(n),n++},c.clearImmediate=h)}(\"undefined\"==typeof self?void 0===e?this:e:self)}).call(this,r(\"./node_modules/webpack/buildin/global.js\"),r(\"./node_modules/process/browser.js\"))},\"./node_modules/style-loader/lib/addStyles.js\":function(e,t,r){var n,i,a,o={},s=(n=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===i&&(i=n.apply(this,arguments)),i}),l=(a={},function(e,t){if(\"function\"==typeof e)return e();if(void 0===a[e]){var r=function(e,t){return t?t.querySelector(e):document.querySelector(e)}.call(this,e,t);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}a[e]=r}return a[e]}),d=null,u=0,c=[],h=r(\"./node_modules/style-loader/lib/urls.js\");function f(e,t){for(var r=0;r<e.length;r++){var n=e[r],i=o[n.id];if(i){i.refs++;for(var a=0;a<i.parts.length;a++)i.parts[a](n.parts[a]);for(;a<n.parts.length;a++)i.parts.push(_(n.parts[a],t))}else{var s=[];for(a=0;a<n.parts.length;a++)s.push(_(n.parts[a],t));o[n.id]={id:n.id,refs:1,parts:s}}}}function p(e,t){for(var r=[],n={},i=0;i<e.length;i++){var a=e[i],o=t.base?a[0]+t.base:a[0],s={css:a[1],media:a[2],sourceMap:a[3]};n[o]?n[o].parts.push(s):r.push(n[o]={id:o,parts:[s]})}return r}function m(e,t){var r=l(e.insertInto);if(!r)throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.\");var n=c[c.length-1];if(\"top\"===e.insertAt)n?n.nextSibling?r.insertBefore(t,n.nextSibling):r.appendChild(t):r.insertBefore(t,r.firstChild),c.push(t);else if(\"bottom\"===e.insertAt)r.appendChild(t);else{if(\"object\"!=typeof e.insertAt||!e.insertAt.before)throw new Error(\"[Style Loader]\\n\\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\\n Must be 'top', 'bottom', or Object.\\n (https://github.com/webpack-contrib/style-loader#insertat)\\n\");var i=l(e.insertAt.before,r);r.insertBefore(t,i)}}function g(e){var t;null!==e.parentNode&&(e.parentNode.removeChild(e),0<=(t=c.indexOf(e))&&c.splice(t,1))}function y(e){var t,n=document.createElement(\"style\");return void 0===e.attrs.type&&(e.attrs.type=\"text/css\"),void 0!==e.attrs.nonce||(t=r.nc)&&(e.attrs.nonce=t),v(n,e.attrs),m(e,n),n}function v(e,t){Object.keys(t).forEach((function(r){e.setAttribute(r,t[r])}))}function _(e,t){var r,n,i,a,o,s,l;if(t.transform&&e.css){if(!(r=\"function\"==typeof t.transform?t.transform(e.css):t.transform.default(e.css)))return function(){};e.css=r}return o=t.singleton?(n=u++,i=d=d||y(t),a=k.bind(null,i,n,!1),k.bind(null,i,n,!0)):e.sourceMap&&\"function\"==typeof URL&&\"function\"==typeof URL.createObjectURL&&\"function\"==typeof URL.revokeObjectURL&&\"function\"==typeof Blob&&\"function\"==typeof btoa?(s=t,l=document.createElement(\"link\"),void 0===s.attrs.type&&(s.attrs.type=\"text/css\"),s.attrs.rel=\"stylesheet\",v(l,s.attrs),m(s,l),a=function(e,t,r){var n=r.css,i=r.sourceMap,a=void 0===t.convertToAbsoluteUrls&&i;(t.convertToAbsoluteUrls||a)&&(n=h(n)),i&&(n+=\"\\n/*# sourceMappingURL=data:application/json;base64,\"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+\" */\");var o=new Blob([n],{type:\"text/css\"}),s=e.href;e.href=URL.createObjectURL(o),s&&URL.revokeObjectURL(s)}.bind(null,i=l,t),function(){g(i),i.href&&URL.revokeObjectURL(i.href)}):(i=y(t),a=function(e,t){var r=t.css,n=t.media;if(n&&e.setAttribute(\"media\",n),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}.bind(null,i),function(){g(i)}),a(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;a(e=t)}else o()}}e.exports=function(e,t){if(\"undefined\"!=typeof DEBUG&&DEBUG&&\"object\"!=typeof document)throw new Error(\"The style-loader cannot be used in a non-browser environment\");(t=t||{}).attrs=\"object\"==typeof t.attrs?t.attrs:{},t.singleton||\"boolean\"==typeof t.singleton||(t.singleton=s()),t.insertInto||(t.insertInto=\"head\"),t.insertAt||(t.insertAt=\"bottom\");var r=p(e,t);return f(r,t),function(e){for(var n=[],i=0;i<r.length;i++){var a=r[i];(s=o[a.id]).refs--,n.push(s)}e&&f(p(e,t),t);var s;for(i=0;i<n.length;i++)if(0===(s=n[i]).refs){for(var l=0;l<s.parts.length;l++)s.parts[l]();delete o[s.id]}}};var b,E=(b=[],function(e,t){return b[e]=t,b.filter(Boolean).join(\"\\n\")});function k(e,t,r,n){var i,a,o=r?\"\":n.css;e.styleSheet?e.styleSheet.cssText=E(t,o):(i=document.createTextNode(o),(a=e.childNodes)[t]&&e.removeChild(a[t]),a.length?e.insertBefore(i,a[t]):e.appendChild(i))}},\"./node_modules/style-loader/lib/urls.js\":function(e,t){e.exports=function(e){var t=\"undefined\"!=typeof window&&window.location;if(!t)throw new Error(\"fixUrls requires window.location\");if(!e||\"string\"!=typeof e)return e;var r=t.protocol+\"//\"+t.host,n=r+t.pathname.replace(/\\/[^\\/]*$/,\"/\");return e.replace(/url\\s*\\(((?:[^)(]|\\((?:[^)(]+|\\([^)(]*\\))*\\))*)\\)/gi,(function(e,t){var i,a=t.trim().replace(/^\"(.*)\"$/,(function(e,t){return t})).replace(/^'(.*)'$/,(function(e,t){return t}));return/^(#|data:|http:\\/\\/|https:\\/\\/|file:\\/\\/\\/|\\s*$)/i.test(a)?e:(i=0===a.indexOf(\"//\")?a:0===a.indexOf(\"/\")?r+a:n+a.replace(/^\\.\\//,\"\"),\"url(\"+JSON.stringify(i)+\")\")}))}},\"./node_modules/timers-browserify/main.js\":function(e,t,r){(function(e){var n=void 0!==e&&e||\"undefined\"!=typeof self&&self||window,i=Function.prototype.apply;function a(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new a(i.call(setTimeout,n,arguments),clearTimeout)},t.setInterval=function(){return new a(i.call(setInterval,n,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(n,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;0<=t&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},r(\"./node_modules/setimmediate/setImmediate.js\"),t.setImmediate=\"undefined\"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate=\"undefined\"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,r(\"./node_modules/webpack/buildin/global.js\"))},\"./node_modules/webpack/buildin/amd-options.js\":function(e,t){(function(t){e.exports=t}).call(this,{})},\"./node_modules/webpack/buildin/global.js\":function(e,t){var r=function(){return this}();try{r=r||new Function(\"return this\")()}catch(e){\"object\"==typeof window&&(r=window)}e.exports=r},\"./node_modules/webpack/buildin/harmony-module.js\":function(e,t){e.exports=function(e){var t;return e.webpackPolyfill||((t=Object.create(e)).children||(t.children=[]),Object.defineProperty(t,\"loaded\",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,\"id\",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,\"exports\",{enumerable:!0}),t.webpackPolyfill=1),t}},\"./src/index.js\":function(e,t,r){\"use strict\";r.r(t),r(\"./src/js/flv.js\"),r(\"./node_modules/dplayer/dist/DPlayer.min.css\");var n=r(\"./node_modules/dplayer/dist/DPlayer.min.js\"),i=r.n(n);window.Hls=r(\"./node_modules/hls.js/dist/hls.js\");var a,o,s,l,d,u,c,h,f,p,m={name:\"VuePlayer\",data:function(){return{}},props:{id:{type:String,default:\"player\"},isSwf:{type:Boolean,default:!1},src:{type:String},height:{type:String,default:\"auto\"},auto:{type:Boolean,default:!1},type:{type:String,default:\"mp4\"}},mounted:function(){var e,t,r;this.isSwf||(\"m3u8\"==this.type?(e=new i.a({container:document.getElementById(this.id),screenshot:!1,video:{url:this.src,type:\"hls\"},autoplay:this.auto}),this.commonUtil(e)):\"flv\"==this.type?(t=new i.a({container:document.getElementById(this.id),screenshot:!1,video:{url:this.src,type:\"flv\"},autoplay:this.auto}),this.commonUtil(t)):\"mp4\"!=this.type&&\"mov\"!=this.type||(r=new i.a({container:document.getElementById(this.id),screenshot:!1,video:{url:this.src},autoplay:this.auto}),this.commonUtil(r)))},methods:{commonUtil:function(e){var t=this;e.on(\"contextmenu_show\",(function(){$(\".dplayer-menu\").hide()})),e.on(\"canplaythrough\",(function(){setTimeout((function(){t.$emit(\"getVtime\",e.video.duration)}),300)}))}}},g=(o=function(){var e=this.$createElement,t=this._self._c||e;return t(\"div\",[this.isSwf?t(\"object\",{attrs:{WIDTH:\"100%\",HEIGHT:this.height,id:\"myMovieName\"}},[t(\"embed\",{attrs:{src:this.src,quality:\"high\",bgcolor:\"#FFFFFF\",WIDTH:\"100%\",HEIGHT:this.height,NAME:\"myMovieName\",ALIGN:\"\",TYPE:\"application/x-shockwave-flash\",PLUGINSPAGE:\"http://www.macromedia.com/go/getflashplayer\"}})]):t(\"div\",{attrs:{id:this.id}})])},l=!(s=[]),d=\"2c6755a8\",u=null,p=\"function\"==typeof(a=m)?a.options:a,o&&(p.render=o,p.staticRenderFns=s,p._compiled=!0),l&&(p.functional=!0),p._scopeId=\"data-v-\"+d,u&&(c=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||\"undefined\"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),e&&e._registeredComponents&&e._registeredComponents.add(u)},p._ssrRegister=c),c&&(p.functional?(p._injectStyles=c,h=p.render,p.render=function(e,t){return c.call(t),h(e,t)}):(f=p.beforeCreate,p.beforeCreate=f?[].concat(f,c):[c])),{exports:a,options:p}).exports;g.install=function(e){return e.component(g.name,g)},\"undefined\"!=typeof window&&window.Vue&&window.Vue.component(g.name,g),t.default=g},\"./src/js/flv.js\":function(e,t,r){\"use strict\";(function(e,t){var n=r(\"./node_modules/@babel/runtime/helpers/typeof.js\"),i=r.n(n);!function(n){\"object\"==(\"undefined\"==typeof exports?\"undefined\":i()(exports))&&void 0!==t?t.exports=n():\"function\"==typeof define&&r(\"./node_modules/webpack/buildin/amd-options.js\")?define([],n):(\"undefined\"!=typeof window?window:void 0!==e?e:\"undefined\"!=typeof self?self:this).flvjs=n()}((function(){return function e(t,r,n){function i(o,s){if(!r[o]){if(!t[o]){if(a)return a(o,!0);var l=new Error(\"Cannot find module '\"+o+\"'\");throw l.code=\"MODULE_NOT_FOUND\",l}var d=r[o]={exports:{}};t[o][0].call(d.exports,(function(e){return i(t[o][1][e]||e)}),d,d.exports,e,t,r,n)}return r[o].exports}for(var a=!1,o=0;o<n.length;o++)i(n[o]);return i}({1:[function(t,r,n){(function(e,a){var o;o=function(){function r(e){return\"function\"==typeof e}function n(){var e=setTimeout;return function(){return e(o,1)}}function o(){for(var e=0;e<T;e+=2)(0,M[e])(M[e+1]),M[e]=void 0,M[e+1]=void 0;T=0}function s(e,t){var r=this,n=new this.constructor(d);void 0===n[B]&&_(n);var i,a=r._state;return a?(i=arguments[a-1],A((function(){return v(a,n,i,r._result)}))):g(r,n,e,t),n}function l(e){if(e&&\"object\"==i()(e)&&e.constructor===this)return e;var t=new this(d);return h(t,e),t}function d(){}function u(e){try{return e.then}catch(e){return j.error=e,j}}function c(e,t,n){var i,a;t.constructor===e.constructor&&n===s&&t.constructor.resolve===l?(i=e,(a=t)._state===U?p(i,a._result):a._state===N?m(i,a._result):g(a,void 0,(function(e){return h(i,e)}),(function(e){return m(i,e)}))):n===j?(m(e,j.error),j.error=null):void 0!==n&&r(n)?function(e,t,r){A((function(e){var n=!1,i=function(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}(r,t,(function(r){n||(n=!0,(t!==r?h:p)(e,r))}),(function(t){n||(n=!0,m(e,t))}),e._label);!n&&i&&(n=!0,m(e,i))}),e)}(e,t,n):p(e,t)}function h(e,t){var r,n;e===t?m(e,new TypeError(\"You cannot resolve a promise with itself\")):(r=t,n=i()(r),null===r||\"object\"!==n&&\"function\"!==n?p(e,t):c(e,t,u(t)))}function f(e){e._onerror&&e._onerror(e._result),y(e)}function p(e,t){e._state===F&&(e._result=t,e._state=U,0!==e._subscribers.length&&A(y,e))}function m(e,t){e._state===F&&(e._state=N,e._result=t,A(f,e))}function g(e,t,r,n){var i=e._subscribers,a=i.length;e._onerror=null,i[a]=t,i[a+U]=r,i[a+N]=n,0===a&&e._state&&A(y,e)}function y(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n,i=void 0,a=e._result,o=0;o<t.length;o+=3)n=t[o],i=t[o+r],n?v(r,n,i,a):i(a);e._subscribers.length=0}}function v(e,t,n,i){var a=r(n),o=void 0,s=void 0,l=void 0,d=void 0;if(a){if((o=function(e,t){try{return e(t)}catch(e){return j.error=e,j}}(n,i))===j?(d=!0,s=o.error,o.error=null):l=!0,t===o)return void m(t,new TypeError(\"A promises callback cannot return that same promise.\"))}else o=i,l=!0;t._state!==F||(a&&l?h(t,o):d?m(t,s):e===U?p(t,o):e===N&&m(t,o))}function _(e){e[B]=G++,e._state=void 0,e._result=void 0,e._subscribers=[]}var b,E,k,w,S=Array.isArray?Array.isArray:function(e){return\"[object Array]\"===Object.prototype.toString.call(e)},T=0,x=void 0,L=void 0,A=function(e,t){M[T]=e,M[T+1]=t,2===(T+=2)&&(L?L(o):P())},R=\"undefined\"!=typeof window?window:void 0,D=R||{},O=D.MutationObserver||D.WebKitMutationObserver,C=\"undefined\"==typeof self&&void 0!==e&&\"[object process]\"==={}.toString.call(e),I=\"undefined\"!=typeof Uint8ClampedArray&&\"undefined\"!=typeof importScripts&&\"undefined\"!=typeof MessageChannel,M=new Array(1e3),P=void 0,B=(P=C?function(){return e.nextTick(o)}:O?(E=0,k=new O(o),w=document.createTextNode(\"\"),k.observe(w,{characterData:!0}),function(){w.data=E=++E%2}):I?((b=new MessageChannel).port1.onmessage=o,function(){return b.port2.postMessage(0)}):(void 0===R&&\"function\"==typeof t?function(){try{var e=Function(\"return this\")().require(\"vertx\");return void 0!==(x=e.runOnLoop||e.runOnContext)?function(){x(o)}:n()}catch(e){return n()}}:n)(),Math.random().toString(36).substring(2)),F=void 0,U=1,N=2,j={error:null},G=0,z=(Y.prototype._enumerate=function(e){for(var t=0;this._state===F&&t<e.length;t++)this._eachEntry(e[t],t)},Y.prototype._eachEntry=function(e,t){var r,n,i=this._instanceConstructor,a=i.resolve;a===l?(r=u(e))===s&&e._state!==F?this._settledAt(e._state,t,e._result):\"function\"!=typeof r?(this._remaining--,this._result[t]=e):i===q?(c(n=new i(d),e,r),this._willSettleAt(n,t)):this._willSettleAt(new i((function(t){return t(e)})),t):this._willSettleAt(a(e),t)},Y.prototype._settledAt=function(e,t,r){var n=this.promise;n._state===F&&(this._remaining--,e===N?m(n,r):this._result[t]=r),0===this._remaining&&p(n,this._result)},Y.prototype._willSettleAt=function(e,t){var r=this;g(e,void 0,(function(e){return r._settledAt(U,t,e)}),(function(e){return r._settledAt(N,t,e)}))},Y),q=(V.prototype.catch=function(e){return this.then(null,e)},V.prototype.finally=function(e){var t=this.constructor;return r(e)?this.then((function(r){return t.resolve(e()).then((function(){return r}))}),(function(r){return t.resolve(e()).then((function(){throw r}))})):this.then(e,e)},V);function V(e){this[B]=G++,this._result=this._state=void 0,this._subscribers=[],d!==e&&(\"function\"!=typeof e&&function(){throw new TypeError(\"You must pass a resolver function as the first argument to the promise constructor\")}(),this instanceof V?function(e,t){try{t((function(t){h(e,t)}),(function(t){m(e,t)}))}catch(t){m(e,t)}}(this,e):function(){throw new TypeError(\"Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.\")}())}function Y(e,t){this._instanceConstructor=e,this.promise=new e(d),this.promise[B]||_(this.promise),S(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?p(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&p(this.promise,this._result))):m(this.promise,new Error(\"Array Methods must be provided an Array\"))}return q.prototype.then=s,q.all=function(e){return new z(this,e).promise},q.race=function(e){var t=this;return new t(S(e)?function(r,n){for(var i=e.length,a=0;a<i;a++)t.resolve(e[a]).then(r,n)}:function(e,t){return t(new TypeError(\"You must pass an array to race.\"))})},q.resolve=l,q.reject=function(e){var t=new this(d);return m(t,e),t},q._setScheduler=function(e){L=e},q._setAsap=function(e){A=e},q._asap=A,q.polyfill=function(){var e=void 0;if(void 0!==a)e=a;else if(\"undefined\"!=typeof self)e=self;else try{e=Function(\"return this\")()}catch(e){throw new Error(\"polyfill failed because global object is unavailable in this environment\")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if(\"[object Promise]\"===r&&!t.cast)return}e.Promise=q},q.Promise=q},\"object\"==i()(n)&&void 0!==r?r.exports=o():this.ES6Promise=o()}).call(this,t(\"_process\"),void 0!==e?e:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{_process:3}],2:[function(e,t,r){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function a(e){return\"function\"==typeof e}function o(e){return\"object\"==i()(e)&&null!==e}function s(e){return void 0===e}((t.exports=n).EventEmitter=n).prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(\"number\"!=typeof e||e<0||isNaN(e))throw TypeError(\"n must be a positive number\");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,r,n,i,l,d;if(this._events||(this._events={}),\"error\"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var u=new Error('Uncaught, unspecified \"error\" event. ('+t+\")\");throw u.context=t,u}if(s(r=this._events[e]))return!1;if(a(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:i=Array.prototype.slice.call(arguments,1),r.apply(this,i)}else if(o(r))for(i=Array.prototype.slice.call(arguments,1),n=(d=r.slice()).length,l=0;l<n;l++)d[l].apply(this,i);return!0},n.prototype.on=n.prototype.addListener=function(e,t){var r;if(!a(t))throw TypeError(\"listener must be a function\");return this._events||(this._events={}),this._events.newListener&&this.emit(\"newListener\",e,a(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned&&(r=s(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&0<r&&this._events[e].length>r&&(this._events[e].warned=!0,console.error(\"(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.\",this._events[e].length),\"function\"==typeof console.trace&&console.trace()),this},n.prototype.once=function(e,t){function r(){this.removeListener(e,r),n||(n=!0,t.apply(this,arguments))}if(!a(t))throw TypeError(\"listener must be a function\");var n=!1;return r.listener=t,this.on(e,r),this},n.prototype.removeListener=function(e,t){var r,n,i,s;if(!a(t))throw TypeError(\"listener must be a function\");if(!this._events||!this._events[e])return this;if(i=(r=this._events[e]).length,n=-1,r===t||a(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit(\"removeListener\",e,t);else if(o(r)){for(s=i;0<s--;)if(r[s]===t||r[s].listener&&r[s].listener===t){n=s;break}if(n<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(n,1),this._events.removeListener&&this.emit(\"removeListener\",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)\"removeListener\"!==t&&this.removeAllListeners(t);return this.removeAllListeners(\"removeListener\"),this._events={},this}if(a(r=this._events[e]))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?a(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(a(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},{}],3:[function(e,t,r){function n(){throw new Error(\"setTimeout has not been defined\")}function i(){throw new Error(\"clearTimeout has not been defined\")}function a(e){if(u===setTimeout)return setTimeout(e,0);if((u===n||!u)&&setTimeout)return u=setTimeout,setTimeout(e,0);try{return u(e,0)}catch(t){try{return u.call(null,e,0)}catch(t){return u.call(this,e,0)}}}function o(){m&&f&&(m=!1,f.length?p=f.concat(p):g=-1,p.length&&s())}function s(){if(!m){var e=a(o);m=!0;for(var t=p.length;t;){for(f=p,p=[];++g<t;)f&&f[g].run();g=-1,t=p.length}f=null,m=!1,function(e){if(c===clearTimeout)return clearTimeout(e);if((c===i||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(e);try{c(e)}catch(t){try{return c.call(null,e)}catch(t){return c.call(this,e)}}}(e)}}function l(e,t){this.fun=e,this.array=t}function d(){}var u,c,h=t.exports={};!function(){try{u=\"function\"==typeof setTimeout?setTimeout:n}catch(e){u=n}try{c=\"function\"==typeof clearTimeout?clearTimeout:i}catch(e){c=i}}();var f,p=[],m=!1,g=-1;h.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];p.push(new l(e,t)),1!==p.length||m||a(s)},l.prototype.run=function(){this.fun.apply(null,this.array)},h.title=\"browser\",h.browser=!0,h.env={},h.argv=[],h.version=\"\",h.versions={},h.on=d,h.addListener=d,h.once=d,h.off=d,h.removeListener=d,h.removeAllListeners=d,h.emit=d,h.prependListener=d,h.prependOnceListener=d,h.listeners=function(e){return[]},h.binding=function(e){throw new Error(\"process.binding is not supported\")},h.cwd=function(){return\"/\"},h.chdir=function(e){throw new Error(\"process.chdir is not supported\")},h.umask=function(){return 0}},{}],4:[function(e,t,r){var n=arguments[3],i=arguments[4],a=arguments[5],o=JSON.stringify;t.exports=function(e,t){for(var r,s=Object.keys(a),l=0,d=s.length;l<d;l++){var u=s[l],c=a[u].exports;if(c===e||c&&c.default===e){r=u;break}}if(!r){r=Math.floor(Math.pow(16,8)*Math.random()).toString(16);var h={};for(l=0,d=s.length;l<d;l++)h[u=s[l]]=u;i[r]=[\"function(require,module,exports){\"+e+\"(self); }\",h]}var f=Math.floor(Math.pow(16,8)*Math.random()).toString(16),p={};p[r]=r,i[f]=[\"function(require,module,exports){var f = require(\"+o(r)+\");(f.default ? f.default : f)(self);}\",p];var m={};!function e(t){for(var r in m[t]=!0,i[t][1]){var n=i[t][1][r];m[n]||e(n)}}(f);var g=\"(\"+n+\")({\"+Object.keys(m).map((function(e){return o(e)+\":[\"+i[e][0]+\",\"+o(i[e][1])+\"]\"})).join(\",\")+\"},{},[\"+o(f)+\"])\",y=window.URL||window.webkitURL||window.mozURL||window.msURL,v=new Blob([g],{type:\"text/javascript\"});if(t&&t.bare)return v;var _=y.createObjectURL(v),b=new Worker(_);return b.objectURL=_,b}},{}],5:[function(e,t,r){Object.defineProperty(r,\"__esModule\",{value:!0}),r.createDefaultConfig=function(){return Object.assign({},n)};var n=r.defaultConfig={enableWorker:!1,enableStashBuffer:!0,stashInitialSize:void 0,isLive:!1,lazyLoad:!0,lazyLoadMaxDuration:180,lazyLoadRecoverDuration:30,deferLoadAfterSourceOpen:!0,autoCleanupMaxBackwardDuration:180,autoCleanupMinBackwardDuration:120,statisticsInfoReportInterval:600,fixAudioTimestampGap:!0,accurateSeek:!1,seekType:\"range\",seekParamStart:\"bstart\",seekParamEnd:\"bend\",rangeLoadZeroStart:!1,customSeekHandler:void 0,reuseRedirectedURL:!1,headers:void 0,customLoader:void 0}},{}],6:[function(e,t,r){Object.defineProperty(r,\"__esModule\",{value:!0});var n=e(\"../io/io-controller.js\"),i=n&&n.__esModule?n:{default:n},a=e(\"../config.js\"),o=(function(e,t,r){t&&l(e.prototype,t),r&&l(e,r)}(s,null,[{key:\"supportMSEH264Playback\",value:function(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs=\"avc1.42E01E,mp4a.40.2\"')}},{key:\"supportNetworkStreamIO\",value:function(){var e=new i.default({},(0,a.createDefaultConfig)()),t=e.loaderType;return e.destroy(),\"fetch-stream-loader\"==t||\"xhr-moz-chunked-loader\"==t}},{key:\"getNetworkLoaderTypeName\",value:function(){var e=new i.default({},(0,a.createDefaultConfig)()),t=e.loaderType;return e.destroy(),t}},{key:\"supportNativeMediaPlayback\",value:function(e){null==s.videoElement&&(s.videoElement=window.document.createElement(\"video\"));var t=s.videoElement.canPlayType(e);return\"probably\"===t||\"maybe\"==t}},{key:\"getFeatureList\",value:function(){var e={mseFlvPlayback:!1,mseLiveFlvPlayback:!1,networkStreamIO:!1,networkLoaderName:\"\",nativeMP4H264Playback:!1,nativeWebmVP8Playback:!1,nativeWebmVP9Playback:!1};return e.mseFlvPlayback=s.supportMSEH264Playback(),e.networkStreamIO=s.supportNetworkStreamIO(),e.networkLoaderName=s.getNetworkLoaderTypeName(),e.mseLiveFlvPlayback=e.mseFlvPlayback&&e.networkStreamIO,e.nativeMP4H264Playback=s.supportNativeMediaPlayback('video/mp4; codecs=\"avc1.42001E, mp4a.40.2\"'),e.nativeWebmVP8Playback=s.supportNativeMediaPlayback('video/webm; codecs=\"vp8.0, vorbis\"'),e.nativeWebmVP9Playback=s.supportNativeMediaPlayback('video/webm; codecs=\"vp9\"'),e}}]),s);function s(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,s)}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.default=o},{\"../config.js\":5,\"../io/io-controller.js\":23}],7:[function(e,t,r){Object.defineProperty(r,\"__esModule\",{value:!0});var n=(function(e,t,r){t&&a(e.prototype,t)}(i,[{key:\"isComplete\",value:function(){var e=!1===this.hasAudio||!0===this.hasAudio&&null!=this.audioCodec&&null!=this.audioSampleRate&&null!=this.audioChannelCount,t=!1===this.hasVideo||!0===this.hasVideo&&null!=this.videoCodec&&null!=this.width&&null!=this.height&&null!=this.fps&&null!=this.profile&&null!=this.level&&null!=this.refFrames&&null!=this.chromaFormat&&null!=this.sarNum&&null!=this.sarDen;return null!=this.mimeType&&null!=this.duration&&null!=this.metadata&&null!=this.hasKeyframesIndex&&e&&t}},{key:\"isSeekable\",value:function(){return!0===this.hasKeyframesIndex}},{key:\"getNearestKeyframe\",value:function(e){if(null==this.keyframesIndex)return null;var t=this.keyframesIndex,r=this._search(t.times,e);return{index:r,milliseconds:t.times[r],fileposition:t.filepositions[r]}}},{key:\"_search\",value:function(e,t){var r,n=0,i=e.length-1,a=0,o=i;for(t<e[0]&&(n=0,a=o+1);a<=o;){if((r=a+Math.floor((o-a)/2))===i||t>=e[r]&&t<e[r+1]){n=r;break}e[r]<t?a=r+1:o=r-1}return n}}]),i);function i(){(function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")})(this,i),this.mimeType=null,this.duration=null,this.hasAudio=null,this.hasVideo=null,this.audioCodec=null,this.videoCodec=null,this.audioDataRate=null,this.videoDataRate=null,this.audioSampleRate=null,this.audioChannelCount=null,this.width=null,this.height=null,this.fps=null,this.profile=null,this.level=null,this.refFrames=null,this.chromaFormat=null,this.sarNum=null,this.sarDen=null,this.metadata=null,this.segments=null,this.segmentCount=null,this.hasKeyframesIndex=null,this.keyframesIndex=null}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.default=n},{}],8:[function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}Object.defineProperty(r,\"__esModule\",{value:!0});var i=function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e};function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e){n(this,o),this._type=e,this._list=[],this._lastAppendLocation=-1}function s(){n(this,s),this._list=[]}function l(){n(this,l),this.beginDts=0,this.endDts=0,this.beginPts=0,this.endPts=0,this.originalBeginDts=0,this.originalEndDts=0,this.syncPoints=[],this.firstSample=null,this.lastSample=null}r.SampleInfo=function e(t,r,i,a,o){n(this,e),this.dts=t,this.pts=r,this.duration=i,this.originalDts=a,this.isSyncPoint=o,this.fileposition=null},r.MediaSegmentInfo=(i(l,[{key:\"appendSyncPoint\",value:function(e){e.isSyncPoint=!0,this.syncPoints.push(e)}}]),l),r.IDRSampleList=(i(s,[{key:\"clear\",value:function(){this._list=[]}},{key:\"appendArray\",value:function(e){var t=this._list;0!==e.length&&(0<t.length&&e[0].originalDts<t[t.length-1].originalDts&&this.clear(),Array.prototype.push.apply(t,e))}},{key:\"getLastSyncPointBeforeDts\",value:function(e){if(0==this._list.length)return null;var t,r=this._list,n=0,i=r.length-1,a=0,o=i;for(e<r[0].dts&&(n=0,a=o+1);a<=o;){if((t=a+Math.floor((o-a)/2))===i||e>=r[t].dts&&e<r[t+1].dts){n=t;break}r[t].dts<e?a=t+1:o=t-1}return this._list[n]}}]),s),r.MediaSegmentInfoList=(i(o,[{key:\"isEmpty\",value:function(){return 0===this._list.length}},{key:\"clear\",value:function(){this._list=[],this._lastAppendLocation=-1}},{key:\"_searchNearestSegmentBefore\",value:function(e){var t=this._list;if(0===t.length)return-2;var r,n=t.length-1,i=0,a=n,o=0;if(e<t[0].originalBeginDts)return-1;for(;i<=a;){if((r=i+Math.floor((a-i)/2))===n||e>t[r].lastSample.originalDts&&e<t[r+1].originalBeginDts){o=r;break}t[r].originalBeginDts<e?i=r+1:a=r-1}return o}},{key:\"_searchNearestSegmentAfter\",value:function(e){return this._searchNearestSegmentBefore(e)+1}},{key:\"append\",value:function(e){var t=this._list,r=e,n=this._lastAppendLocation,i=0;-1!==n&&n<t.length&&r.originalBeginDts>=t[n].lastSample.originalDts&&(n===t.length-1||n<t.length-1&&r.originalBeginDts<t[n+1].originalBeginDts)?i=n+1:0<t.length&&(i=this._searchNearestSegmentBefore(r.originalBeginDts)+1),this._lastAppendLocation=i,this._list.splice(i,0,r)}},{key:\"getLastSegmentBefore\",value:function(e){var t=this._searchNearestSegmentBefore(e);return 0<=t?this._list[t]:null}},{key:\"getLastSampleBefore\",value:function(e){var t=this.getLastSegmentBefore(e);return null!=t?t.lastSample:null}},{key:\"getLastSyncPointBefore\",value:function(e){for(var t=this._searchNearestSegmentBefore(e),r=this._list[t].syncPoints;0===r.length&&0<t;)t--,r=this._list[t].syncPoints;return 0<r.length?r[r.length-1]:null}},{key:\"type\",get:function(){return this._type}},{key:\"length\",get:function(){return this._list.length}}]),o)},{}],9:[function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,\"__esModule\",{value:!0});var i=n(e(\"events\")),a=n(e(\"../utils/logger.js\")),o=n(e(\"../utils/browser.js\")),s=n(e(\"./mse-events.js\")),l=e(\"./media-segment-info.js\"),d=e(\"../utils/exception.js\"),u=(function(e,t,r){t&&h(e.prototype,t),r&&h(e,r)}(c,[{key:\"destroy\",value:function(){(this._mediaElement||this._mediaSource)&&this.detachMediaElement(),this.e=null,this._emitter.removeAllListeners(),this._emitter=null}},{key:\"on\",value:function(e,t){this._emitter.addListener(e,t)}},{key:\"off\",value:function(e,t){this._emitter.removeListener(e,t)}},{key:\"attachMediaElement\",value:function(e){if(this._mediaSource)throw new d.IllegalStateException(\"MediaSource has been attached to an HTMLMediaElement!\");var t=this._mediaSource=new window.MediaSource;t.addEventListener(\"sourceopen\",this.e.onSourceOpen),t.addEventListener(\"sourceended\",this.e.onSourceEnded),t.addEventListener(\"sourceclose\",this.e.onSourceClose),this._mediaElement=e,this._mediaSourceObjectURL=window.URL.createObjectURL(this._mediaSource),e.src=this._mediaSourceObjectURL}},{key:\"detachMediaElement\",value:function(){if(this._mediaSource){var e=this._mediaSource;for(var t in this._sourceBuffers){var r=this._pendingSegments[t];r.splice(0,r.length),this._pendingSegments[t]=null,this._pendingRemoveRanges[t]=null,this._lastInitSegments[t]=null;var n=this._sourceBuffers[t];if(n){if(\"closed\"!==e.readyState){try{e.removeSourceBuffer(n)}catch(e){a.default.e(this.TAG,e.message)}n.removeEventListener(\"error\",this.e.onSourceBufferError),n.removeEventListener(\"updateend\",this.e.onSourceBufferUpdateEnd)}this._mimeTypes[t]=null,this._sourceBuffers[t]=null}}if(\"open\"===e.readyState)try{e.endOfStream()}catch(e){a.default.e(this.TAG,e.message)}e.removeEventListener(\"sourceopen\",this.e.onSourceOpen),e.removeEventListener(\"sourceended\",this.e.onSourceEnded),e.removeEventListener(\"sourceclose\",this.e.onSourceClose),this._pendingSourceBufferInit=[],this._isBufferFull=!1,this._idrList.clear(),this._mediaSource=null}this._mediaElement&&(this._mediaElement.src=\"\",this._mediaElement.removeAttribute(\"src\"),this._mediaElement=null),this._mediaSourceObjectURL&&(window.URL.revokeObjectURL(this._mediaSourceObjectURL),this._mediaSourceObjectURL=null)}},{key:\"appendInitSegment\",value:function(e,t){if(!this._mediaSource||\"open\"!==this._mediaSource.readyState)return this._pendingSourceBufferInit.push(e),void this._pendingSegments[e.type].push(e);var r=e,n=\"\"+r.container;r.codec&&0<r.codec.length&&(n+=\";codecs=\"+r.codec);var i=!1;if(a.default.v(this.TAG,\"Received Initialization Segment, mimeType: \"+n),this._lastInitSegments[r.type]=r,n!==this._mimeTypes[r.type]){if(this._mimeTypes[r.type])a.default.v(this.TAG,\"Notice: \"+r.type+\" mimeType changed, origin: \"+this._mimeTypes[r.type]+\", target: \"+n);else{i=!0;try{var l=this._sourceBuffers[r.type]=this._mediaSource.addSourceBuffer(n);l.addEventListener(\"error\",this.e.onSourceBufferError),l.addEventListener(\"updateend\",this.e.onSourceBufferUpdateEnd)}catch(e){return a.default.e(this.TAG,e.message),void this._emitter.emit(s.default.ERROR,{code:e.code,msg:e.message})}}this._mimeTypes[r.type]=n}t||this._pendingSegments[r.type].push(r),i||this._sourceBuffers[r.type]&&!this._sourceBuffers[r.type].updating&&this._doAppendSegments(),o.default.safari&&\"audio/mpeg\"===r.container&&0<r.mediaDuration&&(this._requireSetMediaDuration=!0,this._pendingMediaDuration=r.mediaDuration/1e3,this._updateMediaSourceDuration())}},{key:\"appendMediaSegment\",value:function(e){var t=e;this._pendingSegments[t.type].push(t),this._config.autoCleanupSourceBuffer&&this._needCleanupSourceBuffer()&&this._doCleanupSourceBuffer();var r=this._sourceBuffers[t.type];!r||r.updating||this._hasPendingRemoveRanges()||this._doAppendSegments()}},{key:\"seek\",value:function(){for(var e in this._sourceBuffers)if(this._sourceBuffers[e]){var t=this._sourceBuffers[e];if(\"open\"===this._mediaSource.readyState)try{t.abort()}catch(e){a.default.e(this.TAG,e.message)}this._idrList.clear();var r=this._pendingSegments[e];if(r.splice(0,r.length),\"closed\"!==this._mediaSource.readyState){for(var n,i=0;i<t.buffered.length;i++){var s=t.buffered.start(i),l=t.buffered.end(i);this._pendingRemoveRanges[e].push({start:s,end:l})}t.updating||this._doRemoveRanges(),o.default.safari&&(n=this._lastInitSegments[e])&&(this._pendingSegments[e].push(n),t.updating||this._doAppendSegments())}}}},{key:\"endOfStream\",value:function(){var e=this._mediaSource,t=this._sourceBuffers;e&&\"open\"===e.readyState?t.video&&t.video.updating||t.audio&&t.audio.updating?this._hasPendingEos=!0:(this._hasPendingEos=!1,e.endOfStream()):e&&\"closed\"===e.readyState&&this._hasPendingSegments()&&(this._hasPendingEos=!0)}},{key:\"getNearestKeyframe\",value:function(e){return this._idrList.getLastSyncPointBeforeDts(e)}},{key:\"_needCleanupSourceBuffer\",value:function(){if(!this._config.autoCleanupSourceBuffer)return!1;var e=this._mediaElement.currentTime;for(var t in this._sourceBuffers){var r=this._sourceBuffers[t];if(r){var n=r.buffered;if(1<=n.length&&e-n.start(0)>=this._config.autoCleanupMaxBackwardDuration)return!0}}return!1}},{key:\"_doCleanupSourceBuffer\",value:function(){var e=this._mediaElement.currentTime;for(var t in this._sourceBuffers){var r=this._sourceBuffers[t];if(r){for(var n=r.buffered,i=!1,a=0;a<n.length;a++){var o,s=n.start(a),l=n.end(a);s<=e&&e<l+3?e-s>=this._config.autoCleanupMaxBackwardDuration&&(i=!0,o=e-this._config.autoCleanupMinBackwardDuration,this._pendingRemoveRanges[t].push({start:s,end:o})):l<e&&(i=!0,this._pendingRemoveRanges[t].push({start:s,end:l}))}i&&!r.updating&&this._doRemoveRanges()}}}},{key:\"_updateMediaSourceDuration\",value:function(){var e,t,r=this._sourceBuffers;0===this._mediaElement.readyState||\"open\"!==this._mediaSource.readyState||r.video&&r.video.updating||r.audio&&r.audio.updating||(e=this._mediaSource.duration,0<(t=this._pendingMediaDuration)&&(isNaN(e)||e<t)&&(a.default.v(this.TAG,\"Update MediaSource duration from \"+e+\" to \"+t),this._mediaSource.duration=t),this._requireSetMediaDuration=!1,this._pendingMediaDuration=0)}},{key:\"_doRemoveRanges\",value:function(){for(var e in this._pendingRemoveRanges)if(this._sourceBuffers[e]&&!this._sourceBuffers[e].updating)for(var t=this._sourceBuffers[e],r=this._pendingRemoveRanges[e];r.length&&!t.updating;){var n=r.shift();t.remove(n.start,n.end)}}},{key:\"_doAppendSegments\",value:function(){var e=this._pendingSegments;for(var t in e)if(this._sourceBuffers[t]&&!this._sourceBuffers[t].updating&&0<e[t].length){var r,n,i=e[t].shift();if(i.timestampOffset&&(r=this._sourceBuffers[t].timestampOffset,n=i.timestampOffset/1e3,.1<Math.abs(r-n)&&(a.default.v(this.TAG,\"Update MPEG audio timestampOffset from \"+r+\" to \"+n),this._sourceBuffers[t].timestampOffset=n),delete i.timestampOffset),!i.data||0===i.data.byteLength)continue;try{this._sourceBuffers[t].appendBuffer(i.data),this._isBufferFull=!1,\"video\"===t&&i.hasOwnProperty(\"info\")&&this._idrList.appendArray(i.info.syncPoints)}catch(e){this._pendingSegments[t].unshift(i),22===e.code?(this._isBufferFull||this._emitter.emit(s.default.BUFFER_FULL),this._isBufferFull=!0):(a.default.e(this.TAG,e.message),this._emitter.emit(s.default.ERROR,{code:e.code,msg:e.message}))}}}},{key:\"_onSourceOpen\",value:function(){if(a.default.v(this.TAG,\"MediaSource onSourceOpen\"),this._mediaSource.removeEventListener(\"sourceopen\",this.e.onSourceOpen),0<this._pendingSourceBufferInit.length)for(var e=this._pendingSourceBufferInit;e.length;){var t=e.shift();this.appendInitSegment(t,!0)}this._hasPendingSegments()&&this._doAppendSegments(),this._emitter.emit(s.default.SOURCE_OPEN)}},{key:\"_onSourceEnded\",value:function(){a.default.v(this.TAG,\"MediaSource onSourceEnded\")}},{key:\"_onSourceClose\",value:function(){a.default.v(this.TAG,\"MediaSource onSourceClose\"),this._mediaSource&&null!=this.e&&(this._mediaSource.removeEventListener(\"sourceopen\",this.e.onSourceOpen),this._mediaSource.removeEventListener(\"sourceended\",this.e.onSourceEnded),this._mediaSource.removeEventListener(\"sourceclose\",this.e.onSourceClose))}},{key:\"_hasPendingSegments\",value:function(){var e=this._pendingSegments;return 0<e.video.length||0<e.audio.length}},{key:\"_hasPendingRemoveRanges\",value:function(){var e=this._pendingRemoveRanges;return 0<e.video.length||0<e.audio.length}},{key:\"_onSourceBufferUpdateEnd\",value:function(){this._requireSetMediaDuration?this._updateMediaSourceDuration():this._hasPendingRemoveRanges()?this._doRemoveRanges():this._hasPendingSegments()?this._doAppendSegments():this._hasPendingEos&&this.endOfStream(),this._emitter.emit(s.default.UPDATE_END)}},{key:\"_onSourceBufferError\",value:function(e){a.default.e(this.TAG,\"SourceBuffer Error: \"+e)}}]),c);function c(e){(function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")})(this,c),this.TAG=\"MSEController\",this._config=e,this._emitter=new i.default,this._config.isLive&&null==this._config.autoCleanupSourceBuffer&&(this._config.autoCleanupSourceBuffer=!0),this.e={onSourceOpen:this._onSourceOpen.bind(this),onSourceEnded:this._onSourceEnded.bind(this),onSourceClose:this._onSourceClose.bind(this),onSourceBufferError:this._onSourceBufferError.bind(this),onSourceBufferUpdateEnd:this._onSourceBufferUpdateEnd.bind(this)},this._mediaSource=null,this._mediaSourceObjectURL=null,this._mediaElement=null,this._isBufferFull=!1,this._hasPendingEos=!1,this._requireSetMediaDuration=!1,this._pendingMediaDuration=0,this._pendingSourceBufferInit=[],this._mimeTypes={video:null,audio:null},this._sourceBuffers={video:null,audio:null},this._lastInitSegments={video:null,audio:null},this._pendingSegments={video:[],audio:[]},this._pendingRemoveRanges={video:[],audio:[]},this._idrList=new l.IDRSampleList}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.default=u},{\"../utils/browser.js\":39,\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./media-segment-info.js\":8,\"./mse-events.js\":10,events:2}],10:[function(e,t,r){Object.defineProperty(r,\"__esModule\",{value:!0}),r.default={ERROR:\"error\",SOURCE_OPEN:\"source_open\",UPDATE_END:\"update_end\",BUFFER_FULL:\"buffer_full\"}},{}],11:[function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,\"__esModule\",{value:!0});var i=n(e(\"events\")),a=n(e(\"../utils/logger.js\")),o=n(e(\"../utils/logging-control.js\")),s=n(e(\"./transmuxing-controller.js\")),l=n(e(\"./transmuxing-events.js\")),d=n(e(\"./transmuxing-worker.js\")),u=n(e(\"./media-info.js\")),c=(function(e,t,r){t&&f(e.prototype,t),r&&f(e,r)}(h,[{key:\"destroy\",value:function(){this._worker?this._workerDestroying||(this._workerDestroying=!0,this._worker.postMessage({cmd:\"destroy\"}),o.default.removeListener(this.e.onLoggingConfigChanged),this.e=null):(this._controller.destroy(),this._controller=null),this._emitter.removeAllListeners(),this._emitter=null}},{key:\"on\",value:function(e,t){this._emitter.addListener(e,t)}},{key:\"off\",value:function(e,t){this._emitter.removeListener(e,t)}},{key:\"hasWorker\",value:function(){return null!=this._worker}},{key:\"open\",value:function(){this._worker?this._worker.postMessage({cmd:\"start\"}):this._controller.start()}},{key:\"close\",value:function(){this._worker?this._worker.postMessage({cmd:\"stop\"}):this._controller.stop()}},{key:\"seek\",value:function(e){this._worker?this._worker.postMessage({cmd:\"seek\",param:e}):this._controller.seek(e)}},{key:\"pause\",value:function(){this._worker?this._worker.postMessage({cmd:\"pause\"}):this._controller.pause()}},{key:\"resume\",value:function(){this._worker?this._worker.postMessage({cmd:\"resume\"}):this._controller.resume()}},{key:\"_onInitSegment\",value:function(e,t){var r=this;Promise.resolve().then((function(){r._emitter.emit(l.default.INIT_SEGMENT,e,t)}))}},{key:\"_onMediaSegment\",value:function(e,t){var r=this;Promise.resolve().then((function(){r._emitter.emit(l.default.MEDIA_SEGMENT,e,t)}))}},{key:\"_onLoadingComplete\",value:function(){var e=this;Promise.resolve().then((function(){e._emitter.emit(l.default.LOADING_COMPLETE)}))}},{key:\"_onRecoveredEarlyEof\",value:function(){var e=this;Promise.resolve().then((function(){e._emitter.emit(l.default.RECOVERED_EARLY_EOF)}))}},{key:\"_onMediaInfo\",value:function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(l.default.MEDIA_INFO,e)}))}},{key:\"_onMetaDataArrived\",value:function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(l.default.METADATA_ARRIVED,e)}))}},{key:\"_onScriptDataArrived\",value:function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(l.default.SCRIPTDATA_ARRIVED,e)}))}},{key:\"_onStatisticsInfo\",value:function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(l.default.STATISTICS_INFO,e)}))}},{key:\"_onIOError\",value:function(e,t){var r=this;Promise.resolve().then((function(){r._emitter.emit(l.default.IO_ERROR,e,t)}))}},{key:\"_onDemuxError\",value:function(e,t){var r=this;Promise.resolve().then((function(){r._emitter.emit(l.default.DEMUX_ERROR,e,t)}))}},{key:\"_onRecommendSeekpoint\",value:function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(l.default.RECOMMEND_SEEKPOINT,e)}))}},{key:\"_onLoggingConfigChanged\",value:function(e){this._worker&&this._worker.postMessage({cmd:\"logging_config\",param:e})}},{key:\"_onWorkerMessage\",value:function(e){var t=e.data,r=t.data;if(\"destroyed\"===t.msg||this._workerDestroying)return this._workerDestroying=!1,this._worker.terminate(),void(this._worker=null);switch(t.msg){case l.default.INIT_SEGMENT:case l.default.MEDIA_SEGMENT:this._emitter.emit(t.msg,r.type,r.data);break;case l.default.LOADING_COMPLETE:case l.default.RECOVERED_EARLY_EOF:this._emitter.emit(t.msg);break;case l.default.MEDIA_INFO:Object.setPrototypeOf(r,u.default.prototype),this._emitter.emit(t.msg,r);break;case l.default.METADATA_ARRIVED:case l.default.SCRIPTDATA_ARRIVED:case l.default.STATISTICS_INFO:this._emitter.emit(t.msg,r);break;case l.default.IO_ERROR:case l.default.DEMUX_ERROR:this._emitter.emit(t.msg,r.type,r.info);break;case l.default.RECOMMEND_SEEKPOINT:this._emitter.emit(t.msg,r);break;case\"logcat_callback\":a.default.emitter.emit(\"log\",r.type,r.logcat)}}}]),h);function h(t,r){if(function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,h),this.TAG=\"Transmuxer\",this._emitter=new i.default,r.enableWorker&&\"undefined\"!=typeof Worker)try{var n=e(\"webworkify\");this._worker=n(d.default),this._workerDestroying=!1,this._worker.addEventListener(\"message\",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:\"init\",param:[t,r]}),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this)},o.default.registerListener(this.e.onLoggingConfigChanged),this._worker.postMessage({cmd:\"logging_config\",param:o.default.getConfig()})}catch(n){a.default.e(this.TAG,\"Error while initialize transmuxing worker, fallback to inline transmuxing\"),this._worker=null,this._controller=new s.default(t,r)}else this._controller=new s.default(t,r);var u;this._controller&&((u=this._controller).on(l.default.IO_ERROR,this._onIOError.bind(this)),u.on(l.default.DEMUX_ERROR,this._onDemuxError.bind(this)),u.on(l.default.INIT_SEGMENT,this._onInitSegment.bind(this)),u.on(l.default.MEDIA_SEGMENT,this._onMediaSegment.bind(this)),u.on(l.default.LOADING_COMPLETE,this._onLoadingComplete.bind(this)),u.on(l.default.RECOVERED_EARLY_EOF,this._onRecoveredEarlyEof.bind(this)),u.on(l.default.MEDIA_INFO,this._onMediaInfo.bind(this)),u.on(l.default.METADATA_ARRIVED,this._onMetaDataArrived.bind(this)),u.on(l.default.SCRIPTDATA_ARRIVED,this._onScriptDataArrived.bind(this)),u.on(l.default.STATISTICS_INFO,this._onStatisticsInfo.bind(this)),u.on(l.default.RECOMMEND_SEEKPOINT,this._onRecommendSeekpoint.bind(this)))}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.default=c},{\"../utils/logger.js\":41,\"../utils/logging-control.js\":42,\"./media-info.js\":7,\"./transmuxing-controller.js\":12,\"./transmuxing-events.js\":13,\"./transmuxing-worker.js\":14,events:2,webworkify:4}],12:[function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,\"__esModule\",{value:!0});var i=n(e(\"events\")),a=n(e(\"../utils/logger.js\")),o=n(e(\"../utils/browser.js\")),s=n(e(\"./media-info.js\")),l=n(e(\"../demux/flv-demuxer.js\")),d=n(e(\"../remux/mp4-remuxer.js\")),u=n(e(\"../demux/demux-errors.js\")),c=n(e(\"../io/io-controller.js\")),h=n(e(\"./transmuxing-events.js\")),f=(e(\"../io/loader.js\"),function(e,t,r){t&&m(e.prototype,t),r&&m(e,r)}(p,[{key:\"destroy\",value:function(){this._mediaInfo=null,this._mediaDataSource=null,this._statisticsReporter&&this._disableStatisticsReporter(),this._ioctl&&(this._ioctl.destroy(),this._ioctl=null),this._demuxer&&(this._demuxer.destroy(),this._demuxer=null),this._remuxer&&(this._remuxer.destroy(),this._remuxer=null),this._emitter.removeAllListeners(),this._emitter=null}},{key:\"on\",value:function(e,t){this._emitter.addListener(e,t)}},{key:\"off\",value:function(e,t){this._emitter.removeListener(e,t)}},{key:\"start\",value:function(){this._loadSegment(0),this._enableStatisticsReporter()}},{key:\"_loadSegment\",value:function(e,t){this._currentSegmentIndex=e;var r=this._mediaDataSource.segments[e],n=this._ioctl=new c.default(r,this._config,e);n.onError=this._onIOException.bind(this),n.onSeeked=this._onIOSeeked.bind(this),n.onComplete=this._onIOComplete.bind(this),n.onRedirect=this._onIORedirect.bind(this),n.onRecoveredEarlyEof=this._onIORecoveredEarlyEof.bind(this),t?this._demuxer.bindDataSource(this._ioctl):n.onDataArrival=this._onInitChunkArrival.bind(this),n.open(t)}},{key:\"stop\",value:function(){this._internalAbort(),this._disableStatisticsReporter()}},{key:\"_internalAbort\",value:function(){this._ioctl&&(this._ioctl.destroy(),this._ioctl=null)}},{key:\"pause\",value:function(){this._ioctl&&this._ioctl.isWorking()&&(this._ioctl.pause(),this._disableStatisticsReporter())}},{key:\"resume\",value:function(){this._ioctl&&this._ioctl.isPaused()&&(this._ioctl.resume(),this._enableStatisticsReporter())}},{key:\"seek\",value:function(e){var t,r,n,i,a;null!=this._mediaInfo&&this._mediaInfo.isSeekable()&&((t=this._searchSegmentIndexContains(e))===this._currentSegmentIndex?null==(r=this._mediaInfo.segments[t])?this._pendingSeekTime=e:(n=r.getNearestKeyframe(e),this._remuxer.seek(n.milliseconds),this._ioctl.seek(n.fileposition),this._pendingResolveSeekPoint=n.milliseconds):null==(i=this._mediaInfo.segments[t])?(this._pendingSeekTime=e,this._internalAbort(),this._remuxer.seek(),this._remuxer.insertDiscontinuity(),this._loadSegment(t)):(a=i.getNearestKeyframe(e),this._internalAbort(),this._remuxer.seek(e),this._remuxer.insertDiscontinuity(),this._demuxer.resetMediaInfo(),this._demuxer.timestampBase=this._mediaDataSource.segments[t].timestampBase,this._loadSegment(t,a.fileposition),this._pendingResolveSeekPoint=a.milliseconds,this._reportSegmentMediaInfo(t)),this._enableStatisticsReporter())}},{key:\"_searchSegmentIndexContains\",value:function(e){for(var t=this._mediaDataSource.segments,r=t.length-1,n=0;n<t.length;n++)if(e<t[n].timestampBase){r=n-1;break}return r}},{key:\"_onInitChunkArrival\",value:function(e,t){var r,n=this,i=null;return 0<t?(this._demuxer.bindDataSource(this._ioctl),this._demuxer.timestampBase=this._mediaDataSource.segments[this._currentSegmentIndex].timestampBase,this._demuxer.parseChunks(e,t)):(i=l.default.probe(e)).match?(this._demuxer=new l.default(i,this._config),this._remuxer||(this._remuxer=new d.default(this._config)),null==(r=this._mediaDataSource).duration||isNaN(r.duration)||(this._demuxer.overridedDuration=r.duration),\"boolean\"==typeof r.hasAudio&&(this._demuxer.overridedHasAudio=r.hasAudio),\"boolean\"==typeof r.hasVideo&&(this._demuxer.overridedHasVideo=r.hasVideo),this._demuxer.timestampBase=r.segments[this._currentSegmentIndex].timestampBase,this._demuxer.onError=this._onDemuxException.bind(this),this._demuxer.onMediaInfo=this._onMediaInfo.bind(this),this._demuxer.onMetaDataArrived=this._onMetaDataArrived.bind(this),this._demuxer.onScriptDataArrived=this._onScriptDataArrived.bind(this),this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl)),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this),this._demuxer.parseChunks(e,t)):(i=null,a.default.e(this.TAG,\"Non-FLV, Unsupported media type!\"),Promise.resolve().then((function(){n._internalAbort()})),this._emitter.emit(h.default.DEMUX_ERROR,u.default.FORMAT_UNSUPPORTED,\"Non-FLV, Unsupported media type\"),0)}},{key:\"_onMediaInfo\",value:function(e){var t=this;null==this._mediaInfo&&(this._mediaInfo=Object.assign({},e),this._mediaInfo.keyframesIndex=null,this._mediaInfo.segments=[],this._mediaInfo.segmentCount=this._mediaDataSource.segments.length,Object.setPrototypeOf(this._mediaInfo,s.default.prototype));var r=Object.assign({},e);Object.setPrototypeOf(r,s.default.prototype),this._mediaInfo.segments[this._currentSegmentIndex]=r,this._reportSegmentMediaInfo(this._currentSegmentIndex),null!=this._pendingSeekTime&&Promise.resolve().then((function(){var e=t._pendingSeekTime;t._pendingSeekTime=null,t.seek(e)}))}},{key:\"_onMetaDataArrived\",value:function(e){this._emitter.emit(h.default.METADATA_ARRIVED,e)}},{key:\"_onScriptDataArrived\",value:function(e){this._emitter.emit(h.default.SCRIPTDATA_ARRIVED,e)}},{key:\"_onIOSeeked\",value:function(){this._remuxer.insertDiscontinuity()}},{key:\"_onIOComplete\",value:function(e){var t=e+1;t<this._mediaDataSource.segments.length?(this._internalAbort(),this._remuxer.flushStashedSamples(),this._loadSegment(t)):(this._remuxer.flushStashedSamples(),this._emitter.emit(h.default.LOADING_COMPLETE),this._disableStatisticsReporter())}},{key:\"_onIORedirect\",value:function(e){var t=this._ioctl.extraData;this._mediaDataSource.segments[t].redirectedURL=e}},{key:\"_onIORecoveredEarlyEof\",value:function(){this._emitter.emit(h.default.RECOVERED_EARLY_EOF)}},{key:\"_onIOException\",value:function(e,t){a.default.e(this.TAG,\"IOException: type = \"+e+\", code = \"+t.code+\", msg = \"+t.msg),this._emitter.emit(h.default.IO_ERROR,e,t),this._disableStatisticsReporter()}},{key:\"_onDemuxException\",value:function(e,t){a.default.e(this.TAG,\"DemuxException: type = \"+e+\", info = \"+t),this._emitter.emit(h.default.DEMUX_ERROR,e,t)}},{key:\"_onRemuxerInitSegmentArrival\",value:function(e,t){this._emitter.emit(h.default.INIT_SEGMENT,e,t)}},{key:\"_onRemuxerMediaSegmentArrival\",value:function(e,t){var r,n;null==this._pendingSeekTime&&(this._emitter.emit(h.default.MEDIA_SEGMENT,e,t),null!=this._pendingResolveSeekPoint&&\"video\"===e)&&(r=t.info.syncPoints,n=this._pendingResolveSeekPoint,this._pendingResolveSeekPoint=null,o.default.safari&&0<r.length&&r[0].originalDts===n&&(n=r[0].pts),this._emitter.emit(h.default.RECOMMEND_SEEKPOINT,n))}},{key:\"_enableStatisticsReporter\",value:function(){null==this._statisticsReporter&&(this._statisticsReporter=self.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval))}},{key:\"_disableStatisticsReporter\",value:function(){this._statisticsReporter&&(self.clearInterval(this._statisticsReporter),this._statisticsReporter=null)}},{key:\"_reportSegmentMediaInfo\",value:function(e){var t=this._mediaInfo.segments[e],r=Object.assign({},t);r.duration=this._mediaInfo.duration,r.segmentCount=this._mediaInfo.segmentCount,delete r.segments,delete r.keyframesIndex,this._emitter.emit(h.default.MEDIA_INFO,r)}},{key:\"_reportStatisticsInfo\",value:function(){var e={};e.url=this._ioctl.currentURL,e.hasRedirect=this._ioctl.hasRedirect,e.hasRedirect&&(e.redirectedURL=this._ioctl.currentRedirectedURL),e.speed=this._ioctl.currentSpeed,e.loaderType=this._ioctl.loaderType,e.currentSegmentIndex=this._currentSegmentIndex,e.totalSegmentCount=this._mediaDataSource.segments.length,this._emitter.emit(h.default.STATISTICS_INFO,e)}}]),p);function p(e,t){(function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")})(this,p),this.TAG=\"TransmuxingController\",this._emitter=new i.default,this._config=t,e.segments||(e.segments=[{duration:e.duration,filesize:e.filesize,url:e.url}]),\"boolean\"!=typeof e.cors&&(e.cors=!0),\"boolean\"!=typeof e.withCredentials&&(e.withCredentials=!1),this._mediaDataSource=e;var r=this._currentSegmentIndex=0;this._mediaDataSource.segments.forEach((function(n){n.timestampBase=r,r+=n.duration,n.cors=e.cors,n.withCredentials=e.withCredentials,t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy)})),isNaN(r)||this._mediaDataSource.duration===r||(this._mediaDataSource.duration=r),this._mediaInfo=null,this._demuxer=null,this._remuxer=null,this._ioctl=null,this._pendingSeekTime=null,this._pendingResolveSeekPoint=null,this._statisticsReporter=null}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.default=f},{\"../demux/demux-errors.js\":16,\"../demux/flv-demuxer.js\":18,\"../io/io-controller.js\":23,\"../io/loader.js\":24,\"../remux/mp4-remuxer.js\":38,\"../utils/browser.js\":39,\"../utils/logger.js\":41,\"./media-info.js\":7,\"./transmuxing-events.js\":13,events:2}],13:[function(e,t,r){Object.defineProperty(r,\"__esModule\",{value:!0}),r.default={IO_ERROR:\"io_error\",DEMUX_ERROR:\"demux_error\",INIT_SEGMENT:\"init_segment\",MEDIA_SEGMENT:\"media_segment\",LOADING_COMPLETE:\"loading_complete\",RECOVERED_EARLY_EOF:\"recovered_early_eof\",MEDIA_INFO:\"media_info\",METADATA_ARRIVED:\"metadata_arrived\",SCRIPTDATA_ARRIVED:\"scriptdata_arrived\",STATISTICS_INFO:\"statistics_info\",RECOMMEND_SEEKPOINT:\"recommend_seekpoint\"}},{}],14:[function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,\"__esModule\",{value:!0});var i=(n(e(\"../utils/logger.js\")),e(\"../utils/logging-control.js\")),a=n(i),o=n(e(\"../utils/polyfill.js\")),s=n(e(\"./transmuxing-controller.js\")),l=n(e(\"./transmuxing-events.js\"));r.default=function(e){function t(t,r){e.postMessage({msg:l.default.IO_ERROR,data:{type:t,info:r}})}var r=null,n=function(t,r){e.postMessage({msg:\"logcat_callback\",data:{type:t,logcat:r}})}.bind(this);o.default.install(),e.addEventListener(\"message\",(function(i){switch(i.data.cmd){case\"init\":(r=new s.default(i.data.param[0],i.data.param[1])).on(l.default.IO_ERROR,t.bind(this)),r.on(l.default.DEMUX_ERROR,function(t,r){e.postMessage({msg:l.default.DEMUX_ERROR,data:{type:t,info:r}})}.bind(this)),r.on(l.default.INIT_SEGMENT,function(t,r){var n={msg:l.default.INIT_SEGMENT,data:{type:t,data:r}};e.postMessage(n,[r.data])}.bind(this)),r.on(l.default.MEDIA_SEGMENT,function(t,r){var n={msg:l.default.MEDIA_SEGMENT,data:{type:t,data:r}};e.postMessage(n,[r.data])}.bind(this)),r.on(l.default.LOADING_COMPLETE,function(){var t={msg:l.default.LOADING_COMPLETE};e.postMessage(t)}.bind(this)),r.on(l.default.RECOVERED_EARLY_EOF,function(){var t={msg:l.default.RECOVERED_EARLY_EOF};e.postMessage(t)}.bind(this)),r.on(l.default.MEDIA_INFO,function(t){var r={msg:l.default.MEDIA_INFO,data:t};e.postMessage(r)}.bind(this)),r.on(l.default.METADATA_ARRIVED,function(t){var r={msg:l.default.METADATA_ARRIVED,data:t};e.postMessage(r)}.bind(this)),r.on(l.default.SCRIPTDATA_ARRIVED,function(t){var r={msg:l.default.SCRIPTDATA_ARRIVED,data:t};e.postMessage(r)}.bind(this)),r.on(l.default.STATISTICS_INFO,function(t){var r={msg:l.default.STATISTICS_INFO,data:t};e.postMessage(r)}.bind(this)),r.on(l.default.RECOMMEND_SEEKPOINT,function(t){e.postMessage({msg:l.default.RECOMMEND_SEEKPOINT,data:t})}.bind(this));break;case\"destroy\":r&&(r.destroy(),r=null),e.postMessage({msg:\"destroyed\"});break;case\"start\":r.start();break;case\"stop\":r.stop();break;case\"seek\":r.seek(i.data.param);break;case\"pause\":r.pause();break;case\"resume\":r.resume();break;case\"logging_config\":var o=i.data.param;a.default.applyConfig(o),!0===o.enableCallback?a.default.addLogListener(n):a.default.removeLogListener(n)}}))}},{\"../utils/logger.js\":41,\"../utils/logging-control.js\":42,\"../utils/polyfill.js\":43,\"./transmuxing-controller.js\":12,\"./transmuxing-events.js\":13}],15:[function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,\"__esModule\",{value:!0});var i,a=n(e(\"../utils/logger.js\")),o=n(e(\"../utils/utf8-conv.js\")),s=e(\"../utils/exception.js\"),l=(i=new ArrayBuffer(2),new DataView(i).setInt16(0,256,!0),256===new Int16Array(i)[0]),d=(function(e,t,r){t&&c(e.prototype,t),r&&c(e,r)}(u,null,[{key:\"parseScriptData\",value:function(e,t,r){var n={};try{var i=u.parseValue(e,t,r),o=u.parseValue(e,t+i.size,r-i.size);n[i.data]=o.data}catch(e){a.default.e(\"AMF\",e.toString())}return n}},{key:\"parseObject\",value:function(e,t,r){if(r<3)throw new s.IllegalStateException(\"Data not enough when parse ScriptDataObject\");var n=u.parseString(e,t,r),i=u.parseValue(e,t+n.size,r-n.size),a=i.objectEnd;return{data:{name:n.data,value:i.data},size:n.size+i.size,objectEnd:a}}},{key:\"parseVariable\",value:function(e,t,r){return u.parseObject(e,t,r)}},{key:\"parseString\",value:function(e,t,r){if(r<2)throw new s.IllegalStateException(\"Data not enough when parse String\");var n=new DataView(e,t,r).getUint16(0,!l);return{data:0<n?(0,o.default)(new Uint8Array(e,t+2,n)):\"\",size:2+n}}},{key:\"parseLongString\",value:function(e,t,r){if(r<4)throw new s.IllegalStateException(\"Data not enough when parse LongString\");var n=new DataView(e,t,r).getUint32(0,!l);return{data:0<n?(0,o.default)(new Uint8Array(e,t+4,n)):\"\",size:4+n}}},{key:\"parseDate\",value:function(e,t,r){if(r<10)throw new s.IllegalStateException(\"Data size invalid when parse Date\");var n=new DataView(e,t,r),i=n.getFloat64(0,!l);return i+=60*n.getInt16(8,!l)*1e3,{data:new Date(i),size:10}}},{key:\"parseValue\",value:function(e,t,r){if(r<1)throw new s.IllegalStateException(\"Data not enough when parse Value\");var n=new DataView(e,t,r),i=1,o=n.getUint8(0),d=void 0,c=!1;try{switch(o){case 0:d=n.getFloat64(1,!l),i+=8;break;case 1:d=!!n.getUint8(1),i+=1;break;case 2:var h=u.parseString(e,t+1,r-1);d=h.data;i+=h.size;break;case 3:d={};var f=0;for(9==(16777215&n.getUint32(r-4,!l))&&(f=3);i<r-4;){var p=u.parseObject(e,t+i,r-i-f);if(p.objectEnd)break;d[p.data.name]=p.data.value,i+=p.size}i<=r-3&&9==(16777215&n.getUint32(i-1,!l))&&(i+=3);break;case 8:d={},i+=4;var m=0;for(9==(16777215&n.getUint32(r-4,!l))&&(m=3);i<r-8;){var g=u.parseVariable(e,t+i,r-i-m);if(g.objectEnd)break;d[g.data.name]=g.data.value,i+=g.size}i<=r-3&&9==(16777215&n.getUint32(i-1,!l))&&(i+=3);break;case 9:i=1,c=!(d=void 0);break;case 10:d=[];var y=n.getUint32(1,!l);i+=4;for(var v=0;v<y;v++){var _=u.parseValue(e,t+i,r-i);d.push(_.data),i+=_.size}break;case 11:var b=u.parseDate(e,t+1,r-1);d=b.data,i+=b.size;break;case 12:var E=u.parseString(e,t+1,r-1);d=E.data,i+=E.size;break;default:i=r,a.default.w(\"AMF\",\"Unsupported AMF value type \"+o)}}catch(e){a.default.e(\"AMF\",e.toString())}return{data:d,size:i,objectEnd:c}}}]),u);function u(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,u)}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.default=d},{\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"../utils/utf8-conv.js\":44}],16:[function(e,t,r){Object.defineProperty(r,\"__esModule\",{value:!0}),r.default={OK:\"OK\",FORMAT_ERROR:\"FormatError\",FORMAT_UNSUPPORTED:\"FormatUnsupported\",CODEC_UNSUPPORTED:\"CodecUnsupported\"}},{}],17:[function(e,t,r){Object.defineProperty(r,\"__esModule\",{value:!0});var n=e(\"../utils/exception.js\"),i=(function(e,t,r){t&&o(e.prototype,t),r&&o(e,r)}(a,[{key:\"destroy\",value:function(){this._buffer=null}},{key:\"_fillCurrentWord\",value:function(){var e=this._total_bytes-this._buffer_index;if(e<=0)throw new n.IllegalStateException(\"ExpGolomb: _fillCurrentWord() but no bytes available\");var t=Math.min(4,e),r=new Uint8Array(4);r.set(this._buffer.subarray(this._buffer_index,this._buffer_index+t)),this._current_word=new DataView(r.buffer).getUint32(0,!1),this._buffer_index+=t,this._current_word_bits_left=8*t}},{key:\"readBits\",value:function(e){if(32<e)throw new n.InvalidArgumentException(\"ExpGolomb: readBits() bits exceeded max 32bits!\");if(e<=this._current_word_bits_left){var t=this._current_word>>>32-e;return this._current_word<<=e,this._current_word_bits_left-=e,t}var r=this._current_word_bits_left?this._current_word:0;r>>>=32-this._current_word_bits_left;var i=e-this._current_word_bits_left;this._fillCurrentWord();var a=Math.min(i,this._current_word_bits_left),o=this._current_word>>>32-a;return this._current_word<<=a,this._current_word_bits_left-=a,r<<a|o}},{key:\"readBool\",value:function(){return 1===this.readBits(1)}},{key:\"readByte\",value:function(){return this.readBits(8)}},{key:\"_skipLeadingZero\",value:function(){var e=void 0;for(e=0;e<this._current_word_bits_left;e++)if(0!=(this._current_word&2147483648>>>e))return this._current_word<<=e,this._current_word_bits_left-=e,e;return this._fillCurrentWord(),e+this._skipLeadingZero()}},{key:\"readUEG\",value:function(){var e=this._skipLeadingZero();return this.readBits(e+1)-1}},{key:\"readSEG\",value:function(){var e=this.readUEG();return 1&e?e+1>>>1:-1*(e>>>1)}}]),a);function a(e){(function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")})(this,a),this.TAG=\"ExpGolomb\",this._buffer=e,this._buffer_index=0,this._total_bytes=e.byteLength,this._total_bits=8*e.byteLength,this._current_word=0,this._current_word_bits_left=0}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.default=i},{\"../utils/exception.js\":40}],18:[function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,\"__esModule\",{value:!0});var a=\"function\"==typeof Symbol&&\"symbol\"==i()(Symbol.iterator)?function(e){return i()(e)}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":i()(e)},o=n(e(\"../utils/logger.js\")),s=n(e(\"./amf-parser.js\")),l=n(e(\"./sps-parser.js\")),d=n(e(\"./demux-errors.js\")),u=n(e(\"../core/media-info.js\")),c=e(\"../utils/exception.js\"),h=(function(e,t,r){t&&p(e.prototype,t),r&&p(e,r)}(f,[{key:\"destroy\",value:function(){this._mediaInfo=null,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._videoTrack=null,this._audioTrack=null,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null}},{key:\"bindDataSource\",value:function(e){return e.onDataArrival=this.parseChunks.bind(this),this}},{key:\"resetMediaInfo\",value:function(){this._mediaInfo=new u.default}},{key:\"_isInitialMetadataDispatched\",value:function(){return this._hasAudio&&this._hasVideo?this._audioInitialMetadataDispatched&&this._videoInitialMetadataDispatched:this._hasAudio&&!this._hasVideo?this._audioInitialMetadataDispatched:!(this._hasAudio||!this._hasVideo)&&this._videoInitialMetadataDispatched}},{key:\"parseChunks\",value:function(e,t){if(!(this._onError&&this._onMediaInfo&&this._onTrackMetadata&&this._onDataAvailable))throw new c.IllegalStateException(\"Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified\");var r=0,n=this._littleEndian;if(0===t){if(!(13<e.byteLength))return 0;r=f.probe(e).dataOffset}for(this._firstParse&&(this._firstParse=!1,t+r!==this._dataOffset&&o.default.w(this.TAG,\"First time parsing but chunk byteStart invalid!\"),0!==new DataView(e,r).getUint32(0,!n)&&o.default.w(this.TAG,\"PrevTagSize0 !== 0 !!!\"),r+=4);r<e.byteLength;){this._dispatch=!0;var i=new DataView(e,r);if(r+11+4>e.byteLength)break;var a=i.getUint8(0),s=16777215&i.getUint32(0,!n);if(r+11+s+4>e.byteLength)break;if(8===a||9===a||18===a){var l=i.getUint8(4),d=i.getUint8(5),u=i.getUint8(6)|d<<8|l<<16|i.getUint8(7)<<24;0!=(16777215&i.getUint32(7,!n))&&o.default.w(this.TAG,\"Meet tag which has StreamID != 0!\");var h=r+11;switch(a){case 8:this._parseAudioData(e,h,s,u);break;case 9:this._parseVideoData(e,h,s,u,t+r);break;case 18:this._parseScriptData(e,h,s)}var p=i.getUint32(11+s,!n);p!==11+s&&o.default.w(this.TAG,\"Invalid PrevTagSize \"+p),r+=11+s+4}else o.default.w(this.TAG,\"Unsupported tag type \"+a+\", skipped\"),r+=11+s+4}return this._isInitialMetadataDispatched()&&this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack),r}},{key:\"_parseScriptData\",value:function(e,t,r){var n=s.default.parseScriptData(e,t,r);if(n.hasOwnProperty(\"onMetaData\")){if(null==n.onMetaData||\"object\"!==a(n.onMetaData))return void o.default.w(this.TAG,\"Invalid onMetaData structure!\");this._metadata&&o.default.w(this.TAG,\"Found another onMetaData tag!\"),this._metadata=n;var i,l,d,u,c=this._metadata.onMetaData;this._onMetaDataArrived&&this._onMetaDataArrived(Object.assign({},c)),\"boolean\"==typeof c.hasAudio&&!1===this._hasAudioFlagOverrided&&(this._hasAudio=c.hasAudio,this._mediaInfo.hasAudio=this._hasAudio),\"boolean\"==typeof c.hasVideo&&!1===this._hasVideoFlagOverrided&&(this._hasVideo=c.hasVideo,this._mediaInfo.hasVideo=this._hasVideo),\"number\"==typeof c.audiodatarate&&(this._mediaInfo.audioDataRate=c.audiodatarate),\"number\"==typeof c.videodatarate&&(this._mediaInfo.videoDataRate=c.videodatarate),\"number\"==typeof c.width&&(this._mediaInfo.width=c.width),\"number\"==typeof c.height&&(this._mediaInfo.height=c.height),\"number\"==typeof c.duration?this._durationOverrided||(i=Math.floor(c.duration*this._timescale),this._duration=i,this._mediaInfo.duration=i):this._mediaInfo.duration=0,\"number\"!=typeof c.framerate||0<(l=Math.floor(1e3*c.framerate))&&(d=l/1e3,this._referenceFrameRate.fixed=!0,this._referenceFrameRate.fps=d,this._referenceFrameRate.fps_num=l,this._referenceFrameRate.fps_den=1e3,this._mediaInfo.fps=d),\"object\"===a(c.keyframes)?(this._mediaInfo.hasKeyframesIndex=!0,u=c.keyframes,this._mediaInfo.keyframesIndex=this._parseKeyframesIndex(u),c.keyframes=null):this._mediaInfo.hasKeyframesIndex=!1,this._dispatch=!1,this._mediaInfo.metadata=c,o.default.v(this.TAG,\"Parsed onMetaData\"),this._mediaInfo.isComplete()&&this._onMediaInfo(this._mediaInfo)}0<Object.keys(n).length&&this._onScriptDataArrived&&this._onScriptDataArrived(Object.assign({},n))}},{key:\"_parseKeyframesIndex\",value:function(e){for(var t=[],r=[],n=1;n<e.times.length;n++){var i=this._timestampBase+Math.floor(1e3*e.times[n]);t.push(i),r.push(e.filepositions[n])}return{times:t,filepositions:r}}},{key:\"_parseAudioData\",value:function(e,t,r,n){if(r<=1)o.default.w(this.TAG,\"Flv: Invalid audio packet, missing SoundData payload!\");else if(!0!==this._hasAudioFlagOverrided||!1!==this._hasAudio){var i=(this._littleEndian,new DataView(e,t,r)).getUint8(0),a=i>>>4;if(2!=a&&10!=a)return void this._onError(d.default.CODEC_UNSUPPORTED,\"Flv: Unsupported audio codec idx: \"+a);var s,l=(12&i)>>>2;if(!(0<=l&&l<=4))return void this._onError(d.default.FORMAT_ERROR,\"Flv: Invalid audio sample rate idx: \"+l);s=this._flvSoundRateTable[l];var u=1&i,c=this._audioMetadata,h=this._audioTrack;if(c||(!1===this._hasAudio&&!1===this._hasAudioFlagOverrided&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),(c=this._audioMetadata={}).type=\"audio\",c.id=h.id,c.timescale=this._timescale,c.duration=this._duration,c.audioSampleRate=s,c.channelCount=0==u?1:2),10==a){var f,p,m,g,y=this._parseAACAudioData(e,t+1,r-1);if(null==y)return;0===y.packetType?(c.config&&o.default.w(this.TAG,\"Found another AudioSpecificConfig!\"),f=y.data,c.audioSampleRate=f.samplingRate,c.channelCount=f.channelCount,c.codec=f.codec,c.originalCodec=f.originalCodec,c.config=f.config,c.refSampleDuration=1024/c.audioSampleRate*c.timescale,o.default.v(this.TAG,\"Parsed AudioSpecificConfig\"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata(\"audio\",c),(p=this._mediaInfo).audioCodec=c.originalCodec,p.audioSampleRate=c.audioSampleRate,p.audioChannelCount=c.channelCount,p.hasVideo?null!=p.videoCodec&&(p.mimeType='video/x-flv; codecs=\"'+p.videoCodec+\",\"+p.audioCodec+'\"'):p.mimeType='video/x-flv; codecs=\"'+p.audioCodec+'\"',p.isComplete()&&this._onMediaInfo(p)):1===y.packetType?(m=this._timestampBase+n,g={unit:y.data,length:y.data.byteLength,dts:m,pts:m},h.samples.push(g),h.length+=y.data.length):o.default.e(this.TAG,\"Flv: Unsupported AAC data type \"+y.packetType)}else if(2==a){if(!c.codec){var v=this._parseMP3AudioData(e,t+1,r-1,!0);if(null==v)return;c.audioSampleRate=v.samplingRate,c.channelCount=v.channelCount,c.codec=v.codec,c.originalCodec=v.originalCodec,c.refSampleDuration=1152/c.audioSampleRate*c.timescale,o.default.v(this.TAG,\"Parsed MPEG Audio Frame Header\"),this._audioInitialMetadataDispatched=!0,this._onTrackMetadata(\"audio\",c);var _=this._mediaInfo;_.audioCodec=c.codec,_.audioSampleRate=c.audioSampleRate,_.audioChannelCount=c.channelCount,_.audioDataRate=v.bitRate,_.hasVideo?null!=_.videoCodec&&(_.mimeType='video/x-flv; codecs=\"'+_.videoCodec+\",\"+_.audioCodec+'\"'):_.mimeType='video/x-flv; codecs=\"'+_.audioCodec+'\"',_.isComplete()&&this._onMediaInfo(_)}var b=this._parseMP3AudioData(e,t+1,r-1,!1);if(null==b)return;var E=this._timestampBase+n,k={unit:b,length:b.byteLength,dts:E,pts:E};h.samples.push(k),h.length+=b.length}}}},{key:\"_parseAACAudioData\",value:function(e,t,r){if(!(r<=1)){var n={},i=new Uint8Array(e,t,r);return n.packetType=i[0],0===i[0]?n.data=this._parseAACAudioSpecificConfig(e,t+1,r-1):n.data=i.subarray(1),n}o.default.w(this.TAG,\"Flv: Invalid AAC packet, missing AACPacketType or/and Data!\")}},{key:\"_parseAACAudioSpecificConfig\",value:function(e,t,r){var n,i,a=new Uint8Array(e,t,r),o=null,s=0,l=null;s=n=a[0]>>>3;if((i=(7&a[0])<<1|a[1]>>>7)<0||i>=this._mpegSamplingRates.length)this._onError(d.default.FORMAT_ERROR,\"Flv: AAC invalid sampling frequency index!\");else{var u=this._mpegSamplingRates[i],c=(120&a[1])>>>3;if(!(c<0||8<=c)){5===s&&(l=(7&a[1])<<1|a[2]>>>7,a[2]);var h=self.navigator.userAgent.toLowerCase();return-1!==h.indexOf(\"firefox\")?l=6<=i?(s=5,o=new Array(4),i-3):(s=2,o=new Array(2),i):-1!==h.indexOf(\"android\")?(s=2,o=new Array(2),l=i):(s=5,l=i,o=new Array(4),6<=i?l=i-3:1==c&&(s=2,o=new Array(2),l=i)),o[0]=s<<3,o[0]|=(15&i)>>>1,o[1]=(15&i)<<7,o[1]|=(15&c)<<3,5===s&&(o[1]|=(15&l)>>>1,o[2]=(1&l)<<7,o[2]|=8,o[3]=0),{config:o,samplingRate:u,channelCount:c,codec:\"mp4a.40.\"+s,originalCodec:\"mp4a.40.\"+n}}this._onError(d.default.FORMAT_ERROR,\"Flv: AAC invalid channel configuration\")}}},{key:\"_parseMP3AudioData\",value:function(e,t,r,n){if(!(r<4)){var i=(this._littleEndian,new Uint8Array(e,t,r)),a=null;if(n){if(255!==i[0])return;var s=i[1]>>>3&3,l=(6&i[1])>>1,d=(240&i[2])>>>4,u=(12&i[2])>>>2,c=3!=(i[3]>>>6&3)?2:1,h=0,f=0;switch(s){case 0:h=this._mpegAudioV25SampleRateTable[u];break;case 2:h=this._mpegAudioV20SampleRateTable[u];break;case 3:h=this._mpegAudioV10SampleRateTable[u]}switch(l){case 1:d<this._mpegAudioL3BitRateTable.length&&(f=this._mpegAudioL3BitRateTable[d]);break;case 2:d<this._mpegAudioL2BitRateTable.length&&(f=this._mpegAudioL2BitRateTable[d]);break;case 3:d<this._mpegAudioL1BitRateTable.length&&(f=this._mpegAudioL1BitRateTable[d])}a={bitRate:f,samplingRate:h,channelCount:c,codec:\"mp3\",originalCodec:\"mp3\"}}else a=i;return a}o.default.w(this.TAG,\"Flv: Invalid MP3 packet, header missing!\")}},{key:\"_parseVideoData\",value:function(e,t,r,n,i){if(r<=1)o.default.w(this.TAG,\"Flv: Invalid video packet, missing VideoData payload!\");else if(!0!==this._hasVideoFlagOverrided||!1!==this._hasVideo){var a=new Uint8Array(e,t,r)[0],s=(240&a)>>>4,l=15&a;if(7!=l)return void this._onError(d.default.CODEC_UNSUPPORTED,\"Flv: Unsupported codec in video frame: \"+l);this._parseAVCVideoPacket(e,t+1,r-1,n,i,s)}}},{key:\"_parseAVCVideoPacket\",value:function(e,t,r,n,i,a){if(r<4)o.default.w(this.TAG,\"Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime\");else{var s=this._littleEndian,l=new DataView(e,t,r),u=l.getUint8(0),c=(16777215&l.getUint32(0,!s))<<8>>8;if(0===u)this._parseAVCDecoderConfigurationRecord(e,t+4,r-4);else if(1===u)this._parseAVCVideoData(e,t+4,r-4,n,i,a,c);else if(2!==u)return void this._onError(d.default.FORMAT_ERROR,\"Flv: Invalid video packet type \"+u)}}},{key:\"_parseAVCDecoderConfigurationRecord\",value:function(e,t,r){if(r<7)o.default.w(this.TAG,\"Flv: Invalid AVCDecoderConfigurationRecord, lack of data!\");else{var n=this._videoMetadata,i=this._videoTrack,a=this._littleEndian,s=new DataView(e,t,r);n?void 0!==n.avcc&&o.default.w(this.TAG,\"Found another AVCDecoderConfigurationRecord!\"):(!1===this._hasVideo&&!1===this._hasVideoFlagOverrided&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),(n=this._videoMetadata={}).type=\"video\",n.id=i.id,n.timescale=this._timescale,n.duration=this._duration);var u=s.getUint8(0),c=s.getUint8(1);if(s.getUint8(2),s.getUint8(3),1===u&&0!==c)if(this._naluLengthSize=1+(3&s.getUint8(4)),3===this._naluLengthSize||4===this._naluLengthSize){var h=31&s.getUint8(5);if(0!=h){1<h&&o.default.w(this.TAG,\"Flv: Strange AVCDecoderConfigurationRecord: SPS Count = \"+h);for(var f=6,p=0;p<h;p++){var m=s.getUint16(f,!a);if(f+=2,0!==m){var g=new Uint8Array(e,t+f,m);f+=m;var y=l.default.parseSPS(g);if(0===p){n.codecWidth=y.codec_size.width,n.codecHeight=y.codec_size.height,n.presentWidth=y.present_size.width,n.presentHeight=y.present_size.height,n.profile=y.profile_string,n.level=y.level_string,n.bitDepth=y.bit_depth,n.chromaFormat=y.chroma_format,n.sarRatio=y.sar_ratio,n.frameRate=y.frame_rate,!1!==y.frame_rate.fixed&&0!==y.frame_rate.fps_num&&0!==y.frame_rate.fps_den||(n.frameRate=this._referenceFrameRate);var v=n.frameRate.fps_den,_=n.frameRate.fps_num;n.refSampleDuration=n.timescale*(v/_);for(var b=g.subarray(1,4),E=\"avc1.\",k=0;k<3;k++){var w=b[k].toString(16);w.length<2&&(w=\"0\"+w),E+=w}n.codec=E;var S=this._mediaInfo;S.width=n.codecWidth,S.height=n.codecHeight,S.fps=n.frameRate.fps,S.profile=n.profile,S.level=n.level,S.refFrames=y.ref_frames,S.chromaFormat=y.chroma_format_string,S.sarNum=n.sarRatio.width,S.sarDen=n.sarRatio.height,S.videoCodec=E,S.hasAudio?null!=S.audioCodec&&(S.mimeType='video/x-flv; codecs=\"'+S.videoCodec+\",\"+S.audioCodec+'\"'):S.mimeType='video/x-flv; codecs=\"'+S.videoCodec+'\"',S.isComplete()&&this._onMediaInfo(S)}}}var T=s.getUint8(f);if(0!==T){1<T&&o.default.w(this.TAG,\"Flv: Strange AVCDecoderConfigurationRecord: PPS Count = \"+T),f++;for(var x=0;x<T;x++){var L=s.getUint16(f,!a);f+=2,0!==L&&(f+=L)}n.avcc=new Uint8Array(r),n.avcc.set(new Uint8Array(e,t,r),0),o.default.v(this.TAG,\"Parsed AVCDecoderConfigurationRecord\"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata(\"video\",n)}else this._onError(d.default.FORMAT_ERROR,\"Flv: Invalid AVCDecoderConfigurationRecord: No PPS\")}else this._onError(d.default.FORMAT_ERROR,\"Flv: Invalid AVCDecoderConfigurationRecord: No SPS\")}else this._onError(d.default.FORMAT_ERROR,\"Flv: Strange NaluLengthSizeMinusOne: \"+(this._naluLengthSize-1));else this._onError(d.default.FORMAT_ERROR,\"Flv: Invalid AVCDecoderConfigurationRecord\")}}},{key:\"_parseAVCVideoData\",value:function(e,t,r,n,i,a,s){for(var l,d,u=this._littleEndian,c=new DataView(e,t,r),h=[],f=0,p=0,m=this._naluLengthSize,g=this._timestampBase+n,y=1===a;p<r;){if(r<=p+4){o.default.w(this.TAG,\"Malformed Nalu near timestamp \"+g+\", offset = \"+p+\", dataSize = \"+r);break}var v=c.getUint32(p,!u);if(3===m&&(v>>>=8),r-m<v)return void o.default.w(this.TAG,\"Malformed Nalus near timestamp \"+g+\", NaluSize > DataSize!\");var _=31&c.getUint8(p+m);5==_&&(y=!0);var b=new Uint8Array(e,t+p,m+v),E={type:_,data:b};h.push(E),f+=b.byteLength,p+=m+v}h.length&&(l=this._videoTrack,d={units:h,length:f,isKeyframe:y,dts:g,cts:s,pts:g+s},y&&(d.fileposition=i),l.samples.push(d),l.length+=f)}},{key:\"onTrackMetadata\",get:function(){return this._onTrackMetadata},set:function(e){this._onTrackMetadata=e}},{key:\"onMediaInfo\",get:function(){return this._onMediaInfo},set:function(e){this._onMediaInfo=e}},{key:\"onMetaDataArrived\",get:function(){return this._onMetaDataArrived},set:function(e){this._onMetaDataArrived=e}},{key:\"onScriptDataArrived\",get:function(){return this._onScriptDataArrived},set:function(e){this._onScriptDataArrived=e}},{key:\"onError\",get:function(){return this._onError},set:function(e){this._onError=e}},{key:\"onDataAvailable\",get:function(){return this._onDataAvailable},set:function(e){this._onDataAvailable=e}},{key:\"timestampBase\",get:function(){return this._timestampBase},set:function(e){this._timestampBase=e}},{key:\"overridedDuration\",get:function(){return this._duration},set:function(e){this._durationOverrided=!0,this._duration=e,this._mediaInfo.duration=e}},{key:\"overridedHasAudio\",set:function(e){this._hasAudioFlagOverrided=!0,this._hasAudio=e,this._mediaInfo.hasAudio=e}},{key:\"overridedHasVideo\",set:function(e){this._hasVideoFlagOverrided=!0,this._hasVideo=e,this._mediaInfo.hasVideo=e}}],[{key:\"probe\",value:function(e){var t=new Uint8Array(e),r={match:!1};if(70!==t[0]||76!==t[1]||86!==t[2]||1!==t[3])return r;var n,i=(4&t[4])>>>2!=0,a=0!=(1&t[4]),o=(n=t)[5]<<24|n[6]<<16|n[7]<<8|n[8];return o<9?r:{match:!0,consumed:o,dataOffset:o,hasAudioTrack:i,hasVideoTrack:a}}}]),f);function f(e,t){var r;(function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")})(this,f),this.TAG=\"FLVDemuxer\",this._config=t,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null,this._dataOffset=e.dataOffset,this._firstParse=!0,this._dispatch=!1,this._hasAudio=e.hasAudioTrack,this._hasVideo=e.hasVideoTrack,this._hasAudioFlagOverrided=!1,this._hasVideoFlagOverrided=!1,this._audioInitialMetadataDispatched=!1,this._videoInitialMetadataDispatched=!1,this._mediaInfo=new u.default,this._mediaInfo.hasAudio=this._hasAudio,this._mediaInfo.hasVideo=this._hasVideo,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._naluLengthSize=4,this._timestampBase=0,this._timescale=1e3,this._duration=0,this._durationOverrided=!1,this._referenceFrameRate={fixed:!0,fps:23.976,fps_num:23976,fps_den:1e3},this._flvSoundRateTable=[5500,11025,22050,44100,48e3],this._mpegSamplingRates=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],this._mpegAudioV10SampleRateTable=[44100,48e3,32e3,0],this._mpegAudioV20SampleRateTable=[22050,24e3,16e3,0],this._mpegAudioV25SampleRateTable=[11025,12e3,8e3,0],this._mpegAudioL1BitRateTable=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],this._mpegAudioL2BitRateTable=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],this._mpegAudioL3BitRateTable=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],this._videoTrack={type:\"video\",id:1,sequenceNumber:0,samples:[],length:0},this._audioTrack={type:\"audio\",id:2,sequenceNumber:0,samples:[],length:0},this._littleEndian=(r=new ArrayBuffer(2),new DataView(r).setInt16(0,256,!0),256===new Int16Array(r)[0])}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.default=h},{\"../core/media-info.js\":7,\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./amf-parser.js\":15,\"./demux-errors.js\":16,\"./sps-parser.js\":19}],19:[function(e,t,r){Object.defineProperty(r,\"__esModule\",{value:!0});var n=e(\"./exp-golomb.js\"),i=n&&n.__esModule?n:{default:n},a=(function(e,t,r){t&&s(e.prototype,t),r&&s(e,r)}(o,null,[{key:\"_ebsp2rbsp\",value:function(e){for(var t=e,r=t.byteLength,n=new Uint8Array(r),i=0,a=0;a<r;a++)2<=a&&3===t[a]&&0===t[a-1]&&0===t[a-2]||(n[i]=t[a],i++);return new Uint8Array(n.buffer,0,i)}},{key:\"parseSPS\",value:function(e){var t=o._ebsp2rbsp(e),r=new i.default(t);r.readByte();var n=r.readByte();r.readByte();var a=r.readByte();r.readUEG();var s=o.getProfileString(n),l=o.getLevelString(a),d=1,u=420,c=8;if((100===n||110===n||122===n||244===n||44===n||83===n||86===n||118===n||128===n||138===n||144===n)&&(3===(d=r.readUEG())&&r.readBits(1),d<=3&&(u=[0,420,422,444][d]),c=r.readUEG()+8,r.readUEG(),r.readBits(1),r.readBool()))for(var h=3!==d?8:12,f=0;f<h;f++)r.readBool()&&o._skipScalingList(r,f<6?16:64);r.readUEG();var p=r.readUEG();if(0===p)r.readUEG();else if(1===p){r.readBits(1),r.readSEG(),r.readSEG();for(var m=r.readUEG(),g=0;g<m;g++)r.readSEG()}var y=r.readUEG();r.readBits(1);var v=r.readUEG(),_=r.readUEG(),b=r.readBits(1);0===b&&r.readBits(1),r.readBits(1);var E=0,k=0,w=0,S=0;r.readBool()&&(E=r.readUEG(),k=r.readUEG(),w=r.readUEG(),S=r.readUEG());var T,x,L,A=1,R=1,D=0,O=!0,C=0,I=0;r.readBool()&&(r.readBool()&&(0<(T=r.readByte())&&T<16?(A=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][T-1],R=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][T-1]):255===T&&(A=r.readByte()<<8|r.readByte(),R=r.readByte()<<8|r.readByte())),r.readBool()&&r.readBool(),r.readBool()&&(r.readBits(4),r.readBool()&&r.readBits(24)),r.readBool()&&(r.readUEG(),r.readUEG()),r.readBool()&&(x=r.readBits(32),L=r.readBits(32),O=r.readBool(),D=(C=L)/(I=2*x)));var M=1;1===A&&1===R||(M=A/R);var P,B=0;P=0===d?(B=1,2-b):(B=3===d?1:2,(1===d?2:1)*(2-b));var F=16*(v+1),U=16*(_+1)*(2-b);F-=(E+k)*B,U-=(w+S)*P;var N=Math.ceil(F*M);return r.destroy(),r=null,{profile_string:s,level_string:l,bit_depth:c,ref_frames:y,chroma_format:u,chroma_format_string:o.getChromaFormatString(u),frame_rate:{fixed:O,fps:D,fps_den:I,fps_num:C},sar_ratio:{width:A,height:R},codec_size:{width:F,height:U},present_size:{width:N,height:U}}}},{key:\"_skipScalingList\",value:function(e,t){for(var r=8,n=8,i=0;i<t;i++)0!==n&&(n=(r+e.readSEG()+256)%256),r=0===n?r:n}},{key:\"getProfileString\",value:function(e){switch(e){case 66:return\"Baseline\";case 77:return\"Main\";case 88:return\"Extended\";case 100:return\"High\";case 110:return\"High10\";case 122:return\"High422\";case 244:return\"High444\";default:return\"Unknown\"}}},{key:\"getLevelString\",value:function(e){return(e/10).toFixed(1)}},{key:\"getChromaFormatString\",value:function(e){switch(e){case 420:return\"4:2:0\";case 422:return\"4:2:2\";case 444:return\"4:4:4\";default:return\"Unknown\"}}}]),o);function o(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,o)}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.default=a},{\"./exp-golomb.js\":17}],20:[function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,\"__esModule\",{value:!0});var a=\"function\"==typeof Symbol&&\"symbol\"==i()(Symbol.iterator)?function(e){return i()(e)}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":i()(e)},o=n(e(\"./utils/polyfill.js\")),s=n(e(\"./core/features.js\")),l=e(\"./io/loader.js\"),d=n(e(\"./player/flv-player.js\")),u=n(e(\"./player/native-player.js\")),c=n(e(\"./player/player-events.js\")),h=e(\"./player/player-errors.js\"),f=n(e(\"./utils/logging-control.js\")),p=e(\"./utils/exception.js\");o.default.install();var m={createPlayer:function(e,t){var r=e;if(null==r||\"object\"!==(void 0===r?\"undefined\":a(r)))throw new p.InvalidArgumentException(\"MediaDataSource must be an javascript object!\");if(!r.hasOwnProperty(\"type\"))throw new p.InvalidArgumentException(\"MediaDataSource must has type field to indicate video file type!\");return\"flv\"!==r.type?new u.default(r,t):new d.default(r,t)},isSupported:function(){return s.default.supportMSEH264Playback()},getFeatureList:function(){return s.default.getFeatureList()}};m.BaseLoader=l.BaseLoader,m.LoaderStatus=l.LoaderStatus,m.LoaderErrors=l.LoaderErrors,m.Events=c.default,m.ErrorTypes=h.ErrorTypes,m.ErrorDetails=h.ErrorDetails,m.FlvPlayer=d.default,m.NativePlayer=u.default,m.LoggingControl=f.default,Object.defineProperty(m,\"version\",{enumerable:!0,get:function(){return\"1.5.0\"}}),r.default=m},{\"./core/features.js\":6,\"./io/loader.js\":24,\"./player/flv-player.js\":32,\"./player/native-player.js\":33,\"./player/player-errors.js\":34,\"./player/player-events.js\":35,\"./utils/exception.js\":40,\"./utils/logging-control.js\":42,\"./utils/polyfill.js\":43}],21:[function(e,t,r){t.exports=e(\"./flv.js\").default},{\"./flv.js\":20}],22:[function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,\"__esModule\",{value:!0});var a=\"function\"==typeof Symbol&&\"symbol\"==i()(Symbol.iterator)?function(e){return i()(e)}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":i()(e)},o=function(e,t,r){return t&&f(e.prototype,t),r&&f(e,r),e},s=(n(e(\"../utils/logger.js\")),e(\"../utils/browser.js\")),l=n(s),d=e(\"./loader.js\"),u=e(\"../utils/exception.js\"),c=(function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+i()(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(h,d.BaseLoader),o(h,null,[{key:\"isSupported\",value:function(){try{var e=l.default.msedge&&15048<=l.default.version.minor,t=!l.default.msedge||e;return self.fetch&&self.ReadableStream&&t}catch(e){return!1}}}]),o(h,[{key:\"destroy\",value:function(){this.isWorking()&&this.abort(),function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,r,n)}if(\"value\"in i)return i.value;var o=i.get;return void 0!==o?o.call(n):void 0}(h.prototype.__proto__||Object.getPrototypeOf(h.prototype),\"destroy\",this).call(this)}},{key:\"open\",value:function(e,t){var r=this;this._dataSource=e,this._range=t;var n=e.url;this._config.reuseRedirectedURL&&null!=e.redirectedURL&&(n=e.redirectedURL);var i=this._seekHandler.getConfig(n,t),o=new self.Headers;if(\"object\"===a(i.headers)){var s=i.headers;for(var l in s)s.hasOwnProperty(l)&&o.append(l,s[l])}var c={method:\"GET\",headers:o,mode:\"cors\",cache:\"default\",referrerPolicy:\"no-referrer-when-downgrade\"};if(\"object\"===a(this._config.headers))for(var h in this._config.headers)o.append(h,this._config.headers[h]);!1===e.cors&&(c.mode=\"same-origin\"),e.withCredentials&&(c.credentials=\"include\"),e.referrerPolicy&&(c.referrerPolicy=e.referrerPolicy),this._status=d.LoaderStatus.kConnecting,self.fetch(i.url,c).then((function(e){if(r._requestAbort)return r._requestAbort=!1,void(r._status=d.LoaderStatus.kIdle);if(e.ok&&200<=e.status&&e.status<=299){var t;e.url!==i.url&&r._onURLRedirect&&(t=r._seekHandler.removeURLParameters(e.url),r._onURLRedirect(t));var n=e.headers.get(\"Content-Length\");return null!=n&&(r._contentLength=parseInt(n),0!==r._contentLength&&r._onContentLengthKnown&&r._onContentLengthKnown(r._contentLength)),r._pump.call(r,e.body.getReader())}if(r._status=d.LoaderStatus.kError,!r._onError)throw new u.RuntimeException(\"FetchStreamLoader: Http code invalid, \"+e.status+\" \"+e.statusText);r._onError(d.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:e.status,msg:e.statusText})})).catch((function(e){if(r._status=d.LoaderStatus.kError,!r._onError)throw e;r._onError(d.LoaderErrors.EXCEPTION,{code:-1,msg:e.message})}))}},{key:\"abort\",value:function(){this._requestAbort=!0}},{key:\"_pump\",value:function(e){var t=this;return e.read().then((function(r){if(r.done)if(null!==t._contentLength&&t._receivedLength<t._contentLength){t._status=d.LoaderStatus.kError;var n=d.LoaderErrors.EARLY_EOF,i={code:-1,msg:\"Fetch stream meet Early-EOF\"};if(!t._onError)throw new u.RuntimeException(i.msg);t._onError(n,i)}else t._status=d.LoaderStatus.kComplete,t._onComplete&&t._onComplete(t._range.from,t._range.from+t._receivedLength-1);else{if(!0===t._requestAbort)return t._requestAbort=!1,t._status=d.LoaderStatus.kComplete,e.cancel();t._status=d.LoaderStatus.kBuffering;var a=r.value.buffer,o=t._range.from+t._receivedLength;t._receivedLength+=a.byteLength,t._onDataArrival&&t._onDataArrival(a,o,t._receivedLength),t._pump(e)}})).catch((function(e){if(11!==e.code||!l.default.msedge){t._status=d.LoaderStatus.kError;var r=0,n=19!==e.code&&\"network error\"!==e.message||!(null===t._contentLength||null!==t._contentLength&&t._receivedLength<t._contentLength)?(r=d.LoaderErrors.EXCEPTION,{code:e.code,msg:e.message}):(r=d.LoaderErrors.EARLY_EOF,{code:e.code,msg:\"Fetch stream meet Early-EOF\"});if(!t._onError)throw new u.RuntimeException(n.msg);t._onError(r,n)}}))}}]),h);function h(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,h);var r=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=i()(t)&&\"function\"!=typeof t?e:t}(this,(h.__proto__||Object.getPrototypeOf(h)).call(this,\"fetch-stream-loader\"));return r.TAG=\"FetchStreamLoader\",r._seekHandler=e,r._config=t,r._needStash=!0,r._requestAbort=!1,r._contentLength=null,r._receivedLength=0,r}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.default=c},{\"../utils/browser.js\":39,\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./loader.js\":24}],23:[function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,\"__esModule\",{value:!0});var i=n(e(\"../utils/logger.js\")),a=n(e(\"./speed-sampler.js\")),o=e(\"./loader.js\"),s=n(e(\"./fetch-stream-loader.js\")),l=n(e(\"./xhr-moz-chunked-loader.js\")),d=(n(e(\"./xhr-msstream-loader.js\")),e(\"./xhr-range-loader.js\")),u=n(d),c=n(e(\"./websocket-loader.js\")),h=n(e(\"./range-seek-handler.js\")),f=n(e(\"./param-seek-handler.js\")),p=e(\"../utils/exception.js\"),m=(function(e,t,r){t&&y(e.prototype,t),r&&y(e,r)}(g,[{key:\"destroy\",value:function(){this._loader.isWorking()&&this._loader.abort(),this._loader.destroy(),this._loader=null,this._loaderClass=null,this._dataSource=null,this._stashBuffer=null,this._stashUsed=this._stashSize=this._bufferSize=this._stashByteStart=0,this._currentRange=null,this._speedSampler=null,this._isEarlyEofReconnecting=!1,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._extraData=null}},{key:\"isWorking\",value:function(){return this._loader&&this._loader.isWorking()&&!this._paused}},{key:\"isPaused\",value:function(){return this._paused}},{key:\"_selectSeekHandler\",value:function(){var e=this._config;if(\"range\"===e.seekType)this._seekHandler=new h.default(this._config.rangeLoadZeroStart);else if(\"param\"===e.seekType){var t=e.seekParamStart||\"bstart\",r=e.seekParamEnd||\"bend\";this._seekHandler=new f.default(t,r)}else{if(\"custom\"!==e.seekType)throw new p.InvalidArgumentException(\"Invalid seekType in config: \"+e.seekType);if(\"function\"!=typeof e.customSeekHandler)throw new p.InvalidArgumentException(\"Custom seekType specified in config but invalid customSeekHandler!\");this._seekHandler=new e.customSeekHandler}}},{key:\"_selectLoader\",value:function(){if(null!=this._config.customLoader)this._loaderClass=this._config.customLoader;else if(this._isWebSocketURL)this._loaderClass=c.default;else if(s.default.isSupported())this._loaderClass=s.default;else if(l.default.isSupported())this._loaderClass=l.default;else{if(!u.default.isSupported())throw new p.RuntimeException(\"Your browser doesn't support xhr with arraybuffer responseType!\");this._loaderClass=u.default}}},{key:\"_createLoader\",value:function(){this._loader=new this._loaderClass(this._seekHandler,this._config),!1===this._loader.needStashBuffer&&(this._enableStash=!1),this._loader.onContentLengthKnown=this._onContentLengthKnown.bind(this),this._loader.onURLRedirect=this._onURLRedirect.bind(this),this._loader.onDataArrival=this._onLoaderChunkArrival.bind(this),this._loader.onComplete=this._onLoaderComplete.bind(this),this._loader.onError=this._onLoaderError.bind(this)}},{key:\"open\",value:function(e){this._currentRange={from:0,to:-1},e&&(this._currentRange.from=e),this._speedSampler.reset(),e||(this._fullRequestFlag=!0),this._loader.open(this._dataSource,Object.assign({},this._currentRange))}},{key:\"abort\",value:function(){this._loader.abort(),this._paused&&(this._paused=!1,this._resumeFrom=0)}},{key:\"pause\",value:function(){this.isWorking()&&(this._loader.abort(),0!==this._stashUsed?(this._resumeFrom=this._stashByteStart,this._currentRange.to=this._stashByteStart-1):this._resumeFrom=this._currentRange.to+1,this._stashUsed=0,this._stashByteStart=0,this._paused=!0)}},{key:\"resume\",value:function(){var e;this._paused&&(this._paused=!1,e=this._resumeFrom,this._resumeFrom=0,this._internalSeek(e,!0))}},{key:\"seek\",value:function(e){this._paused=!1,this._stashUsed=0,this._stashByteStart=0,this._internalSeek(e,!0)}},{key:\"_internalSeek\",value:function(e,t){this._loader.isWorking()&&this._loader.abort(),this._flushStashBuffer(t),this._loader.destroy(),this._loader=null;var r={from:e,to:-1};this._currentRange={from:r.from,to:-1},this._speedSampler.reset(),this._stashSize=this._stashInitialSize,this._createLoader(),this._loader.open(this._dataSource,r),this._onSeeked&&this._onSeeked()}},{key:\"updateUrl\",value:function(e){if(!e||\"string\"!=typeof e||0===e.length)throw new p.InvalidArgumentException(\"Url must be a non-empty string!\");this._dataSource.url=e}},{key:\"_expandBuffer\",value:function(e){for(var t,r,n=this._stashSize;n+1048576<e;)n*=2;(n+=1048576)!==this._bufferSize&&(t=new ArrayBuffer(n),0<this._stashUsed&&(r=new Uint8Array(this._stashBuffer,0,this._stashUsed),new Uint8Array(t,0,n).set(r,0)),this._stashBuffer=t,this._bufferSize=n)}},{key:\"_normalizeSpeed\",value:function(e){var t,r=this._speedNormalizeList,n=r.length-1,i=0,a=n;if(e<r[0])return r[0];for(;i<=a;){if((t=i+Math.floor((a-i)/2))===n||e>=r[t]&&e<r[t+1])return r[t];r[t]<e?i=t+1:a=t-1}}},{key:\"_adjustStashSize\",value:function(e){var t=0;8192<(t=this._config.isLive||e<512?e:512<=e&&e<=1024?Math.floor(1.5*e):2*e)&&(t=8192);var r=1024*t+1048576;this._bufferSize<r&&this._expandBuffer(r),this._stashSize=1024*t}},{key:\"_dispatchChunks\",value:function(e,t){return this._currentRange.to=t+e.byteLength-1,this._onDataArrival(e,t)}},{key:\"_onURLRedirect\",value:function(e){this._redirectedURL=e,this._onRedirect&&this._onRedirect(e)}},{key:\"_onContentLengthKnown\",value:function(e){e&&this._fullRequestFlag&&(this._totalLength=e,this._fullRequestFlag=!1)}},{key:\"_onLoaderChunkArrival\",value:function(e,t){if(!this._onDataArrival)throw new p.IllegalStateException(\"IOController: No existing consumer (onDataArrival) callback!\");var r,n,i,a,o,s,l,d,u,c,h,f,m;this._paused||(this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,this._onRecoveredEarlyEof&&this._onRecoveredEarlyEof()),this._speedSampler.addBytes(e.byteLength),0!==(r=this._speedSampler.lastSecondKBps)&&(n=this._normalizeSpeed(r),this._speedNormalized!==n&&(this._speedNormalized=n,this._adjustStashSize(n))),this._enableStash?(0===this._stashUsed&&0===this._stashByteStart&&(this._stashByteStart=t),this._stashUsed+e.byteLength<=this._stashSize?(new Uint8Array(this._stashBuffer,0,this._stashSize).set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength):(i=new Uint8Array(this._stashBuffer,0,this._bufferSize),0<this._stashUsed?(a=this._stashBuffer.slice(0,this._stashUsed),(o=this._dispatchChunks(a,this._stashByteStart))<a.byteLength?0<o&&(s=new Uint8Array(a,o),i.set(s,0),this._stashUsed=s.byteLength,this._stashByteStart+=o):(this._stashUsed=0,this._stashByteStart+=o),this._stashUsed+e.byteLength>this._bufferSize&&(this._expandBuffer(this._stashUsed+e.byteLength),i=new Uint8Array(this._stashBuffer,0,this._bufferSize)),i.set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength):(l=this._dispatchChunks(e,t))<e.byteLength&&((d=e.byteLength-l)>this._bufferSize&&(this._expandBuffer(d),i=new Uint8Array(this._stashBuffer,0,this._bufferSize)),i.set(new Uint8Array(e,l),0),this._stashUsed+=d,this._stashByteStart=t+l))):0===this._stashUsed?(u=this._dispatchChunks(e,t))<e.byteLength&&((c=e.byteLength-u)>this._bufferSize&&this._expandBuffer(c),new Uint8Array(this._stashBuffer,0,this._bufferSize).set(new Uint8Array(e,u),0),this._stashUsed+=c,this._stashByteStart=t+u):(this._stashUsed+e.byteLength>this._bufferSize&&this._expandBuffer(this._stashUsed+e.byteLength),(h=new Uint8Array(this._stashBuffer,0,this._bufferSize)).set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength,(f=this._dispatchChunks(this._stashBuffer.slice(0,this._stashUsed),this._stashByteStart))<this._stashUsed&&0<f&&(m=new Uint8Array(this._stashBuffer,f),h.set(m,0)),this._stashUsed-=f,this._stashByteStart+=f))}},{key:\"_flushStashBuffer\",value:function(e){if(0<this._stashUsed){var t,r,n=this._stashBuffer.slice(0,this._stashUsed),a=this._dispatchChunks(n,this._stashByteStart),o=n.byteLength-a;if(a<n.byteLength){if(!e)return 0<a&&(t=new Uint8Array(this._stashBuffer,0,this._bufferSize),r=new Uint8Array(n,a),t.set(r,0),this._stashUsed=r.byteLength,this._stashByteStart+=a),0;i.default.w(this.TAG,o+\" bytes unconsumed data remain when flush buffer, dropped\")}return this._stashUsed=0,this._stashByteStart=0,o}return 0}},{key:\"_onLoaderComplete\",value:function(){this._flushStashBuffer(!0),this._onComplete&&this._onComplete(this._extraData)}},{key:\"_onLoaderError\",value:function(e,t){switch(i.default.e(this.TAG,\"Loader error, code = \"+t.code+\", msg = \"+t.msg),this._flushStashBuffer(!1),this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,e=o.LoaderErrors.UNRECOVERABLE_EARLY_EOF),e){case o.LoaderErrors.EARLY_EOF:if(!this._config.isLive&&this._totalLength){var r=this._currentRange.to+1;return void(r<this._totalLength&&(i.default.w(this.TAG,\"Connection lost, trying reconnect...\"),this._isEarlyEofReconnecting=!0,this._internalSeek(r,!1)))}e=o.LoaderErrors.UNRECOVERABLE_EARLY_EOF;break;case o.LoaderErrors.UNRECOVERABLE_EARLY_EOF:case o.LoaderErrors.CONNECTING_TIMEOUT:case o.LoaderErrors.HTTP_STATUS_CODE_INVALID:case o.LoaderErrors.EXCEPTION:}if(!this._onError)throw new p.RuntimeException(\"IOException: \"+t.msg);this._onError(e,t)}},{key:\"status\",get:function(){return this._loader.status}},{key:\"extraData\",get:function(){return this._extraData},set:function(e){this._extraData=e}},{key:\"onDataArrival\",get:function(){return this._onDataArrival},set:function(e){this._onDataArrival=e}},{key:\"onSeeked\",get:function(){return this._onSeeked},set:function(e){this._onSeeked=e}},{key:\"onError\",get:function(){return this._onError},set:function(e){this._onError=e}},{key:\"onComplete\",get:function(){return this._onComplete},set:function(e){this._onComplete=e}},{key:\"onRedirect\",get:function(){return this._onRedirect},set:function(e){this._onRedirect=e}},{key:\"onRecoveredEarlyEof\",get:function(){return this._onRecoveredEarlyEof},set:function(e){this._onRecoveredEarlyEof=e}},{key:\"currentURL\",get:function(){return this._dataSource.url}},{key:\"hasRedirect\",get:function(){return null!=this._redirectedURL||null!=this._dataSource.redirectedURL}},{key:\"currentRedirectedURL\",get:function(){return this._redirectedURL||this._dataSource.redirectedURL}},{key:\"currentSpeed\",get:function(){return this._loaderClass===u.default?this._loader.currentSpeed:this._speedSampler.lastSecondKBps}},{key:\"loaderType\",get:function(){return this._loader.type}}]),g);function g(e,t,r){(function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")})(this,g),this.TAG=\"IOController\",this._config=t,this._extraData=r,this._stashInitialSize=393216,null!=t.stashInitialSize&&0<t.stashInitialSize&&(this._stashInitialSize=t.stashInitialSize),this._stashUsed=0,this._stashSize=this._stashInitialSize,this._bufferSize=3145728,this._stashBuffer=new ArrayBuffer(this._bufferSize),this._stashByteStart=0,!(this._enableStash=!0)===t.enableStashBuffer&&(this._enableStash=!1),this._loader=null,this._loaderClass=null,this._seekHandler=null,this._dataSource=e,this._isWebSocketURL=/wss?:\\/\\/(.+?)/.test(e.url),this._refTotalLength=e.filesize?e.filesize:null,this._totalLength=this._refTotalLength,this._fullRequestFlag=!1,this._currentRange=null,this._redirectedURL=null,this._speedNormalized=0,this._speedSampler=new a.default,this._speedNormalizeList=[64,128,256,384,512,768,1024,1536,2048,3072,4096],this._isEarlyEofReconnecting=!1,this._paused=!1,this._resumeFrom=0,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._selectSeekHandler(),this._selectLoader(),this._createLoader()}function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.default=m},{\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./fetch-stream-loader.js\":22,\"./loader.js\":24,\"./param-seek-handler.js\":25,\"./range-seek-handler.js\":26,\"./speed-sampler.js\":27,\"./websocket-loader.js\":28,\"./xhr-moz-chunked-loader.js\":29,\"./xhr-msstream-loader.js\":30,\"./xhr-range-loader.js\":31}],24:[function(e,t,r){Object.defineProperty(r,\"__esModule\",{value:!0}),r.BaseLoader=r.LoaderErrors=r.LoaderStatus=void 0;var n=e(\"../utils/exception.js\"),i=r.LoaderStatus={kIdle:0,kConnecting:1,kBuffering:2,kError:3,kComplete:4};function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e){(function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")})(this,o),this._type=e||\"undefined\",this._status=i.kIdle,this._needStash=!1,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}r.LoaderErrors={OK:\"OK\",EXCEPTION:\"Exception\",HTTP_STATUS_CODE_INVALID:\"HttpStatusCodeInvalid\",CONNECTING_TIMEOUT:\"ConnectingTimeout\",EARLY_EOF:\"EarlyEof\",UNRECOVERABLE_EARLY_EOF:\"UnrecoverableEarlyEof\"},r.BaseLoader=(function(e,t,r){t&&a(e.prototype,t),r&&a(e,r)}(o,[{key:\"destroy\",value:function(){this._status=i.kIdle,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}},{key:\"isWorking\",value:function(){return this._status===i.kConnecting||this._status===i.kBuffering}},{key:\"open\",value:function(){throw new n.NotImplementedException(\"Unimplemented abstract function!\")}},{key:\"abort\",value:function(){throw new n.NotImplementedException(\"Unimplemented abstract function!\")}},{key:\"type\",get:function(){return this._type}},{key:\"status\",get:function(){return this._status}},{key:\"needStashBuffer\",get:function(){return this._needStash}},{key:\"onContentLengthKnown\",get:function(){return this._onContentLengthKnown},set:function(e){this._onContentLengthKnown=e}},{key:\"onURLRedirect\",get:function(){return this._onURLRedirect},set:function(e){this._onURLRedirect=e}},{key:\"onDataArrival\",get:function(){return this._onDataArrival},set:function(e){this._onDataArrival=e}},{key:\"onError\",get:function(){return this._onError},set:function(e){this._onError=e}},{key:\"onComplete\",get:function(){return this._onComplete},set:function(e){this._onComplete=e}}]),o)},{\"../utils/exception.js\":40}],25:[function(e,t,r){Object.defineProperty(r,\"__esModule\",{value:!0});var n=(function(e,t,r){t&&a(e.prototype,t)}(i,[{key:\"getConfig\",value:function(e,t){var r,n=e;return 0===t.from&&-1===t.to||(r=!0,-1===n.indexOf(\"?\")&&(n+=\"?\",r=!1),r&&(n+=\"&\"),n+=this._startName+\"=\"+t.from.toString(),-1!==t.to&&(n+=\"&\"+this._endName+\"=\"+t.to.toString())),{url:n,headers:{}}}},{key:\"removeURLParameters\",value:function(e){var t=e.split(\"?\")[0],r=void 0,n=e.indexOf(\"?\");-1!==n&&(r=e.substring(n+1));var i=\"\";if(null!=r&&0<r.length)for(var a=r.split(\"&\"),o=0;o<a.length;o++){var s=a[o].split(\"=\"),l=0<o;s[0]!==this._startName&&s[0]!==this._endName&&(l&&(i+=\"&\"),i+=a[o])}return 0===i.length?t:t+\"?\"+i}}]),i);function i(e,t){(function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")})(this,i),this._startName=e,this._endName=t}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.default=n},{}],26:[function(e,t,r){Object.defineProperty(r,\"__esModule\",{value:!0});var n=(function(e,t,r){t&&a(e.prototype,t)}(i,[{key:\"getConfig\",value:function(e,t){var r,n={};return 0!==t.from||-1!==t.to?(void 0,r=-1!==t.to?\"bytes=\"+t.from.toString()+\"-\"+t.to.toString():\"bytes=\"+t.from.toString()+\"-\",n.Range=r):this._zeroStart&&(n.Range=\"bytes=0-\"),{url:e,headers:n}}},{key:\"removeURLParameters\",value:function(e){return e}}]),i);function i(e){(function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")})(this,i),this._zeroStart=e||!1}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.default=n},{}],27:[function(e,t,r){Object.defineProperty(r,\"__esModule\",{value:!0});var n=(function(e,t,r){t&&a(e.prototype,t)}(i,[{key:\"reset\",value:function(){this._firstCheckpoint=this._lastCheckpoint=0,this._totalBytes=this._intervalBytes=0,this._lastSecondBytes=0}},{key:\"addBytes\",value:function(e){0===this._firstCheckpoint?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=e,this._totalBytes+=e):this._now()-this._lastCheckpoint<1e3?(this._intervalBytes+=e,this._totalBytes+=e):(this._lastSecondBytes=this._intervalBytes,this._intervalBytes=e,this._totalBytes+=e,this._lastCheckpoint=this._now())}},{key:\"currentKBps\",get:function(){this.addBytes(0);var e=(this._now()-this._lastCheckpoint)/1e3;return 0==e&&(e=1),this._intervalBytes/e/1024}},{key:\"lastSecondKBps\",get:function(){return this.addBytes(0),0!==this._lastSecondBytes?this._lastSecondBytes/1024:500<=this._now()-this._lastCheckpoint?this.currentKBps:0}},{key:\"averageKBps\",get:function(){var e=(this._now()-this._firstCheckpoint)/1e3;return this._totalBytes/e/1024}}]),i);function i(){(function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")})(this,i),this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._totalBytes=0,this._lastSecondBytes=0,self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.default=n},{}],28:[function(e,t,r){Object.defineProperty(r,\"__esModule\",{value:!0});var n=function(e,t,r){return t&&u(e.prototype,t),r&&u(e,r),e},a=e(\"../utils/logger.js\"),o=(a&&a.__esModule,e(\"./loader.js\")),s=e(\"../utils/exception.js\"),l=(function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+i()(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(d,o.BaseLoader),n(d,null,[{key:\"isSupported\",value:function(){try{return void 0!==self.WebSocket}catch(e){return!1}}}]),n(d,[{key:\"destroy\",value:function(){this._ws&&this.abort(),function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,r,n)}if(\"value\"in i)return i.value;var o=i.get;return void 0!==o?o.call(n):void 0}(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),\"destroy\",this).call(this)}},{key:\"open\",value:function(e){try{var t=this._ws=new self.WebSocket(e.url);t.binaryType=\"arraybuffer\",t.onopen=this._onWebSocketOpen.bind(this),t.onclose=this._onWebSocketClose.bind(this),t.onmessage=this._onWebSocketMessage.bind(this),t.onerror=this._onWebSocketError.bind(this),this._status=o.LoaderStatus.kConnecting}catch(e){this._status=o.LoaderStatus.kError;var r={code:e.code,msg:e.message};if(!this._onError)throw new s.RuntimeException(r.msg);this._onError(o.LoaderErrors.EXCEPTION,r)}}},{key:\"abort\",value:function(){var e=this._ws;!e||0!==e.readyState&&1!==e.readyState||(this._requestAbort=!0,e.close()),this._ws=null,this._status=o.LoaderStatus.kComplete}},{key:\"_onWebSocketOpen\",value:function(){this._status=o.LoaderStatus.kBuffering}},{key:\"_onWebSocketClose\",value:function(){!0!==this._requestAbort?(this._status=o.LoaderStatus.kComplete,this._onComplete&&this._onComplete(0,this._receivedLength-1)):this._requestAbort=!1}},{key:\"_onWebSocketMessage\",value:function(e){var t=this;if(e.data instanceof ArrayBuffer)this._dispatchArrayBuffer(e.data);else if(e.data instanceof Blob){var r=new FileReader;r.onload=function(){t._dispatchArrayBuffer(r.result)},r.readAsArrayBuffer(e.data)}else{this._status=o.LoaderStatus.kError;var n={code:-1,msg:\"Unsupported WebSocket message type: \"+e.data.constructor.name};if(!this._onError)throw new s.RuntimeException(n.msg);this._onError(o.LoaderErrors.EXCEPTION,n)}}},{key:\"_dispatchArrayBuffer\",value:function(e){var t=e,r=this._receivedLength;this._receivedLength+=t.byteLength,this._onDataArrival&&this._onDataArrival(t,r,this._receivedLength)}},{key:\"_onWebSocketError\",value:function(e){this._status=o.LoaderStatus.kError;var t={code:e.code,msg:e.message};if(!this._onError)throw new s.RuntimeException(t.msg);this._onError(o.LoaderErrors.EXCEPTION,t)}}]),d);function d(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,d);var e=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=i()(t)&&\"function\"!=typeof t?e:t}(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,\"websocket-loader\"));return e.TAG=\"WebSocketLoader\",e._needStash=!0,e._ws=null,e._requestAbort=!1,e._receivedLength=0,e}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.default=l},{\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./loader.js\":24}],29:[function(e,t,r){Object.defineProperty(r,\"__esModule\",{value:!0});var n=\"function\"==typeof Symbol&&\"symbol\"==i()(Symbol.iterator)?function(e){return i()(e)}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":i()(e)},a=function(e,t,r){return t&&h(e.prototype,t),r&&h(e,r),e},o=e(\"../utils/logger.js\"),s=o&&o.__esModule?o:{default:o},l=e(\"./loader.js\"),d=e(\"../utils/exception.js\"),u=(function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+i()(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(c,l.BaseLoader),a(c,null,[{key:\"isSupported\",value:function(){try{var e=new XMLHttpRequest;return e.open(\"GET\",\"https://example.com\",!0),(e.responseType=\"moz-chunked-arraybuffer\")===e.responseType}catch(e){return s.default.w(\"MozChunkedLoader\",e.message),!1}}}]),a(c,[{key:\"destroy\",value:function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onloadend=null,this._xhr.onerror=null,this._xhr=null),function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,r,n)}if(\"value\"in i)return i.value;var o=i.get;return void 0!==o?o.call(n):void 0}(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),\"destroy\",this).call(this)}},{key:\"open\",value:function(e,t){this._dataSource=e,this._range=t;var r=e.url;this._config.reuseRedirectedURL&&null!=e.redirectedURL&&(r=e.redirectedURL);var i=this._seekHandler.getConfig(r,t);this._requestURL=i.url;var a=this._xhr=new XMLHttpRequest;if(a.open(\"GET\",i.url,!0),a.responseType=\"moz-chunked-arraybuffer\",a.onreadystatechange=this._onReadyStateChange.bind(this),a.onprogress=this._onProgress.bind(this),a.onloadend=this._onLoadEnd.bind(this),a.onerror=this._onXhrError.bind(this),e.withCredentials&&(a.withCredentials=!0),\"object\"===n(i.headers)){var o=i.headers;for(var s in o)o.hasOwnProperty(s)&&a.setRequestHeader(s,o[s])}if(\"object\"===n(this._config.headers)){var d=this._config.headers;for(var u in d)d.hasOwnProperty(u)&&a.setRequestHeader(u,d[u])}this._status=l.LoaderStatus.kConnecting,a.send()}},{key:\"abort\",value:function(){this._requestAbort=!0,this._xhr&&this._xhr.abort(),this._status=l.LoaderStatus.kComplete}},{key:\"_onReadyStateChange\",value:function(e){var t,r=e.target;if(2===r.readyState)if(null!=r.responseURL&&r.responseURL!==this._requestURL&&this._onURLRedirect&&(t=this._seekHandler.removeURLParameters(r.responseURL),this._onURLRedirect(t)),0!==r.status&&(r.status<200||299<r.status)){if(this._status=l.LoaderStatus.kError,!this._onError)throw new d.RuntimeException(\"MozChunkedLoader: Http code invalid, \"+r.status+\" \"+r.statusText);this._onError(l.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:r.status,msg:r.statusText})}else this._status=l.LoaderStatus.kBuffering}},{key:\"_onProgress\",value:function(e){var t,r;this._status!==l.LoaderStatus.kError&&(null===this._contentLength&&null!==e.total&&0!==e.total&&(this._contentLength=e.total,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)),t=e.target.response,r=this._range.from+this._receivedLength,this._receivedLength+=t.byteLength,this._onDataArrival&&this._onDataArrival(t,r,this._receivedLength))}},{key:\"_onLoadEnd\",value:function(){!0!==this._requestAbort?this._status!==l.LoaderStatus.kError&&(this._status=l.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1)):this._requestAbort=!1}},{key:\"_onXhrError\",value:function(e){this._status=l.LoaderStatus.kError;var t=0,r=this._contentLength&&e.loaded<this._contentLength?(t=l.LoaderErrors.EARLY_EOF,{code:-1,msg:\"Moz-Chunked stream meet Early-Eof\"}):(t=l.LoaderErrors.EXCEPTION,{code:-1,msg:e.constructor.name+\" \"+e.type});if(!this._onError)throw new d.RuntimeException(r.msg);this._onError(t,r)}}]),c);function c(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,c);var r=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=i()(t)&&\"function\"!=typeof t?e:t}(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,\"xhr-moz-chunked-loader\"));return r.TAG=\"MozChunkedLoader\",r._seekHandler=e,r._config=t,r._needStash=!0,r._xhr=null,r._requestAbort=!1,r._contentLength=null,r._receivedLength=0,r}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.default=u},{\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./loader.js\":24}],30:[function(e,t,r){Object.defineProperty(r,\"__esModule\",{value:!0});var n=\"function\"==typeof Symbol&&\"symbol\"==i()(Symbol.iterator)?function(e){return i()(e)}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":i()(e)},a=function(e,t,r){return t&&h(e.prototype,t),r&&h(e,r),e},o=e(\"../utils/logger.js\"),s=o&&o.__esModule?o:{default:o},l=e(\"./loader.js\"),d=e(\"../utils/exception.js\"),u=(function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+i()(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(c,l.BaseLoader),a(c,null,[{key:\"isSupported\",value:function(){try{if(void 0===self.MSStream||void 0===self.MSStreamReader)return!1;var e=new XMLHttpRequest;return e.open(\"GET\",\"https://example.com\",!0),(e.responseType=\"ms-stream\")===e.responseType}catch(e){return s.default.w(\"MSStreamLoader\",e.message),!1}}}]),a(c,[{key:\"destroy\",value:function(){this.isWorking()&&this.abort(),this._reader&&(this._reader.onprogress=null,this._reader.onload=null,this._reader.onerror=null,this._reader=null),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr=null),function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,r,n)}if(\"value\"in i)return i.value;var o=i.get;return void 0!==o?o.call(n):void 0}(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),\"destroy\",this).call(this)}},{key:\"open\",value:function(e,t){this._internalOpen(e,t,!1)}},{key:\"_internalOpen\",value:function(e,t,r){this._dataSource=e,r?this._currentRange=t:this._totalRange=t;var i=e.url;this._config.reuseRedirectedURL&&(null!=this._currentRedirectedURL?i=this._currentRedirectedURL:null!=e.redirectedURL&&(i=e.redirectedURL));var a=this._seekHandler.getConfig(i,t);this._currentRequestURL=a.url;var o=this._reader=new self.MSStreamReader;o.onprogress=this._msrOnProgress.bind(this),o.onload=this._msrOnLoad.bind(this),o.onerror=this._msrOnError.bind(this);var s=this._xhr=new XMLHttpRequest;if(s.open(\"GET\",a.url,!0),s.responseType=\"ms-stream\",s.onreadystatechange=this._xhrOnReadyStateChange.bind(this),s.onerror=this._xhrOnError.bind(this),e.withCredentials&&(s.withCredentials=!0),\"object\"===n(a.headers)){var d=a.headers;for(var u in d)d.hasOwnProperty(u)&&s.setRequestHeader(u,d[u])}if(\"object\"===n(this._config.headers)){var c=this._config.headers;for(var h in c)c.hasOwnProperty(h)&&s.setRequestHeader(h,c[h])}this._isReconnecting?this._isReconnecting=!1:this._status=l.LoaderStatus.kConnecting,s.send()}},{key:\"abort\",value:function(){this._internalAbort(),this._status=l.LoaderStatus.kComplete}},{key:\"_internalAbort\",value:function(){this._reader&&(1===this._reader.readyState&&this._reader.abort(),this._reader.onprogress=null,this._reader.onload=null,this._reader.onerror=null,this._reader=null),this._xhr&&(this._xhr.abort(),this._xhr.onreadystatechange=null,this._xhr=null)}},{key:\"_xhrOnReadyStateChange\",value:function(e){var t,r,n=e.target;if(2===n.readyState)if(200<=n.status&&n.status<=299){this._status=l.LoaderStatus.kBuffering,null!=n.responseURL&&(r=this._seekHandler.removeURLParameters(n.responseURL),n.responseURL!==this._currentRequestURL&&r!==this._currentRedirectedURL&&(this._currentRedirectedURL=r,this._onURLRedirect&&this._onURLRedirect(r)));var i,a=n.getResponseHeader(\"Content-Length\");null==a||null!=this._contentLength||0<(i=parseInt(a))&&(this._contentLength=i,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength))}else{if(this._status=l.LoaderStatus.kError,!this._onError)throw new d.RuntimeException(\"MSStreamLoader: Http code invalid, \"+n.status+\" \"+n.statusText);this._onError(l.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:n.status,msg:n.statusText})}else 3===n.readyState&&200<=n.status&&n.status<=299&&(this._status=l.LoaderStatus.kBuffering,t=n.response,this._reader.readAsArrayBuffer(t))}},{key:\"_xhrOnError\",value:function(e){this._status=l.LoaderStatus.kError;var t=l.LoaderErrors.EXCEPTION,r={code:-1,msg:e.constructor.name+\" \"+e.type};if(!this._onError)throw new d.RuntimeException(r.msg);this._onError(t,r)}},{key:\"_msrOnProgress\",value:function(e){var t,r,n=e.target.result;null!=n?(t=n.slice(this._lastTimeBufferSize),this._lastTimeBufferSize=n.byteLength,r=this._totalRange.from+this._receivedLength,this._receivedLength+=t.byteLength,this._onDataArrival&&this._onDataArrival(t,r,this._receivedLength),n.byteLength>=this._bufferLimit&&(s.default.v(this.TAG,\"MSStream buffer exceeded max size near \"+(r+t.byteLength)+\", reconnecting...\"),this._doReconnectIfNeeded())):this._doReconnectIfNeeded()}},{key:\"_doReconnectIfNeeded\",value:function(){var e;(null==this._contentLength||this._receivedLength<this._contentLength)&&(this._isReconnecting=!0,this._lastTimeBufferSize=0,this._internalAbort(),e={from:this._totalRange.from+this._receivedLength,to:-1},this._internalOpen(this._dataSource,e,!0))}},{key:\"_msrOnLoad\",value:function(){this._status=l.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._totalRange.from,this._totalRange.from+this._receivedLength-1)}},{key:\"_msrOnError\",value:function(e){this._status=l.LoaderStatus.kError;var t=0,r=this._contentLength&&this._receivedLength<this._contentLength?(t=l.LoaderErrors.EARLY_EOF,{code:-1,msg:\"MSStream meet Early-Eof\"}):(t=l.LoaderErrors.EARLY_EOF,{code:-1,msg:e.constructor.name+\" \"+e.type});if(!this._onError)throw new d.RuntimeException(r.msg);this._onError(t,r)}}]),c);function c(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,c);var r=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=i()(t)&&\"function\"!=typeof t?e:t}(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,\"xhr-msstream-loader\"));return r.TAG=\"MSStreamLoader\",r._seekHandler=e,r._config=t,r._needStash=!0,r._xhr=null,r._reader=null,r._totalRange=null,r._currentRange=null,r._currentRequestURL=null,r._currentRedirectedURL=null,r._contentLength=null,r._receivedLength=0,r._bufferLimit=16777216,r._lastTimeBufferSize=0,r._isReconnecting=!1,r}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.default=u},{\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./loader.js\":24}],31:[function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,\"__esModule\",{value:!0});var a=\"function\"==typeof Symbol&&\"symbol\"==i()(Symbol.iterator)?function(e){return i()(e)}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":i()(e)},o=function(e,t,r){return t&&f(e.prototype,t),r&&f(e,r),e},s=n(e(\"../utils/logger.js\")),l=n(e(\"./speed-sampler.js\")),d=e(\"./loader.js\"),u=e(\"../utils/exception.js\"),c=(function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+i()(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(h,d.BaseLoader),o(h,null,[{key:\"isSupported\",value:function(){try{var e=new XMLHttpRequest;return e.open(\"GET\",\"https://example.com\",!0),(e.responseType=\"arraybuffer\")===e.responseType}catch(e){return s.default.w(\"RangeLoader\",e.message),!1}}}]),o(h,[{key:\"destroy\",value:function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr=null),function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,r,n)}if(\"value\"in i)return i.value;var o=i.get;return void 0!==o?o.call(n):void 0}(h.prototype.__proto__||Object.getPrototypeOf(h.prototype),\"destroy\",this).call(this)}},{key:\"open\",value:function(e,t){this._dataSource=e,this._range=t,this._status=d.LoaderStatus.kConnecting;var r=!1;null!=this._dataSource.filesize&&0!==this._dataSource.filesize&&(r=!0,this._totalLength=this._dataSource.filesize),this._totalLengthReceived||r?this._openSubRange():(this._waitForTotalLength=!0,this._internalOpen(this._dataSource,{from:0,to:-1}))}},{key:\"_openSubRange\",value:function(){var e=1024*this._currentChunkSizeKB,t=this._range.from+this._receivedLength,r=t+e;null!=this._contentLength&&r-this._range.from>=this._contentLength&&(r=this._range.from+this._contentLength-1),this._currentRequestRange={from:t,to:r},this._internalOpen(this._dataSource,this._currentRequestRange)}},{key:\"_internalOpen\",value:function(e,t){this._lastTimeLoaded=0;var r=e.url;this._config.reuseRedirectedURL&&(null!=this._currentRedirectedURL?r=this._currentRedirectedURL:null!=e.redirectedURL&&(r=e.redirectedURL));var n=this._seekHandler.getConfig(r,t);this._currentRequestURL=n.url;var i=this._xhr=new XMLHttpRequest;if(i.open(\"GET\",n.url,!0),i.responseType=\"arraybuffer\",i.onreadystatechange=this._onReadyStateChange.bind(this),i.onprogress=this._onProgress.bind(this),i.onload=this._onLoad.bind(this),i.onerror=this._onXhrError.bind(this),e.withCredentials&&(i.withCredentials=!0),\"object\"===a(n.headers)){var o=n.headers;for(var s in o)o.hasOwnProperty(s)&&i.setRequestHeader(s,o[s])}if(\"object\"===a(this._config.headers)){var l=this._config.headers;for(var d in l)l.hasOwnProperty(d)&&i.setRequestHeader(d,l[d])}i.send()}},{key:\"abort\",value:function(){this._requestAbort=!0,this._internalAbort(),this._status=d.LoaderStatus.kComplete}},{key:\"_internalAbort\",value:function(){this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr.abort(),this._xhr=null)}},{key:\"_onReadyStateChange\",value:function(e){var t,r=e.target;if(2===r.readyState)if(null!=r.responseURL&&(t=this._seekHandler.removeURLParameters(r.responseURL),r.responseURL!==this._currentRequestURL&&t!==this._currentRedirectedURL&&(this._currentRedirectedURL=t,this._onURLRedirect&&this._onURLRedirect(t))),200<=r.status&&r.status<=299){if(this._waitForTotalLength)return;this._status=d.LoaderStatus.kBuffering}else{if(this._status=d.LoaderStatus.kError,!this._onError)throw new u.RuntimeException(\"RangeLoader: Http code invalid, \"+r.status+\" \"+r.statusText);this._onError(d.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:r.status,msg:r.statusText})}}},{key:\"_onProgress\",value:function(e){if(this._status!==d.LoaderStatus.kError){if(null===this._contentLength){var t,r=!1;if(this._waitForTotalLength&&(this._waitForTotalLength=!1,r=this._totalLengthReceived=!0,t=e.total,this._internalAbort(),null!=t&0!==t&&(this._totalLength=t)),-1===this._range.to?this._contentLength=this._totalLength-this._range.from:this._contentLength=this._range.to-this._range.from+1,r)return void this._openSubRange();this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)}var n=e.loaded-this._lastTimeLoaded;this._lastTimeLoaded=e.loaded,this._speedSampler.addBytes(n)}}},{key:\"_normalizeSpeed\",value:function(e){var t,r=this._chunkSizeKBList,n=r.length-1,i=0,a=n;if(e<r[0])return r[0];for(;i<=a;){if((t=i+Math.floor((a-i)/2))===n||e>=r[t]&&e<r[t+1])return r[t];r[t]<e?i=t+1:a=t-1}}},{key:\"_onLoad\",value:function(e){if(this._status!==d.LoaderStatus.kError){if(this._waitForTotalLength)return void(this._waitForTotalLength=!1);this._lastTimeLoaded=0;var t,r=this._speedSampler.lastSecondKBps;0===r&&3<=++this._zeroSpeedChunkCount&&(r=this._speedSampler.currentKBps),0!==r&&(t=this._normalizeSpeed(r),this._currentSpeedNormalized!==t&&(this._currentSpeedNormalized=t,this._currentChunkSizeKB=t));var n=e.target.response,i=this._range.from+this._receivedLength;this._receivedLength+=n.byteLength;var a=!1;null!=this._contentLength&&this._receivedLength<this._contentLength?this._openSubRange():a=!0,this._onDataArrival&&this._onDataArrival(n,i,this._receivedLength),a&&(this._status=d.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1))}}},{key:\"_onXhrError\",value:function(e){this._status=d.LoaderStatus.kError;var t=0,r=this._contentLength&&0<this._receivedLength&&this._receivedLength<this._contentLength?(t=d.LoaderErrors.EARLY_EOF,{code:-1,msg:\"RangeLoader meet Early-Eof\"}):(t=d.LoaderErrors.EXCEPTION,{code:-1,msg:e.constructor.name+\" \"+e.type});if(!this._onError)throw new u.RuntimeException(r.msg);this._onError(t,r)}},{key:\"currentSpeed\",get:function(){return this._speedSampler.lastSecondKBps}}]),h);function h(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,h);var r=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=i()(t)&&\"function\"!=typeof t?e:t}(this,(h.__proto__||Object.getPrototypeOf(h)).call(this,\"xhr-range-loader\"));return r.TAG=\"RangeLoader\",r._seekHandler=e,r._config=t,r._needStash=!1,r._chunkSizeKBList=[128,256,384,512,768,1024,1536,2048,3072,4096,5120,6144,7168,8192],r._currentChunkSizeKB=384,r._currentSpeedNormalized=0,r._zeroSpeedChunkCount=0,r._xhr=null,r._speedSampler=new l.default,r._requestAbort=!1,r._waitForTotalLength=!1,r._totalLengthReceived=!1,r._currentRequestURL=null,r._currentRedirectedURL=null,r._currentRequestRange=null,r._totalLength=null,r._contentLength=null,r._receivedLength=0,r._lastTimeLoaded=0,r}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.default=c},{\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./loader.js\":24,\"./speed-sampler.js\":27}],32:[function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,\"__esModule\",{value:!0});var a=\"function\"==typeof Symbol&&\"symbol\"==i()(Symbol.iterator)?function(e){return i()(e)}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":i()(e)},o=n(e(\"events\")),s=n(e(\"../utils/logger.js\")),l=n(e(\"../utils/browser.js\")),d=n(e(\"./player-events.js\")),u=n(e(\"../core/transmuxer.js\")),c=n(e(\"../core/transmuxing-events.js\")),h=n(e(\"../core/mse-controller.js\")),f=n(e(\"../core/mse-events.js\")),p=e(\"./player-errors.js\"),m=e(\"../config.js\"),g=e(\"../utils/exception.js\"),y=(function(e,t,r){t&&_(e.prototype,t),r&&_(e,r)}(v,[{key:\"destroy\",value:function(){null!=this._progressChecker&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._transmuxer&&this.unload(),this._mediaElement&&this.detachMediaElement(),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null}},{key:\"on\",value:function(e,t){var r=this;e===d.default.MEDIA_INFO?null!=this._mediaInfo&&Promise.resolve().then((function(){r._emitter.emit(d.default.MEDIA_INFO,r.mediaInfo)})):e===d.default.STATISTICS_INFO&&null!=this._statisticsInfo&&Promise.resolve().then((function(){r._emitter.emit(d.default.STATISTICS_INFO,r.statisticsInfo)})),this._emitter.addListener(e,t)}},{key:\"off\",value:function(e,t){this._emitter.removeListener(e,t)}},{key:\"attachMediaElement\",value:function(e){var t=this;if((this._mediaElement=e).addEventListener(\"loadedmetadata\",this.e.onvLoadedMetadata),e.addEventListener(\"seeking\",this.e.onvSeeking),e.addEventListener(\"canplay\",this.e.onvCanPlay),e.addEventListener(\"stalled\",this.e.onvStalled),e.addEventListener(\"progress\",this.e.onvProgress),this._msectl=new h.default(this._config),this._msectl.on(f.default.UPDATE_END,this._onmseUpdateEnd.bind(this)),this._msectl.on(f.default.BUFFER_FULL,this._onmseBufferFull.bind(this)),this._msectl.on(f.default.SOURCE_OPEN,(function(){t._mseSourceOpened=!0,t._hasPendingLoad&&(t._hasPendingLoad=!1,t.load())})),this._msectl.on(f.default.ERROR,(function(e){t._emitter.emit(d.default.ERROR,p.ErrorTypes.MEDIA_ERROR,p.ErrorDetails.MEDIA_MSE_ERROR,e)})),this._msectl.attachMediaElement(e),null!=this._pendingSeekTime)try{e.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch(e){}}},{key:\"detachMediaElement\",value:function(){this._mediaElement&&(this._msectl.detachMediaElement(),this._mediaElement.removeEventListener(\"loadedmetadata\",this.e.onvLoadedMetadata),this._mediaElement.removeEventListener(\"seeking\",this.e.onvSeeking),this._mediaElement.removeEventListener(\"canplay\",this.e.onvCanPlay),this._mediaElement.removeEventListener(\"stalled\",this.e.onvStalled),this._mediaElement.removeEventListener(\"progress\",this.e.onvProgress),this._mediaElement=null),this._msectl&&(this._msectl.destroy(),this._msectl=null)}},{key:\"load\",value:function(){var e=this;if(!this._mediaElement)throw new g.IllegalStateException(\"HTMLMediaElement must be attached before load()!\");if(this._transmuxer)throw new g.IllegalStateException(\"FlvPlayer.load() has been called, please call unload() first!\");if(!this._hasPendingLoad){if(this._config.deferLoadAfterSourceOpen&&!1===this._mseSourceOpened)return void(this._hasPendingLoad=!0);0<this._mediaElement.readyState&&(this._requestSetTime=!0,this._mediaElement.currentTime=0),this._transmuxer=new u.default(this._mediaDataSource,this._config),this._transmuxer.on(c.default.INIT_SEGMENT,(function(t,r){e._msectl.appendInitSegment(r)})),this._transmuxer.on(c.default.MEDIA_SEGMENT,(function(t,r){var n;e._msectl.appendMediaSegment(r),e._config.lazyLoad&&!e._config.isLive&&(n=e._mediaElement.currentTime,r.info.endDts>=1e3*(n+e._config.lazyLoadMaxDuration)&&null==e._progressChecker&&(s.default.v(e.TAG,\"Maximum buffering duration exceeded, suspend transmuxing task\"),e._suspendTransmuxer()))})),this._transmuxer.on(c.default.LOADING_COMPLETE,(function(){e._msectl.endOfStream(),e._emitter.emit(d.default.LOADING_COMPLETE)})),this._transmuxer.on(c.default.RECOVERED_EARLY_EOF,(function(){e._emitter.emit(d.default.RECOVERED_EARLY_EOF)})),this._transmuxer.on(c.default.IO_ERROR,(function(t,r){e._emitter.emit(d.default.ERROR,p.ErrorTypes.NETWORK_ERROR,t,r)})),this._transmuxer.on(c.default.DEMUX_ERROR,(function(t,r){e._emitter.emit(d.default.ERROR,p.ErrorTypes.MEDIA_ERROR,t,{code:-1,msg:r})})),this._transmuxer.on(c.default.MEDIA_INFO,(function(t){e._mediaInfo=t,e._emitter.emit(d.default.MEDIA_INFO,Object.assign({},t))})),this._transmuxer.on(c.default.METADATA_ARRIVED,(function(t){e._emitter.emit(d.default.METADATA_ARRIVED,t)})),this._transmuxer.on(c.default.SCRIPTDATA_ARRIVED,(function(t){e._emitter.emit(d.default.SCRIPTDATA_ARRIVED,t)})),this._transmuxer.on(c.default.STATISTICS_INFO,(function(t){e._statisticsInfo=e._fillStatisticsInfo(t),e._emitter.emit(d.default.STATISTICS_INFO,Object.assign({},e._statisticsInfo))})),this._transmuxer.on(c.default.RECOMMEND_SEEKPOINT,(function(t){e._mediaElement&&!e._config.accurateSeek&&(e._requestSetTime=!0,e._mediaElement.currentTime=t/1e3)})),this._transmuxer.open()}}},{key:\"unload\",value:function(){this._mediaElement&&this._mediaElement.pause(),this._msectl&&this._msectl.seek(0),this._transmuxer&&(this._transmuxer.close(),this._transmuxer.destroy(),this._transmuxer=null)}},{key:\"play\",value:function(){return this._mediaElement.play()}},{key:\"pause\",value:function(){this._mediaElement.pause()}},{key:\"_fillStatisticsInfo\",value:function(e){if(e.playerType=this._type,!(this._mediaElement instanceof HTMLVideoElement))return e;var t,r=!0,n=0,i=0;return this._mediaElement.getVideoPlaybackQuality?(n=(t=this._mediaElement.getVideoPlaybackQuality()).totalVideoFrames,i=t.droppedVideoFrames):null!=this._mediaElement.webkitDecodedFrameCount?(n=this._mediaElement.webkitDecodedFrameCount,i=this._mediaElement.webkitDroppedFrameCount):r=!1,r&&(e.decodedFrames=n,e.droppedFrames=i),e}},{key:\"_onmseUpdateEnd\",value:function(){if(this._config.lazyLoad&&!this._config.isLive){for(var e=this._mediaElement.buffered,t=this._mediaElement.currentTime,r=0,n=0;n<e.length;n++){var i=e.start(n),a=e.end(n);if(i<=t&&t<a){r=a;break}}r>=t+this._config.lazyLoadMaxDuration&&null==this._progressChecker&&(s.default.v(this.TAG,\"Maximum buffering duration exceeded, suspend transmuxing task\"),this._suspendTransmuxer())}}},{key:\"_onmseBufferFull\",value:function(){s.default.v(this.TAG,\"MSE SourceBuffer is full, suspend transmuxing task\"),null==this._progressChecker&&this._suspendTransmuxer()}},{key:\"_suspendTransmuxer\",value:function(){this._transmuxer&&(this._transmuxer.pause(),null==this._progressChecker&&(this._progressChecker=window.setInterval(this._checkProgressAndResume.bind(this),1e3)))}},{key:\"_checkProgressAndResume\",value:function(){for(var e=this._mediaElement.currentTime,t=this._mediaElement.buffered,r=!1,n=0;n<t.length;n++){var i=t.start(n),a=t.end(n);if(i<=e&&e<a){e>=a-this._config.lazyLoadRecoverDuration&&(r=!0);break}}r&&(window.clearInterval(this._progressChecker),this._progressChecker=null,r&&(s.default.v(this.TAG,\"Continue loading from paused position\"),this._transmuxer.resume()))}},{key:\"_isTimepointBuffered\",value:function(e){for(var t=this._mediaElement.buffered,r=0;r<t.length;r++){var n=t.start(r),i=t.end(r);if(n<=e&&e<i)return!0}return!1}},{key:\"_internalSeek\",value:function(e){var t,r,n=this._isTimepointBuffered(e),i=!1,a=0;e<1&&0<this._mediaElement.buffered.length&&((t=this._mediaElement.buffered.start(0))<1&&e<t||l.default.safari)&&(i=!0,a=l.default.safari?.1:t),i?(this._requestSetTime=!0,this._mediaElement.currentTime=a):n?(this._alwaysSeekKeyframe?(r=this._msectl.getNearestKeyframe(Math.floor(1e3*e)),this._requestSetTime=!0,this._mediaElement.currentTime=null!=r?r.dts/1e3:e):(this._requestSetTime=!0,this._mediaElement.currentTime=e),null!=this._progressChecker&&this._checkProgressAndResume()):(null!=this._progressChecker&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._msectl.seek(e),this._transmuxer.seek(Math.floor(1e3*e)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=e))}},{key:\"_checkAndApplyUnbufferedSeekpoint\",value:function(){var e;this._seekpointRecord&&(this._seekpointRecord.recordTime<=this._now()-100?(e=this._mediaElement.currentTime,this._seekpointRecord=null,this._isTimepointBuffered(e)||(null!=this._progressChecker&&(window.clearTimeout(this._progressChecker),this._progressChecker=null),this._msectl.seek(e),this._transmuxer.seek(Math.floor(1e3*e)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=e))):window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50))}},{key:\"_checkAndResumeStuckPlayback\",value:function(e){var t,r=this._mediaElement;e||!this._receivedCanPlay||r.readyState<2?0<(t=r.buffered).length&&r.currentTime<t.start(0)&&(s.default.w(this.TAG,\"Playback seems stuck at \"+r.currentTime+\", seek to \"+t.start(0)),this._requestSetTime=!0,this._mediaElement.currentTime=t.start(0),this._mediaElement.removeEventListener(\"progress\",this.e.onvProgress)):this._mediaElement.removeEventListener(\"progress\",this.e.onvProgress)}},{key:\"_onvLoadedMetadata\",value:function(){null!=this._pendingSeekTime&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null)}},{key:\"_onvSeeking\",value:function(){var e,t=this._mediaElement.currentTime,r=this._mediaElement.buffered;if(this._requestSetTime)this._requestSetTime=!1;else{if(t<1&&0<r.length){var n=r.start(0);if(n<1&&t<n||l.default.safari)return this._requestSetTime=!0,void(this._mediaElement.currentTime=l.default.safari?.1:n)}if(this._isTimepointBuffered(t))return!this._alwaysSeekKeyframe||null!=(e=this._msectl.getNearestKeyframe(Math.floor(1e3*t)))&&(this._requestSetTime=!0,this._mediaElement.currentTime=e.dts/1e3),void(null!=this._progressChecker&&this._checkProgressAndResume());this._seekpointRecord={seekPoint:t,recordTime:this._now()},window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)}}},{key:\"_onvCanPlay\",value:function(){this._receivedCanPlay=!0,this._mediaElement.removeEventListener(\"canplay\",this.e.onvCanPlay)}},{key:\"_onvStalled\",value:function(){this._checkAndResumeStuckPlayback(!0)}},{key:\"_onvProgress\",value:function(){this._checkAndResumeStuckPlayback()}},{key:\"type\",get:function(){return this._type}},{key:\"buffered\",get:function(){return this._mediaElement.buffered}},{key:\"duration\",get:function(){return this._mediaElement.duration}},{key:\"volume\",get:function(){return this._mediaElement.volume},set:function(e){this._mediaElement.volume=e}},{key:\"muted\",get:function(){return this._mediaElement.muted},set:function(e){this._mediaElement.muted=e}},{key:\"currentTime\",get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(e){this._mediaElement?this._internalSeek(e):this._pendingSeekTime=e}},{key:\"mediaInfo\",get:function(){return Object.assign({},this._mediaInfo)}},{key:\"statisticsInfo\",get:function(){return null==this._statisticsInfo&&(this._statisticsInfo={}),this._statisticsInfo=this._fillStatisticsInfo(this._statisticsInfo),Object.assign({},this._statisticsInfo)}}]),v);function v(e,t){if(function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,v),this.TAG=\"FlvPlayer\",this._type=\"FlvPlayer\",this._emitter=new o.default,this._config=(0,m.createDefaultConfig)(),\"object\"===(void 0===t?\"undefined\":a(t))&&Object.assign(this._config,t),\"flv\"!==e.type.toLowerCase())throw new g.InvalidArgumentException(\"FlvPlayer requires an flv MediaDataSource input!\");!0===e.isLive&&(this._config.isLive=!0),this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this),onvSeeking:this._onvSeeking.bind(this),onvCanPlay:this._onvCanPlay.bind(this),onvStalled:this._onvStalled.bind(this),onvProgress:this._onvProgress.bind(this)},self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now,this._pendingSeekTime=null,this._requestSetTime=!1,this._seekpointRecord=null,this._progressChecker=null,this._mediaDataSource=e,this._mediaElement=null,this._msectl=null,this._transmuxer=null,this._mseSourceOpened=!1,this._hasPendingLoad=!1,this._receivedCanPlay=!1,this._mediaInfo=null,this._statisticsInfo=null;var r=l.default.chrome&&(l.default.version.major<50||50===l.default.version.major&&l.default.version.build<2661);this._alwaysSeekKeyframe=!!(r||l.default.msedge||l.default.msie),this._alwaysSeekKeyframe&&(this._config.accurateSeek=!1)}function _(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.default=y},{\"../config.js\":5,\"../core/mse-controller.js\":9,\"../core/mse-events.js\":10,\"../core/transmuxer.js\":11,\"../core/transmuxing-events.js\":13,\"../utils/browser.js\":39,\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./player-errors.js\":34,\"./player-events.js\":35,events:2}],33:[function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,\"__esModule\",{value:!0});var a=\"function\"==typeof Symbol&&\"symbol\"==i()(Symbol.iterator)?function(e){return i()(e)}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":i()(e)},o=n(e(\"events\")),s=n(e(\"./player-events.js\")),l=e(\"../config.js\"),d=e(\"../utils/exception.js\"),u=(function(e,t,r){t&&h(e.prototype,t),r&&h(e,r)}(c,[{key:\"destroy\",value:function(){this._mediaElement&&(this.unload(),this.detachMediaElement()),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null}},{key:\"on\",value:function(e,t){var r=this;e===s.default.MEDIA_INFO?null!=this._mediaElement&&0!==this._mediaElement.readyState&&Promise.resolve().then((function(){r._emitter.emit(s.default.MEDIA_INFO,r.mediaInfo)})):e===s.default.STATISTICS_INFO&&null!=this._mediaElement&&0!==this._mediaElement.readyState&&Promise.resolve().then((function(){r._emitter.emit(s.default.STATISTICS_INFO,r.statisticsInfo)})),this._emitter.addListener(e,t)}},{key:\"off\",value:function(e,t){this._emitter.removeListener(e,t)}},{key:\"attachMediaElement\",value:function(e){if((this._mediaElement=e).addEventListener(\"loadedmetadata\",this.e.onvLoadedMetadata),null!=this._pendingSeekTime)try{e.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch(e){}}},{key:\"detachMediaElement\",value:function(){this._mediaElement&&(this._mediaElement.src=\"\",this._mediaElement.removeAttribute(\"src\"),this._mediaElement.removeEventListener(\"loadedmetadata\",this.e.onvLoadedMetadata),this._mediaElement=null),null!=this._statisticsReporter&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)}},{key:\"load\",value:function(){if(!this._mediaElement)throw new d.IllegalStateException(\"HTMLMediaElement must be attached before load()!\");this._mediaElement.src=this._mediaDataSource.url,0<this._mediaElement.readyState&&(this._mediaElement.currentTime=0),this._mediaElement.preload=\"auto\",this._mediaElement.load(),this._statisticsReporter=window.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval)}},{key:\"unload\",value:function(){this._mediaElement&&(this._mediaElement.src=\"\",this._mediaElement.removeAttribute(\"src\")),null!=this._statisticsReporter&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)}},{key:\"play\",value:function(){return this._mediaElement.play()}},{key:\"pause\",value:function(){this._mediaElement.pause()}},{key:\"_onvLoadedMetadata\",value:function(){null!=this._pendingSeekTime&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null),this._emitter.emit(s.default.MEDIA_INFO,this.mediaInfo)}},{key:\"_reportStatisticsInfo\",value:function(){this._emitter.emit(s.default.STATISTICS_INFO,this.statisticsInfo)}},{key:\"type\",get:function(){return this._type}},{key:\"buffered\",get:function(){return this._mediaElement.buffered}},{key:\"duration\",get:function(){return this._mediaElement.duration}},{key:\"volume\",get:function(){return this._mediaElement.volume},set:function(e){this._mediaElement.volume=e}},{key:\"muted\",get:function(){return this._mediaElement.muted},set:function(e){this._mediaElement.muted=e}},{key:\"currentTime\",get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(e){this._mediaElement?this._mediaElement.currentTime=e:this._pendingSeekTime=e}},{key:\"mediaInfo\",get:function(){var e={mimeType:(this._mediaElement instanceof HTMLAudioElement?\"audio/\":\"video/\")+this._mediaDataSource.type};return this._mediaElement&&(e.duration=Math.floor(1e3*this._mediaElement.duration),this._mediaElement instanceof HTMLVideoElement&&(e.width=this._mediaElement.videoWidth,e.height=this._mediaElement.videoHeight)),e}},{key:\"statisticsInfo\",get:function(){var e={playerType:this._type,url:this._mediaDataSource.url};if(!(this._mediaElement instanceof HTMLVideoElement))return e;var t,r=!0,n=0,i=0;return this._mediaElement.getVideoPlaybackQuality?(n=(t=this._mediaElement.getVideoPlaybackQuality()).totalVideoFrames,i=t.droppedVideoFrames):null!=this._mediaElement.webkitDecodedFrameCount?(n=this._mediaElement.webkitDecodedFrameCount,i=this._mediaElement.webkitDroppedFrameCount):r=!1,r&&(e.decodedFrames=n,e.droppedFrames=i),e}}]),c);function c(e,t){if(function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,c),this.TAG=\"NativePlayer\",this._type=\"NativePlayer\",this._emitter=new o.default,this._config=(0,l.createDefaultConfig)(),\"object\"===(void 0===t?\"undefined\":a(t))&&Object.assign(this._config,t),\"flv\"===e.type.toLowerCase())throw new d.InvalidArgumentException(\"NativePlayer does't support flv MediaDataSource input!\");if(e.hasOwnProperty(\"segments\"))throw new d.InvalidArgumentException(\"NativePlayer(\"+e.type+\") doesn't support multipart playback!\");this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this)},this._pendingSeekTime=null,this._statisticsReporter=null,this._mediaDataSource=e,this._mediaElement=null}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.default=u},{\"../config.js\":5,\"../utils/exception.js\":40,\"./player-events.js\":35,events:2}],34:[function(e,t,r){Object.defineProperty(r,\"__esModule\",{value:!0}),r.ErrorDetails=r.ErrorTypes=void 0;var n=e(\"../io/loader.js\"),i=e(\"../demux/demux-errors.js\"),a=i&&i.__esModule?i:{default:i};r.ErrorTypes={NETWORK_ERROR:\"NetworkError\",MEDIA_ERROR:\"MediaError\",OTHER_ERROR:\"OtherError\"},r.ErrorDetails={NETWORK_EXCEPTION:n.LoaderErrors.EXCEPTION,NETWORK_STATUS_CODE_INVALID:n.LoaderErrors.HTTP_STATUS_CODE_INVALID,NETWORK_TIMEOUT:n.LoaderErrors.CONNECTING_TIMEOUT,NETWORK_UNRECOVERABLE_EARLY_EOF:n.LoaderErrors.UNRECOVERABLE_EARLY_EOF,MEDIA_MSE_ERROR:\"MediaMSEError\",MEDIA_FORMAT_ERROR:a.default.FORMAT_ERROR,MEDIA_FORMAT_UNSUPPORTED:a.default.FORMAT_UNSUPPORTED,MEDIA_CODEC_UNSUPPORTED:a.default.CODEC_UNSUPPORTED}},{\"../demux/demux-errors.js\":16,\"../io/loader.js\":24}],35:[function(e,t,r){Object.defineProperty(r,\"__esModule\",{value:!0}),r.default={ERROR:\"error\",LOADING_COMPLETE:\"loading_complete\",RECOVERED_EARLY_EOF:\"recovered_early_eof\",MEDIA_INFO:\"media_info\",METADATA_ARRIVED:\"metadata_arrived\",SCRIPTDATA_ARRIVED:\"scriptdata_arrived\",STATISTICS_INFO:\"statistics_info\"}},{}],36:[function(e,t,r){Object.defineProperty(r,\"__esModule\",{value:!0});var n=(function(e,t,r){r&&a(e,r)}(i,0,[{key:\"getSilentFrame\",value:function(e,t){if(\"mp4a.40.2\"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null}}]),i);function i(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,i)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.default=n},{}],37:[function(e,t,r){Object.defineProperty(r,\"__esModule\",{value:!0});var n=(function(e,t,r){r&&a(e,r)}(i,0,[{key:\"init\",value:function(){for(var e in i.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],\".mp3\":[]})i.types.hasOwnProperty(e)&&(i.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);var t=i.constants={};t.FTYP=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]),t.STSD_PREFIX=new Uint8Array([0,0,0,0,0,0,0,1]),t.STTS=new Uint8Array([0,0,0,0,0,0,0,0]),t.STSC=t.STCO=t.STTS,t.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),t.HDLR_VIDEO=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),t.HDLR_AUDIO=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),t.DREF=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),t.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),t.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}},{key:\"box\",value:function(e){for(var t=8,r=null,n=Array.prototype.slice.call(arguments,1),i=n.length,a=0;a<i;a++)t+=n[a].byteLength;(r=new Uint8Array(t))[0]=t>>>24&255,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r.set(e,4);for(var o=8,s=0;s<i;s++)r.set(n[s],o),o+=n[s].byteLength;return r}},{key:\"generateInitSegment\",value:function(e){var t=i.box(i.types.ftyp,i.constants.FTYP),r=i.moov(e),n=new Uint8Array(t.byteLength+r.byteLength);return n.set(t,0),n.set(r,t.byteLength),n}},{key:\"moov\",value:function(e){var t=i.mvhd(e.timescale,e.duration),r=i.trak(e),n=i.mvex(e);return i.box(i.types.moov,t,r,n)}},{key:\"mvhd\",value:function(e,t){return i.box(i.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,e>>>24&255,e>>>16&255,e>>>8&255,255&e,t>>>24&255,t>>>16&255,t>>>8&255,255&t,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))}},{key:\"trak\",value:function(e){return i.box(i.types.trak,i.tkhd(e),i.mdia(e))}},{key:\"tkhd\",value:function(e){var t=e.id,r=e.duration,n=e.presentWidth,a=e.presentHeight;return i.box(i.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t,0,0,0,0,r>>>24&255,r>>>16&255,r>>>8&255,255&r,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>>8&255,255&n,0,0,a>>>8&255,255&a,0,0]))}},{key:\"mdia\",value:function(e){return i.box(i.types.mdia,i.mdhd(e),i.hdlr(e),i.minf(e))}},{key:\"mdhd\",value:function(e){var t=e.timescale,r=e.duration;return i.box(i.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t,r>>>24&255,r>>>16&255,r>>>8&255,255&r,85,196,0,0]))}},{key:\"hdlr\",value:function(e){var t=\"audio\"===e.type?i.constants.HDLR_AUDIO:i.constants.HDLR_VIDEO;return i.box(i.types.hdlr,t)}},{key:\"minf\",value:function(e){var t=\"audio\"===e.type?i.box(i.types.smhd,i.constants.SMHD):i.box(i.types.vmhd,i.constants.VMHD);return i.box(i.types.minf,t,i.dinf(),i.stbl(e))}},{key:\"dinf\",value:function(){return i.box(i.types.dinf,i.box(i.types.dref,i.constants.DREF))}},{key:\"stbl\",value:function(e){return i.box(i.types.stbl,i.stsd(e),i.box(i.types.stts,i.constants.STTS),i.box(i.types.stsc,i.constants.STSC),i.box(i.types.stsz,i.constants.STSZ),i.box(i.types.stco,i.constants.STCO))}},{key:\"stsd\",value:function(e){return\"audio\"===e.type?\"mp3\"===e.codec?i.box(i.types.stsd,i.constants.STSD_PREFIX,i.mp3(e)):i.box(i.types.stsd,i.constants.STSD_PREFIX,i.mp4a(e)):i.box(i.types.stsd,i.constants.STSD_PREFIX,i.avc1(e))}},{key:\"mp3\",value:function(e){var t=e.channelCount,r=e.audioSampleRate,n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t,0,16,0,0,0,0,r>>>8&255,255&r,0,0]);return i.box(i.types[\".mp3\"],n)}},{key:\"mp4a\",value:function(e){var t=e.channelCount,r=e.audioSampleRate,n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t,0,16,0,0,0,0,r>>>8&255,255&r,0,0]);return i.box(i.types.mp4a,n,i.esds(e))}},{key:\"esds\",value:function(e){var t=e.config||[],r=t.length,n=new Uint8Array([0,0,0,0,3,23+r,0,1,0,4,15+r,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([r]).concat(t).concat([6,1,2]));return i.box(i.types.esds,n)}},{key:\"avc1\",value:function(e){var t=e.avcc,r=e.codecWidth,n=e.codecHeight,a=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,r>>>8&255,255&r,n>>>8&255,255&n,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return i.box(i.types.avc1,a,i.box(i.types.avcC,t))}},{key:\"mvex\",value:function(e){return i.box(i.types.mvex,i.trex(e))}},{key:\"trex\",value:function(e){var t=e.id,r=new Uint8Array([0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return i.box(i.types.trex,r)}},{key:\"moof\",value:function(e,t){return i.box(i.types.moof,i.mfhd(e.sequenceNumber),i.traf(e,t))}},{key:\"mfhd\",value:function(e){var t=new Uint8Array([0,0,0,0,e>>>24&255,e>>>16&255,e>>>8&255,255&e]);return i.box(i.types.mfhd,t)}},{key:\"traf\",value:function(e,t){var r=e.id,n=i.box(i.types.tfhd,new Uint8Array([0,0,0,0,r>>>24&255,r>>>16&255,r>>>8&255,255&r])),a=i.box(i.types.tfdt,new Uint8Array([0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t])),o=i.sdtp(e),s=i.trun(e,o.byteLength+16+16+8+16+8+8);return i.box(i.types.traf,n,a,s,o)}},{key:\"sdtp\",value:function(e){for(var t=e.samples||[],r=t.length,n=new Uint8Array(4+r),a=0;a<r;a++){var o=t[a].flags;n[a+4]=o.isLeading<<6|o.dependsOn<<4|o.isDependedOn<<2|o.hasRedundancy}return i.box(i.types.sdtp,n)}},{key:\"trun\",value:function(e,t){var r=e.samples||[],n=r.length,a=12+16*n,o=new Uint8Array(a);t+=8+a,o.set([0,0,15,1,n>>>24&255,n>>>16&255,n>>>8&255,255&n,t>>>24&255,t>>>16&255,t>>>8&255,255&t],0);for(var s=0;s<n;s++){var l=r[s].duration,d=r[s].size,u=r[s].flags,c=r[s].cts;o.set([l>>>24&255,l>>>16&255,l>>>8&255,255&l,d>>>24&255,d>>>16&255,d>>>8&255,255&d,u.isLeading<<2|u.dependsOn,u.isDependedOn<<6|u.hasRedundancy<<4|u.isNonSync,0,0,c>>>24&255,c>>>16&255,c>>>8&255,255&c],12+16*s)}return i.box(i.types.trun,o)}},{key:\"mdat\",value:function(e){return i.box(i.types.mdat,e)}}]),i);function i(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,i)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}n.init(),r.default=n},{}],38:[function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,\"__esModule\",{value:!0});var i=n(e(\"../utils/logger.js\")),a=n(e(\"./mp4-generator.js\")),o=n(e(\"./aac-silent.js\")),s=n(e(\"../utils/browser.js\")),l=e(\"../core/media-segment-info.js\"),d=e(\"../utils/exception.js\"),u=(function(e,t,r){t&&h(e.prototype,t),r&&h(e,r)}(c,[{key:\"destroy\",value:function(){this._dtsBase=-1,this._dtsBaseInited=!1,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList.clear(),this._audioSegmentInfoList=null,this._videoSegmentInfoList.clear(),this._videoSegmentInfoList=null,this._onInitSegment=null,this._onMediaSegment=null}},{key:\"bindDataSource\",value:function(e){return e.onDataAvailable=this.remux.bind(this),e.onTrackMetadata=this._onTrackMetadataReceived.bind(this),this}},{key:\"insertDiscontinuity\",value:function(){this._audioNextDts=this._videoNextDts=void 0}},{key:\"seek\",value:function(){this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._videoSegmentInfoList.clear(),this._audioSegmentInfoList.clear()}},{key:\"remux\",value:function(e,t){if(!this._onMediaSegment)throw new d.IllegalStateException(\"MP4Remuxer: onMediaSegment callback must be specificed!\");this._dtsBaseInited||this._calculateDtsBase(e,t),this._remuxVideo(t),this._remuxAudio(e)}},{key:\"_onTrackMetadataReceived\",value:function(e,t){var r=null,n=\"mp4\",i=t.codec;if(\"audio\"===e)r=\"mp3\"===(this._audioMeta=t).codec&&this._mp3UseMpegAudio?(n=\"mpeg\",i=\"\",new Uint8Array):a.default.generateInitSegment(t);else{if(\"video\"!==e)return;this._videoMeta=t,r=a.default.generateInitSegment(t)}if(!this._onInitSegment)throw new d.IllegalStateException(\"MP4Remuxer: onInitSegment callback must be specified!\");this._onInitSegment(e,{type:e,data:r.buffer,codec:i,container:e+\"/\"+n,mediaDuration:t.duration})}},{key:\"_calculateDtsBase\",value:function(e,t){this._dtsBaseInited||(e.samples&&e.samples.length&&(this._audioDtsBase=e.samples[0].dts),t.samples&&t.samples.length&&(this._videoDtsBase=t.samples[0].dts),this._dtsBase=Math.min(this._audioDtsBase,this._videoDtsBase),this._dtsBaseInited=!0)}},{key:\"flushStashedSamples\",value:function(){var e=this._videoStashedLastSample,t=this._audioStashedLastSample,r={type:\"video\",id:1,sequenceNumber:0,samples:[],length:0};null!=e&&(r.samples.push(e),r.length=e.length);var n={type:\"audio\",id:2,sequenceNumber:0,samples:[],length:0};null!=t&&(n.samples.push(t),n.length=t.length),this._videoStashedLastSample=null,this._audioStashedLastSample=null,this._remuxVideo(r,!0),this._remuxAudio(n,!0)}},{key:\"_remuxAudio\",value:function(e,t){if(null!=this._audioMeta){var r=e,n=r.samples,d=void 0,u=-1,c=this._audioMeta.refSampleDuration,h=\"mp3\"===this._audioMeta.codec&&this._mp3UseMpegAudio,f=this._dtsBaseInited&&void 0===this._audioNextDts,p=!1;if(n&&0!==n.length&&(1!==n.length||t)){var m,g=0,y=null,v=0,_=(v=h?(g=0,r.length):(g=8)+r.length,null);1<n.length&&(v-=(_=n.pop()).length),null!=this._audioStashedLastSample&&(m=this._audioStashedLastSample,this._audioStashedLastSample=null,n.unshift(m),v+=m.length),null!=_&&(this._audioStashedLastSample=_);var b,E,k,w,S,T,x,L=n[0].dts-this._dtsBase;this._audioNextDts?d=L-this._audioNextDts:this._audioSegmentInfoList.isEmpty()?(d=0,this._fillSilentAfterSeek&&!this._videoSegmentInfoList.isEmpty()&&\"mp3\"!==this._audioMeta.originalCodec&&(p=!0)):d=null!=(b=this._audioSegmentInfoList.getLastSampleBefore(L))?((E=L-(b.originalDts+b.duration))<=3&&(E=0),L-(b.dts+b.duration+E)):0,p&&(k=L-d,null!=(w=this._videoSegmentInfoList.getLastSegmentBefore(L))&&w.beginDts<k?(S=o.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount))&&(T=w.beginDts,x=k-w.beginDts,i.default.v(this.TAG,\"InsertPrefixSilentAudio: dts: \"+T+\", duration: \"+x),n.unshift({unit:S,dts:T,pts:T}),v+=S.byteLength):p=!1);for(var A=[],R=0;R<n.length;R++){var D=n[R],O=D.unit,C=D.dts-this._dtsBase,I=C-d;-1===u&&(u=I);var M=0,P=!1,B=null;if(1.5*c<(M=R!==n.length-1?n[R+1].dts-this._dtsBase-d-I:null!=_?_.dts-this._dtsBase-d-I:1<=A.length?A[A.length-1].duration:Math.floor(c))&&\"mp3\"!==this._audioMeta.codec&&this._fillAudioTimestampGap&&!s.default.safari){P=!0;var F=Math.abs(M-c),U=Math.ceil(F/c),N=I+c;i.default.w(this.TAG,\"Large audio timestamp gap detected, may cause AV sync to drift. Silent frames will be generated to avoid unsync.\\ndts: \"+(I+M)+\" ms, expected: \"+(I+Math.round(c))+\" ms, delta: \"+Math.round(F)+\" ms, generate: \"+U+\" frames\");var j=o.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);null==j&&(i.default.w(this.TAG,\"Unable to generate silent frame for \"+this._audioMeta.originalCodec+\" with \"+this._audioMeta.channelCount+\" channels, repeat last frame\"),j=O),B=[];for(var G=0;G<U;G++){var z,q=Math.round(N);0<B.length&&((z=B[B.length-1]).duration=q-z.dts);var V={dts:q,pts:q,cts:0,unit:j,size:j.byteLength,duration:0,originalDts:C,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}};B.push(V),v+=V.size,N+=c}var Y=B[B.length-1];Y.duration=I+M-Y.dts,M=Math.round(c)}A.push({dts:I,pts:I,cts:0,unit:D.unit,size:D.unit.byteLength,duration:M,originalDts:C,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),P&&A.push.apply(A,B)}h?y=new Uint8Array(v):((y=new Uint8Array(v))[0]=v>>>24&255,y[1]=v>>>16&255,y[2]=v>>>8&255,y[3]=255&v,y.set(a.default.types.mdat,4));for(var H=0;H<A.length;H++){var K=A[H].unit;y.set(K,g),g+=K.byteLength}var W=A[A.length-1],X=W.dts+W.duration;this._audioNextDts=X;var $=new l.MediaSegmentInfo;$.beginDts=u,$.endDts=X,$.beginPts=u,$.endPts=X,$.originalBeginDts=A[0].originalDts,$.originalEndDts=W.originalDts+W.duration,$.firstSample=new l.SampleInfo(A[0].dts,A[0].pts,A[0].duration,A[0].originalDts,!1),$.lastSample=new l.SampleInfo(W.dts,W.pts,W.duration,W.originalDts,!1),this._isLive||this._audioSegmentInfoList.append($),r.samples=A,r.sequenceNumber++;var Q=h?new Uint8Array:a.default.moof(r,u);r.samples=[],r.length=0;var J={type:\"audio\",data:this._mergeBoxes(Q,y).buffer,sampleCount:A.length,info:$};h&&f&&(J.timestampOffset=u),this._onMediaSegment(\"audio\",J)}}}},{key:\"_remuxVideo\",value:function(e,t){if(null!=this._videoMeta){var r=e,n=r.samples,i=void 0,o=-1,s=-1;if(n&&0!==n.length&&(1!==n.length||t)){var d,u=8,c=null,h=8+e.length,f=null;1<n.length&&(h-=(f=n.pop()).length),null!=this._videoStashedLastSample&&(d=this._videoStashedLastSample,this._videoStashedLastSample=null,n.unshift(d),h+=d.length),null!=f&&(this._videoStashedLastSample=f);var p,m,g=n[0].dts-this._dtsBase;i=this._videoNextDts?g-this._videoNextDts:this._videoSegmentInfoList.isEmpty()||null==(p=this._videoSegmentInfoList.getLastSampleBefore(g))?0:((m=g-(p.originalDts+p.duration))<=3&&(m=0),g-(p.dts+p.duration+m));for(var y=new l.MediaSegmentInfo,v=[],_=0;_<n.length;_++){var b=n[_],E=b.dts-this._dtsBase,k=b.isKeyframe,w=E-i,S=b.cts,T=w+S;-1===o&&(o=w,s=T);var x,L;L=_!==n.length-1?n[_+1].dts-this._dtsBase-i-w:null!=f?f.dts-this._dtsBase-i-w:1<=v.length?v[v.length-1].duration:Math.floor(this._videoMeta.refSampleDuration),k&&((x=new l.SampleInfo(w,T,L,b.dts,!0)).fileposition=b.fileposition,y.appendSyncPoint(x)),v.push({dts:w,pts:T,cts:S,units:b.units,size:b.length,isKeyframe:k,duration:L,originalDts:E,flags:{isLeading:0,dependsOn:k?2:1,isDependedOn:k?1:0,hasRedundancy:0,isNonSync:k?0:1}})}(c=new Uint8Array(h))[0]=h>>>24&255,c[1]=h>>>16&255,c[2]=h>>>8&255,c[3]=255&h,c.set(a.default.types.mdat,4);for(var A=0;A<v.length;A++)for(var R=v[A].units;R.length;){var D=R.shift().data;c.set(D,u),u+=D.byteLength}var O,C=v[v.length-1],I=C.dts+C.duration,M=C.pts+C.duration;this._videoNextDts=I,y.beginDts=o,y.endDts=I,y.beginPts=s,y.endPts=M,y.originalBeginDts=v[0].originalDts,y.originalEndDts=C.originalDts+C.duration,y.firstSample=new l.SampleInfo(v[0].dts,v[0].pts,v[0].duration,v[0].originalDts,v[0].isKeyframe),y.lastSample=new l.SampleInfo(C.dts,C.pts,C.duration,C.originalDts,C.isKeyframe),this._isLive||this._videoSegmentInfoList.append(y),r.samples=v,r.sequenceNumber++,this._forceFirstIDR&&((O=v[0].flags).dependsOn=2,O.isNonSync=0);var P=a.default.moof(r,o);r.samples=[],r.length=0,this._onMediaSegment(\"video\",{type:\"video\",data:this._mergeBoxes(P,c).buffer,sampleCount:v.length,info:y})}}}},{key:\"_mergeBoxes\",value:function(e,t){var r=new Uint8Array(e.byteLength+t.byteLength);return r.set(e,0),r.set(t,e.byteLength),r}},{key:\"onInitSegment\",get:function(){return this._onInitSegment},set:function(e){this._onInitSegment=e}},{key:\"onMediaSegment\",get:function(){return this._onMediaSegment},set:function(e){this._onMediaSegment=e}}]),c);function c(e){(function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")})(this,c),this.TAG=\"MP4Remuxer\",this._config=e,this._isLive=!0===e.isLive,this._dtsBase=-1,this._dtsBaseInited=!1,this._audioDtsBase=1/0,this._videoDtsBase=1/0,this._audioNextDts=void 0,this._videoNextDts=void 0,this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList=new l.MediaSegmentInfoList(\"audio\"),this._videoSegmentInfoList=new l.MediaSegmentInfoList(\"video\"),this._onInitSegment=null,this._onMediaSegment=null,this._forceFirstIDR=!(!s.default.chrome||!(s.default.version.major<50||50===s.default.version.major&&s.default.version.build<2661)),this._fillSilentAfterSeek=s.default.msedge||s.default.msie,this._mp3UseMpegAudio=!s.default.firefox,this._fillAudioTimestampGap=this._config.fixAudioTimestampGap}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.default=u},{\"../core/media-segment-info.js\":8,\"../utils/browser.js\":39,\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./aac-silent.js\":36,\"./mp4-generator.js\":37}],39:[function(e,t,r){Object.defineProperty(r,\"__esModule\",{value:!0});var n={};!function(){var e,t=self.navigator.userAgent.toLowerCase(),r=/(edge)\\/([\\w.]+)/.exec(t)||/(opr)[\\/]([\\w.]+)/.exec(t)||/(chrome)[ \\/]([\\w.]+)/.exec(t)||/(iemobile)[\\/]([\\w.]+)/.exec(t)||/(version)(applewebkit)[ \\/]([\\w.]+).*(safari)[ \\/]([\\w.]+)/.exec(t)||/(webkit)[ \\/]([\\w.]+).*(version)[ \\/]([\\w.]+).*(safari)[ \\/]([\\w.]+)/.exec(t)||/(webkit)[ \\/]([\\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \\/]([\\w.]+)/.exec(t)||/(msie) ([\\w.]+)/.exec(t)||0<=t.indexOf(\"trident\")&&/(rv)(?::| )([\\w.]+)/.exec(t)||t.indexOf(\"compatible\")<0&&/(firefox)[ \\/]([\\w.]+)/.exec(t)||[],i=/(ipad)/.exec(t)||/(ipod)/.exec(t)||/(windows phone)/.exec(t)||/(iphone)/.exec(t)||/(kindle)/.exec(t)||/(android)/.exec(t)||/(windows)/.exec(t)||/(mac)/.exec(t)||/(linux)/.exec(t)||/(cros)/.exec(t)||[],a={browser:r[5]||r[3]||r[1]||\"\",version:r[2]||r[4]||\"0\",majorVersion:r[4]||r[2]||\"0\",platform:i[0]||\"\"},o={};for(var s in a.browser&&(o[a.browser]=!0,e=a.majorVersion.split(\".\"),o.version={major:parseInt(a.majorVersion,10),string:a.version},1<e.length&&(o.version.minor=parseInt(e[1],10)),2<e.length&&(o.version.build=parseInt(e[2],10))),a.platform&&(o[a.platform]=!0),(o.chrome||o.opr||o.safari)&&(o.webkit=!0),(o.rv||o.iemobile)&&(o.rv&&delete o.rv,a.browser=\"msie\",o.msie=!0),o.edge&&(delete o.edge,a.browser=\"msedge\",o.msedge=!0),o.opr&&(a.browser=\"opera\",o.opera=!0),o.safari&&o.android&&(a.browser=\"android\",o.android=!0),o.name=a.browser,o.platform=a.platform,n)n.hasOwnProperty(s)&&delete n[s];Object.assign(n,o)}(),r.default=n},{}],40:[function(e,t,r){function n(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=i()(t)&&\"function\"!=typeof t?e:t}function a(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+i()(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function o(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}Object.defineProperty(r,\"__esModule\",{value:!0});var s=function(e,t,r){return t&&u(e.prototype,t),r&&u(e,r),e},l=r.RuntimeException=(s(d,[{key:\"toString\",value:function(){return this.name+\": \"+this.message}},{key:\"name\",get:function(){return\"RuntimeException\"}},{key:\"message\",get:function(){return this._message}}]),d);function d(e){o(this,d),this._message=e}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e){return o(this,c),n(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,e))}function h(e){return o(this,h),n(this,(h.__proto__||Object.getPrototypeOf(h)).call(this,e))}function f(e){return o(this,f),n(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,e))}r.IllegalStateException=(a(f,l),s(f,[{key:\"name\",get:function(){return\"IllegalStateException\"}}]),f),r.InvalidArgumentException=(a(h,l),s(h,[{key:\"name\",get:function(){return\"InvalidArgumentException\"}}]),h),r.NotImplementedException=(a(c,l),s(c,[{key:\"name\",get:function(){return\"NotImplementedException\"}}]),c)},{}],41:[function(e,t,r){Object.defineProperty(r,\"__esModule\",{value:!0});var n=e(\"events\"),i=n&&n.__esModule?n:{default:n},a=(function(e,t,r){t&&s(e.prototype,t),r&&s(e,r)}(o,null,[{key:\"e\",value:function(e,t){e&&!o.FORCE_GLOBAL_TAG||(e=o.GLOBAL_TAG);var r=\"[\"+e+\"] > \"+t;o.ENABLE_CALLBACK&&o.emitter.emit(\"log\",\"error\",r),o.ENABLE_ERROR&&(console.error?console.error(r):console.warn?console.warn(r):console.log(r))}},{key:\"i\",value:function(e,t){e&&!o.FORCE_GLOBAL_TAG||(e=o.GLOBAL_TAG);var r=\"[\"+e+\"] > \"+t;o.ENABLE_CALLBACK&&o.emitter.emit(\"log\",\"info\",r),o.ENABLE_INFO&&(console.info?console.info(r):console.log(r))}},{key:\"w\",value:function(e,t){e&&!o.FORCE_GLOBAL_TAG||(e=o.GLOBAL_TAG);var r=\"[\"+e+\"] > \"+t;o.ENABLE_CALLBACK&&o.emitter.emit(\"log\",\"warn\",r),o.ENABLE_WARN&&(console.warn?console.warn(r):console.log(r))}},{key:\"d\",value:function(e,t){e&&!o.FORCE_GLOBAL_TAG||(e=o.GLOBAL_TAG);var r=\"[\"+e+\"] > \"+t;o.ENABLE_CALLBACK&&o.emitter.emit(\"log\",\"debug\",r),o.ENABLE_DEBUG&&(console.debug?console.debug(r):console.log(r))}},{key:\"v\",value:function(e,t){e&&!o.FORCE_GLOBAL_TAG||(e=o.GLOBAL_TAG);var r=\"[\"+e+\"] > \"+t;o.ENABLE_CALLBACK&&o.emitter.emit(\"log\",\"verbose\",r),o.ENABLE_VERBOSE&&console.log(r)}}]),o);function o(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,o)}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}a.GLOBAL_TAG=\"flv.js\",a.FORCE_GLOBAL_TAG=!1,a.ENABLE_ERROR=!0,a.ENABLE_INFO=!0,a.ENABLE_WARN=!0,a.ENABLE_DEBUG=!0,a.ENABLE_VERBOSE=!0,a.ENABLE_CALLBACK=!1,a.emitter=new i.default,r.default=a},{events:2}],42:[function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,\"__esModule\",{value:!0});var i=n(e(\"events\")),a=n(e(\"./logger.js\")),o=(function(e,t,r){t&&l(e.prototype,t),r&&l(e,r)}(s,null,[{key:\"getConfig\",value:function(){return{globalTag:a.default.GLOBAL_TAG,forceGlobalTag:a.default.FORCE_GLOBAL_TAG,enableVerbose:a.default.ENABLE_VERBOSE,enableDebug:a.default.ENABLE_DEBUG,enableInfo:a.default.ENABLE_INFO,enableWarn:a.default.ENABLE_WARN,enableError:a.default.ENABLE_ERROR,enableCallback:a.default.ENABLE_CALLBACK}}},{key:\"applyConfig\",value:function(e){a.default.GLOBAL_TAG=e.globalTag,a.default.FORCE_GLOBAL_TAG=e.forceGlobalTag,a.default.ENABLE_VERBOSE=e.enableVerbose,a.default.ENABLE_DEBUG=e.enableDebug,a.default.ENABLE_INFO=e.enableInfo,a.default.ENABLE_WARN=e.enableWarn,a.default.ENABLE_ERROR=e.enableError,a.default.ENABLE_CALLBACK=e.enableCallback}},{key:\"_notifyChange\",value:function(){var e,t=s.emitter;0<t.listenerCount(\"change\")&&(e=s.getConfig(),t.emit(\"change\",e))}},{key:\"registerListener\",value:function(e){s.emitter.addListener(\"change\",e)}},{key:\"removeListener\",value:function(e){s.emitter.removeListener(\"change\",e)}},{key:\"addLogListener\",value:function(e){a.default.emitter.addListener(\"log\",e),0<a.default.emitter.listenerCount(\"log\")&&(a.default.ENABLE_CALLBACK=!0,s._notifyChange())}},{key:\"removeLogListener\",value:function(e){a.default.emitter.removeListener(\"log\",e),0===a.default.emitter.listenerCount(\"log\")&&(a.default.ENABLE_CALLBACK=!1,s._notifyChange())}},{key:\"forceGlobalTag\",get:function(){return a.default.FORCE_GLOBAL_TAG},set:function(e){a.default.FORCE_GLOBAL_TAG=e,s._notifyChange()}},{key:\"globalTag\",get:function(){return a.default.GLOBAL_TAG},set:function(e){a.default.GLOBAL_TAG=e,s._notifyChange()}},{key:\"enableAll\",get:function(){return a.default.ENABLE_VERBOSE&&a.default.ENABLE_DEBUG&&a.default.ENABLE_INFO&&a.default.ENABLE_WARN&&a.default.ENABLE_ERROR},set:function(e){a.default.ENABLE_VERBOSE=e,a.default.ENABLE_DEBUG=e,a.default.ENABLE_INFO=e,a.default.ENABLE_WARN=e,a.default.ENABLE_ERROR=e,s._notifyChange()}},{key:\"enableDebug\",get:function(){return a.default.ENABLE_DEBUG},set:function(e){a.default.ENABLE_DEBUG=e,s._notifyChange()}},{key:\"enableVerbose\",get:function(){return a.default.ENABLE_VERBOSE},set:function(e){a.default.ENABLE_VERBOSE=e,s._notifyChange()}},{key:\"enableInfo\",get:function(){return a.default.ENABLE_INFO},set:function(e){a.default.ENABLE_INFO=e,s._notifyChange()}},{key:\"enableWarn\",get:function(){return a.default.ENABLE_WARN},set:function(e){a.default.ENABLE_WARN=e,s._notifyChange()}},{key:\"enableError\",get:function(){return a.default.ENABLE_ERROR},set:function(e){a.default.ENABLE_ERROR=e,s._notifyChange()}}]),s);function s(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,s)}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}o.emitter=new i.default,r.default=o},{\"./logger.js\":41,events:2}],43:[function(e,t,r){Object.defineProperty(r,\"__esModule\",{value:!0});var n=(function(e,t,r){r&&a(e,r)}(i,0,[{key:\"install\",value:function(){Object.setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Object.assign=Object.assign||function(e){if(null==e)throw new TypeError(\"Cannot convert undefined or null to object\");for(var t=Object(e),r=1;r<arguments.length;r++){var n=arguments[r];if(null!=n)for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])}return t},\"function\"!=typeof self.Promise&&e(\"es6-promise\").polyfill()}}]),i);function i(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,i)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}n.install(),r.default=n},{\"es6-promise\":1}],44:[function(e,t,r){function n(e,t,r){var n=e;if(t+r<n.length){for(;r--;)if(128!=(192&n[++t]))return;return 1}}Object.defineProperty(r,\"__esModule\",{value:!0}),r.default=function(e){for(var t=[],r=e,i=0,a=e.length;i<a;)if(r[i]<128)t.push(String.fromCharCode(r[i])),++i;else{if(!(r[i]<192))if(r[i]<224){if(n(r,i,1)){var o=(31&r[i])<<6|63&r[i+1];if(128<=o){t.push(String.fromCharCode(65535&o)),i+=2;continue}}}else if(r[i]<240){if(n(r,i,2)){var s=(15&r[i])<<12|(63&r[i+1])<<6|63&r[i+2];if(2048<=s&&55296!=(63488&s)){t.push(String.fromCharCode(65535&s)),i+=3;continue}}}else if(r[i]<248&&n(r,i,3)){var l=(7&r[i])<<18|(63&r[i+1])<<12|(63&r[i+2])<<6|63&r[i+3];if(65536<l&&l<1114112){l-=65536,t.push(String.fromCharCode(l>>>10|55296)),t.push(String.fromCharCode(1023&l|56320)),i+=4;continue}}t.push(String.fromCharCode(65533)),++i}return t.join(\"\")}},{}]},{},[21])(21)}))}).call(this,r(\"./node_modules/webpack/buildin/global.js\"),r(\"./node_modules/webpack/buildin/harmony-module.js\")(e))}},e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:n})},e.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},e.t=function(t,r){if(1&r&&(t=e(t)),8&r)return t;if(4&r&&\"object\"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:t}),2&r&&\"string\"!=typeof t)for(var i in t)e.d(n,i,function(e){return t[e]}.bind(null,i));return n},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,\"a\",r),r},e.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},e.p=\"\",e(e.s=\"./src/index.js\");function e(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var t,r}));","extractedComments":[]}